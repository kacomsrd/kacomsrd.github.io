!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.tased=t():e.tased=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/scripts/",n(n.s=484)}({100:function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},105:function(e,t,n){"use strict";n.r(t),n.d(t,"AuthError",(function(){return m})),n.d(t,"AuthErrorMessage",(function(){return g})),n.d(t,"BrowserAuthError",(function(){return Zt})),n.d(t,"BrowserAuthErrorMessage",(function(){return Jt})),n.d(t,"BrowserConfigurationAuthError",(function(){return an})),n.d(t,"BrowserConfigurationAuthErrorMessage",(function(){return on})),n.d(t,"InteractionRequiredAuthError",(function(){return kt})),n.d(t,"LogLevel",(function(){return h})),n.d(t,"Logger",(function(){return se})),n.d(t,"PublicClientApplication",(function(){return Cn}));
/*! @azure/msal-browser v2.1.0 2020-08-25 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function i(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function a(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}c((r=r.apply(e,t||[])).next())}))}function s(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function c(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}
/*! @azure/msal-common v1.2.0 2020-08-25 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var u=function(e,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function l(e,t){function n(){this.constructor=e}u(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var d=function(){return(d=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function f(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}c((r=r.apply(e,t||[])).next())}))}function p(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var h,g={unexpectedError:{code:"unexpected_error",desc:"Unexpected error in authentication."}},m=function(e){function t(n,r){var i=this,o=r?n+": "+r:n;return i=e.call(this,o)||this,Object.setPrototypeOf(i,t.prototype),i.errorCode=n,i.errorMessage=r,i.name="AuthError",i}return l(t,e),t.createUnexpectedError=function(e){return new t(g.unexpectedError.code,g.unexpectedError.desc+": "+e)},t}(Error),v="1.2.0",y={code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},w={code:"client_info_empty_error",desc:"The client info was empty. Please review the trace to determine the root cause."},b={code:"id_token_parsing_error",desc:"ID token cannot be parsed. Please review stack trace to determine root cause."},C={code:"null_or_empty_id_token",desc:"The idToken is null or empty. Please review the trace to determine the root cause."},E={code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},I={code:"invalid_authority_type",desc:"The given authority is not a valid type of authority supported by MSAL. Please review the trace to determine the root cause."},T={code:"hash_not_deserialized",desc:"The hash parameters could not be deserialized. Please review the trace to determine the root cause."},S={code:"invalid_state",desc:"State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState()."},_={code:"state_mismatch",desc:"State mismatch error. Please check your network. Continued requests may cause cache overflow."},A={code:"nonce_mismatch",desc:"Nonce mismatch error. This may be caused by a race condition in concurrent requests."},x={code:"account_mismatch",desc:"The cached account and account which made the token request do not match."},R={code:"invalid_id_token",desc:"Invalid ID token format."},k={code:"no_tokens_found",desc:"No tokens were found for the given scopes, and no authorization code was passed to acquireToken. You must retrieve an authorization code before making a call to acquireToken()."},P={code:"cache_parse_error",desc:"Could not parse cache key."},O={code:"user_login_error",desc:"User login is required."},N={code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account."},M={code:"multiple_matching_accounts",desc:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account"},D={code:"request_cannot_be_made",desc:"Token request cannot be made without authorization code or refresh token."},L={code:"cannot_append_empty_scope",desc:"Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info."},U={code:"cannot_remove_empty_scope",desc:"Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info."},F={code:"cannot_append_scopeset",desc:"Cannot append ScopeSet due to error."},q={code:"empty_input_scopeset",desc:"Empty input ScopeSet cannot be processed."},V={code:"device_code_polling_cancelled",desc:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true."},G={code:"device_code_expired",desc:"Device code is expired."},H={code:"no_account_in_silent_request",desc:"Please pass an account object, silent flow is not supported without account information"},j={code:"invalid_cache_record",desc:"Cache record object was null or undefined."},z={code:"invalid_cache_environment",desc:"Invalid environment when attempting to create cache entry"},B={code:"no_account_found",desc:"No account found in cache for given key."},K={code:"no cache plugin set on CacheManager",desc:"ICachePlugin needs to be set before using readFromStorage or writeFromStorage"},W={code:"no_crypto_object",desc:"No crypto object detected. This is required for the following operation: "},X={code:"invalid_cache_type",desc:"Invalid cache type"},Y={code:"unexpected_account_type",desc:"Unexpected account type."},Q={code:"unexpected_credential_type",desc:"Unexpected credential type."},J={code:"invalid_assertion",desc:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515"},Z={code:"invalid_client_credential",desc:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential"},$=function(e){function t(n,r){var i=e.call(this,n,r)||this;return i.name="ClientAuthError",Object.setPrototypeOf(i,t.prototype),i}return l(t,e),t.createClientInfoDecodingError=function(e){return new t(y.code,y.desc+" Failed with error: "+e)},t.createClientInfoEmptyError=function(e){return new t(w.code,w.desc+" Given Object: "+e)},t.createIdTokenParsingError=function(e){return new t(b.code,b.desc+" Failed with error: "+e)},t.createIdTokenNullOrEmptyError=function(e){return new t(C.code,C.desc+" Raw ID Token Value: "+e)},t.createEndpointDiscoveryIncompleteError=function(e){return new t(E.code,E.desc+" Detail: "+e)},t.createInvalidAuthorityTypeError=function(e){return new t(I.code,I.desc+" Given Url: "+e)},t.createHashNotDeserializedError=function(e){return new t(T.code,T.desc+" Given Object: "+e)},t.createInvalidStateError=function(e,n){return new t(S.code,S.desc+" Invalid State: "+e+", Root Err: "+n)},t.createStateMismatchError=function(){return new t(_.code,_.desc)},t.createNonceMismatchError=function(){return new t(A.code,A.desc)},t.createAccountMismatchError=function(){return new t(x.code,x.desc)},t.createInvalidIdTokenError=function(e){return new t(R.code,R.desc+" Given token: "+JSON.stringify(e))},t.createNoTokensFoundError=function(){return new t(k.code,k.desc)},t.createCacheParseError=function(e){return new t(P.code,P.desc+" Cache key: "+e)},t.createUserLoginRequiredError=function(){return new t(O.code,O.desc)},t.createMultipleMatchingTokensInCacheError=function(e){return new t(N.code,"Cache error for scope "+e+": "+N.desc+".")},t.createMultipleMatchingAccountsInCacheError=function(){return new t(M.code,M.desc)},t.createTokenRequestCannotBeMadeError=function(){return new t(D.code,D.desc)},t.createAppendEmptyScopeToSetError=function(e){return new t(L.code,L.desc+" Given Scope: "+e)},t.createRemoveEmptyScopeFromSetError=function(e){return new t(U.code,U.desc+" Given Scope: "+e)},t.createAppendScopeSetError=function(e){return new t(F.code,F.desc+" Detail Error: "+e)},t.createEmptyInputScopeSetError=function(e){return new t(q.code,q.desc+" Given ScopeSet: "+e)},t.createDeviceCodeCancelledError=function(){return new t(V.code,""+V.desc)},t.createDeviceCodeExpiredError=function(){return new t(G.code,""+G.desc)},t.createNoAccountInSilentRequestError=function(){return new t(H.code,""+H.desc)},t.createNullOrUndefinedCacheRecord=function(){return new t(j.code,j.desc)},t.createInvalidCacheEnvironmentError=function(){return new t(z.code,z.desc)},t.createNoAccountFoundError=function(){return new t(B.code,B.desc)},t.createCachePluginError=function(){return new t(K.code,""+K.desc)},t.createNoCryptoObjectError=function(e){return new t(W.code,""+W.desc+e)},t.createInvalidCacheTypeError=function(){return new t(X.code,""+X.desc)},t.createUnexpectedAccountTypeError=function(){return new t(Y.code,""+Y.desc)},t.createUnexpectedCredentialTypeError=function(){return new t(Q.code,""+Q.desc)},t.createInvalidAssertionError=function(){return new t(J.code,""+J.desc)},t.createInvalidCredentialError=function(){return new t(Z.code,""+Z.desc)},t}(m),ee=function(){function e(){}return e.decodeJwt=function(t){if(e.isEmpty(t))throw $.createIdTokenNullOrEmptyError(t);var n=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);if(!n||n.length<4)throw $.createIdTokenParsingError("Given token is malformed: "+JSON.stringify(t));return{header:n[1],JWSPayload:n[2],JWSSig:n[3]}},e.isEmpty=function(e){return void 0===e||!e||0===e.length},e.startsWith=function(e,t){return 0===e.indexOf(t)},e.endsWith=function(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length},e.queryStringToObject=function(e){var t,n=/\+/g,r=/([^&=]+)=([^&]*)/g,i=function(e){return decodeURIComponent(decodeURIComponent(e.replace(n," ")))},o={};for(t=r.exec(e);t;)o[i(t[1])]=i(t[2]),t=r.exec(e);return o},e.trimArrayEntries=function(e){return e.map((function(e){return e.trim()}))},e.removeEmptyStringsFromArray=function(t){return t.filter((function(t){return!e.isEmpty(t)}))},e}();!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(h||(h={}));var te,ne,re,ie,oe,ae,se=function(){function e(e){this.level=h.Info,e&&(this.localCallback=e.loggerCallback,this.piiLoggingEnabled=e.piiLoggingEnabled,this.level=e.logLevel)}return e.prototype.logMessage=function(e,t){if(!(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)){var n=(new Date).toUTCString(),r=(ee.isEmpty(this.correlationId)?"["+n+"] : ":"["+n+"] : ["+this.correlationId+"]")+" : "+v+" : "+h[t.logLevel]+" - "+e;this.executeCallback(t.logLevel,r,t.containsPii)}},e.prototype.executeCallback=function(e,t,n){this.localCallback&&this.localCallback(e,t,n)},e.prototype.error=function(e,t){this.logMessage(e,{logLevel:h.Error,containsPii:!1,correlationId:t||""})},e.prototype.errorPii=function(e,t){this.logMessage(e,{logLevel:h.Error,containsPii:!0,correlationId:t||""})},e.prototype.warning=function(e,t){this.logMessage(e,{logLevel:h.Warning,containsPii:!1,correlationId:t||""})},e.prototype.warningPii=function(e,t){this.logMessage(e,{logLevel:h.Warning,containsPii:!0,correlationId:t||""})},e.prototype.info=function(e,t){this.logMessage(e,{logLevel:h.Info,containsPii:!1,correlationId:t||""})},e.prototype.infoPii=function(e,t){this.logMessage(e,{logLevel:h.Info,containsPii:!0,correlationId:t||""})},e.prototype.verbose=function(e,t){this.logMessage(e,{logLevel:h.Verbose,containsPii:!1,correlationId:t||""})},e.prototype.verbosePii=function(e,t){this.logMessage(e,{logLevel:h.Verbose,containsPii:!0,correlationId:t||""})},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},e}(),ce="MSAL.JS",ue="msal.js.common",le="msal",de="https://login.microsoftonline.com/common/",fe="adfs",pe="https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",he="|",ge="openid",me="profile",ve="offline_access",ye="code",we="S256",be="application/x-www-form-urlencoded;charset=utf-8",Ce="authorization_pending",Ee="not_defined";!function(e){e.CONTENT_TYPE="Content-Type",e.X_CLIENT_CURR_TELEM="x-client-current-telemetry",e.X_CLIENT_LAST_TELEM="x-client-last-telemetry"}(te||(te={})),function(e){e.ID_TOKEN="idtoken",e.CLIENT_INFO="client.info",e.ADAL_ID_TOKEN="adal.idtoken",e.ERROR="error",e.ERROR_DESC="error.description"}(ne||(ne={})),function(e){e.COMMON="common",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers"}(re||(re={})),function(e){e.CLIENT_ID="client_id",e.REDIRECT_URI="redirect_uri",e.RESPONSE_TYPE="response_type",e.RESPONSE_MODE="response_mode",e.GRANT_TYPE="grant_type",e.CLAIMS="claims",e.SCOPE="scope",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.REFRESH_TOKEN="refresh_token",e.EXPIRES_IN="expires_in",e.STATE="state",e.NONCE="nonce",e.PROMPT="prompt",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info",e.CODE="code",e.CODE_CHALLENGE="code_challenge",e.CODE_CHALLENGE_METHOD="code_challenge_method",e.CODE_VERIFIER="code_verifier",e.CLIENT_REQUEST_ID="client-request-id",e.X_CLIENT_SKU="x-client-SKU",e.X_CLIENT_VER="x-client-VER",e.X_CLIENT_OS="x-client-OS",e.X_CLIENT_CPU="x-client-CPU",e.POST_LOGOUT_URI="post_logout_redirect_uri",e.DEVICE_CODE="device_code",e.CLIENT_SECRET="client_secret",e.CLIENT_ASSERTION="client_assertion",e.CLIENT_ASSERTION_TYPE="client_assertion_type"}(ie||(ie={})),function(e){e.ISSUER="iss",e.OBJID="oid",e.SUBJECT="sub",e.TENANTID="tid",e.VERSION="ver",e.PREF_USERNAME="preferred_username",e.NAME="name",e.NONCE="nonce",e.EXPIRATION="exp",e.HOME_OBJID="home_oid",e.SESSIONID="sid",e.CLOUD_INSTANCE_HOSTNAME="cloud_instance_host_name"}(oe||(oe={})),function(e){e.ACCESS_TOKEN="access_token",e.XMS_CC="xms_cc"}(ae||(ae={}));var Ie,Te={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"};!function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ID_TOKEN="id_token",e.DOMAIN_HINT="domain_hint",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"}(Ie||(Ie={}));Ie.SID,Ie.LOGIN_HINT;var Se,_e,Ae,xe,Re,ke,Pe,Oe={PLAIN:"plain",S256:"S256"};!function(e){e.QUERY="query",e.FRAGMENT="fragment",e.FORM_POST="form_post"}(Se||(Se={})),function(e){e.IMPLICIT_GRANT="implicit",e.AUTHORIZATION_CODE_GRANT="authorization_code",e.CLIENT_CREDENTIALS_GRANT="client_credentials",e.RESOURCE_OWNER_PASSWORD_GRANT="password",e.REFRESH_TOKEN_GRANT="refresh_token",e.DEVICE_CODE_GRANT="device_code"}(_e||(_e={})),function(e){e.MSSTS_ACCOUNT_TYPE="MSSTS",e.ADFS_ACCOUNT_TYPE="ADFS",e.MSAV1_ACCOUNT_TYPE="MSA",e.GENERIC_ACCOUNT_TYPE="Generic"}(Ae||(Ae={})),function(e){e.CACHE_KEY_SEPARATOR="-",e.CLIENT_INFO_SEPARATOR="."}(xe||(xe={})),function(e){e.ID_TOKEN="IdToken",e.ACCESS_TOKEN="AccessToken",e.REFRESH_TOKEN="RefreshToken"}(Re||(Re={})),function(e){e.ACCOUNT="Account",e.CREDENTIAL="Credential",e.APP_METADATA="AppMetadata",e.TEMPORARY="TempCache",e.TELEMETRY="Telemetry"}(ke||(ke={})),function(e){e[e.ADFS=1001]="ADFS",e[e.MSA=1002]="MSA",e[e.MSSTS=1003]="MSSTS",e[e.GENERIC=1004]="GENERIC",e[e.ACCESS_TOKEN=2001]="ACCESS_TOKEN",e[e.REFRESH_TOKEN=2002]="REFRESH_TOKEN",e[e.ID_TOKEN=2003]="ID_TOKEN",e[e.APP_METADATA=3001]="APP_METADATA"}(Pe||(Pe={}));var Ne={SCHEMA_VERSION:2,FAILURE_LIMIT:3,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:","},Me=function(){function e(){}return e.prototype.generateAccountId=function(){return e.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},e.prototype.generateCredentialId=function(){return e.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},e.prototype.generateTarget=function(){return e.generateTargetForCacheKey(this.target)},e.prototype.generateCredentialKey=function(){return e.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId)},e.prototype.generateType=function(){switch(this.credentialType){case Re.ID_TOKEN:return Pe.ID_TOKEN;case Re.ACCESS_TOKEN:return Pe.ACCESS_TOKEN;case Re.REFRESH_TOKEN:return Pe.REFRESH_TOKEN;default:throw $.createUnexpectedCredentialTypeError()}},e.getCredentialType=function(e){return-1!==e.indexOf(Re.ACCESS_TOKEN.toLowerCase())?Re.ACCESS_TOKEN:-1!==e.indexOf(Re.ID_TOKEN.toLowerCase())?Re.ID_TOKEN:-1!==e.indexOf(Re.REFRESH_TOKEN.toLowerCase())?Re.REFRESH_TOKEN:Ee},e.generateCredentialCacheKey=function(e,t,n,r,i,o,a){return[this.generateAccountIdForCacheKey(e,t),this.generateCredentialIdForCacheKey(n,r,i,a),this.generateTargetForCacheKey(o)].join(xe.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateAccountIdForCacheKey=function(e,t){return[e,t].join(xe.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateCredentialIdForCacheKey=function(e,t,n,r){return[e,e===Re.REFRESH_TOKEN&&r||t,n||""].join(xe.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateTargetForCacheKey=function(e){return(e||"").toLowerCase()},e}(),De={code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},Le={code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},Ue={code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},Fe={code:"authority_uri_insecure",desc:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},qe={code:"url_parse_error",desc:"URL could not be parsed into appropriate segments."},Ve={code:"empty_url_error",desc:"URL was empty or null."},Ge={code:"empty_input_scopes_error",desc:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token."},He={code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},je={code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},ze={code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent' and 'none'.  Please see here for valid configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},Be={code:"invalid_claims",desc:"Given claims parameter must be a stringified JSON object."},Ke={code:"token_request_empty",desc:"Token request was empty and not found in cache."},We={code:"logout_request_empty",desc:"The logout request was null or undefined."},Xe={code:"invalid_code_challenge_method",desc:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".'},Ye={code:"pkce_params_missing",desc:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request"},Qe={code:"invalid_known_authorities",desc:"knownAuthorities and cloudDiscoveryMetadata cannot both be provided. Please provide cloudDiscoveryMetadata object for AAD, knownAuthorities otherwise."},Je={code:"invalid_cloud_discovery_metadata",desc:"Invalid cloudDiscoveryMetadata provided. Must be a JSON object containing tenant_discovery_endpoint and metadata fields"},Ze={code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter."},$e=function(e){function t(n,r){var i=e.call(this,n,r)||this;return i.name="ClientConfigurationError",Object.setPrototypeOf(i,t.prototype),i}return l(t,e),t.createRedirectUriEmptyError=function(){return new t(De.code,De.desc)},t.createPostLogoutRedirectUriEmptyError=function(){return new t(Le.code,Le.desc)},t.createClaimsRequestParsingError=function(e){return new t(Ue.code,Ue.desc+" Given value: "+e)},t.createInsecureAuthorityUriError=function(e){return new t(Fe.code,Fe.desc+" Given URI: "+e)},t.createUrlParseError=function(e){return new t(qe.code,qe.desc+" Given Error: "+e)},t.createUrlEmptyError=function(){return new t(Ve.code,Ve.desc)},t.createScopesNonArrayError=function(e){return new t(He.code,He.desc+" Given Scopes: "+e)},t.createEmptyScopesArrayError=function(e){return new t(Ge.code,Ge.desc+" Given Scopes: "+e)},t.createClientIdSingleScopeError=function(e){return new t(je.code,je.desc+" Given Scopes: "+e)},t.createInvalidPromptError=function(e){return new t(ze.code,ze.desc+" Given value: "+e)},t.createInvalidClaimsRequestError=function(){return new t(Be.code,Be.desc)},t.createEmptyLogoutRequestError=function(){return new t(We.code,We.desc)},t.createEmptyTokenRequestError=function(){return new t(Ke.code,Ke.desc)},t.createInvalidCodeChallengeMethodError=function(){return new t(Xe.code,Xe.desc)},t.createInvalidCodeChallengeParamsError=function(){return new t(Ye.code,Ye.desc)},t.createKnownAuthoritiesCloudDiscoveryMetadataError=function(){return new t(Qe.code,Qe.desc)},t.createInvalidCloudDiscoveryMetadataError=function(){return new t(Je.code,Je.desc)},t.createUntrustedAuthorityError=function(){return new t(Ze.code,Ze.desc)},t}($),et=function(){function e(e){var t=this,n=e?ee.trimArrayEntries(function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}(e)):[],r=n?ee.removeEmptyStringsFromArray(n):[];this.validateInputScopes(r),this.scopes=new Set,r.forEach((function(e){return t.scopes.add(e)}))}return e.fromString=function(t){return new e((t=t||"").split(" "))},e.prototype.validateInputScopes=function(e){if(!e||e.length<1)throw $e.createEmptyScopesArrayError(e)},e.prototype.containsScope=function(e){return!ee.isEmpty(e)&&this.scopes.has(e)},e.prototype.containsScopeSet=function(e){var t=this;return!(!e||e.scopes.size<=0)&&(this.scopes.size>=e.scopes.size&&e.asArray().every((function(e){return t.containsScope(e)})))},e.prototype.appendScope=function(e){ee.isEmpty(e)||this.scopes.add(e.trim())},e.prototype.appendScopes=function(e){var t=this;try{e.forEach((function(e){return t.appendScope(e)}))}catch(e){throw $.createAppendScopeSetError(e)}},e.prototype.removeScope=function(e){if(ee.isEmpty(e))throw $.createRemoveEmptyScopeFromSetError(e);this.scopes.delete(e.trim())},e.prototype.unionScopeSets=function(e){if(!e)throw $.createEmptyInputScopeSetError(e);var t=new Set;return e.scopes.forEach((function(e){return t.add(e)})),this.scopes.forEach((function(e){return t.add(e)})),t},e.prototype.intersectingScopeSets=function(e){if(!e)throw $.createEmptyInputScopeSetError(e);var t=this.unionScopeSets(e),n=e.getScopeCount(),r=this.getScopeCount();return t.size<r+n},e.prototype.getScopeCount=function(){return this.scopes.size},e.prototype.asArray=function(){var e=[];return this.scopes.forEach((function(t){return e.push(t)})),e},e.prototype.printScopes=function(){return this.scopes?this.asArray().join(" "):""},e.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()},e}();function tt(e,t){if(ee.isEmpty(e))throw $.createClientInfoEmptyError(e);try{var n=t.base64Decode(e);return JSON.parse(n)}catch(e){throw $.createClientInfoDecodingError(e)}}var nt=function(){function e(t){if(this._urlString=t,ee.isEmpty(this._urlString))throw $e.createUrlEmptyError();ee.isEmpty(this.getHash())&&(this._urlString=e.canonicalizeUri(t))}return Object.defineProperty(e.prototype,"urlString",{get:function(){return this._urlString},enumerable:!0,configurable:!0}),e.canonicalizeUri=function(e){return e&&(e=e.toLowerCase()),e&&!ee.endsWith(e,"/")&&(e+="/"),e},e.prototype.validateAsUri=function(){var e;try{e=this.getUrlComponents()}catch(e){throw $e.createUrlParseError(e)}if(!e.HostNameAndPort||!e.PathSegments||e.PathSegments.length<1)throw $e.createUrlParseError("Given url string: "+this.urlString);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw $e.createInsecureAuthorityUriError(this.urlString)},e.prototype.urlRemoveQueryStringParameter=function(e){var t=new RegExp("(\\&"+e+"=)[^&]+");return this._urlString=this.urlString.replace(t,""),t=new RegExp("("+e+"=)[^&]+&"),this._urlString=this.urlString.replace(t,""),t=new RegExp("("+e+"=)[^&]+"),this._urlString=this.urlString.replace(t,""),this.urlString},e.removeHashFromUrl=function(t){return e.canonicalizeUri(t.split("#")[0])},e.prototype.replaceTenantPath=function(t){var n=this.getUrlComponents(),r=n.PathSegments;return!t||0===r.length||r[0]!==re.COMMON&&r[0]!==re.ORGANIZATIONS||(r[0]=t),e.constructAuthorityUriFromObject(n)},e.prototype.getHash=function(){return e.parseHash(this.urlString)},e.prototype.getUrlComponents=function(){var e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw $e.createUrlParseError("Given url string: "+this.urlString);var n={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5]},r=n.AbsolutePath.split("/");return r=r.filter((function(e){return e&&e.length>0})),n.PathSegments=r,n},e.getDomainFromUrl=function(e){var t=RegExp("^([^:/?#]+://)?([^/?#]*)"),n=e.match(t);if(!n)throw $e.createUrlParseError("Given url string: "+e);return n[2]},e.parseHash=function(e){var t=e.indexOf("#"),n=e.indexOf("#/");return n>-1?e.substring(n+2):t>-1?e.substring(t+1):""},e.constructAuthorityUriFromObject=function(t){return new e(t.Protocol+"//"+t.HostNameAndPort+"/"+t.PathSegments.join("/"))},e.getDeserializedHash=function(t){if(ee.isEmpty(t))return{};var n=e.parseHash(t),r=ee.queryStringToObject(ee.isEmpty(n)?t:n);if(!r)throw $.createHashNotDeserializedError(JSON.stringify(r));return r},e.hashContainsKnownProperties=function(t){if(ee.isEmpty(t))return!1;var n=e.getDeserializedHash(t);return!!(n.code||n.error_description||n.error||n.state)},e}(),rt=function(){function e(){}return e.setTrustedAuthoritiesFromConfig=function(e,t){if(!this.getTrustedHostList().length){if(e.length>0&&!ee.isEmpty(t))throw $e.createKnownAuthoritiesCloudDiscoveryMetadataError();this.createCloudDiscoveryMetadataFromKnownAuthorities(e);try{if(t){var n=JSON.parse(t);this.saveCloudDiscoveryMetadata(n.metadata)}}catch(e){throw $e.createInvalidCloudDiscoveryMetadataError()}}},e.setTrustedAuthoritiesFromNetwork=function(e,t){return f(this,void 0,void 0,(function(){var n,r,i,o;return p(this,(function(a){switch(a.label){case 0:n=""+pe+e.urlString+"oauth2/v2.0/authorize",a.label=1;case 1:return a.trys.push([1,3,,4]),[4,t.sendGetRequestAsync(n)];case 2:return r=a.sent(),i=r.body.metadata,this.saveCloudDiscoveryMetadata(i),[3,4];case 3:return a.sent(),[2];case 4:return o=e.getUrlComponents().HostNameAndPort,this.getTrustedHostList().length>0&&!this.IsInTrustedHostList(o)&&this.createCloudDiscoveryMetadataFromKnownAuthorities([o]),[2]}}))}))},e.saveCloudDiscoveryMetadata=function(t){t.forEach((function(t){t.aliases.forEach((function(n){e.TrustedHostList[n.toLowerCase()]=t}))}))},e.createCloudDiscoveryMetadataFromKnownAuthorities=function(e){var t=this;e.forEach((function(e){var n=nt.getDomainFromUrl(e).toLowerCase();t.TrustedHostList[n]={preferred_cache:n,preferred_network:n,aliases:[n]}}))},e.getTrustedHostList=function(){return Object.keys(this.TrustedHostList)},e.getCloudDiscoveryMetadata=function(e){return this.TrustedHostList[e.toLowerCase()]||null},e.IsInTrustedHostList=function(e){return Object.keys(this.TrustedHostList).indexOf(e.toLowerCase())>-1},e.TrustedHostList={},e}(),it=function(){function e(){}return e.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(xe.CACHE_KEY_SEPARATOR).toLowerCase()},e.prototype.generateAccountKey=function(){return e.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username})},e.prototype.generateType=function(){switch(this.authorityType){case Ae.ADFS_ACCOUNT_TYPE:return Pe.ADFS;case Ae.MSAV1_ACCOUNT_TYPE:return Pe.MSA;case Ae.MSSTS_ACCOUNT_TYPE:return Pe.MSSTS;case Ae.GENERIC_ACCOUNT_TYPE:return Pe.GENERIC;default:throw $.createUnexpectedAccountTypeError()}},e.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username}},e.generateAccountCacheKey=function(e){return[e.homeAccountId,e.environment||"",e.tenantId||""].join(xe.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAccount=function(t,n,r,i){var o=new e;o.authorityType=Ae.MSSTS_ACCOUNT_TYPE,o.clientInfo=t;var a=tt(t,i);o.homeAccountId=""+a.uid+xe.CLIENT_INFO_SEPARATOR+a.utid;var s=n.canonicalAuthorityUrlComponents.HostNameAndPort,c=rt.getCloudDiscoveryMetadata(s)?rt.getCloudDiscoveryMetadata(s).preferred_cache:"";if(ee.isEmpty(c))throw $.createInvalidCacheEnvironmentError();if(o.environment=c,o.realm=r.claims.tid,r){var u=ee.isEmpty(r.claims.oid)?r.claims.sid:r.claims.oid;o.localAccountId=u,o.username=r.claims.preferred_username||(r.claims.emails?r.claims.emails[0]:""),o.name=r.claims.name}return o},e.createADFSAccount=function(t,n){var r=new e;r.authorityType=Ae.ADFS_ACCOUNT_TYPE,r.homeAccountId=n.claims.sub;var i=t.canonicalAuthorityUrlComponents.HostNameAndPort,o=rt.getCloudDiscoveryMetadata(i)?rt.getCloudDiscoveryMetadata(i).preferred_cache:"";if(ee.isEmpty(o))throw $.createInvalidCacheEnvironmentError();return r.environment=o,r.username=n.claims.upn,r},e.isAccountEntity=function(e){return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType")},e}(),ot=function(){function e(){}return e.prototype.getAllAccounts=function(){var t=this.getAccountsFilteredBy(),n=Object.keys(t).map((function(e){return t[e]}));return n.length<1?[]:n.map((function(t){var n=new it;return(n=e.toObject(n,t)).getAccountInfo()}))},e.prototype.saveCacheRecord=function(e){if(!e)throw $.createNullOrUndefinedCacheRecord();e.account&&this.saveAccount(e.account),e.idToken&&this.saveCredential(e.idToken),e.accessToken&&this.saveAccessToken(e.accessToken),e.refreshToken&&this.saveCredential(e.refreshToken)},e.prototype.saveAccount=function(e){var t=e.generateAccountKey();this.setItem(t,e,ke.ACCOUNT)},e.prototype.saveCredential=function(e){var t=e.generateCredentialKey();this.setItem(t,e,ke.CREDENTIAL)},e.prototype.saveAccessToken=function(e){var t=this,n=this.getCredentialsFilteredBy({clientId:e.clientId,credentialType:Re.ACCESS_TOKEN,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm}),r=et.fromString(e.target),i=Object.keys(n.accessTokens).map((function(e){return n.accessTokens[e]}));i&&i.forEach((function(e){et.fromString(e.target).intersectingScopeSets(r)&&t.removeCredential(e)})),this.saveCredential(e)},e.prototype.getAccount=function(e){return this.getItem(e,ke.ACCOUNT)},e.prototype.getCredential=function(e){return this.getItem(e,ke.CREDENTIAL)},e.prototype.getAccountsFilteredBy=function(e){return this.getAccountsFilteredByInternal(e?e.homeAccountId:"",e?e.environment:"",e?e.realm:"")},e.prototype.getAccountsFilteredByInternal=function(e,t,n){var r=this,i=this.getKeys(),o={};return i.forEach((function(i){var a=r.getAccountEntity(i);if(!a)return null;(ee.isEmpty(e)||r.matchHomeAccountId(a,e))&&(ee.isEmpty(t)||r.matchEnvironment(a,t))&&(ee.isEmpty(n)||r.matchRealm(a,n))&&(o[i]=a)})),o},e.prototype.getCredentialsFilteredBy=function(e){return this.getCredentialsFilteredByInternal(e.homeAccountId,e.environment,e.credentialType,e.clientId,e.realm,e.target)},e.prototype.getCredentialsFilteredByInternal=function(e,t,n,r,i,o){var a=this,s=this.getKeys(),c={idTokens:{},accessTokens:{},refreshTokens:{}};return s.forEach((function(s){var u,l=Me.getCredentialType(s);if(l!==Ee){try{u=a.getItem(s,ke.CREDENTIAL)}catch(e){return}if((ee.isEmpty(e)||a.matchHomeAccountId(u,e))&&(ee.isEmpty(t)||a.matchEnvironment(u,t))&&(ee.isEmpty(i)||a.matchRealm(u,i))&&(ee.isEmpty(n)||a.matchCredentialType(u,n))&&(ee.isEmpty(r)||a.matchClientId(u,r))&&(ee.isEmpty(o)||a.matchTarget(u,o)))switch(l){case Re.ID_TOKEN:c.idTokens[s]=u;break;case Re.ACCESS_TOKEN:c.accessTokens[s]=u;break;case Re.REFRESH_TOKEN:c.refreshTokens[s]=u}}})),c},e.prototype.removeAppMetadata=function(){var e=this;return this.getKeys().forEach((function(t){e.isAppMetadata(t)&&e.removeItem(t,ke.APP_METADATA)})),!0},e.prototype.removeAllAccounts=function(){var e=this;return this.getKeys().forEach((function(t){e.getAccountEntity(t)&&e.removeAccount(t)})),!0},e.prototype.removeAccount=function(e){var t=this.getAccount(e);if(!t)throw $.createNoAccountFoundError();return this.removeAccountContext(t)&&this.removeItem(e,ke.ACCOUNT)},e.prototype.removeAccountContext=function(e){var t=this,n=this.getKeys(),r=e.generateAccountId();return n.forEach((function(e){if(Me.getCredentialType(e)!==Ee){var n=t.getItem(e,ke.CREDENTIAL);n&&r===n.generateAccountId()&&t.removeCredential(n)}})),!0},e.prototype.removeCredential=function(e){var t=e.generateCredentialKey();return this.removeItem(t,ke.CREDENTIAL)},e.prototype.matchHomeAccountId=function(e,t){return e.homeAccountId&&t===e.homeAccountId},e.prototype.matchEnvironment=function(e,t){var n=rt.getCloudDiscoveryMetadata(t);return!!(n&&n.aliases.indexOf(e.environment)>-1)},e.prototype.matchCredentialType=function(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()},e.prototype.matchClientId=function(e,t){return e.clientId&&t===e.clientId},e.prototype.matchRealm=function(e,t){return e.realm&&t===e.realm},e.prototype.matchTarget=function(e,t){if(e.credentialType!==Re.ACCESS_TOKEN||ee.isEmpty(e.target))return!1;var n=et.fromString(e.target),r=et.fromString(t);return n.removeScope(ve),r.removeScope(ve),n.containsScopeSet(r)},e.prototype.getAccountEntity=function(e){if(Me.getCredentialType(e)!==Ee||this.isAppMetadata(e))return null;var t;try{t=this.getItem(e,ke.ACCOUNT)}catch(e){return null}return!t||ee.isEmpty(t.authorityType)?null:t},e.prototype.isAppMetadata=function(e){return-1!==e.indexOf("appmetadata")},e.toObject=function(e,t){for(var n in t)e[n]=t[n];return e},e}(),at=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.prototype.setItem=function(){throw m.createUnexpectedError("Storage interface - setItem() has not been implemented for the cacheStorage interface.")},t.prototype.getItem=function(){throw m.createUnexpectedError("Storage interface - getItem() has not been implemented for the cacheStorage interface.")},t.prototype.removeItem=function(){throw m.createUnexpectedError("Storage interface - removeItem() has not been implemented for the cacheStorage interface.")},t.prototype.containsKey=function(){throw m.createUnexpectedError("Storage interface - containsKey() has not been implemented for the cacheStorage interface.")},t.prototype.getKeys=function(){throw m.createUnexpectedError("Storage interface - getKeys() has not been implemented for the cacheStorage interface.")},t.prototype.clear=function(){throw m.createUnexpectedError("Storage interface - clear() has not been implemented for the cacheStorage interface.")},t}(ot),st={clientId:"",authority:null,knownAuthorities:[],cloudDiscoveryMetadata:"",clientCapabilities:[]},ct={tokenRenewalOffsetSeconds:300},ut={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:h.Info},lt={sendGetRequestAsync:function(){return f(this,void 0,void 0,(function(){return p(this,(function(e){throw"Network interface - sendGetRequestAsync() has not been implemented",m.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented")}))}))},sendPostRequestAsync:function(){return f(this,void 0,void 0,(function(){return p(this,(function(e){throw"Network interface - sendPostRequestAsync() has not been implemented",m.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented")}))}))}},dt={createNewGuid:function(){throw m.createUnexpectedError("Crypto interface - createNewGuid() has not been implemented")},base64Decode:function(){throw m.createUnexpectedError("Crypto interface - base64Decode() has not been implemented")},base64Encode:function(){throw m.createUnexpectedError("Crypto interface - base64Encode() has not been implemented")},generatePkceCodes:function(){return f(this,void 0,void 0,(function(){return p(this,(function(e){throw"Crypto interface - generatePkceCodes() has not been implemented",m.createUnexpectedError("Crypto interface - generatePkceCodes() has not been implemented")}))}))}},ft={sku:ue,version:"1.2.0",cpu:"",os:""},pt={clientSecret:"",clientAssertion:null};var ht,gt=function(){function e(e){var t,n,r,i,o,a,s,c,u,l;this.config=(n=(t=e).authOptions,r=t.systemOptions,i=t.loggerOptions,o=t.storageInterface,a=t.networkInterface,s=t.cryptoInterface,c=t.clientCredentials,u=t.libraryInfo,l=t.serverTelemetryManager,{authOptions:d(d({},st),n),systemOptions:d(d({},ct),r),loggerOptions:d(d({},ut),i),storageInterface:o||new at,networkInterface:a||lt,cryptoInterface:s||dt,clientCredentials:c||pt,libraryInfo:d(d({},ft),u),serverTelemetryManager:l||null}),this.logger=new se(this.config.loggerOptions),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,rt.setTrustedAuthoritiesFromConfig(this.config.authOptions.knownAuthorities,this.config.authOptions.cloudDiscoveryMetadata),this.authority=this.config.authOptions.authority}return e.prototype.createDefaultTokenRequestHeaders=function(){var e=this.createDefaultLibraryHeaders();return e[te.CONTENT_TYPE]=be,this.serverTelemetryManager&&(e[te.X_CLIENT_CURR_TELEM]=this.serverTelemetryManager.generateCurrentRequestHeaderValue(),e[te.X_CLIENT_LAST_TELEM]=this.serverTelemetryManager.generateLastRequestHeaderValue()),e},e.prototype.createDefaultLibraryHeaders=function(){var e={};return e[ie.X_CLIENT_SKU]=this.config.libraryInfo.sku,e[ie.X_CLIENT_VER]=this.config.libraryInfo.version,e[ie.X_CLIENT_OS]=this.config.libraryInfo.os,e[ie.X_CLIENT_CPU]=this.config.libraryInfo.cpu,e},e.prototype.executePostToTokenEndpoint=function(e,t,n){return f(this,void 0,void 0,(function(){var r;return p(this,(function(i){switch(i.label){case 0:return[4,this.networkClient.sendPostRequestAsync(e,{body:t,headers:n})];case 1:return r=i.sent(),this.config.serverTelemetryManager&&r.status<500&&429!==r.status&&this.config.serverTelemetryManager.clearTelemetryCache(),[2,r]}}))}))},e}(),mt=function(){function e(){}return e.validateRedirectUri=function(e){if(ee.isEmpty(e))throw $e.createRedirectUriEmptyError()},e.validatePrompt=function(e){if([Te.LOGIN,Te.SELECT_ACCOUNT,Te.CONSENT,Te.NONE].indexOf(e)<0)throw $e.createInvalidPromptError(e)},e.validateClaims=function(e){try{JSON.parse(e)}catch(e){throw $e.createInvalidClaimsRequestError()}},e.validateCodeChallengeParams=function(e,t){if(ee.isEmpty(e)||ee.isEmpty(t))throw $e.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(t)},e.validateCodeChallengeMethod=function(e){if([Oe.PLAIN,Oe.S256].indexOf(e)<0)throw $e.createInvalidCodeChallengeMethodError()},e.sanitizeEQParams=function(e,t){return e?(t.forEach((function(t,n){e[n]&&delete e[n]})),e):null},e}(),vt=function(){function e(){this.parameters=new Map}return e.prototype.addResponseTypeCode=function(){this.parameters.set(ie.RESPONSE_TYPE,encodeURIComponent(ye))},e.prototype.addResponseMode=function(e){this.parameters.set(ie.RESPONSE_MODE,encodeURIComponent(e||Se.QUERY))},e.prototype.addScopes=function(e){this.parameters.set(ie.SCOPE,encodeURIComponent(e.printScopes()))},e.prototype.addClientId=function(e){this.parameters.set(ie.CLIENT_ID,encodeURIComponent(e))},e.prototype.addRedirectUri=function(e){mt.validateRedirectUri(e),this.parameters.set(ie.REDIRECT_URI,encodeURIComponent(e))},e.prototype.addDomainHint=function(e){this.parameters.set(Ie.DOMAIN_HINT,encodeURIComponent(e))},e.prototype.addLoginHint=function(e){this.parameters.set(Ie.LOGIN_HINT,encodeURIComponent(e))},e.prototype.addSid=function(e){this.parameters.set(Ie.SID,encodeURIComponent(e))},e.prototype.addClaims=function(e,t){var n=this.addClientCapabilitiesToClaims(e,t);mt.validateClaims(n),this.parameters.set(ie.CLAIMS,encodeURIComponent(n))},e.prototype.addCorrelationId=function(e){this.parameters.set(ie.CLIENT_REQUEST_ID,encodeURIComponent(e))},e.prototype.addLibraryInfo=function(e){this.parameters.set(ie.X_CLIENT_SKU,e.sku),this.parameters.set(ie.X_CLIENT_VER,e.version),this.parameters.set(ie.X_CLIENT_OS,e.os),this.parameters.set(ie.X_CLIENT_CPU,e.cpu)},e.prototype.addPrompt=function(e){mt.validatePrompt(e),this.parameters.set(""+ie.PROMPT,encodeURIComponent(e))},e.prototype.addState=function(e){ee.isEmpty(e)||this.parameters.set(ie.STATE,encodeURIComponent(e))},e.prototype.addNonce=function(e){this.parameters.set(ie.NONCE,encodeURIComponent(e))},e.prototype.addCodeChallengeParams=function(e,t){if(mt.validateCodeChallengeParams(e,t),!e||!t)throw $e.createInvalidCodeChallengeParamsError();this.parameters.set(ie.CODE_CHALLENGE,encodeURIComponent(e)),this.parameters.set(ie.CODE_CHALLENGE_METHOD,encodeURIComponent(t))},e.prototype.addAuthorizationCode=function(e){this.parameters.set(ie.CODE,encodeURIComponent(e))},e.prototype.addDeviceCode=function(e){this.parameters.set(ie.DEVICE_CODE,encodeURIComponent(e))},e.prototype.addRefreshToken=function(e){this.parameters.set(ie.REFRESH_TOKEN,encodeURIComponent(e))},e.prototype.addCodeVerifier=function(e){this.parameters.set(ie.CODE_VERIFIER,encodeURIComponent(e))},e.prototype.addClientSecret=function(e){this.parameters.set(ie.CLIENT_SECRET,encodeURIComponent(e))},e.prototype.addClientAssertion=function(e){this.parameters.set(ie.CLIENT_ASSERTION,encodeURIComponent(e))},e.prototype.addClientAssertionType=function(e){this.parameters.set(ie.CLIENT_ASSERTION_TYPE,encodeURIComponent(e))},e.prototype.addGrantType=function(e){this.parameters.set(ie.GRANT_TYPE,encodeURIComponent(e))},e.prototype.addClientInfo=function(){this.parameters.set("client_info","1")},e.prototype.addExtraQueryParameters=function(e){var t=this;mt.sanitizeEQParams(e,this.parameters),Object.keys(e).forEach((function(n){t.parameters.set(n,e[n])}))},e.prototype.addClientCapabilitiesToClaims=function(e,t){var n;if(ee.isEmpty(e))n={};else try{n=JSON.parse(e)}catch(e){throw $e.createInvalidClaimsRequestError()}return t&&t.length>0&&(n.hasOwnProperty(ae.ACCESS_TOKEN)||(n[ae.ACCESS_TOKEN]={}),n[ae.ACCESS_TOKEN][ae.XMS_CC]={values:t}),JSON.stringify(n)},e.prototype.createQueryString=function(){var e=new Array;return this.parameters.forEach((function(t,n){e.push(n+"="+t)})),e.join("&")},e}(),yt=function(e){function t(n,r,i){var o=e.call(this,n,r)||this;return o.name="ServerError",o.subError=i,Object.setPrototypeOf(o,t.prototype),o}return l(t,e),t}(m),wt=function(){function e(t,n){if(ee.isEmpty(t))throw $.createIdTokenNullOrEmptyError(t);this.rawIdToken=t,this.claims=e.extractIdToken(t,n)}return e.extractIdToken=function(e,t){var n=ee.decodeJwt(e);if(!n)return null;try{var r=n.JWSPayload,i=t.base64Decode(r);return JSON.parse(i)}catch(e){throw $.createIdTokenParsingError(e)}},e}(),bt=function(){function e(){}return e.nowSeconds=function(){return Math.round((new Date).getTime()/1e3)},e.isTokenExpired=function(t,n){var r=Number(t)||0;return e.nowSeconds()+n>r},e}();!function(e){e[e.Default=0]="Default",e[e.Adfs=1]="Adfs"}(ht||(ht={}));var Ct,Et,It,Tt,St=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.createIdTokenEntity=function(e,n,r,i,o){var a=new t;return a.credentialType=Re.ID_TOKEN,a.homeAccountId=e,a.environment=n,a.clientId=i,a.secret=r,a.realm=o,a},t.isIdTokenEntity=function(e){return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===Re.ID_TOKEN},t}(Me),_t=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.createAccessTokenEntity=function(e,n,r,i,o,a,s,c){var u=new t;u.homeAccountId=e,u.credentialType=Re.ACCESS_TOKEN,u.secret=r;var l=bt.nowSeconds();return u.cachedAt=l.toString(),u.expiresOn=s.toString(),u.extendedExpiresOn=c.toString(),u.environment=n,u.clientId=i,u.realm=o,u.target=a,u},t.isAccessTokenEntity=function(e){return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.hasOwnProperty("target")&&e.credentialType===Re.ACCESS_TOKEN},t}(Me),At=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.createRefreshTokenEntity=function(e,n,r,i,o){var a=new t;return a.clientId=i,a.credentialType=Re.REFRESH_TOKEN,a.environment=n,a.homeAccountId=e,a.secret=r,o&&(a.familyId=o),a},t.isRefreshTokenEntity=function(e){return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===Re.REFRESH_TOKEN},t}(Me),xt=["interaction_required","consent_required","login_required"],Rt=["message_only","additional_action","basic_action","user_password_expired","consent_required"],kt=function(e){function t(n,r,i){var o=e.call(this,n,r,i)||this;return o.name="InteractionRequiredAuthError",Object.setPrototypeOf(o,t.prototype),o}return l(t,e),t.isInteractionRequiredError=function(e,t,n){var r=!ee.isEmpty(e)&&xt.indexOf(e)>-1,i=!ee.isEmpty(n)&&Rt.indexOf(n)>-1,o=!ee.isEmpty(t)&&xt.some((function(e){return t.indexOf(e)>-1}));return r||o||i},t}(yt),Pt=function(e,t,n,r){this.account=e,this.idToken=t,this.accessToken=n,this.refreshToken=r},Ot=function(){function e(){}return e.setRequestState=function(t,n,r){var i=e.generateLibraryState(t,r);return ee.isEmpty(n)?i:""+i+he+n},e.generateLibraryState=function(e,t){if(!e)throw $.createNoCryptoObjectError("generateLibraryState");var n={id:e.createNewGuid(),ts:bt.nowSeconds()};t&&(n.meta=t);var r=JSON.stringify(n);return e.base64Encode(r)},e.parseRequestState=function(e,t){if(!e)throw $.createNoCryptoObjectError("parseRequestState");if(ee.isEmpty(t))throw $.createInvalidStateError(t,"Null, undefined or empty state");try{var n=decodeURIComponent(t).split(he),r=n[0],i=n.length>1?n.slice(1).join(he):"",o=e.base64Decode(r),a=JSON.parse(o);return{userRequestState:ee.isEmpty(i)?"":i,libraryState:a}}catch(e){throw $.createInvalidStateError(t,e)}},e}(),Nt=function(){function e(e,t,n,r){this.clientId=e,this.cacheStorage=t,this.cryptoObj=n,this.logger=r}return e.prototype.validateServerAuthorizationCodeResponse=function(e,t,n){if(decodeURIComponent(e.state)!==decodeURIComponent(t))throw $.createStateMismatchError();if(e.error||e.error_description||e.suberror){if(kt.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new kt(e.error,e.error_description,e.suberror);throw new yt(e.error,e.error_description,e.suberror)}e.client_info&&tt(e.client_info,n)},e.prototype.validateTokenResponse=function(e){if(e.error||e.error_description||e.suberror){if(kt.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new kt(e.error,e.error_description,e.suberror);var t=e.error_codes+" - ["+e.timestamp+"]: "+e.error_description+" - Correlation ID: "+e.correlation_id+" - Trace ID: "+e.trace_id;throw new yt(e.error,t)}},e.prototype.handleServerTokenResponse=function(t,n,r,i,o){t.client_info?(this.clientInfo=tt(t.client_info,this.cryptoObj),ee.isEmpty(this.clientInfo.uid)||ee.isEmpty(this.clientInfo.utid)||(this.homeAccountIdentifier=this.clientInfo.uid+"."+this.clientInfo.utid)):this.homeAccountIdentifier="";var a=null;if(!ee.isEmpty(t.id_token)&&(a=new wt(t.id_token,this.cryptoObj),!ee.isEmpty(r)&&a.claims.nonce!==r))throw $.createNonceMismatchError();var s=null;ee.isEmpty(i)||(s=Ot.parseRequestState(this.cryptoObj,i));var c=this.generateCacheRecord(t,a,n,s&&s.libraryState,o);return this.cacheStorage.saveCacheRecord(c),e.generateAuthenticationResult(c,a,!1,s)},e.prototype.generateCacheRecord=function(e,t,n,r,i){var o=n.canonicalAuthorityUrlComponents.HostNameAndPort,a=rt.getCloudDiscoveryMetadata(o)?rt.getCloudDiscoveryMetadata(o).preferred_cache:"";if(ee.isEmpty(a))throw $.createInvalidCacheEnvironmentError();var s=null,c=null;ee.isEmpty(e.id_token)||(s=St.createIdTokenEntity(this.homeAccountIdentifier,a,e.id_token,this.clientId,t.claims.tid),c=this.generateAccountEntity(e,t,n));var u=null;if(!ee.isEmpty(e.access_token)){var l=e.scope?et.fromString(e.scope):new et(i||[]),d=bt.nowSeconds(),f=(r?r.ts:d)+e.expires_in,p=f+e.ext_expires_in;u=_t.createAccessTokenEntity(this.homeAccountIdentifier,a,e.access_token,this.clientId,t?t.claims.tid:n.tenant,l.printScopesLowerCase(),f,p)}var h=null;return ee.isEmpty(e.refresh_token)||(h=At.createRefreshTokenEntity(this.homeAccountIdentifier,a,e.refresh_token,this.clientId,e.foci)),new Pt(c,s,u,h)},e.prototype.generateAccountEntity=function(e,t,n){if(n.authorityType===ht.Adfs)return it.createADFSAccount(n,t);if(ee.isEmpty(e.client_info))throw $.createClientInfoEmptyError(e.client_info);return it.createAccount(e.client_info,n,t,this.cryptoObj)},e.generateAuthenticationResult=function(e,t,n,r){var i="",o=[],a=null,s=null,c=null;return e.accessToken&&(i=e.accessToken.secret,o=et.fromString(e.accessToken.target).asArray(),a=new Date(1e3*Number(e.accessToken.expiresOn)),s=new Date(1e3*Number(e.accessToken.extendedExpiresOn))),e.refreshToken&&(c=e.refreshToken.familyId||null),{uniqueId:t?t.claims.oid||t.claims.sub:"",tenantId:t?t.claims.tid:"",scopes:o,account:e.account?e.account.getAccountInfo():null,idToken:t?t.rawIdToken:"",idTokenClaims:t?t.claims:null,accessToken:i,fromCache:n,expiresOn:a,extExpiresOn:s,familyId:c,state:r?r.userRequestState:""}},e}(),Mt=function(e){function t(t){return e.call(this,t)||this}return l(t,e),t.prototype.getAuthCodeUrl=function(e){return f(this,void 0,void 0,(function(){var t;return p(this,(function(n){return t=this.createAuthCodeUrlQueryString(e),[2,this.authority.authorizationEndpoint+"?"+t]}))}))},t.prototype.acquireToken=function(e,t,n){return f(this,void 0,void 0,(function(){var r,i;return p(this,(function(o){switch(o.label){case 0:if(this.logger.info("in acquireToken call"),!e||ee.isEmpty(e.code))throw $.createTokenRequestCannotBeMadeError();return[4,this.executeTokenRequest(this.authority,e)];case 1:return r=o.sent(),(i=new Nt(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger)).validateTokenResponse(r.body),[2,i.handleServerTokenResponse(r.body,this.authority,t,n)]}}))}))},t.prototype.handleFragmentResponse=function(e,t){var n=new Nt(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger),r=new nt(e),i=nt.getDeserializedHash(r.getHash());return n.validateServerAuthorizationCodeResponse(i,t,this.cryptoUtils),i.code},t.prototype.getLogoutUri=function(e){if(!e)throw $e.createEmptyLogoutRequestError();e.account?this.cacheManager.removeAccount(it.generateAccountCacheKey(e.account)):this.cacheManager.clear();var t=e.postLogoutRedirectUri?"?"+ie.POST_LOGOUT_URI+"="+encodeURIComponent(e.postLogoutRedirectUri):"",n=e.correlationId?"&"+ie.CLIENT_REQUEST_ID+"="+encodeURIComponent(e.correlationId):"";return""+this.authority.endSessionEndpoint+t+n},t.prototype.executeTokenRequest=function(e,t){return f(this,void 0,void 0,(function(){var n,r;return p(this,(function(i){return n=this.createTokenRequestBody(t),r=this.createDefaultTokenRequestHeaders(),[2,this.executePostToTokenEndpoint(e.tokenEndpoint,n,r)]}))}))},t.prototype.createTokenRequestBody=function(e){var t=new vt;t.addClientId(this.config.authOptions.clientId),t.addRedirectUri(e.redirectUri);var n=new et(e.scopes||[]);if(t.addScopes(n),t.addAuthorizationCode(e.code),e.codeVerifier&&t.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){var r=this.config.clientCredentials.clientAssertion;t.addClientAssertion(r.assertion),t.addClientAssertionType(r.assertionType)}t.addGrantType(_e.AUTHORIZATION_CODE_GRANT),t.addClientInfo();var i=e.correlationId||this.config.cryptoInterface.createNewGuid();return t.addCorrelationId(i),(!ee.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),t.createQueryString()},t.prototype.createAuthCodeUrlQueryString=function(e){var t=new vt;t.addClientId(this.config.authOptions.clientId);var n=new et(e.scopes||[]);e.extraScopesToConsent&&n.appendScopes(e.extraScopesToConsent),t.addScopes(n),t.addRedirectUri(e.redirectUri);var r=e.correlationId||this.config.cryptoInterface.createNewGuid();return t.addCorrelationId(r),t.addResponseMode(e.responseMode),t.addResponseTypeCode(),t.addLibraryInfo(this.config.libraryInfo),t.addClientInfo(),e.codeChallenge&&t.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&t.addPrompt(e.prompt),e.loginHint&&t.addLoginHint(e.loginHint),e.domainHint&&t.addDomainHint(e.domainHint),e.sid&&t.addSid(e.sid),e.nonce&&t.addNonce(e.nonce),e.state&&t.addState(e.state),(!ee.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),t.createQueryString()},t}(gt),Dt=(function(e){function t(t){return e.call(this,t)||this}l(t,e),t.prototype.acquireToken=function(e){return f(this,void 0,void 0,(function(){var t,n,r;return p(this,(function(i){switch(i.label){case 0:return[4,this.getDeviceCode(e)];case 1:return t=i.sent(),e.deviceCodeCallback(t),[4,this.acquireTokenWithDeviceCode(e,t)];case 2:return n=i.sent(),(r=new Nt(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger)).validateTokenResponse(n),[2,r.handleServerTokenResponse(n,this.authority)]}}))}))},t.prototype.getDeviceCode=function(e){return f(this,void 0,void 0,(function(){var t,n;return p(this,(function(r){return t=this.createQueryString(e),n=this.createDefaultLibraryHeaders(),[2,this.executePostRequestToDeviceCodeEndpoint(this.authority.deviceCodeEndpoint,t,n)]}))}))},t.prototype.executePostRequestToDeviceCodeEndpoint=function(e,t,n){return f(this,void 0,void 0,(function(){var r,i,o,a,s,c,u;return p(this,(function(l){switch(l.label){case 0:return[4,this.networkClient.sendPostRequestAsync(e,{body:t,headers:n})];case 1:return r=l.sent().body,i=r.user_code,o=r.device_code,a=r.verification_uri,s=r.expires_in,c=r.interval,u=r.message,[2,{userCode:i,deviceCode:o,verificationUri:a,expiresIn:s,interval:c,message:u}]}}))}))},t.prototype.createQueryString=function(e){var t=new vt,n=new et(e.scopes||[]);return t.addScopes(n),t.addClientId(this.config.authOptions.clientId),(!ee.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),t.createQueryString()},t.prototype.acquireTokenWithDeviceCode=function(e,t){return f(this,void 0,void 0,(function(){var n,r,i,o,a=this;return p(this,(function(s){return n=this.createTokenRequestBody(e,t),r=this.createDefaultTokenRequestHeaders(),i=bt.nowSeconds()+t.expiresIn,o=1e3*t.interval,[2,new Promise((function(t,s){var c=setInterval((function(){return f(a,void 0,void 0,(function(){var o,a;return p(this,(function(u){switch(u.label){case 0:return u.trys.push([0,5,,6]),e.cancel?(this.logger.error("Token request cancelled by setting DeviceCodeRequest.cancel = true"),clearInterval(c),s($.createDeviceCodeCancelledError()),[3,4]):[3,1];case 1:return bt.nowSeconds()>i?(this.logger.error("Device code expired. Expiration time of device code was "+i),clearInterval(c),s($.createDeviceCodeExpiredError()),[3,4]):[3,2];case 2:return[4,this.executePostToTokenEndpoint(this.authority.tokenEndpoint,n,r)];case 3:(o=u.sent()).body&&o.body.error==Ce?this.logger.info(o.body.error_description):(clearInterval(c),t(o.body)),u.label=4;case 4:return[3,6];case 5:return a=u.sent(),clearInterval(c),s(a),[3,6];case 6:return[2]}}))}))}),o)}))]}))}))},t.prototype.createTokenRequestBody=function(e,t){var n=new vt,r=new et(e.scopes||[]);n.addScopes(r),n.addClientId(this.config.authOptions.clientId),n.addGrantType(_e.DEVICE_CODE_GRANT),n.addDeviceCode(t.deviceCode);var i=e.correlationId||this.config.cryptoInterface.createNewGuid();return n.addCorrelationId(i),n.addClientInfo(),(!ee.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&n.addClaims(e.claims,this.config.authOptions.clientCapabilities),n.createQueryString()}}(gt),function(e){function t(t){return e.call(this,t)||this}return l(t,e),t.prototype.acquireToken=function(e){return f(this,void 0,void 0,(function(){var t,n;return p(this,(function(r){switch(r.label){case 0:return[4,this.executeTokenRequest(e,this.authority)];case 1:return t=r.sent(),(n=new Nt(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger)).validateTokenResponse(t.body),[2,n.handleServerTokenResponse(t.body,this.authority)]}}))}))},t.prototype.executeTokenRequest=function(e,t){return f(this,void 0,void 0,(function(){var n,r;return p(this,(function(i){return n=this.createTokenRequestBody(e),r=this.createDefaultTokenRequestHeaders(),[2,this.executePostToTokenEndpoint(t.tokenEndpoint,n,r)]}))}))},t.prototype.createTokenRequestBody=function(e){var t=new vt;t.addClientId(this.config.authOptions.clientId);var n=new et(e.scopes||[]);t.addScopes(n),t.addGrantType(_e.REFRESH_TOKEN_GRANT),t.addClientInfo();var r=e.correlationId||this.config.cryptoInterface.createNewGuid();if(t.addCorrelationId(r),t.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){var i=this.config.clientCredentials.clientAssertion;t.addClientAssertion(i.assertion),t.addClientAssertionType(i.assertionType)}return(!ee.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),t.createQueryString()},t}(gt)),Lt=(function(e){function t(t){return e.call(this,t)||this}l(t,e),t.prototype.acquireToken=function(e){return f(this,void 0,void 0,(function(){var t;return p(this,(function(n){switch(n.label){case 0:return this.scopeSet=new et(e.scopes||[]),e.skipCache?[4,this.executeTokenRequest(e,this.authority)]:[3,2];case 1:return[2,n.sent()];case 2:return null==(t=this.getCachedAuthenticationResult())?[3,3]:[2,t];case 3:return[4,this.executeTokenRequest(e,this.authority)];case 4:return[2,n.sent()]}}))}))},t.prototype.getCachedAuthenticationResult=function(){var e=this.readAccessTokenFromCache();return!e||bt.isTokenExpired(e.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds)?null:Nt.generateAuthenticationResult({account:null,accessToken:e,idToken:null,refreshToken:null},null,!0)},t.prototype.readAccessTokenFromCache=function(){var e={homeAccountId:"",environment:this.authority.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:Re.ACCESS_TOKEN,clientId:this.config.authOptions.clientId,realm:this.authority.tenant,target:this.scopeSet.printScopesLowerCase()},t=this.cacheManager.getCredentialsFilteredBy(e),n=Object.keys(t.accessTokens).map((function(e){return t.accessTokens[e]}));return n.length<1?null:n[0]},t.prototype.executeTokenRequest=function(e,t){return f(this,void 0,void 0,(function(){var n,r,i,o;return p(this,(function(a){switch(a.label){case 0:return n=this.createTokenRequestBody(e),r=this.createDefaultTokenRequestHeaders(),[4,this.executePostToTokenEndpoint(t.tokenEndpoint,n,r)];case 1:return i=a.sent(),(o=new Nt(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger)).validateTokenResponse(i.body),[2,o.handleServerTokenResponse(i.body,this.authority,null,null,e.scopes)]}}))}))},t.prototype.createTokenRequestBody=function(e){var t=new vt;t.addClientId(this.config.authOptions.clientId),t.addScopes(this.scopeSet),t.addGrantType(_e.CLIENT_CREDENTIALS_GRANT);var n=e.correlationId||this.config.cryptoInterface.createNewGuid();if(t.addCorrelationId(n),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){var r=this.config.clientCredentials.clientAssertion;t.addClientAssertion(r.assertion),t.addClientAssertionType(r.assertionType)}return(!ee.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),t.createQueryString()}}(gt),function(e){function t(t){return e.call(this,t)||this}return l(t,e),t.prototype.acquireToken=function(e){return f(this,void 0,void 0,(function(){var t,n,r,i,o,a,s,c,u,l,f;return p(this,(function(p){if(!e)throw $e.createEmptyTokenRequestError();if(!e.account)throw $.createNoAccountInSilentRequestError();if(t=new et(e.scopes||[]),n=it.generateAccountCacheKey(e.account),r=this.cacheManager.getAccount(n),i=r.homeAccountId,o=r.environment,a=this.readAccessTokenFromCache(i,o,t,r.realm),s=this.readRefreshTokenFromCache(i,o),this.isRefreshRequired(e,a)){if(!s)throw $.createNoTokensFoundError();return c=new Dt(this.config),u=d(d({},e),{refreshToken:s.secret}),[2,c.acquireToken(u)]}return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),l=this.readIdTokenFromCache(i,o,r.realm),f=new wt(l.secret,this.config.cryptoInterface),[2,Nt.generateAuthenticationResult({account:r,accessToken:a,idToken:l,refreshToken:s},f,!0)]}))}))},t.prototype.isRefreshRequired=function(e,t){return!(!e.forceRefresh&&!e.claims)||!(t&&!bt.isTokenExpired(t.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))},t.prototype.readIdTokenFromCache=function(e,t,n){var r=Me.generateCredentialCacheKey(e,t,Re.ID_TOKEN,this.config.authOptions.clientId,n);return this.cacheManager.getCredential(r)},t.prototype.readAccessTokenFromCache=function(e,t,n,r){var i={homeAccountId:e,environment:t,credentialType:Re.ACCESS_TOKEN,clientId:this.config.authOptions.clientId,realm:r,target:n.printScopesLowerCase()},o=this.cacheManager.getCredentialsFilteredBy(i),a=Object.keys(o.accessTokens).map((function(e){return o.accessTokens[e]}));if(a.length>1);else if(a.length<1)return null;return a[0]},t.prototype.readRefreshTokenFromCache=function(e,t){var n=Me.generateCredentialCacheKey(e,t,Re.REFRESH_TOKEN,this.config.authOptions.clientId);return this.cacheManager.getCredential(n)},t}(gt)),Ut=function(){function e(e,t){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t}return Object.defineProperty(e.prototype,"authorityType",{get:function(){var e=this.canonicalAuthorityUrlComponents.PathSegments;return e.length&&e[0].toLowerCase()===fe?ht.Adfs:ht.Default},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(e){this._canonicalAuthority=new nt(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete())return this.replaceTenant(this.tenantDiscoveryResponse.authorization_endpoint);throw $.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete())return this.replaceTenant(this.tenantDiscoveryResponse.token_endpoint);throw $.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete())return this.tenantDiscoveryResponse.token_endpoint.replace("/token","/devicecode");throw $.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete())return this.replaceTenant(this.tenantDiscoveryResponse.end_session_endpoint);throw $.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete())return this.replaceTenant(this.tenantDiscoveryResponse.issuer);throw $.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),e.prototype.replaceTenant=function(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)},Object.defineProperty(e.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.authorityType===ht.Adfs?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!0,configurable:!0}),e.prototype.discoveryComplete=function(){return!!this.tenantDiscoveryResponse},e.prototype.discoverEndpoints=function(e){return f(this,void 0,void 0,(function(){return p(this,(function(t){return[2,this.networkInterface.sendGetRequestAsync(e)]}))}))},Object.defineProperty(e.prototype,"aadInstanceDiscoveryEndpointUrl",{get:function(){return""+pe+this.canonicalAuthority+"oauth2/v2.0/authorize"},enumerable:!0,configurable:!0}),e.prototype.validateAndSetPreferredNetwork=function(){return f(this,void 0,void 0,(function(){var e,t;return p(this,(function(n){switch(n.label){case 0:return e=this.canonicalAuthorityUrlComponents.HostNameAndPort,0!==rt.getTrustedHostList().length?[3,2]:[4,rt.setTrustedAuthoritiesFromNetwork(this._canonicalAuthority,this.networkInterface)];case 1:n.sent(),n.label=2;case 2:if(!rt.IsInTrustedHostList(e))throw $e.createUntrustedAuthorityError();return t=rt.getCloudDiscoveryMetadata(e).preferred_network,e!==t&&(this.canonicalAuthority=this.canonicalAuthority.replace(e,t)),[2]}}))}))},e.prototype.resolveEndpointsAsync=function(){return f(this,void 0,void 0,(function(){var e,t;return p(this,(function(n){switch(n.label){case 0:return[4,this.validateAndSetPreferredNetwork()];case 1:return n.sent(),e=this.defaultOpenIdConfigurationEndpoint,[4,this.discoverEndpoints(e)];case 2:return t=n.sent(),this.tenantDiscoveryResponse=t.body,[2]}}))}))},e}(),Ft=function(){function e(){}return e.createDiscoveredInstance=function(t,n){return f(this,void 0,void 0,(function(){var r,i;return p(this,(function(o){switch(o.label){case 0:if((r=e.createInstance(t,n)).discoveryComplete())return[2,r];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,r.resolveEndpointsAsync()];case 2:return o.sent(),[2,r];case 3:throw i=o.sent(),$.createEndpointDiscoveryIncompleteError(i);case 4:return[2]}}))}))},e.createInstance=function(e,t){if(ee.isEmpty(e))throw $e.createUrlEmptyError();return new Ut(e,t)},e}(),qt=function(){function e(e,t){this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.forceRefresh=e.forceRefresh||!1,this.telemetryCacheKey=Ne.CACHE_KEY+xe.CACHE_KEY_SEPARATOR+e.clientId}return e.prototype.generateCurrentRequestHeaderValue=function(){var e=this.forceRefresh?1:0,t=""+this.apiId+Ne.VALUE_SEPARATOR+e;return[Ne.SCHEMA_VERSION,t,""].join(Ne.CATEGORY_SEPARATOR)},e.prototype.generateLastRequestHeaderValue=function(){var e=this.getLastRequests(),t=e.failedRequests.join(Ne.VALUE_SEPARATOR),n=e.errors.join(Ne.VALUE_SEPARATOR),r=e.errorCount;return[Ne.SCHEMA_VERSION,e.cacheHits,t,n,r].join(Ne.CATEGORY_SEPARATOR)},e.prototype.cacheFailedRequest=function(e){var t=this.getLastRequests();t.failedRequests.push(this.apiId,this.correlationId),t.errors.push(e.errorCode),t.errorCount+=1,t.errors.length>Ne.FAILURE_LIMIT&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),this.cacheManager.setItem(this.telemetryCacheKey,t,ke.TELEMETRY)},e.prototype.incrementCacheHits=function(){var e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setItem(this.telemetryCacheKey,e,ke.TELEMETRY),e.cacheHits},e.prototype.getLastRequests=function(){return this.cacheManager.getItem(this.telemetryCacheKey,ke.TELEMETRY)||{failedRequests:[],errors:[],errorCount:0,cacheHits:0}},e.prototype.clearTelemetryCache=function(){this.cacheManager.removeItem(this.telemetryCacheKey)},e}(),Vt="localStorage",Gt="sessionStorage",Ht="interaction.status",jt="interaction_in_progress",zt="invalid_grant",Bt=483,Kt=600,Wt=50,Xt="msal.js.browser";!function(e){e.GET="GET",e.POST="POST"}(Ct||(Ct={})),function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",e.SESSION_STATE="session.state",e.REQUEST_STATE="request.state",e.NONCE_IDTOKEN="nonce.id_token",e.ORIGIN_URI="request.origin",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.REQUEST_PARAMS="request.params",e.SCOPES="scopes"}(Et||(Et={})),function(e){e[e.acquireTokenRedirect=861]="acquireTokenRedirect",e[e.acquireTokenPopup=862]="acquireTokenPopup",e[e.ssoSilent=863]="ssoSilent",e[e.acquireTokenSilent_authCode=864]="acquireTokenSilent_authCode",e[e.handleRedirectPromise=865]="handleRedirectPromise",e[e.acquireTokenSilent_silentFlow=61]="acquireTokenSilent_silentFlow"}(It||(It={})),function(e){e.REDIRECT="redirect",e.POPUP="popup",e.SILENT="silent"}(Tt||(Tt={}));var Yt={scopes:[ge,me]},Qt=function(){function e(){}return e.prototype.sendGetRequestAsync=function(e,t){return a(this,void 0,void 0,(function(){var n,r;return s(this,(function(i){switch(i.label){case 0:return[4,fetch(e,{method:Ct.GET,headers:this.getFetchHeaders(t)})];case 1:return n=i.sent(),r={headers:this.getHeaderDict(n.headers)},[4,n.json()];case 2:return[2,(r.body=i.sent(),r.status=n.status,r)]}}))}))},e.prototype.sendPostRequestAsync=function(e,t){return a(this,void 0,void 0,(function(){var n,r,i;return s(this,(function(o){switch(o.label){case 0:return n=t&&t.body||"",[4,fetch(e,{method:Ct.POST,headers:this.getFetchHeaders(t),body:n})];case 1:return r=o.sent(),i={headers:this.getHeaderDict(r.headers)},[4,r.json()];case 2:return[2,(i.body=o.sent(),i.status=r.status,i)]}}))}))},e.prototype.getFetchHeaders=function(e){var t=new Headers;return e&&e.headers?(Object.keys(e.headers).forEach((function(n){t.append(n,e.headers[n])})),t):t},e.prototype.getHeaderDict=function(e){var t={};return e.forEach((function(e,n){t[n]=e})),t},e}(),Jt={noWindowObjectError:{code:"no_window_object",desc:"No window object detected."},pkceNotGenerated:{code:"pkce_not_created",desc:"The PKCE code challenge and verifier could not be generated."},cryptoDoesNotExist:{code:"crypto_nonexistent",desc:"The crypto object or function is not available."},httpMethodNotImplementedError:{code:"http_method_not_implemented",desc:"The HTTP method given has not been implemented in this library."},emptyNavigateUriError:{code:"empty_navigate_uri",desc:"Navigation URI is empty. Please check stack trace for more info."},hashEmptyError:{code:"hash_empty_error",desc:"Hash value cannot be processed because it is empty."},interactionInProgress:{code:"interaction_in_progress",desc:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API."},popUpWindowError:{code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},emptyWindowError:{code:"empty_window_error",desc:"window.open returned null or undefined window object."},userCancelledError:{code:"user_cancelled",desc:"User cancelled the flow."},monitorWindowTimeoutError:{code:"monitor_window_timeout",desc:"Token acquisition in popup failed due to timeout."},redirectInIframeError:{code:"redirect_in_iframe",desc:"Code flow is not supported inside an iframe. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs."},blockTokenRequestsInHiddenIframeError:{code:"block_iframe_reload",desc:"Request was blocked inside an iframe because MSAL detected an authentication response. Please ensure monitorWindowForHash was called."},iframeClosedPrematurelyError:{code:"iframe_closed_prematurely",desc:"The iframe being monitored was closed prematurely."},silentSSOInsufficientInfoError:{code:"silent_sso_error",desc:"Silent SSO could not be completed - insufficient information was provided. Please provide either a loginHint or sid."},silentPromptValueError:{code:"silent_prompt_value_error",desc:"The value given for the prompt value is not valid for silent requests - must be set to 'none'."},tokenRequestCacheError:{code:"token_request_cache_error",desc:"The token request could not be fetched from the cache correctly."},invalidCacheType:{code:"invalid_cache_type",desc:"Invalid cache type"}},Zt=function(e){function t(n,r){var i=e.call(this,n,r)||this;return Object.setPrototypeOf(i,t.prototype),i.name="BrowserAuthError",i}return i(t,e),t.createNoWindowObjectError=function(){return new t(Jt.noWindowObjectError.code,Jt.noWindowObjectError.desc)},t.createPkceNotGeneratedError=function(e){return new t(Jt.pkceNotGenerated.code,Jt.pkceNotGenerated.desc+" Detail:"+e)},t.createCryptoNotAvailableError=function(e){return new t(Jt.cryptoDoesNotExist.code,Jt.cryptoDoesNotExist.desc+" Detail:"+e)},t.createHttpMethodNotImplementedError=function(e){return new t(Jt.httpMethodNotImplementedError.code,Jt.httpMethodNotImplementedError.desc+" Given Method: "+e)},t.createEmptyNavigationUriError=function(){return new t(Jt.emptyNavigateUriError.code,Jt.emptyNavigateUriError.desc)},t.createEmptyHashError=function(e){return new t(Jt.hashEmptyError.code,Jt.hashEmptyError.desc+" Given Url: "+e)},t.createInteractionInProgressError=function(){return new t(Jt.interactionInProgress.code,Jt.interactionInProgress.desc)},t.createPopupWindowError=function(e){var n=Jt.popUpWindowError.desc;return n=ee.isEmpty(e)?n:n+" Details: "+e,new t(Jt.popUpWindowError.code,n)},t.createEmptyWindowCreatedError=function(){return new t(Jt.emptyWindowError.code,Jt.emptyWindowError.desc)},t.createUserCancelledError=function(){return new t(Jt.userCancelledError.code,Jt.userCancelledError.desc)},t.createMonitorWindowTimeoutError=function(){return new t(Jt.monitorWindowTimeoutError.code,Jt.monitorWindowTimeoutError.desc)},t.createRedirectInIframeError=function(e){return new t(Jt.redirectInIframeError.code,Jt.redirectInIframeError.desc+" (window.parent !== window) => "+e)},t.createBlockReloadInHiddenIframeError=function(){return new t(Jt.blockTokenRequestsInHiddenIframeError.code,Jt.blockTokenRequestsInHiddenIframeError.desc)},t.createIframeClosedPrematurelyError=function(){return new t(Jt.iframeClosedPrematurelyError.code,Jt.iframeClosedPrematurelyError.desc)},t.createSilentSSOInsufficientInfoError=function(){return new t(Jt.silentSSOInsufficientInfoError.code,Jt.silentSSOInsufficientInfoError.desc)},t.createSilentPromptValueError=function(e){return new t(Jt.silentPromptValueError.code,Jt.silentPromptValueError.desc+" Given value: "+e)},t.createTokenRequestCacheError=function(e){return new t(Jt.tokenRequestCacheError.code,Jt.tokenRequestCacheError.desc+" Error Detail: "+e)},t.createInvalidCacheTypeError=function(){return new t(Jt.invalidCacheType.code,""+Jt.invalidCacheType.desc)},t}(m),$t=function(){function e(){}return e.prototype.sendGetRequestAsync=function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(n){return[2,this.sendRequestAsync(e,Ct.GET,t)]}))}))},e.prototype.sendPostRequestAsync=function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(n){return[2,this.sendRequestAsync(e,Ct.POST,t)]}))}))},e.prototype.sendRequestAsync=function(e,t,n){var r=this;return new Promise((function(i,o){var a=new XMLHttpRequest;if(a.open(t,e,!0),r.setXhrHeaders(a,n),a.onload=function(){(a.status<200||a.status>=300)&&o(a.responseText);try{var e=JSON.parse(a.responseText),t={headers:r.getHeaderDict(a),body:e,status:a.status};i(t)}catch(e){o(a.responseText)}},a.onerror=function(){o(a.status)},"POST"===t&&n.body)a.send(n.body);else{if("GET"!==t)throw Zt.createHttpMethodNotImplementedError(t);a.send()}}))},e.prototype.setXhrHeaders=function(e,t){t&&t.headers&&Object.keys(t.headers).forEach((function(n){e.setRequestHeader(n,t.headers[n])}))},e.prototype.getHeaderDict=function(e){var t=e.getAllResponseHeaders().trim().split(/[\r\n]+/),n={};return t.forEach((function(e){var t=e.split(": "),r=t.shift(),i=t.join(": ");n[r]=i})),n},e}(),en=function(){function e(){}return e.navigateWindow=function(e,t){t?window.location.replace(e):window.location.assign(e)},e.clearHash=function(){window.location.hash=""},e.replaceHash=function(e){var t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):""},e.isInIframe=function(){return window.parent!==window},e.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},e.getHomepage=function(){var e=new nt(window.location.href).getUrlComponents();return e.Protocol+"//"+e.HostNameAndPort+"/"},e.getBrowserNetworkClient=function(){return window.fetch?new Qt:new $t},e.blockReloadInHiddenIframes=function(){if(nt.hashContainsKnownProperties(window.location.hash)&&e.isInIframe())throw Zt.createBlockReloadInHiddenIframeError()},e.detectIEOrEdge=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),n=e.indexOf("Trident/"),r=e.indexOf("Edge/");return t>0||n>0||r>0},e}(),tn={clientId:"",authority:""+de,knownAuthorities:[],cloudDiscoveryMetadata:"",redirectUri:"",postLogoutRedirectUri:"",navigateToLoginRequestUrl:!0,clientCapabilities:[]},nn={cacheLocation:Gt,storeAuthStateInCookie:!1},rn=o(o({},ct),{loggerOptions:{loggerCallback:function(){},piiLoggingEnabled:!1},networkClient:en.getBrowserNetworkClient(),windowHashTimeout:6e4,iframeHashTimeout:6e3,loadFrameTimeout:en.detectIEOrEdge()?500:0,asyncPopups:!1});var on={redirectUriNotSet:{code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},postLogoutUriNotSet:{code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},storageNotSupportedError:{code:"storage_not_supported",desc:"Given storage configuration option was not supported."},noRedirectCallbacksSet:{code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},invalidCallbackObject:{code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."}},an=function(e){function t(n,r){var i=e.call(this,n,r)||this;return i.name="BrowserConfigurationAuthError",Object.setPrototypeOf(i,t.prototype),i}return i(t,e),t.createRedirectUriEmptyError=function(){return new t(on.redirectUriNotSet.code,on.redirectUriNotSet.desc)},t.createPostLogoutRedirectUriEmptyError=function(){return new t(on.postLogoutUriNotSet.code,on.postLogoutUriNotSet.desc)},t.createStorageNotSupportedError=function(e){return new t(on.storageNotSupportedError.code,on.storageNotSupportedError.desc+" Given Location: "+e)},t.createInvalidCallbackObjectError=function(e){return new t(on.invalidCallbackObject.code,on.invalidCallbackObject.desc+" Given value for callback function: "+e)},t.createRedirectCallbacksNotSetError=function(){return new t(on.noRedirectCallbacksSet.code,on.noRedirectCallbacksSet.desc)},t}(m),sn=function(e){function t(t,n){var r=e.call(this)||this;return r.validateWindowStorage(n.cacheLocation),r.cacheConfig=n,r.windowStorage=window[r.cacheConfig.cacheLocation],r.clientId=t,r.migrateCacheEntries(),r}return i(t,e),t.prototype.validateWindowStorage=function(e){if("undefined"==typeof window||!window)throw Zt.createNoWindowObjectError();if(e!==Vt&&e!==Gt)throw an.createStorageNotSupportedError(e);if(!!!window[e])throw an.createStorageNotSupportedError(e)},t.prototype.migrateCacheEntries=function(){var e=this,t=le+"."+ne.ID_TOKEN,n=le+"."+ne.CLIENT_INFO,r=le+"."+ne.ERROR,i=le+"."+ne.ERROR_DESC,o=[this.windowStorage.getItem(t),this.windowStorage.getItem(n),this.windowStorage.getItem(r),this.windowStorage.getItem(i)];[ne.ID_TOKEN,ne.CLIENT_INFO,ne.ERROR,ne.ERROR_DESC].forEach((function(t,n){return e.migrateCacheEntry(t,o[n])}))},t.prototype.migrateCacheEntry=function(e,t){t&&this.setItem(this.generateCacheKey(e),t,ke.TEMPORARY)},t.prototype.validateObjectKey=function(e){JSON.parse(e)},t.prototype.setItem=function(e,t,n){switch(n){case ke.ACCOUNT:case ke.CREDENTIAL:case ke.APP_METADATA:this.windowStorage.setItem(e,JSON.stringify(t));break;case ke.TEMPORARY:var r=t;this.windowStorage.setItem(e,r),this.cacheConfig.storeAuthStateInCookie&&this.setItemCookie(e,r);break;case ke.TELEMETRY:this.windowStorage.setItem(e,JSON.stringify(t));break;default:throw Zt.createInvalidCacheTypeError()}},t.prototype.getItem=function(e,t){var n=this.windowStorage.getItem(e);if(ee.isEmpty(n))return null;switch(t){case ke.ACCOUNT:var r=new it;return ot.toObject(r,JSON.parse(n));case ke.CREDENTIAL:switch(Me.getCredentialType(e)){case Re.ID_TOKEN:var i=new St;return ot.toObject(i,JSON.parse(n));case Re.ACCESS_TOKEN:var o=new _t;return ot.toObject(o,JSON.parse(n));case Re.REFRESH_TOKEN:var a=new At;return ot.toObject(a,JSON.parse(n))}case ke.APP_METADATA:return JSON.parse(n);case ke.TEMPORARY:var s=this.getItemCookie(e);return this.cacheConfig.storeAuthStateInCookie?s:n;case ke.TELEMETRY:return JSON.parse(n);default:throw Zt.createInvalidCacheTypeError()}},t.prototype.removeItem=function(e){return this.windowStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&this.clearItemCookie(e),!0},t.prototype.containsKey=function(e){return this.windowStorage.hasOwnProperty(e)},t.prototype.getKeys=function(){return Object.keys(this.windowStorage)},t.prototype.clear=function(){var e;for(e in this.removeAllAccounts(),this.removeAppMetadata(),this.windowStorage)!this.windowStorage.hasOwnProperty(e)||-1===e.indexOf(le)&&-1===e.indexOf(this.clientId)||this.removeItem(e)},t.prototype.setItemCookie=function(e,t,n){var r=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/;";n&&(r+="expires="+this.getCookieExpirationTime(n)+";");document.cookie=r},t.prototype.getItemCookie=function(e){for(var t=encodeURIComponent(e)+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var i=n[r];" "===i.charAt(0);)i=i.substring(1);if(0===i.indexOf(t))return decodeURIComponent(i.substring(t.length,i.length))}return""},t.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)},t.prototype.clearMsalCookie=function(e){var t=e?Et.NONCE_IDTOKEN+"|"+e:Et.NONCE_IDTOKEN;this.clearItemCookie(this.generateCacheKey(t)),this.clearItemCookie(this.generateCacheKey(Et.REQUEST_STATE)),this.clearItemCookie(this.generateCacheKey(Et.ORIGIN_URI))},t.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+864e5*e).toUTCString()},t.prototype.getCache=function(){return this.windowStorage},t.prototype.setCache=function(){},t.prototype.generateCacheKey=function(e){try{return this.validateObjectKey(e),e}catch(t){return ee.startsWith(e,le)||ee.startsWith(e,ne.ADAL_ID_TOKEN)?e:le+"."+this.clientId+"."+e}},t.prototype.generateAuthorityKey=function(e){return""+Et.AUTHORITY+he+e},t.prototype.generateNonceKey=function(e){return""+Et.NONCE_IDTOKEN+he+e},t.prototype.setAuthorityCache=function(e,t){var n=this.generateAuthorityKey(t);this.setItem(this.generateCacheKey(n),e,ke.TEMPORARY)},t.prototype.getCachedAuthority=function(){var e=this.getItem(this.generateCacheKey(Et.REQUEST_STATE),ke.TEMPORARY);return e?this.getItem(this.generateCacheKey(this.generateAuthorityKey(e)),ke.TEMPORARY):null},t.prototype.updateCacheEntries=function(e,t,n){this.setItem(this.generateCacheKey(Et.REQUEST_STATE),e,ke.TEMPORARY),this.setItem(this.generateCacheKey(this.generateNonceKey(e)),t,ke.TEMPORARY),this.setAuthorityCache(n,e)},t.prototype.resetRequestCache=function(e){var t=this;this.getKeys().forEach((function(n){ee.isEmpty(e)||-1===n.indexOf(e)||t.removeItem(n)})),this.removeItem(this.generateCacheKey(Et.REQUEST_STATE)),this.removeItem(this.generateCacheKey(Et.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(Et.ORIGIN_URI)),this.removeItem(this.generateCacheKey(Et.URL_HASH))},t.prototype.cleanRequest=function(){this.removeItem(this.generateCacheKey(Ht));var e=this.getItem(this.generateCacheKey(Et.REQUEST_STATE),ke.TEMPORARY);this.resetRequestCache(e||"")},t.prototype.cacheCodeRequest=function(e,t){this.setItem(this.generateCacheKey(Et.REQUEST_PARAMS),t.base64Encode(JSON.stringify(e)),ke.TEMPORARY)},t.prototype.getCachedRequest=function(e,t){try{var n=this.getItem(this.generateCacheKey(Et.REQUEST_PARAMS),ke.TEMPORARY),r=JSON.parse(t.base64Decode(n));if(this.removeItem(this.generateCacheKey(Et.REQUEST_PARAMS)),ee.isEmpty(r.authority)){var i=this.generateAuthorityKey(e),o=this.getItem(this.generateCacheKey(i),ke.TEMPORARY);r.authority=o}return r}catch(e){throw Zt.createTokenRequestCacheError(e)}},t}(ot),cn=function(){function e(){}return e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e}(),un=function(){function e(e){this.cryptoObj=e}return e.prototype.generateGuid=function(){try{var e=new Uint8Array(16);return this.cryptoObj.getRandomValues(e),e[6]|=64,e[6]&=79,e[8]|=128,e[8]&=191,cn.decimalToHex(e[0])+cn.decimalToHex(e[1])+cn.decimalToHex(e[2])+cn.decimalToHex(e[3])+"-"+cn.decimalToHex(e[4])+cn.decimalToHex(e[5])+"-"+cn.decimalToHex(e[6])+cn.decimalToHex(e[7])+"-"+cn.decimalToHex(e[8])+cn.decimalToHex(e[9])+"-"+cn.decimalToHex(e[10])+cn.decimalToHex(e[11])+cn.decimalToHex(e[12])+cn.decimalToHex(e[13])+cn.decimalToHex(e[14])+cn.decimalToHex(e[15])}catch(e){for(var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",n="0123456789abcdef",r=0,i="",o=0;o<36;o++)"-"!==t[o]&&"4"!==t[o]&&(r=16*Math.random()|0),"x"===t[o]?i+=n[r]:"y"===t[o]?(r&=3,i+=n[r|=8]):i+=t[o];return i}},e.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e}(),ln=function(){function e(){}return e.stringToUtf8Arr=function(e){for(var t,n=0,r=e.length,i=0;i<r;i++)n+=(t=e.charCodeAt(i))<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6;for(var o=new Uint8Array(n),a=0,s=0;a<n;s++)(t=e.charCodeAt(s))<128?o[a++]=t:t<2048?(o[a++]=192+(t>>>6),o[a++]=128+(63&t)):t<65536?(o[a++]=224+(t>>>12),o[a++]=128+(t>>>6&63),o[a++]=128+(63&t)):t<2097152?(o[a++]=240+(t>>>18),o[a++]=128+(t>>>12&63),o[a++]=128+(t>>>6&63),o[a++]=128+(63&t)):t<67108864?(o[a++]=248+(t>>>24),o[a++]=128+(t>>>18&63),o[a++]=128+(t>>>12&63),o[a++]=128+(t>>>6&63),o[a++]=128+(63&t)):(o[a++]=252+(t>>>30),o[a++]=128+(t>>>24&63),o[a++]=128+(t>>>18&63),o[a++]=128+(t>>>12&63),o[a++]=128+(t>>>6&63),o[a++]=128+(63&t));return o},e.utf8ArrToString=function(e){for(var t="",n=void 0,r=e.length,i=0;i<r;i++)n=e[i],t+=String.fromCharCode(n>251&&n<254&&i+5<r?1073741824*(n-252)+(e[++i]-128<<24)+(e[++i]-128<<18)+(e[++i]-128<<12)+(e[++i]-128<<6)+e[++i]-128:n>247&&n<252&&i+4<r?(n-248<<24)+(e[++i]-128<<18)+(e[++i]-128<<12)+(e[++i]-128<<6)+e[++i]-128:n>239&&n<248&&i+3<r?(n-240<<18)+(e[++i]-128<<12)+(e[++i]-128<<6)+e[++i]-128:n>223&&n<240&&i+2<r?(n-224<<12)+(e[++i]-128<<6)+e[++i]-128:n>191&&n<224&&i+1<r?(n-192<<6)+e[++i]-128:n);return t},e}(),dn=function(){function e(){}return e.prototype.urlEncode=function(e){return encodeURIComponent(this.encode(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))},e.prototype.urlEncodeArr=function(e){return this.base64EncArr(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},e.prototype.encode=function(e){var t=ln.stringToUtf8Arr(e);return this.base64EncArr(t)},e.prototype.base64EncArr=function(e){for(var t=(3-e.length%3)%3,n="",r=void 0,i=e.length,o=0,a=0;a<i;a++)r=a%3,o|=e[a]<<(16>>>r&24),2!==r&&e.length-a!=1||(n+=String.fromCharCode(this.uint6ToB64(o>>>18&63),this.uint6ToB64(o>>>12&63),this.uint6ToB64(o>>>6&63),this.uint6ToB64(63&o)),o=0);return 0===t?n:n.substring(0,n.length-t)+(1===t?"=":"==")},e.prototype.uint6ToB64=function(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65},e}(),fn=function(){function e(){}return e.prototype.decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}var n=this.base64DecToArr(t);return decodeURIComponent(ln.utf8ArrToString(n))},e.prototype.base64DecToArr=function(e,t){for(var n=e.replace(/[^A-Za-z0-9\+\/]/g,""),r=n.length,i=t?Math.ceil((3*r+1>>>2)/t)*t:3*r+1>>>2,o=new Uint8Array(i),a=void 0,s=void 0,c=0,u=0,l=0;l<r;l++)if(s=3&l,c|=this.b64ToUint6(n.charCodeAt(l))<<18-6*s,3===s||r-l==1){for(a=0;a<3&&u<i;a++,u++)o[u]=c>>>(16>>>a&24)&255;c=0}return o},e.prototype.b64ToUint6=function(e){return e>64&&e<91?e-65:e>96&&e<123?e-71:e>47&&e<58?e+4:43===e?62:47===e?63:0},e}(),pn=function(){function e(e){this.base64Encode=new dn,this.cryptoObj=e}return e.prototype.generateCodes=function(){return a(this,void 0,void 0,(function(){var e,t;return s(this,(function(n){switch(n.label){case 0:return e=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(e)];case 1:return t=n.sent(),[2,{verifier:e,challenge:t}]}}))}))},e.prototype.generateCodeVerifier=function(){try{var e=new Uint8Array(32);return this.cryptoObj.getRandomValues(e),this.base64Encode.urlEncodeArr(e)}catch(e){throw Zt.createPkceNotGeneratedError(e)}},e.prototype.generateCodeChallengeFromVerifier=function(e){return a(this,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(e)];case 1:return t=r.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(t))];case 2:throw n=r.sent(),Zt.createPkceNotGeneratedError(n);case 3:return[2]}}))}))},e}(),hn=function(){function e(){if(!this.hasCryptoAPI())throw Zt.createCryptoNotAvailableError("Browser crypto or msCrypto object not available.")}return e.prototype.sha256Digest=function(e){return a(this,void 0,void 0,(function(){var t;return s(this,(function(n){return t=ln.stringToUtf8Arr(e),[2,this.hasIECrypto()?this.getMSCryptoDigest("SHA-256",t):this.getSubtleCryptoDigest("SHA-256",t)]}))}))},e.prototype.getRandomValues=function(e){var t=window.msCrypto||window.crypto;if(!t.getRandomValues)throw Zt.createCryptoNotAvailableError("getRandomValues does not exist.");t.getRandomValues(e)},e.prototype.hasIECrypto=function(){return!!window.msCrypto},e.prototype.hasBrowserCrypto=function(){return!!window.crypto},e.prototype.hasCryptoAPI=function(){return this.hasIECrypto()||this.hasBrowserCrypto()},e.prototype.getSubtleCryptoDigest=function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(n){return[2,window.crypto.subtle.digest(e,t)]}))}))},e.prototype.getMSCryptoDigest=function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(n){return[2,new Promise((function(n,r){var i=window.msCrypto.subtle.digest(e,t.buffer);i.addEventListener("complete",(function(e){n(e.target.result)})),i.addEventListener("error",(function(e){r(e)}))}))]}))}))},e}(),gn=function(){function e(){this.browserCrypto=new hn,this.b64Encode=new dn,this.b64Decode=new fn,this.guidGenerator=new un(this.browserCrypto),this.pkceGenerator=new pn(this.browserCrypto)}return e.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},e.prototype.base64Encode=function(e){return this.b64Encode.encode(e)},e.prototype.base64Decode=function(e){return this.b64Decode.decode(e)},e.prototype.generatePkceCodes=function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){return[2,this.pkceGenerator.generateCodes()]}))}))},e}(),mn=function(){function e(e,t){this.authModule=e,this.browserStorage=t}return e.prototype.handleCodeResponse=function(e){return a(this,void 0,void 0,(function(){var t,n,r,i,o;return s(this,(function(a){switch(a.label){case 0:if(ee.isEmpty(e))throw Zt.createEmptyHashError(e);return t=this.browserStorage.getItem(this.browserStorage.generateCacheKey(Et.REQUEST_STATE),ke.TEMPORARY),n=this.authModule.handleFragmentResponse(e,t),r=this.browserStorage.generateNonceKey(t),i=this.browserStorage.getItem(this.browserStorage.generateCacheKey(r),ke.TEMPORARY),this.authCodeRequest.code=n,[4,this.authModule.acquireToken(this.authCodeRequest,i,t)];case 1:return o=a.sent(),this.browserStorage.cleanRequest(),[2,o]}}))}))},e}(),vn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.initiateAuthRequest=function(e,t,n,r){if(ee.isEmpty(e))throw this.authModule.logger.info("Navigate url is empty"),Zt.createEmptyNavigationUriError();n&&this.browserStorage.setItem(this.browserStorage.generateCacheKey(Et.ORIGIN_URI),n,ke.TEMPORARY),this.browserStorage.setItem(this.browserStorage.generateCacheKey(Ht),jt,ke.TEMPORARY),this.browserStorage.cacheCodeRequest(t,r),this.authModule.logger.infoPii("Navigate to:"+e);var i=en.isInIframe();if(i)throw Zt.createRedirectInIframeError(i);return en.navigateWindow(e),window},t.prototype.handleCodeResponse=function(e,t){return a(this,void 0,void 0,(function(){var n,r,i,o,a;return s(this,(function(s){switch(s.label){case 0:if(ee.isEmpty(e))throw Zt.createEmptyHashError(e);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Ht)),n=this.browserStorage.getItem(this.browserStorage.generateCacheKey(Et.REQUEST_STATE),ke.TEMPORARY),r=this.authModule.handleFragmentResponse(e,n),i=this.browserStorage.generateNonceKey(n),o=this.browserStorage.getItem(this.browserStorage.generateCacheKey(i),ke.TEMPORARY),this.authCodeRequest=this.browserStorage.getCachedRequest(n,t),this.authCodeRequest.code=r,[4,this.authModule.acquireToken(this.authCodeRequest,o,n)];case 1:return a=s.sent(),this.browserStorage.cleanRequest(),[2,a]}}))}))},t}(mn),yn=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.unloadWindow=r.unloadWindow.bind(r),r}return i(t,e),t.prototype.initiateAuthRequest=function(e,t,n){if(ee.isEmpty(e))throw this.authModule.logger.error("Navigate url is empty"),Zt.createEmptyNavigationUriError();return this.authCodeRequest=t,this.browserStorage.setItem(this.browserStorage.generateCacheKey(Ht),jt,ke.TEMPORARY),this.authModule.logger.infoPii("Navigate to:"+e),this.openPopup(e,n)},t.prototype.monitorPopupForHash=function(e,t){var n=this;return new Promise((function(r,i){var o=t/Wt,a=0,s=setInterval((function(){if(e.closed)return n.cleanPopup(),clearInterval(s),void i(Zt.createUserCancelledError());var t;try{t=e.location.href}catch(e){}if(!ee.isEmpty(t)&&"about:blank"!==t){a++;var c=e.location.hash;return nt.hashContainsKnownProperties(c)?(n.cleanPopup(e),clearInterval(s),void r(c)):a>o?(n.cleanPopup(e),clearInterval(s),void i(Zt.createMonitorWindowTimeoutError())):void 0}}),Wt)}))},t.prototype.openPopup=function(e,n){try{var r=void 0;if(n?(r=n).location.assign(e):void 0===n&&(r=t.openSizedPopup(e)),!r)throw Zt.createEmptyWindowCreatedError();return r.focus&&r.focus(),this.currentWindow=r,window.addEventListener("beforeunload",this.unloadWindow),r}catch(e){throw this.authModule.logger.error("error opening popup "+e.message),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Ht)),Zt.createPopupWindowError(e.toString())}},t.openSizedPopup=function(e){void 0===e&&(e="about:blank");var t=window.screenLeft?window.screenLeft:window.screenX,n=window.screenTop?window.screenTop:window.screenY,r=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,i=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,o=Math.max(0,r/2-Bt/2+t),a=Math.max(0,i/2-Kt/2+n);return window.open(e,ce,"width="+Bt+", height="+Kt+", top="+a+", left="+o)},t.prototype.unloadWindow=function(e){this.browserStorage.cleanRequest(),this.currentWindow.close(),delete e.returnValue},t.prototype.cleanPopup=function(e){e&&e.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Ht))},t}(mn),wn=function(e){function t(t,n,r){var i=e.call(this,t,n)||this;return i.loadFrameTimeout=r,i}return i(t,e),t.prototype.initiateAuthRequest=function(e,t,n){return a(this,void 0,void 0,(function(){var r,i;return s(this,(function(o){switch(o.label){case 0:if(ee.isEmpty(e))throw this.authModule.logger.info("Navigate url is empty"),Zt.createEmptyNavigationUriError();return this.authCodeRequest=t,r=n?"msalTokenFrame"+n:"msalTokenFrame",this.loadFrameTimeout?[4,this.loadFrame(e,r)]:[3,2];case 1:return i=o.sent(),[3,3];case 2:i=this.loadFrameSync(e,r),o.label=3;case 3:return[2,i]}}))}))},t.prototype.monitorIframeForHash=function(e,t){var n=this;return new Promise((function(r,i){var o=window.performance.now()+t,a=setInterval((function(){if(window.performance.now()>o)return n.removeHiddenIframe(e),clearInterval(a),void i(Zt.createMonitorWindowTimeoutError());var t;try{t=e.contentWindow.location.href}catch(e){}if(!ee.isEmpty(t)){var s=e.contentWindow.location.hash;return nt.hashContainsKnownProperties(s)?(n.removeHiddenIframe(e),clearInterval(a),void r(s)):void 0}}),Wt)}))},t.prototype.loadFrame=function(e,t){var n=this;return new Promise((function(r,i){setTimeout((function(){var o=n.loadFrameSync(e,t);o?r(o):i("Unable to load iframe with name: "+t)}),n.loadFrameTimeout)}))},t.prototype.loadFrameSync=function(e,t){var n=this.getHiddenIframe(t);return n?(""!==n.src&&"about:blank"!==n.src||(n.src=e),n):null},t.prototype.getHiddenIframe=function(e){if(void 0===e)return null;var t=document.getElementById(e);if(!t){if(document.createElement&&document.documentElement&&-1===window.navigator.userAgent.indexOf("MSIE 5.0")){var n=document.createElement("iframe");n.setAttribute("id",e),n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height="0",n.style.border="0",n.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),t=document.getElementsByTagName("body")[0].appendChild(n)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeend","<iframe name='"+e+"' id='"+e+"' style='display:none'></iframe>");window.frames&&window.frames[e]&&(t=window.frames[e])}return t},t.prototype.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},t}(mn),bn=function(){function e(){}return e.extractBrowserRequestState=function(e,t){if(ee.isEmpty(t))return null;try{return Ot.parseRequestState(e,t).libraryState.meta}catch(e){throw $.createInvalidStateError(t,e)}},e}(),Cn=function(){function e(e){var t,n,r,i;this.config=(n=(t=e).auth,r=t.cache,i=t.system,{auth:o(o({},tn),n),cache:o(o({},nn),r),system:o(o({},rn),i)}),this.browserCrypto=new gn,this.networkClient=this.config.system.networkClient,this.browserStorage=new sn(this.config.auth.clientId,this.config.cache),this.logger=new se(this.config.system.loggerOptions),rt.setTrustedAuthoritiesFromConfig(this.config.auth.knownAuthorities,this.config.auth.cloudDiscoveryMetadata),this.defaultAuthority=null}return e.prototype.handleRedirectPromise=function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){return[2,this.handleRedirectResponse()]}))}))},e.prototype.handleRedirectResponse=function(){return a(this,void 0,void 0,(function(){var e,t,n,r,i,o;return s(this,(function(a){return e=this.getRedirectResponseHash(),ee.isEmpty(e)?[2,null]:(t=this.browserStorage.getItem(this.browserStorage.generateCacheKey(Et.ORIGIN_URI),ke.TEMPORARY),n=nt.removeHashFromUrl(t||""),r=nt.removeHashFromUrl(window.location.href),n===r&&this.config.auth.navigateToLoginRequestUrl?(t.indexOf("#")>-1&&en.replaceHash(t),[2,this.handleHash(e)]):this.config.auth.navigateToLoginRequestUrl?(en.isInIframe()||(i=this.browserStorage.generateCacheKey(Et.URL_HASH),this.browserStorage.setItem(i,e,ke.TEMPORARY),t&&"null"!==t?en.navigateWindow(t,!0):(o=en.getHomepage(),this.browserStorage.setItem(this.browserStorage.generateCacheKey(Et.ORIGIN_URI),o,ke.TEMPORARY),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),en.navigateWindow(o,!0))),[2,null]):[2,this.handleHash(e)])}))}))},e.prototype.getRedirectResponseHash=function(){var e=window.location.hash,t=nt.hashContainsKnownProperties(e),n=this.browserStorage.getItem(this.browserStorage.generateCacheKey(Et.URL_HASH),ke.TEMPORARY);this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Et.URL_HASH));var r=t?e:n;if(r){var i=nt.getDeserializedHash(r);return bn.extractBrowserRequestState(this.browserCrypto,i.state).interactionType!==Tt.REDIRECT?null:(en.clearHash(),r)}return this.browserStorage.cleanRequest(),null},e.prototype.handleHash=function(e){return a(this,void 0,void 0,(function(){var t,n,r,i,o,a;return s(this,(function(s){switch(s.label){case 0:t=this.browserStorage.getItem(this.browserStorage.generateCacheKey(Et.REQUEST_PARAMS),ke.TEMPORARY),n=JSON.parse(this.browserCrypto.base64Decode(t)),r=this.initializeServerTelemetryManager(It.handleRedirectPromise,n.correlationId),s.label=1;case 1:return s.trys.push([1,4,,5]),i=this.browserStorage.getCachedAuthority(),[4,this.createAuthCodeClient(r,i)];case 2:return o=s.sent(),[4,new vn(o,this.browserStorage).handleCodeResponse(e,this.browserCrypto)];case 3:return[2,s.sent()];case 4:throw a=s.sent(),r.cacheFailedRequest(a),this.browserStorage.cleanRequest(),a;case 5:return[2]}}))}))},e.prototype.loginRedirect=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){return[2,this.acquireTokenRedirect(e||Yt)]}))}))},e.prototype.acquireTokenRedirect=function(e){return a(this,void 0,void 0,(function(){var t,n,r,i,o,a,c,u;return s(this,(function(s){switch(s.label){case 0:t=this.preflightInteractiveRequest(e,Tt.REDIRECT),n=this.initializeServerTelemetryManager(It.acquireTokenRedirect,t.correlationId),s.label=1;case 1:return s.trys.push([1,5,,6]),[4,this.initializeAuthorizationCodeRequest(t)];case 2:return r=s.sent(),[4,this.createAuthCodeClient(n,t.authority)];case 3:return i=s.sent(),o=new vn(i,this.browserStorage),[4,i.getAuthCodeUrl(t)];case 4:return a=s.sent(),c=e&&e.redirectStartPage||window.location.href,o.initiateAuthRequest(a,r,c,this.browserCrypto),[3,6];case 5:throw u=s.sent(),n.cacheFailedRequest(u),this.browserStorage.cleanRequest(),u;case 6:return[2]}}))}))},e.prototype.loginPopup=function(e){return this.acquireTokenPopup(e||Yt)},e.prototype.acquireTokenPopup=function(e){if(this.config.system.asyncPopups)return this.acquireTokenPopupAsync(e);var t=yn.openSizedPopup();return this.acquireTokenPopupAsync(e,t)},e.prototype.acquireTokenPopupAsync=function(e,t){return a(this,void 0,void 0,(function(){var n,r,i,o,a,c,u,l,d;return s(this,(function(s){switch(s.label){case 0:n=this.preflightInteractiveRequest(e,Tt.POPUP),r=this.initializeServerTelemetryManager(It.acquireTokenPopup,n.correlationId),s.label=1;case 1:return s.trys.push([1,7,,8]),[4,this.initializeAuthorizationCodeRequest(n)];case 2:return i=s.sent(),[4,this.createAuthCodeClient(r,n.authority)];case 3:return[4,(o=s.sent()).getAuthCodeUrl(n)];case 4:return a=s.sent(),c=new yn(o,this.browserStorage),u=c.initiateAuthRequest(a,i,t),[4,c.monitorPopupForHash(u,this.config.system.windowHashTimeout)];case 5:return l=s.sent(),[4,c.handleCodeResponse(l)];case 6:return[2,s.sent()];case 7:throw d=s.sent(),r.cacheFailedRequest(d),this.browserStorage.cleanRequest(),d;case 8:return[2]}}))}))},e.prototype.ssoSilent=function(e){return a(this,void 0,void 0,(function(){var t,n,r,i,a,c,u;return s(this,(function(s){switch(s.label){case 0:if(en.blockReloadInHiddenIframes(),ee.isEmpty(e.loginHint)&&ee.isEmpty(e.sid))throw Zt.createSilentSSOInsufficientInfoError();if(e.prompt&&e.prompt!==Te.NONE)throw Zt.createSilentPromptValueError(e.prompt);t=this.initializeAuthorizationRequest(o(o({},e),{prompt:Te.NONE}),Tt.SILENT),n=this.initializeServerTelemetryManager(It.ssoSilent,t.correlationId),s.label=1;case 1:return s.trys.push([1,6,,7]),[4,this.initializeAuthorizationCodeRequest(t)];case 2:return r=s.sent(),i=t.scopes?t.scopes.join(" "):"",[4,this.createAuthCodeClient(n,t.authority)];case 3:return[4,(a=s.sent()).getAuthCodeUrl(t)];case 4:return c=s.sent(),[4,this.silentTokenHelper(c,r,a,i)];case 5:return[2,s.sent()];case 6:throw u=s.sent(),n.cacheFailedRequest(u),this.browserStorage.cleanRequest(),u;case 7:return[2]}}))}))},e.prototype.acquireTokenSilent=function(e){return a(this,void 0,void 0,(function(){var t,n,r,i,a,c,u,l,d,f,p,h;return s(this,(function(s){switch(s.label){case 0:en.blockReloadInHiddenIframes(),t=o(o({},e),this.initializeBaseRequest(e)),n=this.initializeServerTelemetryManager(It.acquireTokenSilent_silentFlow,t.correlationId),s.label=1;case 1:return s.trys.push([1,4,,12]),[4,this.createSilentFlowClient(n,t.authority)];case 2:return[4,s.sent().acquireToken(t)];case 3:return[2,s.sent()];case 4:if(r=s.sent(),n.cacheFailedRequest(r),i=r instanceof yt,a=r instanceof kt,c=r.errorCode===zt,!i||!c||a)return[3,11];u=this.initializeAuthorizationRequest(o(o({},t),{redirectUri:e.redirectUri,prompt:Te.NONE}),Tt.SILENT),n=this.initializeServerTelemetryManager(It.acquireTokenSilent_authCode,u.correlationId),s.label=5;case 5:return s.trys.push([5,10,,11]),[4,this.initializeAuthorizationCodeRequest(u)];case 6:return l=s.sent(),[4,this.createAuthCodeClient(n,u.authority)];case 7:return[4,(d=s.sent()).getAuthCodeUrl(u)];case 8:return f=s.sent(),p=u.scopes?u.scopes.join(" "):"",[4,this.silentTokenHelper(f,l,d,p)];case 9:return[2,s.sent()];case 10:throw h=s.sent(),n.cacheFailedRequest(h),this.browserStorage.cleanRequest(),h;case 11:throw r;case 12:return[2]}}))}))},e.prototype.silentTokenHelper=function(e,t,n,r){return a(this,void 0,void 0,(function(){var i,o,a;return s(this,(function(s){switch(s.label){case 0:return[4,(i=new wn(n,this.browserStorage,this.config.system.loadFrameTimeout)).initiateAuthRequest(e,t,r)];case 1:return o=s.sent(),[4,i.monitorIframeForHash(o,this.config.system.iframeHashTimeout)];case 2:return a=s.sent(),[2,i.handleCodeResponse(a)]}}))}))},e.prototype.logout=function(e){return a(this,void 0,void 0,(function(){var t,n,r;return s(this,(function(i){switch(i.label){case 0:return t=this.initializeLogoutRequest(e),[4,this.createAuthCodeClient(null,t&&t.authority)];case 1:return n=i.sent(),r=n.getLogoutUri(t),en.navigateWindow(r),[2]}}))}))},e.prototype.getAllAccounts=function(){return this.browserStorage.getAllAccounts()},e.prototype.getAccountByUsername=function(e){var t=this.getAllAccounts();return!ee.isEmpty(e)&&t&&t.length&&t.filter((function(t){return t.username.toLowerCase()===e.toLowerCase()}))[0]||null},e.prototype.getAccountByHomeId=function(e){var t=this.getAllAccounts();return!ee.isEmpty(e)&&t&&t.length&&t.filter((function(t){return t.homeAccountId===e}))[0]||null},e.prototype.getRedirectUri=function(e){return e||this.config.auth.redirectUri||en.getCurrentUri()},e.prototype.getPostLogoutRedirectUri=function(e){return e||this.config.auth.postLogoutRedirectUri||en.getCurrentUri()},e.prototype.getDiscoveredDefaultAuthority=function(){return a(this,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:return this.defaultAuthority?[3,2]:(e=this,[4,Ft.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient)]);case 1:e.defaultAuthority=t.sent(),t.label=2;case 2:return[2,this.defaultAuthority]}}))}))},e.prototype.interactionInProgress=function(){return this.browserStorage.getItem(this.browserStorage.generateCacheKey(Ht),ke.TEMPORARY)===jt},e.prototype.createAuthCodeClient=function(e,t){return a(this,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:return[4,this.getClientConfiguration(e,t)];case 1:return n=r.sent(),[2,new Mt(n)]}}))}))},e.prototype.createSilentFlowClient=function(e,t){return a(this,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:return[4,this.getClientConfiguration(e,t)];case 1:return n=r.sent(),[2,new Lt(n)]}}))}))},e.prototype.getClientConfiguration=function(e,t){return a(this,void 0,void 0,(function(){var n,r;return s(this,(function(i){switch(i.label){case 0:return ee.isEmpty(t)||t===this.config.auth.authority?[3,2]:[4,Ft.createDiscoveredInstance(t,this.config.system.networkClient)];case 1:return r=i.sent(),[3,4];case 2:return[4,this.getDiscoveredDefaultAuthority()];case 3:r=i.sent(),i.label=4;case 4:return n=r,[2,{authOptions:{clientId:this.config.auth.clientId,authority:n,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds},loggerOptions:{loggerCallback:this.config.system.loggerOptions.loggerCallback,piiLoggingEnabled:this.config.system.loggerOptions.piiLoggingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:e,libraryInfo:{sku:Xt,version:"2.1.0",cpu:"",os:""}}]}}))}))},e.prototype.preflightInteractiveRequest=function(e,t){if(en.blockReloadInHiddenIframes(),this.interactionInProgress())throw Zt.createInteractionInProgressError();return this.initializeAuthorizationRequest(e,t)},e.prototype.initializeBaseRequest=function(e){var t=o({},e);return ee.isEmpty(t.authority)&&(t.authority=this.config.auth.authority),t.correlationId=e&&e.correlationId||this.browserCrypto.createNewGuid(),t},e.prototype.initializeServerTelemetryManager=function(e,t,n){var r={clientId:this.config.auth.clientId,correlationId:t,apiId:e,forceRefresh:n||!1};return new qt(r,this.browserStorage)},e.prototype.setDefaultScopes=function(e){return o(o({},e),{scopes:c(e&&e.scopes||[],Yt.scopes)})},e.prototype.initializeAuthorizationRequest=function(e,t){var n=o({},e);if(n.redirectUri=this.getRedirectUri(n.redirectUri),ee.isEmpty(n.loginHint)){var r=this.browserStorage.getItem(ne.ADAL_ID_TOKEN,ke.TEMPORARY);if(!ee.isEmpty(r)){var i=new wt(r,this.browserCrypto);this.browserStorage.removeItem(ne.ADAL_ID_TOKEN),i.claims&&i.claims.upn&&(n.loginHint=i.claims.upn)}}var a={interactionType:t};return n.state=Ot.setRequestState(this.browserCrypto,e&&e.state||"",a),ee.isEmpty(n.nonce)&&(n.nonce=this.browserCrypto.createNewGuid()),n.responseMode=Se.FRAGMENT,n=o(o({},n),this.initializeBaseRequest(n)),this.browserStorage.updateCacheEntries(n.state,n.nonce,n.authority),o(o({},n),this.setDefaultScopes(n))},e.prototype.initializeAuthorizationCodeRequest=function(e){return a(this,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:return[4,this.browserCrypto.generatePkceCodes()];case 1:return t=r.sent(),n=o(o({},e),{redirectUri:e.redirectUri,code:"",codeVerifier:t.verifier}),e.codeChallenge=t.challenge,e.codeChallengeMethod=we,[2,n]}}))}))},e.prototype.initializeLogoutRequest=function(e){var t=o({},e);return ee.isEmpty(t.authority)&&(t.authority=this.config.auth.authority),t.correlationId=t&&t.correlationId||this.browserCrypto.createNewGuid(),t.postLogoutRedirectUri=this.getPostLogoutRedirectUri(e?e.postLogoutRedirectUri:""),t},e}()},129:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.client=void 0;const r=n(105);t.client=new r.PublicClientApplication({auth:{clientId:"67dc74f0-fb8c-47a4-8435-63253a3fc3bb",authority:"https://login.microsoftonline.com/organizations/",navigateToLoginRequestUrl:!1},cache:{cacheLocation:"localStorage"}})},20:function(e,t,n){"use strict";(function(e){n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"e",(function(){return a})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}));var r="function",i="object",o="undefined",a="prototype";function s(){return typeof globalThis!==o&&globalThis?globalThis:typeof self!==o&&self?self:typeof window!==o&&window?window:typeof e!==o&&e?e:null}function c(e){var t=Object.create;if(t)return t(e);if(null==e)return{};var n=typeof e;if(n!==i&&n!==r)throw new TypeError("Object prototype may only be an Object:"+e);function o(){}return o[a]=e,new o}var u=function(e,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};var l,d,f,p=s()||{};d=function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object[a].hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},f=function(e,t){function n(){this.constructor=e}u(e,t),e[a]=null===t?c(t):(n[a]=t[a],new n)},(l=p).__assign=l.__assign||Object.assign||d,l.__extends=l.__extends||f,__assign=p.__assign,__extends=p.__extends}).call(this,n(100))},207:function(e,t,n){e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=90)}({17:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r=n(18),i=function(){function e(){}return e.getFirstMatch=function(e,t){var n=t.match(e);return n&&n.length>0&&n[1]||""},e.getSecondMatch=function(e,t){var n=t.match(e);return n&&n.length>1&&n[2]||""},e.matchAndReturnConst=function(e,t,n){if(e.test(t))return n},e.getWindowsVersionName=function(e){switch(e){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},e.getMacOSVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),10===t[0])switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},e.getAndroidVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),!(1===t[0]&&t[1]<5))return 1===t[0]&&t[1]<6?"Cupcake":1===t[0]&&t[1]>=6?"Donut":2===t[0]&&t[1]<2?"Eclair":2===t[0]&&2===t[1]?"Froyo":2===t[0]&&t[1]>2?"Gingerbread":3===t[0]?"Honeycomb":4===t[0]&&t[1]<1?"Ice Cream Sandwich":4===t[0]&&t[1]<4?"Jelly Bean":4===t[0]&&t[1]>=4?"KitKat":5===t[0]?"Lollipop":6===t[0]?"Marshmallow":7===t[0]?"Nougat":8===t[0]?"Oreo":9===t[0]?"Pie":void 0},e.getVersionPrecision=function(e){return e.split(".").length},e.compareVersions=function(t,n,r){void 0===r&&(r=!1);var i=e.getVersionPrecision(t),o=e.getVersionPrecision(n),a=Math.max(i,o),s=0,c=e.map([t,n],(function(t){var n=a-e.getVersionPrecision(t),r=t+new Array(n+1).join(".0");return e.map(r.split("."),(function(e){return new Array(20-e.length).join("0")+e})).reverse()}));for(r&&(s=a-Math.min(i,o)),a-=1;a>=s;){if(c[0][a]>c[1][a])return 1;if(c[0][a]===c[1][a]){if(a===s)return 0;a-=1}else if(c[0][a]<c[1][a])return-1}},e.map=function(e,t){var n,r=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(n=0;n<e.length;n+=1)r.push(t(e[n]));return r},e.find=function(e,t){var n,r;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(n=0,r=e.length;n<r;n+=1){var i=e[n];if(t(i,n))return i}},e.assign=function(e){for(var t,n,r=e,i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];if(Object.assign)return Object.assign.apply(Object,[e].concat(o));var s=function(){var e=o[t];"object"==typeof e&&null!==e&&Object.keys(e).forEach((function(t){r[t]=e[t]}))};for(t=0,n=o.length;t<n;t+=1)s();return e},e.getBrowserAlias=function(e){return r.BROWSER_ALIASES_MAP[e]},e.getBrowserTypeByAlias=function(e){return r.BROWSER_MAP[e]||""},e}();t.default=i,e.exports=t.default},18:function(e,t,n){"use strict";t.__esModule=!0,t.ENGINE_MAP=t.OS_MAP=t.PLATFORMS_MAP=t.BROWSER_MAP=t.BROWSER_ALIASES_MAP=void 0,t.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},t.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},t.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},t.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},t.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(91))&&r.__esModule?r:{default:r},o=n(18);function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(){}var t,n;return e.getParser=function(e,t){if(void 0===t&&(t=!1),"string"!=typeof e)throw new Error("UserAgent should be a string");return new i.default(e,t)},e.parse=function(e){return new i.default(e).getResult()},t=e,(n=[{key:"BROWSER_MAP",get:function(){return o.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return o.ENGINE_MAP}},{key:"OS_MAP",get:function(){return o.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return o.PLATFORMS_MAP}}])&&a(t,n),e}();t.default=s,e.exports=t.default},91:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r=c(n(92)),i=c(n(93)),o=c(n(94)),a=c(n(95)),s=c(n(17));function c(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(e,t){if(void 0===t&&(t=!1),null==e||""===e)throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},!0!==t&&this.parse()}var t=e.prototype;return t.getUA=function(){return this._ua},t.test=function(e){return e.test(this._ua)},t.parseBrowser=function(){var e=this;this.parsedResult.browser={};var t=s.default.find(r.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser},t.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},t.getBrowserName=function(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},t.getBrowserVersion=function(){return this.getBrowser().version},t.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},t.parseOS=function(){var e=this;this.parsedResult.os={};var t=s.default.find(i.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os},t.getOSName=function(e){var t=this.getOS().name;return e?String(t).toLowerCase()||"":t||""},t.getOSVersion=function(){return this.getOS().version},t.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},t.getPlatformType=function(e){void 0===e&&(e=!1);var t=this.getPlatform().type;return e?String(t).toLowerCase()||"":t||""},t.parsePlatform=function(){var e=this;this.parsedResult.platform={};var t=s.default.find(o.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform},t.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},t.getEngineName=function(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},t.parseEngine=function(){var e=this;this.parsedResult.engine={};var t=s.default.find(a.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.engine=t.describe(this.getUA())),this.parsedResult.engine},t.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},t.getResult=function(){return s.default.assign({},this.parsedResult)},t.satisfies=function(e){var t=this,n={},r=0,i={},o=0;if(Object.keys(e).forEach((function(t){var a=e[t];"string"==typeof a?(i[t]=a,o+=1):"object"==typeof a&&(n[t]=a,r+=1)})),r>0){var a=Object.keys(n),c=s.default.find(a,(function(e){return t.isOS(e)}));if(c){var u=this.satisfies(n[c]);if(void 0!==u)return u}var l=s.default.find(a,(function(e){return t.isPlatform(e)}));if(l){var d=this.satisfies(n[l]);if(void 0!==d)return d}}if(o>0){var f=Object.keys(i),p=s.default.find(f,(function(e){return t.isBrowser(e,!0)}));if(void 0!==p)return this.compareVersion(i[p])}},t.isBrowser=function(e,t){void 0===t&&(t=!1);var n=this.getBrowserName().toLowerCase(),r=e.toLowerCase(),i=s.default.getBrowserTypeByAlias(r);return t&&i&&(r=i.toLowerCase()),r===n},t.compareVersion=function(e){var t=[0],n=e,r=!1,i=this.getBrowserVersion();if("string"==typeof i)return">"===e[0]||"<"===e[0]?(n=e.substr(1),"="===e[1]?(r=!0,n=e.substr(2)):t=[],">"===e[0]?t.push(1):t.push(-1)):"="===e[0]?n=e.substr(1):"~"===e[0]&&(r=!0,n=e.substr(1)),t.indexOf(s.default.compareVersions(i,n,r))>-1},t.isOS=function(e){return this.getOSName(!0)===String(e).toLowerCase()},t.isPlatform=function(e){return this.getPlatformType(!0)===String(e).toLowerCase()},t.isEngine=function(e){return this.getEngineName(!0)===String(e).toLowerCase()},t.is=function(e,t){return void 0===t&&(t=!1),this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)},t.some=function(e){var t=this;return void 0===e&&(e=[]),e.some((function(e){return t.is(e)}))},e}();t.default=u,e.exports=t.default},92:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},o=/version\/(\d+(\.?_?\d+)+)/i,a=[{test:[/googlebot/i],describe:function(e){var t={name:"Googlebot"},n=i.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/opera/i],describe:function(e){var t={name:"Opera"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/opr\/|opios/i],describe:function(e){var t={name:"Opera"},n=i.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/SamsungBrowser/i],describe:function(e){var t={name:"Samsung Internet for Android"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Whale/i],describe:function(e){var t={name:"NAVER Whale Browser"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/MZBrowser/i],describe:function(e){var t={name:"MZ Browser"},n=i.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/focus/i],describe:function(e){var t={name:"Focus"},n=i.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/swing/i],describe:function(e){var t={name:"Swing"},n=i.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/coast/i],describe:function(e){var t={name:"Opera Coast"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(e){var t={name:"Opera Touch"},n=i.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/yabrowser/i],describe:function(e){var t={name:"Yandex Browser"},n=i.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/ucbrowser/i],describe:function(e){var t={name:"UC Browser"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Maxthon|mxios/i],describe:function(e){var t={name:"Maxthon"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/epiphany/i],describe:function(e){var t={name:"Epiphany"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/puffin/i],describe:function(e){var t={name:"Puffin"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sleipnir/i],describe:function(e){var t={name:"Sleipnir"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/k-meleon/i],describe:function(e){var t={name:"K-Meleon"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/micromessenger/i],describe:function(e){var t={name:"WeChat"},n=i.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/qqbrowser/i],describe:function(e){var t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},n=i.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/msie|trident/i],describe:function(e){var t={name:"Internet Explorer"},n=i.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/\sedg\//i],describe:function(e){var t={name:"Microsoft Edge"},n=i.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/edg([ea]|ios)/i],describe:function(e){var t={name:"Microsoft Edge"},n=i.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/vivaldi/i],describe:function(e){var t={name:"Vivaldi"},n=i.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/seamonkey/i],describe:function(e){var t={name:"SeaMonkey"},n=i.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sailfish/i],describe:function(e){var t={name:"Sailfish"},n=i.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return n&&(t.version=n),t}},{test:[/silk/i],describe:function(e){var t={name:"Amazon Silk"},n=i.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/phantom/i],describe:function(e){var t={name:"PhantomJS"},n=i.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/slimerjs/i],describe:function(e){var t={name:"SlimerJS"},n=i.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t={name:"BlackBerry"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t={name:"WebOS Browser"},n=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/bada/i],describe:function(e){var t={name:"Bada"},n=i.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/tizen/i],describe:function(e){var t={name:"Tizen"},n=i.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/qupzilla/i],describe:function(e){var t={name:"QupZilla"},n=i.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/firefox|iceweasel|fxios/i],describe:function(e){var t={name:"Firefox"},n=i.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/electron/i],describe:function(e){var t={name:"Electron"},n=i.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/MiuiBrowser/i],describe:function(e){var t={name:"Miui"},n=i.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/chromium/i],describe:function(e){var t={name:"Chromium"},n=i.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/chrome|crios|crmo/i],describe:function(e){var t={name:"Chrome"},n=i.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/GSA/i],describe:function(e){var t={name:"Google Search"},n=i.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){var t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe:function(e){var t={name:"Android Browser"},n=i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/playstation 4/i],describe:function(e){var t={name:"PlayStation 4"},n=i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/safari|applewebkit/i],describe:function(e){var t={name:"Safari"},n=i.default.getFirstMatch(o,e);return n&&(t.version=n),t}},{test:[/.*/i],describe:function(e){var t=-1!==e.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:i.default.getFirstMatch(t,e),version:i.default.getSecondMatch(t,e)}}}];t.default=a,e.exports=t.default},93:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},o=n(18),a=[{test:[/Roku\/DVP/],describe:function(e){var t=i.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:o.OS_MAP.Roku,version:t}}},{test:[/windows phone/i],describe:function(e){var t=i.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.WindowsPhone,version:t}}},{test:[/windows /i],describe:function(e){var t=i.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),n=i.default.getWindowsVersionName(t);return{name:o.OS_MAP.Windows,version:t,versionName:n}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(e){var t={name:o.OS_MAP.iOS},n=i.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return n&&(t.version=n),t}},{test:[/macintosh/i],describe:function(e){var t=i.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),n=i.default.getMacOSVersionName(t),r={name:o.OS_MAP.MacOS,version:t};return n&&(r.versionName=n),r}},{test:[/(ipod|iphone|ipad)/i],describe:function(e){var t=i.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:o.OS_MAP.iOS,version:t}}},{test:function(e){var t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe:function(e){var t=i.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),n=i.default.getAndroidVersionName(t),r={name:o.OS_MAP.Android,version:t};return n&&(r.versionName=n),r}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t=i.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),n={name:o.OS_MAP.WebOS};return t&&t.length&&(n.version=t),n}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t=i.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||i.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||i.default.getFirstMatch(/\bbb(\d+)/i,e);return{name:o.OS_MAP.BlackBerry,version:t}}},{test:[/bada/i],describe:function(e){var t=i.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.Bada,version:t}}},{test:[/tizen/i],describe:function(e){var t=i.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.Tizen,version:t}}},{test:[/linux/i],describe:function(){return{name:o.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:o.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(e){var t=i.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.PlayStation4,version:t}}}];t.default=a,e.exports=t.default},94:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},o=n(18),a=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(e){var t=i.default.getFirstMatch(/(can-l01)/i,e)&&"Nova",n={type:o.PLATFORMS_MAP.mobile,vendor:"Huawei"};return t&&(n.model=t),n}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(e){var t=e.test(/ipod|iphone/i),n=e.test(/like (ipod|iphone)/i);return t&&!n},describe:function(e){var t=i.default.getFirstMatch(/(ipod|iphone)/i,e);return{type:o.PLATFORMS_MAP.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"blackberry"===e.getBrowserName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(e){return"bada"===e.getBrowserName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"windows phone"===e.getBrowserName()},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(e){var t=Number(String(e.getOSVersion()).split(".")[0]);return"android"===e.getOSName(!0)&&t>=3},describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(e){return"android"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"macos"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(e){return"windows"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(e){return"linux"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(e){return"playstation 4"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.tv}}},{test:function(e){return"roku"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.tv}}}];t.default=a,e.exports=t.default},95:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},o=n(18),a=[{test:function(e){return"microsoft edge"===e.getBrowserName(!0)},describe:function(e){if(/\sedg\//i.test(e))return{name:o.ENGINE_MAP.Blink};var t=i.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:o.ENGINE_MAP.EdgeHTML,version:t}}},{test:[/trident/i],describe:function(e){var t={name:o.ENGINE_MAP.Trident},n=i.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){return e.test(/presto/i)},describe:function(e){var t={name:o.ENGINE_MAP.Presto},n=i.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){var t=e.test(/gecko/i),n=e.test(/like gecko/i);return t&&!n},describe:function(e){var t={name:o.ENGINE_MAP.Gecko},n=i.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:o.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(e){var t={name:o.ENGINE_MAP.WebKit},n=i.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}}];t.default=a,e.exports=t.default}})},212:function(e,t,n){"use strict";n.r(t),n.d(t,"ApplicationInsights",(function(){return In})),n.d(t,"Telemetry",(function(){return En})),n.d(t,"ApplicationInsightsContainer",(function(){return Sn})),n.d(t,"AppInsightsCore",(function(){return ye})),n.d(t,"LoggingSeverity",(function(){return R})),n.d(t,"_InternalMessageId",(function(){return N})),n.d(t,"Util",(function(){return Te})),n.d(t,"SeverityLevel",(function(){return Ye})),n.d(t,"Event",(function(){return Ve})),n.d(t,"Exception",(function(){return Be})),n.d(t,"Metric",(function(){return Je})),n.d(t,"PageView",(function(){return $e})),n.d(t,"PageViewPerformance",(function(){return nt})),n.d(t,"RemoteDependencyData",(function(){return et})),n.d(t,"Trace",(function(){return tt})),n.d(t,"DistributedTracingModes",(function(){return le})),n.d(t,"Sender",(function(){return qt})),n.d(t,"ApplicationAnalytics",(function(){return vt})),n.d(t,"PropertiesPlugin",(function(){return Yt})),n.d(t,"DependenciesPlugin",(function(){return Cn}));var r={};n.r(r),n.d(r,"Util",(function(){return Te})),n.d(r,"CorrelationIdHelper",(function(){return _e})),n.d(r,"UrlHelper",(function(){return Se})),n.d(r,"DateTimeUtils",(function(){return xe})),n.d(r,"ConnectionStringParser",(function(){return Me})),n.d(r,"FieldType",(function(){return ue})),n.d(r,"RequestHeaders",(function(){return we})),n.d(r,"DisabledPropertyName",(function(){return Re})),n.d(r,"ProcessLegacy",(function(){return Pe})),n.d(r,"SampleRate",(function(){return ke})),n.d(r,"HttpMethod",(function(){return Oe})),n.d(r,"DEFAULT_BREEZE_ENDPOINT",(function(){return Ne})),n.d(r,"AIData",(function(){return Le})),n.d(r,"AIBase",(function(){return De})),n.d(r,"Envelope",(function(){return Ue})),n.d(r,"Event",(function(){return Ve})),n.d(r,"Exception",(function(){return Be})),n.d(r,"Metric",(function(){return Je})),n.d(r,"PageView",(function(){return $e})),n.d(r,"PageViewData",(function(){return Ze})),n.d(r,"RemoteDependencyData",(function(){return et})),n.d(r,"Trace",(function(){return tt})),n.d(r,"PageViewPerformance",(function(){return nt})),n.d(r,"Data",(function(){return rt})),n.d(r,"SeverityLevel",(function(){return Ye})),n.d(r,"ConfigurationManager",(function(){return it})),n.d(r,"ContextTagKeys",(function(){return ot})),n.d(r,"DataSanitizer",(function(){return be})),n.d(r,"TelemetryItemCreator",(function(){return at})),n.d(r,"CtxTagKeys",(function(){return ct})),n.d(r,"Extensions",(function(){return st})),n.d(r,"DistributedTracingModes",(function(){return le})),n.d(r,"PropertiesPluginIdentifier",(function(){return ut})),n.d(r,"BreezeChannelIdentifier",(function(){return lt})),n.d(r,"AnalyticsPluginIdentifier",(function(){return dt}));var i=n(20),o=i.f,a=i.d,s=i.e,c=i.c,u=i.a;function l(e){var t=u();return t&&t[e]?t[e]:"window"===e&&d()?window:null}function d(){return Boolean(typeof window===a&&window)}function f(){return d()?window:l("window")}function p(){return Boolean(typeof document===a&&document)}function h(){return p()?document:l("document")}function g(){return Boolean(typeof navigator===a&&navigator)?navigator:l("navigator")}function m(){return Boolean(typeof history===a&&history)?history:l("history")}function v(){return typeof location===a&&location?location:l("location")}function y(){return l("performance")}function w(){return Boolean(typeof JSON===a&&JSON||null!==l("JSON"))}function b(){return w()?JSON||l("JSON"):null}i.f;function C(e,t){return typeof e===t}function E(e){return C(e,i.f)||void 0===e}function I(e){return E(e)||null===e}function T(e,t){return e&&Object[i.e].hasOwnProperty.call(e,t)}function S(e){return C(e,i.d)}function _(e){return C(e,i.c)}function A(e,t,n,r){void 0===r&&(r=!1);var i=!1;if(!I(e))try{I(e.addEventListener)?I(e.attachEvent)||(e.attachEvent("on"+t,n),i=!0):(e.addEventListener(t,n,r),i=!0)}catch(e){}return i}function x(e,t,n,r){if(void 0===r&&(r=!1),!I(e))try{I(e.removeEventListener)?I(e.detachEvent)||e.detachEvent("on"+t,n):e.removeEventListener(t,n,r)}catch(e){}}var R,k=function(){function e(){}return e.isDate=function(e){return"[object Date]"===Object[i.e].toString.call(e)},e.isArray=function(e){return"[object Array]"===Object[i.e].toString.call(e)},e.isError=function(e){return"[object Error]"===Object[i.e].toString.call(e)},e.isString=function(e){return C(e,"string")},e.isNumber=function(e){return C(e,"number")},e.isBoolean=function(e){return C(e,"boolean")},e.disableCookies=function(){e._canUseCookies=!1},e.newGuid=function(){function e(){var e=l("crypto");return e?e.getRandomValues(new Uint8Array(1))[0]%16:16*Math.random()}return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(P,(function(t){var n=0|e();return("x"===t?n:3&n|8).toString(16)}))},e.toISOString=function(t){if(e.isDate(t)){var n=function(e){var t=String(e);return 1===t.length&&(t="0"+t),t};return t.getUTCFullYear()+"-"+n(t.getUTCMonth()+1)+"-"+n(t.getUTCDate())+"T"+n(t.getUTCHours())+":"+n(t.getUTCMinutes())+":"+n(t.getUTCSeconds())+"."+String((t.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}},e.arrForEach=function(e,t,n){for(var r=e.length,i=0;i<r;i++)i in e&&t.call(n||e,e[i],i,e)},e.arrIndexOf=function(e,t,n){for(var r=e.length,i=n||0,o=Math.max(i>=0?i:r-Math.abs(i),0);o<r;o++)if(o in e&&e[o]===t)return o;return-1},e.arrMap=function(e,t,n){for(var r=e.length,i=n||e,o=new Array(r),a=0;a<r;a++)a in e&&(o[a]=t.call(i,e[a],e));return o},e.arrReduce=function(e,t,n){var r,i=e.length,o=0;if(arguments.length>=3)r=arguments[2];else{for(;o<i&&!(o in e);)o++;r=e[o++]}for(;o<i;)o in e&&(r=t(r,e[o],o,e)),o++;return r},e.strTrim=function(t){return e.isString(t)?t.replace(/^\s+|\s+$/g,""):t},e.objKeys=function(e){var t=!{toString:null}.propertyIsEnumerable("toString");if(!(_(e)||S(e)&&null!==e))throw new TypeError("objKeys called on non-object");var n=[];for(var r in e)T(e,r)&&n.push(r);if(t)for(var i=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],o=i.length,a=0;a<o;a++)T(e,i[a])&&n.push(i[a]);return n},e.objDefineAccessors=function(e,t,n,r){var i=Object.defineProperty;if(i)try{var o={enumerable:!0,configurable:!0};return n&&(o.get=n),r&&(o.set=r),i(e,t,o),!0}catch(e){}return!1},e.addEventHandler=function(e,t){var n=!1,r=f();r&&(n=A(r,e,t),n=A(r.body,e,t)||n);var i=h();return i&&(n=O.Attach(i,e,t)||n),n},e.dateNow=function(){var e=Date;return e.now?e.now():(new e).getTime()},e.perfNow=function(){var t=y();return t&&t.now?t.now():e.dateNow()},e.isTypeof=C,e.isUndefined=E,e.isNullOrUndefined=I,e.hasOwnProperty=T,e.isFunction=_,e.isObject=S,e.objCreate=i.b,e}(),P=/[xy]/g,O=function(){function e(){}return e.Attach=A,e.AttachEvent=A,e.Detach=x,e.DetachEvent=x,e}();!function(e){e[e.CRITICAL=1]="CRITICAL",e[e.WARNING=2]="WARNING"}(R||(R={}));var N={BrowserDoesNotSupportLocalStorage:0,BrowserCannotReadLocalStorage:1,BrowserCannotReadSessionStorage:2,BrowserCannotWriteLocalStorage:3,BrowserCannotWriteSessionStorage:4,BrowserFailedRemovalFromLocalStorage:5,BrowserFailedRemovalFromSessionStorage:6,CannotSendEmptyTelemetry:7,ClientPerformanceMathError:8,ErrorParsingAISessionCookie:9,ErrorPVCalc:10,ExceptionWhileLoggingError:11,FailedAddingTelemetryToBuffer:12,FailedMonitorAjaxAbort:13,FailedMonitorAjaxDur:14,FailedMonitorAjaxOpen:15,FailedMonitorAjaxRSC:16,FailedMonitorAjaxSend:17,FailedMonitorAjaxGetCorrelationHeader:18,FailedToAddHandlerForOnBeforeUnload:19,FailedToSendQueuedTelemetry:20,FailedToReportDataLoss:21,FlushFailed:22,MessageLimitPerPVExceeded:23,MissingRequiredFieldSpecification:24,NavigationTimingNotSupported:25,OnError:26,SessionRenewalDateIsZero:27,SenderNotInitialized:28,StartTrackEventFailed:29,StopTrackEventFailed:30,StartTrackFailed:31,StopTrackFailed:32,TelemetrySampledAndNotSent:33,TrackEventFailed:34,TrackExceptionFailed:35,TrackMetricFailed:36,TrackPVFailed:37,TrackPVFailedCalc:38,TrackTraceFailed:39,TransmissionFailed:40,FailedToSetStorageBuffer:41,FailedToRestoreStorageBuffer:42,InvalidBackendResponse:43,FailedToFixDepricatedValues:44,InvalidDurationValue:45,TelemetryEnvelopeInvalid:46,CreateEnvelopeError:47,CannotSerializeObject:48,CannotSerializeObjectNonSerializable:49,CircularReferenceDetected:50,ClearAuthContextFailed:51,ExceptionTruncated:52,IllegalCharsInName:53,ItemNotInArray:54,MaxAjaxPerPVExceeded:55,MessageTruncated:56,NameTooLong:57,SampleRateOutOfRange:58,SetAuthContextFailed:59,SetAuthContextFailedAccountName:60,StringValueTooLong:61,StartCalledMoreThanOnce:62,StopCalledWithoutStart:63,TelemetryInitializerFailed:64,TrackArgumentsNotSpecified:65,UrlTooLong:66,SessionStorageBufferFull:67,CannotAccessCookie:68,IdTooLong:69,InvalidEvent:70,FailedMonitorAjaxSetRequestHeader:71,SendBrowserInfoOnUserInit:72,PluginException:73,NotificationException:74,SnippetScriptLoadFailure:99,InvalidInstrumentationKey:100},M=Object.getPrototypeOf,D=0;
/*!
 * Microsoft Dynamic Proto Utility, 1.0.0
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */function L(e,t){return e&&Object.prototype.hasOwnProperty.call(e,t)}function U(e){return"function"==typeof e}function F(e){return e&&(e===Object.prototype||e===Array.prototype)}function q(e){return F(e)||e===Function.prototype}function V(e){if(e){if(M)return M(e);var t=e.__proto__||e.prototype||e.constructor;if(t)return t}return null}function G(e,t,n){return"constructor"!==t&&U(e[t])&&(n||L(e,t))}function H(e){throw new TypeError("DynamicProto: "+e)}function j(e,t){for(var n=e.length-1;n>=0;n--)if(e[n]===t)return!0;return!1}function z(e,t){return L(e,"prototype")?e.name||t||"_unknown_":((e||{}).constructor||{}).name||t||"_unknown_"}var B=function(e,t,n){L(e,"prototype")||H("theClass is an invalid class definition.");var r=e.prototype;(function(e,t){for(var n=V(t);n&&!q(n);){if(n===e)return!0;n=V(n)}return!1})(r,t)||H("["+z(e)+"] is not in class heirarchy of ["+z(t)+"]");var i=null;L(r,"_dynClass")?i=r._dynClass:(i="_dynCls$"+z(e,"_")+"$"+D,D++,r._dynClass=i);var o=function(e){var t={};for(var n in e)!t[n]&&G(e,n,!1)&&(t[n]=e[n]);return t}(t);n(t,function(e,t,n){function r(e,t){return function(){return t.apply(e,arguments)}}var i={};for(var o in n)i[o]=r(t,n[o]);for(var a=V(e),s=[];a&&!q(a)&&!j(s,a);){for(var o in a)!i[o]&&G(a,o,!M)&&(i[o]=r(t,a[o]));s.push(a),a=V(a)}return i}(r,t,o)),function(e,t,n,r){function i(e,t){var n=function(){var r=this;if(r&&L(e,"_dynClass")){var i=((r._dynInstFuncs||{})[e._dynClass]||{})[t];if(i)return i.apply(r,arguments);H("Missing ["+t+"] function")}var o=e[t];return o===n&&(o=V(e)[t]),U(o)||H("["+t+"] is not a function"),o.apply(r,arguments)};return n._isDynProxy=1,n}if(!F(e)){var o=n._dynInstFuncs=n._dynInstFuncs||{},a=o[t]=o[t]||{};for(var s in n)G(n,s,!1)&&n[s]!==r[s]&&(a[s]=n[s],delete n[s],(!L(e,s)||e[s]&&!e[s]._isDynProxy)&&(e[s]=i(e,s)))}}(r,i,t,o)};function K(e){return e?'"'+e.replace(/\"/g,"")+'"':""}var W=function(){function e(e,t,n,r){void 0===n&&(n=!1);this.messageId=e,this.message=(n?"AI: ":"AI (Internal): ")+e;var i="";w()&&(i=b().stringify(r));var o=(t?" message:"+K(t):"")+(r?" props:"+K(i):"");this.message+=o}return e.dataType="MessageData",e}(),X=function(){function e(t){this.identifier="DiagnosticLogger",this.queue=[];var n=0,r={};B(e,this,(function(e){var i=k.isNullOrUndefined,a=k.isUndefined,s=k.isFunction;function c(e,n){var r=t[e];return i(r)?n:r}i(t)&&(t={}),e.consoleLoggingLevel=function(){return c("loggingLevelConsole",0)},e.telemetryLoggingLevel=function(){return c("loggingLevelTelemetry",1)},e.maxInternalMessageLimit=function(){return c("maxMessageLimit",25)},e.enableDebugExceptions=function(){return c("enableDebugExceptions",!1)},e.throwInternal=function(t,n,i,o,s){void 0===s&&(s=!1);var c=new W(n,i,s,o);if(e.enableDebugExceptions())throw c;if(!a(c)&&c&&!a(c.message)){if(s){var u=+c.messageId;!r[u]&&e.consoleLoggingLevel()>=R.WARNING&&(e.warnToConsole(c.message),r[u]=!0)}else e.consoleLoggingLevel()>=R.WARNING&&e.warnToConsole(c.message);e.logInternalMessage(t,c)}},e.warnToConsole=function(e){var t=typeof console!==o?console:l("console");if(t){var n="log";t.warn&&(n="warn"),s(t[n])&&t[n](e)}},e.resetInternalMessageCount=function(){n=0,r={}},e.logInternalMessage=function(t,i){if(!(n>=e.maxInternalMessageLimit())){var o=!0,a="AITR_"+i.messageId;if(r[a]?o=!1:r[a]=!0,o&&(t<=e.telemetryLoggingLevel()&&(e.queue.push(i),n++),n===e.maxInternalMessageLimit())){var s="Internal events throttle limit per PageView reached for this app.",c=new W(N.MessageLimitPerPVExceeded,s,!1);e.queue.push(c),e.warnToConsole(s)}}}}))}return e.prototype.enableDebugExceptions=function(){return!1},e.prototype.consoleLoggingLevel=function(){return 0},e.prototype.telemetryLoggingLevel=function(){return 1},e.prototype.maxInternalMessageLimit=function(){return 25},e.prototype.throwInternal=function(e,t,n,r,i){void 0===i&&(i=!1)},e.prototype.warnToConsole=function(e){},e.prototype.resetInternalMessageCount=function(){},e.prototype.logInternalMessage=function(e,t){},e}(),Y=function(){function e(t,n,r){var i,o=this,a=!1;(o.start=k.dateNow(),o.name=t,o.isAsync=r,o.isChildEvt=function(){return!1},k.isFunction(n))&&(a=k.objDefineAccessors(o,"payload",(function(){return!i&&k.isFunction(n)&&(i=n(),n=null),i})));o.getCtx=function(t){return t?t===e.ParentContextKey||t===e.ChildrenContextKey?o[t]:(o.ctx||{})[t]:null},o.setCtx=function(t,n){if(t)if(t===e.ParentContextKey)o[t]||(o.isChildEvt=function(){return!0}),o[t]=n;else if(t===e.ChildrenContextKey)o[t]=n;else{(o.ctx=o.ctx||{})[t]=n}},o.complete=function(){var t=0,r=o.getCtx(e.ChildrenContextKey);if(k.isArray(r))for(var i=0;i<r.length;i++){var s=r[i];s&&(t+=s.time)}o.time=k.dateNow()-o.start,o.exTime=o.time-t,o.complete=function(){},!a&&k.isFunction(n)&&(o.payload=n())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),Q=function(){function e(t){this.ctx={},B(e,this,(function(e){e.create=function(e,t,n){return new Y(e,t,n)},e.fire=function(e){e&&(e.complete(),t&&t.perfEvent(e))},e.setCtx=function(t,n){t&&((e.ctx=e.ctx||{})[t]=n)},e.getCtx=function(t){return(e.ctx||{})[t]}}))}return e.prototype.create=function(e,t,n){return null},e.prototype.fire=function(e){},e.prototype.setCtx=function(e,t){},e.prototype.getCtx=function(e){},e}();function J(e,t,n,r,i){if(e){var o=e;if(o&&k.isFunction(o.getPerfMgr)&&(o=o.getPerfMgr()),o){var a=void 0,s=o.getCtx("CoreUtils.doPerf");try{if(a=o.create(t(),r,i)){if(s&&a.setCtx&&(a.setCtx(Y.ParentContextKey,s),s.getCtx&&s.setCtx)){var c=s.getCtx(Y.ChildrenContextKey);c||(c=[],s.setCtx(Y.ChildrenContextKey,c)),c.push(a)}return o.setCtx("CoreUtils.doPerf",a),n(a)}}catch(e){a&&a.setCtx&&a.setCtx("exception",e)}finally{a&&o.fire(a),o.setCtx("CoreUtils.doPerf",s)}}}return n()}var Z=k.isFunction,$=function(e,t){var n=this,r=null,i=Z(e.processTelemetry),o=Z(e.setNextPlugin);n._hasRun=!1,n.getPlugin=function(){return e},n.getNext=function(){return r},n.setNext=function(e){r=e},n.processTelemetry=function(a,s){s||(s=t);var c=e?e.identifier:"TelemetryPluginChain";J(s?s.core():null,(function(){return c+":processTelemetry"}),(function(){if(e&&i){n._hasRun=!0;try{s.setNext(r),o&&e.setNextPlugin(r),r&&(r._hasRun=!1),e.processTelemetry(a,s)}catch(n){var t=r&&r._hasRun;r&&t||s.diagLog().throwInternal(R.CRITICAL,N.PluginException,"Plugin ["+e.identifier+"] failed during processTelemetry - "+n),r&&!t&&r.processTelemetry(a,s)}}else r&&(n._hasRun=!0,r.processTelemetry(a,s))}),(function(){return{item:a}}),!a.sync)}},ee=k.isNullOrUndefined;function te(e,t){var n=[];if(e&&e.length>0)for(var r=null,i=0;i<e.length;i++){var o=e[i];if(o&&k.isFunction(o.processTelemetry)){var a=new $(o,t);n.push(a),r&&r.setNext(a),r=a}}return n.length>0?n[0]:null}var ne=function e(t,n,r,i){var o=this,a=null;null!==i&&(t&&k.isFunction(t.getPlugin)?a=function(e,t,n){var r=[],i=!n;if(e)for(;e;){var o=e.getPlugin();(i||o===n)&&(i=!0,r.push(o)),e=e.getNext()}return i||r.push(n),te(r,t)}(t,o,i||t.getPlugin()):i?a=function(e,t,n){var r=e,i=!1;return n&&e&&(r=[],k.arrForEach(e,(function(e){(i||e===n)&&(i=!0,r.push(e))}))),n&&!i&&(r||(r=[]),r.push(n)),te(r,t)}(t,o,i):k.isUndefined(i)&&(a=te(t,o))),o.core=function(){return r},o.diagLog=function(){var e=(r||{}).logger;return e||(e=new X(n||{})),e},o.getCfg=function(){return n},o.getExtCfg=function(e,t){var r;if(void 0===t&&(t={}),n){var i=n.extensionConfig;i&&e&&(r=i[e])}return r||t},o.getConfig=function(e,t,r){var i;void 0===r&&(r=!1);var a=o.getExtCfg(e,null);return a&&!ee(a[t])?i=a[t]:n&&!ee(n[t])&&(i=n[t]),ee(i)?r:i},o.hasNext=function(){return null!=a},o.getNext=function(){return a},o.setNext=function(e){a=e},o.processNext=function(e){var t=a;t&&(a=t.getNext(),t.processTelemetry(e,o))},o.createNew=function(t,i){return void 0===t&&(t=null),new e(t||a,n,r,i)}},re=k.isFunction,ie=function(){function e(){var e=this,t=!1,n=null,r=null;e.core=null,e.diagLog=function(t){return e._getTelCtx(t).diagLog()},e.isInitialized=function(){return t},e.setInitialized=function(e){t=e},e.setNextPlugin=function(e){r=e},e.processNext=function(e,t){t?t.processNext(e):r&&re(r.processTelemetry)&&r.processTelemetry(e,null)},e._getTelCtx=function(t){void 0===t&&(t=null);var i=t;if(!i){var o=n||new ne(null,{},e.core);i=r&&r.getPlugin?o.createNew(null,r.getPlugin):o.createNew(null,r)}return i},e._baseTelInit=function(i,o,a,s){i&&(i.extensionConfig=i.extensionConfig||[]),!s&&o&&(s=o.getProcessTelContext().getNext());var c=r;r&&r.getPlugin&&(c=r.getPlugin()),e.core=o,n=new ne(s,i,o,c),t=!0}}return e.prototype.initialize=function(e,t,n,r){this._baseTelInit(e,t,n,r)},e}(),oe=k.isFunction;function ae(e,t){for(var n=[],r=null,i=e.getNext();i;){var o=i.getPlugin();o&&(r&&oe(r.setNextPlugin)&&oe(o.processTelemetry)&&r.setNextPlugin(o),oe(o.isInitialized)&&o.isInitialized()||n.push(o),r=o,i=i.getNext())}k.arrForEach(n,(function(n){n.initialize(e.getCfg(),e.core(),t,e.getNext())}))}function se(e){return e.sort((function(e,t){var n=0,r=oe(t.processTelemetry);return oe(e.processTelemetry)?n=r?e.priority-t.priority:1:r&&(n=-1),n}))}var ce,ue,le,de=k.objDefineAccessors,fe=function(e){function t(){var n=e.call(this)||this;n.identifier="ChannelControllerPlugin",n.priority=500;var r,i=k.arrForEach;function o(e){e&&e.length>0&&(function(e){i(e,(function(e){if(e.priority<500)throw Error("Channel has invalid priority"+e.identifier)}))}(e=e.sort((function(e,t){return e.priority-t.priority}))),r.push(e))}return B(t,n,(function(e,t){e.setNextPlugin=function(e){},e.processTelemetry=function(e,t){r&&i(r,(function(r){r.length>0&&n._getTelCtx(t).createNew(r).processNext(e)}))},e.getChannelControls=function(){return r},e.initialize=function(n,a,s){e.isInitialized()||(t.initialize(n,a,s),n.isCookieUseDisabled&&k.disableCookies(),function(e,t){r=[],e&&i(e,(function(e){return o(e)}));if(t){var n=[];i(t,(function(e){e.priority>500&&n.push(e)})),o(n)}}((n||{}).channels,s),i(r,(function(e){return ae(new ne(e,n,a),s)})))}})),n}return __extends(t,e),t.prototype.processTelemetry=function(e,t){},t.prototype.getChannelControls=function(){return null},t.prototype.initialize=function(e,t,n){},t._staticInit=(de(t.prototype,"ChannelControls",t.prototype.getChannelControls),void de(t.prototype,"channelQueue",t.prototype.getChannelControls)),t}(ie),pe=k.arrForEach,he=k.isNullOrUndefined,ge=function(){function e(){var t,n,r,i,o=!1;B(e,this,(function(e){e._extensions=new Array,n=new fe,t=[],e.isInitialized=function(){return o},e.initialize=function(t,i,a,s){if(e.isInitialized())throw Error("Core should not be initialized more than once");if(!t||he(t.instrumentationKey))throw Error("Please provide instrumentation key");r=s,e._notificationManager=s,e.config=t||{},t.extensions=he(t.extensions)?[]:t.extensions,(t.extensionConfig=he(t.extensionConfig)?{}:t.extensionConfig).NotificationManager=s,a||(a=k.objCreate({throwInternal:function(e,t,n,r,i){void 0===i&&(i=!1)},warnToConsole:function(e){},resetInternalMessageCount:function(){}})),e.logger=a;var c=[];c.push.apply(c,i.concat(t.extensions)),c=se(c);var u=[],l=[],d={};if(pe(c,(function(e){if(he(e)||he(e.initialize))throw Error("Extensions must provide callback to initialize");var t=e.priority,r=e.identifier;e&&t&&(he(d[t])?d[t]=r:a.warnToConsole("Two extensions have same priority #"+t+" - "+d[t]+", "+r)),!t||t<n.priority?u.push(e):l.push(e)})),c.push(n),u.push(n),c=se(c),e._extensions=c,ae(new ne([n],t,e),c),ae(new ne(u,t,e),c),e._extensions=u,0===e.getTransmissionControls().length)throw new Error("No channels available");o=!0,e.releaseQueue()},e.getTransmissionControls=function(){return n.getChannelControls()},e.track=function(n){n.iKey||(n.iKey=e.config.instrumentationKey),n.time||(n.time=k.toISOString(new Date)),he(n.ver)&&(n.ver="4.0"),e.isInitialized()?e.getProcessTelContext().processNext(n):t.push(n)},e.getProcessTelContext=function(){var t=e._extensions,r=t;return t&&0!==t.length||(r=[n]),new ne(r,e.config,e)},e.getNotifyMgr=function(){return r||(r=k.objCreate({addNotificationListener:function(e){},removeNotificationListener:function(e){},eventsSent:function(e){},eventsDiscarded:function(e,t){},eventsSendRequest:function(e,t){}}),e._notificationManager=r),r},e.getPerfMgr=function(){return i||e.config&&e.config.enablePerfMgr&&(i=new Q(e.getNotifyMgr())),i},e.setPerfMgr=function(e){i=e},e.eventCnt=function(){return t.length},e.releaseQueue=function(){t.length>0&&(pe(t,(function(t){e.getProcessTelContext().processNext(t)})),t=[])}}))}return e.prototype.initialize=function(e,t,n,r){},e.prototype.getTransmissionControls=function(){return null},e.prototype.track=function(e){},e.prototype.getProcessTelContext=function(){return null},e.prototype.getNotifyMgr=function(){return null},e.prototype.getPerfMgr=function(){return null},e.prototype.setPerfMgr=function(e){},e.prototype.eventCnt=function(){return 0},e.prototype.releaseQueue=function(){},e}(),me=2,ve=function(){function e(t){this.listeners=[];var n=k.arrForEach,r=!!(t||{}).perfEvtsSendAll;B(e,this,(function(e){e.addNotificationListener=function(t){e.listeners.push(t)},e.removeNotificationListener=function(t){for(var n=k.arrIndexOf(e.listeners,t);n>-1;)e.listeners.splice(n,1),n=k.arrIndexOf(e.listeners,t)},e.eventsSent=function(t){n(e.listeners,(function(e){e&&e.eventsSent&&setTimeout((function(){return e.eventsSent(t)}),0)}))},e.eventsDiscarded=function(t,r){n(e.listeners,(function(e){e&&e.eventsDiscarded&&setTimeout((function(){return e.eventsDiscarded(t,r)}),0)}))},e.eventsSendRequest=function(t,r){n(e.listeners,(function(e){if(e&&e.eventsSendRequest)if(r)setTimeout((function(){return e.eventsSendRequest(t,r)}),0);else try{e.eventsSendRequest(t,r)}catch(e){}}))},e.perfEvent=function(t){t&&(!r&&t.isChildEvt()||n(e.listeners,(function(e){if(e&&e.perfEvent)if(t.isAsync)setTimeout((function(){return e.perfEvent(t)}),0);else try{e.perfEvent(t)}catch(e){}})))}}))}return e.prototype.addNotificationListener=function(e){},e.prototype.removeNotificationListener=function(e){},e.prototype.eventsSent=function(e){},e.prototype.eventsDiscarded=function(e,t){},e.prototype.eventsSendRequest=function(e,t){},e}(),ye=function(e){function t(){var n=e.call(this)||this;return B(t,n,(function(e,t){function n(t){var n=e.getNotifyMgr();n&&n.eventsDiscarded([t],me)}e.initialize=function(e,n,r,i){t.initialize(e,n,r||new X(e),i||new ve(e))},e.track=function(r){J(e.getPerfMgr(),(function(){return"AppInsightsCore:track"}),(function(){if(null===r)throw n(r),Error("Invalid telemetry item");!function(e){if(k.isNullOrUndefined(e.name))throw n(e),Error("telemetry name required")}(r),t.track(r)}),(function(){return{item:r}}),!r.sync)},e.addNotificationListener=function(t){var n=e.getNotifyMgr();n&&n.addNotificationListener(t)},e.removeNotificationListener=function(t){var n=e.getNotifyMgr();n&&n.removeNotificationListener(t)},e.pollInternalLogs=function(t){var n=e.config.diagnosticLogInterval;return n&&n>0||(n=1e4),setInterval((function(){var n=e.logger?e.logger.queue:[];k.arrForEach(n,(function(n){var r={name:t||"InternalMessageId: "+n.messageId,iKey:e.config.instrumentationKey,time:k.toISOString(new Date),baseType:W.dataType,baseData:{message:n.message}};e.track(r)})),n.length=0}),n)}})),n}return __extends(t,e),t.prototype.initialize=function(e,t,n,r){},t.prototype.track=function(e){},t.prototype.addNotificationListener=function(e){},t.prototype.removeNotificationListener=function(e){},t.prototype.pollInternalLogs=function(e){return 0},t}(ge);!function(e){e[e.LocalStorage=0]="LocalStorage",e[e.SessionStorage=1]="SessionStorage"}(ce||(ce={})),function(e){e[e.Default=0]="Default",e[e.Required=1]="Required",e[e.Array=2]="Array",e[e.Hidden=4]="Hidden"}(ue||(ue={})),function(e){e[e.AI=0]="AI",e[e.AI_AND_W3C=1]="AI_AND_W3C",e[e.W3C=2]="W3C"}(le||(le={}));var we=function(){function e(){}return e.requestContextHeader="Request-Context",e.requestContextTargetKey="appId",e.requestContextAppIdFormat="appId=cid-v1:",e.requestIdHeader="Request-Id",e.traceParentHeader="traceparent",e.sdkContextHeader="Sdk-Context",e.sdkContextHeaderAppIdRequest="appId",e.requestContextHeaderLowerCase="request-context",e}(),be=function(){function e(){}return e.sanitizeKeyAndAddUniqueness=function(t,n,r){var i=n.length,o=e.sanitizeKey(t,n);if(o.length!==i){for(var a=0,s=o;void 0!==r[s];)a++,s=o.substring(0,e.MAX_NAME_LENGTH-3)+e.padNumber(a);o=s}return o},e.sanitizeKey=function(t,n){var r;return n&&(n=e.trim(n.toString())).length>e.MAX_NAME_LENGTH&&(r=n.substring(0,e.MAX_NAME_LENGTH),t.throwInternal(R.WARNING,N.NameTooLong,"name is too long.  It has been truncated to "+e.MAX_NAME_LENGTH+" characters.",{name:n},!0)),r||n},e.sanitizeString=function(t,n,r){var i;return void 0===r&&(r=e.MAX_STRING_LENGTH),n&&(r=r||e.MAX_STRING_LENGTH,(n=e.trim(n)).toString().length>r&&(i=n.toString().substring(0,r),t.throwInternal(R.WARNING,N.StringValueTooLong,"string value is too long. It has been truncated to "+r+" characters.",{value:n},!0))),i||n},e.sanitizeUrl=function(t,n){return e.sanitizeInput(t,n,e.MAX_URL_LENGTH,N.UrlTooLong)},e.sanitizeMessage=function(t,n){var r;return n&&n.length>e.MAX_MESSAGE_LENGTH&&(r=n.substring(0,e.MAX_MESSAGE_LENGTH),t.throwInternal(R.WARNING,N.MessageTruncated,"message is too long, it has been truncated to "+e.MAX_MESSAGE_LENGTH+" characters.",{message:n},!0)),r||n},e.sanitizeException=function(t,n){var r;return n&&n.length>e.MAX_EXCEPTION_LENGTH&&(r=n.substring(0,e.MAX_EXCEPTION_LENGTH),t.throwInternal(R.WARNING,N.ExceptionTruncated,"exception is too long, it has been truncated to "+e.MAX_EXCEPTION_LENGTH+" characters.",{exception:n},!0)),r||n},e.sanitizeProperties=function(t,n){if(n){var r={};for(var i in n){var o=n[i];if(k.isObject(o)&&w())try{o=b().stringify(o)}catch(e){t.throwInternal(R.WARNING,N.CannotSerializeObjectNonSerializable,"custom property is not valid",{exception:e},!0)}o=e.sanitizeString(t,o,e.MAX_PROPERTY_LENGTH),r[i=e.sanitizeKeyAndAddUniqueness(t,i,r)]=o}n=r}return n},e.sanitizeMeasurements=function(t,n){if(n){var r={};for(var i in n){var o=n[i];r[i=e.sanitizeKeyAndAddUniqueness(t,i,r)]=o}n=r}return n},e.sanitizeId=function(t,n){return n?e.sanitizeInput(t,n,e.MAX_ID_LENGTH,N.IdTooLong).toString():n},e.sanitizeInput=function(t,n,r,i){var o;return n&&(n=e.trim(n)).length>r&&(o=n.substring(0,r),t.throwInternal(R.WARNING,i,"input is too long, it has been truncated to "+r+" characters.",{data:n},!0)),o||n},e.padNumber=function(e){var t="00"+e;return t.substr(t.length-3)},e.trim=function(e){return k.isString(e)?e.replace(/^\s+|\s+$/g,""):e},e.MAX_NAME_LENGTH=150,e.MAX_ID_LENGTH=128,e.MAX_PROPERTY_LENGTH=8192,e.MAX_STRING_LENGTH=1024,e.MAX_URL_LENGTH=2048,e.MAX_MESSAGE_LENGTH=32768,e.MAX_EXCEPTION_LENGTH=32768,e}(),Ce=g(),Ee=k.isString,Ie=null;var Te=function(){function e(){}return e.createDomEvent=function(e){var t=null;if(k.isFunction(Event))t=new Event(e);else{var n=h();n&&n.createEvent&&(t=n.createEvent("Event")).initEvent(e,!0,!0)}return t},e.disableStorage=function(){e._canUseLocalStorage=!1,e._canUseSessionStorage=!1},e._getLocalStorageObject=function(){return e.canUseLocalStorage()?e._getVerifiedStorageObject(ce.LocalStorage):null},e._getVerifiedStorageObject=function(e){var t,n,r=null;try{if(k.isNullOrUndefined(u()))return null;n=new Date,(r=e===ce.LocalStorage?l("localStorage"):l("sessionStorage")).setItem(n.toString(),n.toString()),t=r.getItem(n.toString())!==n.toString(),r.removeItem(n.toString()),t&&(r=null)}catch(e){r=null}return r},e.isInternalApplicationInsightsEndpoint=function(t){return-1!==e._internalEndpoints.indexOf(t.toLowerCase())},e.canUseLocalStorage=function(){return void 0===e._canUseLocalStorage&&(e._canUseLocalStorage=!!e._getVerifiedStorageObject(ce.LocalStorage)),e._canUseLocalStorage},e.getStorage=function(t,n){var r=e._getLocalStorageObject();if(null!==r)try{return r.getItem(n)}catch(n){e._canUseLocalStorage=!1,t.throwInternal(R.WARNING,N.BrowserCannotReadLocalStorage,"Browser failed read of local storage. "+e.getExceptionName(n),{exception:e.dump(n)})}return null},e.setStorage=function(t,n,r){var i=e._getLocalStorageObject();if(null!==i)try{return i.setItem(n,r),!0}catch(n){e._canUseLocalStorage=!1,t.throwInternal(R.WARNING,N.BrowserCannotWriteLocalStorage,"Browser failed write to local storage. "+e.getExceptionName(n),{exception:e.dump(n)})}return!1},e.removeStorage=function(t,n){var r=e._getLocalStorageObject();if(null!==r)try{return r.removeItem(n),!0}catch(n){e._canUseLocalStorage=!1,t.throwInternal(R.WARNING,N.BrowserFailedRemovalFromLocalStorage,"Browser failed removal of local storage item. "+e.getExceptionName(n),{exception:e.dump(n)})}return!1},e._getSessionStorageObject=function(){return e.canUseSessionStorage()?e._getVerifiedStorageObject(ce.SessionStorage):null},e.canUseSessionStorage=function(){return void 0===e._canUseSessionStorage&&(e._canUseSessionStorage=!!e._getVerifiedStorageObject(ce.SessionStorage)),e._canUseSessionStorage},e.getSessionStorageKeys=function(){var t=[];if(e.canUseSessionStorage())for(var n in l("sessionStorage"))t.push(n);return t},e.getSessionStorage=function(t,n){var r=e._getSessionStorageObject();if(null!==r)try{return r.getItem(n)}catch(n){e._canUseSessionStorage=!1,t.throwInternal(R.WARNING,N.BrowserCannotReadSessionStorage,"Browser failed read of session storage. "+e.getExceptionName(n),{exception:e.dump(n)})}return null},e.setSessionStorage=function(t,n,r){var i=e._getSessionStorageObject();if(null!==i)try{return i.setItem(n,r),!0}catch(n){e._canUseSessionStorage=!1,t.throwInternal(R.WARNING,N.BrowserCannotWriteSessionStorage,"Browser failed write to session storage. "+e.getExceptionName(n),{exception:e.dump(n)})}return!1},e.removeSessionStorage=function(t,n){var r=e._getSessionStorageObject();if(null!==r)try{return r.removeItem(n),!0}catch(n){e._canUseSessionStorage=!1,t.throwInternal(R.WARNING,N.BrowserFailedRemovalFromSessionStorage,"Browser failed removal of session storage item. "+e.getExceptionName(n),{exception:e.dump(n)})}return!1},e.disableCookies=function(){k.disableCookies()},e.canUseCookies=function(t){if(void 0===k._canUseCookies){k._canUseCookies=!1;try{k._canUseCookies=void 0!==e.document.cookie}catch(n){t.throwInternal(R.WARNING,N.CannotAccessCookie,"Cannot access document.cookie - "+e.getExceptionName(n),{exception:e.dump(n)})}}return k._canUseCookies},e.disallowsSameSiteNone=function(e){return!!Ee(e)&&(-1!==e.indexOf("CPU iPhone OS 12")||-1!==e.indexOf("iPad; CPU OS 12")||(-1!==e.indexOf("Macintosh; Intel Mac OS X 10_14")&&-1!==e.indexOf("Version/")&&-1!==e.indexOf("Safari")||(-1!==e.indexOf("Macintosh; Intel Mac OS X 10_14")&&(n="AppleWebKit/605.1.15 (KHTML, like Gecko)",r=(t=e).length,i=r-n.length,t.substring(i>=0?i:0,r)===n)||(-1!==e.indexOf("Chrome/5")||-1!==e.indexOf("Chrome/6")||(-1!==e.indexOf("UnrealEngine")&&-1===e.indexOf("Chrome")||(-1!==e.indexOf("UCBrowser/12")||-1!==e.indexOf("UCBrowser/11")))))));var t,n,r,i},e.setCookie=function(t,n,r,i){if(e.canUseCookies(t)){var o="",a="";i&&(o=";domain="+i);var s=v();s&&"https:"===s.protocol&&(a=";secure",null===Ie&&(Ie=e.disallowsSameSiteNone((g()||{}).userAgent)),Ie||(r+=";SameSite=None")),e.document.cookie=n+"="+r+o+";path=/"+a}},e.stringToBoolOrDefault=function(e,t){return void 0===t&&(t=!1),null==e?t:"true"===e.toString().toLowerCase()},e.getCookie=function(t,n){if(e.canUseCookies(t)){var r="";if(n&&n.length)for(var i=n+"=",o=e.document.cookie.split(";"),a=0;a<o.length;a++){var s=o[a];if((s=e.trim(s))&&0===s.indexOf(i)){r=s.substring(i.length,o[a].length);break}}return r}},e.deleteCookie=function(t,n){e.canUseCookies(t)&&(e.document.cookie=n+"=;path=/;expires=Thu, 01 Jan 1970 00:00:01 GMT;")},e.newId=function(){for(var e="",t=1073741824*Math.random();t>0;){e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(t%64),t=Math.floor(t/64)}return e},e.random32=function(){return 4294967296*Math.random()|0},e.generateW3CId=function(){for(var t,n=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],r="",i=0;i<4;i++)r+=n[15&(t=e.random32())]+n[t>>4&15]+n[t>>8&15]+n[t>>12&15]+n[t>>16&15]+n[t>>20&15]+n[t>>24&15]+n[t>>28&15];var o=n[8+4*Math.random()|0];return r.substr(0,8)+r.substr(9,4)+"4"+r.substr(13,3)+o+r.substr(16,3)+r.substr(19,12)},e.getIEVersion=function(e){void 0===e&&(e=null);var t=e?e.toLowerCase():Ce?(Ce.userAgent||"").toLowerCase():"";if(-1!==t.indexOf("msie"))return parseInt(t.split("msie")[1]);if(t.indexOf("trident/")){var n=parseInt(t.split("trident/")[1]);if(n)return n+4}return null},e.msToTimeSpan=function(e){(isNaN(e)||e<0)&&(e=0);var t=""+(e=Math.round(e))%1e3,n=""+Math.floor(e/1e3)%60,r=""+Math.floor(e/6e4)%60,i=""+Math.floor(e/36e5)%24,o=Math.floor(e/864e5);return t=1===t.length?"00"+t:2===t.length?"0"+t:t,n=n.length<2?"0"+n:n,r=r.length<2?"0"+r:r,(o>0?o+".":"")+(i=i.length<2?"0"+i:i)+":"+r+":"+n+"."+t},e.isCrossOriginError=function(e,t,n,r,i){return("Script error."===e||"Script error"===e)&&!i},e.dump=function(e){var t=Object[s].toString.call(e),n="";return"[object Error]"===t?n="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e.name+"'":w()&&(n=b().stringify(e)),t+n},e.getExceptionName=function(e){return"[object Error]"===Object[s].toString.call(e)?e.name:""},e.addEventHandler=function(e,t){return O.Attach(f(),e,t)},e.IsBeaconApiSupported=function(){return"sendBeacon"in Ce&&Ce.sendBeacon},e.getExtension=function(e,t){for(var n=null,r=0;!n&&r<e.length;)e[r]&&e[r].identifier===t&&(n=e[r]),r++;return n},e.document=h()||{},e._canUseLocalStorage=void 0,e._canUseSessionStorage=void 0,e._internalEndpoints=["https://dc.services.visualstudio.com/v2/track","https://breeze.aimon.applicationinsights.io/v2/track","https://dc-int.services.visualstudio.com/v2/track"],e.NotSpecified="not_specified",e.trim=k.strTrim,e.isArray=k.isArray,e.isError=k.isError,e.isDate=k.isDate,e.toISOStringForIE8=k.toISOString,e}(),Se=function(){function e(){}return e.parseUrl=function(t){var n=e._htmlAnchorIdx,r=e._htmlAnchorElement,i=r[n];return e.document.createElement?r[n]||(i=r[n]=e.document.createElement("a")):i={host:e.parseHost(t,!0)},i.href=t,++n>=r.length&&(n=0),e._htmlAnchorIdx=n,i},e.getAbsoluteUrl=function(t){var n,r=e.parseUrl(t);return r&&(n=r.href),n},e.getPathName=function(t){var n,r=e.parseUrl(t);return r&&(n=r.pathname),n},e.getCompleteUrl=function(e,t){return e?e.toUpperCase()+" "+t:t},e.parseHost=function(t,n){var r=e.parseFullHost(t,n);if(r){var i=r.match(/(www[0-9]?\.)?(.[^/:]+)(\:[\d]+)?/i);if(null!=i&&i.length>3&&Ee(i[2])&&i[2].length>0)return i[2]+(i[3]||"")}return r},e.parseFullHost=function(e,t){var n=null;if(e){var r=e.match(/(\w*):\/\/(.[^/:]+)(\:[\d]+)?/i);if(null!=r&&r.length>2&&Ee(r[2])&&r[2].length>0&&(n=r[2]||"",t&&r.length>2)){var i=(r[1]||"").toLowerCase(),o=r[3]||"";("http"===i&&":80"===o||"https"===i&&":443"===o)&&(o=""),n+=o}}return n},e.document=h()||{},e._htmlAnchorIdx=0,e._htmlAnchorElement=[null,null,null,null,null],e}(),_e=function(){function e(){}return e.canIncludeCorrelationHeader=function(e,t,n){if(!t||e&&e.disableCorrelationHeaders)return!1;if(e&&e.correlationHeaderExcludePatterns)for(var r=0;r<e.correlationHeaderExcludePatterns.length;r++)if(e.correlationHeaderExcludePatterns[r].test(t))return!1;var i=Se.parseUrl(t).host.toLowerCase();if(!i||-1===i.indexOf(":443")&&-1===i.indexOf(":80")||(i=(Se.parseFullHost(t,!0)||"").toLowerCase()),!(e&&e.enableCorsCorrelation||i===n))return!1;var o,a=e&&e.correlationHeaderDomains;if(a&&(k.arrForEach(a,(function(e){var t=new RegExp(e.toLowerCase().replace(/\./g,".").replace(/\*/g,".*"));o=o||t.test(i)})),!o))return!1;var s=e&&e.correlationHeaderExcludedDomains;if(!s||0===s.length)return!0;for(r=0;r<s.length;r++){if(new RegExp(s[r].toLowerCase().replace(/\./g,".").replace(/\*/g,".*")).test(i))return!1}return i&&i.length>0},e.getCorrelationContext=function(t){if(t){var n=e.getCorrelationContextValue(t,we.requestContextTargetKey);if(n&&n!==e.correlationIdPrefix)return n}},e.getCorrelationContextValue=function(e,t){if(e)for(var n=e.split(","),r=0;r<n.length;++r){var i=n[r].split("=");if(2===i.length&&i[0]===t)return i[1]}},e.correlationIdPrefix="cid-v1:",e}(),Ae=function(){function e(){}return e.ParseDependencyPath=function(e,t,n,r){var i,o=r,a=r;if(t&&t.length>0){var s=Se.parseUrl(t);if(i=s.host,!o)if(null!=s.pathname){var c=0===s.pathname.length?"/":s.pathname;"/"!==c.charAt(0)&&(c="/"+c),a=s.pathname,o=be.sanitizeString(e,n?n+" "+c:c)}else o=be.sanitizeString(e,t)}else i=r,o=r;return{target:i,name:o,data:a}},e}(),xe=function(){function e(){}return e.Now=function(){var e=y();return e&&e.now&&e.timing?e.now()+e.timing.navigationStart:(new Date).getTime()},e.GetDuration=function(e,t){var n=null;return 0===e||0===t||k.isNullOrUndefined(e)||k.isNullOrUndefined(t)||(n=t-e),n},e}(),Re="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",ke="sampleRate",Pe="ProcessLegacy",Oe="http.method",Ne="https://dc.services.visualstudio.com",Me=function(){function e(){}return e.parse=function(t){if(!t)return{};var n=t.split(e._FIELDS_SEPARATOR),r=k.arrReduce(n,(function(t,n){var r=n.split(e._FIELD_KEY_VALUE_SEPARATOR);if(2===r.length){var i=r[0].toLowerCase(),o=r[1];t[i]=o}return t}),{});if(k.objKeys(r).length>0){if(r.endpointsuffix){var i=r.location?r.location+".":"";r.ingestionendpoint=r.ingestionendpoint||"https://"+i+"dc."+r.endpointsuffix}r.ingestionendpoint=r.ingestionendpoint||Ne}return r},e._FIELDS_SEPARATOR=";",e._FIELD_KEY_VALUE_SEPARATOR="=",e}(),De=function(){},Le=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(De),Ue=function(e){function t(t,n,r){var i=e.call(this)||this;return i.name=be.sanitizeString(t,r)||Te.NotSpecified,i.data=n,i.time=k.toISOString(new Date),i.aiDataContract={time:ue.Required,iKey:ue.Required,name:ue.Required,sampleRate:function(){return 100===i.sampleRate?ue.Hidden:ue.Required},tags:ue.Required,data:ue.Required},i}return __extends(t,e),t}((function(){this.ver=1,this.sampleRate=100,this.tags={}})),Fe=function(){},qe=function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}return __extends(t,e),t}(Fe),Ve=function(e){function t(t,n,r,i){var o=e.call(this)||this;return o.aiDataContract={ver:ue.Required,name:ue.Required,properties:ue.Default,measurements:ue.Default},o.name=be.sanitizeString(t,n)||Te.NotSpecified,o.properties=be.sanitizeProperties(t,r),o.measurements=be.sanitizeMeasurements(t,i),o}return __extends(t,e),t.envelopeType="Microsoft.ApplicationInsights.{0}.Event",t.dataType="EventData",t}(qe),Ge=function(){},He=function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.exceptions=[],t.properties={},t.measurements={},t}return __extends(t,e),t}(Fe),je=function(){this.hasFullStack=!0,this.parsedStack=[]};var ze,Be=function(e){function t(t,n,r,i,o,a){var s,c=e.call(this)||this;return c.aiDataContract={ver:ue.Required,exceptions:ue.Required,severityLevel:ue.Default,properties:ue.Default,measurements:ue.Default},"ver"in(s=n)&&"exceptions"in s&&"properties"in s?(c.exceptions=n.exceptions,c.properties=n.properties,c.measurements=n.measurements,n.severityLevel&&(c.severityLevel=n.severityLevel),n.id&&(c.id=n.id),n.problemGroup&&(c.problemGroup=n.problemGroup),c.ver=2,k.isNullOrUndefined(n.isManual)||(c.isManual=n.isManual)):(c.exceptions=[new Ke(t,n)],c.properties=be.sanitizeProperties(t,r)||{},c.measurements=be.sanitizeMeasurements(t,i),o&&(c.severityLevel=o),a&&(c.id=a)),c}return __extends(t,e),t.CreateFromInterface=function(e,n,r,i){var o=n.exceptions&&k.arrMap(n.exceptions,(function(t){return Ke.CreateFromInterface(e,t)}));return new t(e,__assign({},n,{exceptions:o}),r,i)},t.prototype.toInterface=function(){var e=this,t=e.exceptions,n=e.properties,r=e.measurements,i=e.severityLevel,o=(e.ver,e.problemGroup),a=e.id,s=e.isManual;return{ver:"4.0",exceptions:t instanceof Array&&k.arrMap(t,(function(e){return e.toInterface()}))||void 0,severityLevel:i,properties:n,measurements:r,problemGroup:o,id:a,isManual:s}},t.CreateSimpleException=function(e,t,n,r,i,o){return{exceptions:[{hasFullStack:!0,message:e,stack:i,typeName:t}]}},t.envelopeType="Microsoft.ApplicationInsights.{0}.Exception",t.dataType="ExceptionData",t}(He),Ke=function(e){function t(n,r){var i,o=e.call(this)||this;if(o.aiDataContract={id:ue.Default,outerId:ue.Default,typeName:ue.Required,message:ue.Required,hasFullStack:ue.Default,stack:ue.Default,parsedStack:ue.Array},"hasFullStack"in(i=r)&&"typeName"in i)o.typeName=r.typeName,o.message=r.message,o.stack=r.stack,o.parsedStack=r.parsedStack,o.hasFullStack=r.hasFullStack;else{var a=r;Te.isError(a)||(a=a.error||a.evt||a),o.typeName=be.sanitizeString(n,function(e){var t="";if(e&&!(t=e.typeName||e.name||""))try{var n=/function (.{1,})\(/.exec(e.constructor.toString());t=n&&n.length>1?n[1]:""}catch(e){}return t}(a))||Te.NotSpecified,o.message=be.sanitizeMessage(n,r.message)||Te.NotSpecified;var s=r.stack;o.parsedStack=t.parseStack(s),o.stack=be.sanitizeException(n,s),o.hasFullStack=Te.isArray(o.parsedStack)&&o.parsedStack.length>0}return o}return __extends(t,e),t.prototype.toInterface=function(){var e=this.parsedStack instanceof Array&&k.arrMap(this.parsedStack,(function(e){return e.toInterface()}));return{id:this.id,outerId:this.outerId,typeName:this.typeName,message:this.message,hasFullStack:this.hasFullStack,stack:this.stack,parsedStack:e||void 0}},t.CreateFromInterface=function(e,n){var r=n.parsedStack instanceof Array&&k.arrMap(n.parsedStack,(function(e){return We.CreateFromInterface(e)}))||n.parsedStack;return new t(e,__assign({},n,{parsedStack:r}))},t.parseStack=function(e){var t;if(k.isString(e)){var n=e.split("\n");t=[];for(var r=0,i=0,o=0;o<=n.length;o++){var a=n[o];if(We.regex.test(a)){var s=new We(n[o],r++);i+=s.sizeInBytes,t.push(s)}}if(i>32768)for(var c=0,u=t.length-1,l=0,d=c,f=u;c<u;){if((l+=t[c].sizeInBytes+t[u].sizeInBytes)>32768){var p=f-d+1;t.splice(d,p);break}d=c,f=u,c++,u--}}return t},t}(je),We=function(e){function t(n,r){var i=e.call(this)||this;if(i.sizeInBytes=0,i.aiDataContract={level:ue.Required,method:ue.Required,assembly:ue.Default,fileName:ue.Default,line:ue.Default},"string"==typeof n){var o=n;i.level=r,i.method="<no_method>",i.assembly=Te.trim(o),i.fileName="",i.line=0;var a=o.match(t.regex);a&&a.length>=5&&(i.method=Te.trim(a[2])||i.method,i.fileName=Te.trim(a[4]),i.line=parseInt(a[5])||0)}else i.level=n.level,i.method=n.method,i.assembly=n.assembly,i.fileName=n.fileName,i.line=n.line,i.sizeInBytes=0;return i.sizeInBytes+=i.method.length,i.sizeInBytes+=i.fileName.length,i.sizeInBytes+=i.assembly.length,i.sizeInBytes+=t.baseSize,i.sizeInBytes+=i.level.toString().length,i.sizeInBytes+=i.line.toString().length,i}return __extends(t,e),t.CreateFromInterface=function(e){return new t(e,null)},t.prototype.toInterface=function(){return{level:this.level,method:this.method,assembly:this.assembly,fileName:this.fileName,line:this.line}},t.regex=/^([\s]+at)?(.*?)(\@|\s\(|\s)([^\(\@\n]+):([0-9]+):([0-9]+)(\)?)$/,t.baseSize=58,t}(Ge),Xe=function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.metrics=[],t.properties={},t.measurements={},t}return __extends(t,e),t}(Fe);!function(e){e[e.Measurement=0]="Measurement",e[e.Aggregation=1]="Aggregation"}(ze||(ze={}));var Ye,Qe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.aiDataContract={name:ue.Required,kind:ue.Default,value:ue.Required,count:ue.Default,min:ue.Default,max:ue.Default,stdDev:ue.Default},t}return __extends(t,e),t}((function(){this.kind=ze.Measurement})),Je=function(e){function t(t,n,r,i,o,a,s,c){var u=e.call(this)||this;u.aiDataContract={ver:ue.Required,metrics:ue.Required,properties:ue.Default};var l=new Qe;return l.count=i>0?i:void 0,l.max=isNaN(a)||null===a?void 0:a,l.min=isNaN(o)||null===o?void 0:o,l.name=be.sanitizeString(t,n)||Te.NotSpecified,l.value=r,u.metrics=[l],u.properties=be.sanitizeProperties(t,s),u.measurements=be.sanitizeMeasurements(t,c),u}return __extends(t,e),t.envelopeType="Microsoft.ApplicationInsights.{0}.Metric",t.dataType="MetricData",t}(Xe),Ze=function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}return __extends(t,e),t}(qe),$e=function(e){function t(t,n,r,i,o,a,s){var c=e.call(this)||this;return c.aiDataContract={ver:ue.Required,name:ue.Default,url:ue.Default,duration:ue.Default,properties:ue.Default,measurements:ue.Default,id:ue.Default},c.id=be.sanitizeId(t,s),c.url=be.sanitizeUrl(t,r),c.name=be.sanitizeString(t,n)||Te.NotSpecified,isNaN(i)||(c.duration=Te.msToTimeSpan(i)),c.properties=be.sanitizeProperties(t,o),c.measurements=be.sanitizeMeasurements(t,a),c}return __extends(t,e),t.envelopeType="Microsoft.ApplicationInsights.{0}.Pageview",t.dataType="PageviewData",t}(Ze),et=function(e){function t(t,n,r,i,o,a,s,c,u,l,d,f){void 0===u&&(u="Ajax");var p=e.call(this)||this;p.aiDataContract={id:ue.Required,ver:ue.Required,name:ue.Default,resultCode:ue.Default,duration:ue.Default,success:ue.Default,data:ue.Default,target:ue.Default,type:ue.Default,properties:ue.Default,measurements:ue.Default,kind:ue.Default,value:ue.Default,count:ue.Default,min:ue.Default,max:ue.Default,stdDev:ue.Default,dependencyKind:ue.Default,dependencySource:ue.Default,commandName:ue.Default,dependencyTypeName:ue.Default},p.id=n,p.duration=Te.msToTimeSpan(o),p.success=a,p.resultCode=s+"",p.type=be.sanitizeString(t,u);var h=Ae.ParseDependencyPath(t,r,c,i);return p.data=be.sanitizeUrl(t,i)||h.data,p.target=be.sanitizeString(t,h.target),l&&(p.target=p.target+" | "+l),p.name=be.sanitizeString(t,h.name),p.properties=be.sanitizeProperties(t,d),p.measurements=be.sanitizeMeasurements(t,f),p}return __extends(t,e),t.envelopeType="Microsoft.ApplicationInsights.{0}.RemoteDependency",t.dataType="RemoteDependencyData",t}(function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.success=!0,t.properties={},t.measurements={},t}return __extends(t,e),t}(Fe)),tt=function(e){function t(t,n,r,i,o){var a=e.call(this)||this;return a.aiDataContract={ver:ue.Required,message:ue.Required,severityLevel:ue.Default,properties:ue.Default},n=n||Te.NotSpecified,a.message=be.sanitizeMessage(t,n),a.properties=be.sanitizeProperties(t,i),a.measurements=be.sanitizeMeasurements(t,o),r&&(a.severityLevel=r),a}return __extends(t,e),t.envelopeType="Microsoft.ApplicationInsights.{0}.Message",t.dataType="MessageData",t}(function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}return __extends(t,e),t}(Fe)),nt=function(e){function t(t,n,r,i,o,a,s){var c=e.call(this)||this;return c.aiDataContract={ver:ue.Required,name:ue.Default,url:ue.Default,duration:ue.Default,perfTotal:ue.Default,networkConnect:ue.Default,sentRequest:ue.Default,receivedResponse:ue.Default,domProcessing:ue.Default,properties:ue.Default,measurements:ue.Default},c.url=be.sanitizeUrl(t,r),c.name=be.sanitizeString(t,n)||Te.NotSpecified,c.properties=be.sanitizeProperties(t,o),c.measurements=be.sanitizeMeasurements(t,a),s&&(c.domProcessing=s.domProcessing,c.duration=s.duration,c.networkConnect=s.networkConnect,c.perfTotal=s.perfTotal,c.receivedResponse=s.receivedResponse,c.sentRequest=s.sentRequest),c}return __extends(t,e),t.envelopeType="Microsoft.ApplicationInsights.{0}.PageviewPerformance",t.dataType="PageviewPerformanceData",t}(function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}return __extends(t,e),t}(Ze)),rt=function(e){function t(t,n){var r=e.call(this)||this;return r.aiDataContract={baseType:ue.Required,baseData:ue.Required},r.baseType=t,r.baseData=n,r}return __extends(t,e),t}(Le);!function(e){e[e.Verbose=0]="Verbose",e[e.Information=1]="Information",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.Critical=4]="Critical"}(Ye||(Ye={}));var it=function(){function e(){}return e.getConfig=function(e,t,n,r){var i;return void 0===r&&(r=!1),i=n&&e.extensionConfig&&e.extensionConfig[n]&&!k.isNullOrUndefined(e.extensionConfig[n][t])?e.extensionConfig[n][t]:e[t],k.isNullOrUndefined(i)?r:i},e}(),ot=function(){this.applicationVersion="ai.application.ver",this.applicationBuild="ai.application.build",this.applicationTypeId="ai.application.typeId",this.applicationId="ai.application.applicationId",this.applicationLayer="ai.application.layer",this.deviceId="ai.device.id",this.deviceIp="ai.device.ip",this.deviceLanguage="ai.device.language",this.deviceLocale="ai.device.locale",this.deviceModel="ai.device.model",this.deviceFriendlyName="ai.device.friendlyName",this.deviceNetwork="ai.device.network",this.deviceNetworkName="ai.device.networkName",this.deviceOEMName="ai.device.oemName",this.deviceOS="ai.device.os",this.deviceOSVersion="ai.device.osVersion",this.deviceRoleInstance="ai.device.roleInstance",this.deviceRoleName="ai.device.roleName",this.deviceScreenResolution="ai.device.screenResolution",this.deviceType="ai.device.type",this.deviceMachineName="ai.device.machineName",this.deviceVMName="ai.device.vmName",this.deviceBrowser="ai.device.browser",this.deviceBrowserVersion="ai.device.browserVersion",this.locationIp="ai.location.ip",this.locationCountry="ai.location.country",this.locationProvince="ai.location.province",this.locationCity="ai.location.city",this.operationId="ai.operation.id",this.operationName="ai.operation.name",this.operationParentId="ai.operation.parentId",this.operationRootId="ai.operation.rootId",this.operationSyntheticSource="ai.operation.syntheticSource",this.operationCorrelationVector="ai.operation.correlationVector",this.sessionId="ai.session.id",this.sessionIsFirst="ai.session.isFirst",this.sessionIsNew="ai.session.isNew",this.userAccountAcquisitionDate="ai.user.accountAcquisitionDate",this.userAccountId="ai.user.accountId",this.userAgent="ai.user.userAgent",this.userId="ai.user.id",this.userStoreRegion="ai.user.storeRegion",this.userAuthUserId="ai.user.authUserId",this.userAnonymousUserAcquisitionDate="ai.user.anonUserAcquisitionDate",this.userAuthenticatedUserAcquisitionDate="ai.user.authUserAcquisitionDate",this.cloudName="ai.cloud.name",this.cloudRole="ai.cloud.role",this.cloudRoleVer="ai.cloud.roleVer",this.cloudRoleInstance="ai.cloud.roleInstance",this.cloudEnvironment="ai.cloud.environment",this.cloudLocation="ai.cloud.location",this.cloudDeploymentUnit="ai.cloud.deploymentUnit",this.internalNodeName="ai.internal.nodeName",this.internalSdkVersion="ai.internal.sdkVersion",this.internalAgentVersion="ai.internal.agentVersion",this.internalSnippet="ai.internal.snippet",this.internalSdkSrc="ai.internal.sdkSrc"},at=function(){function e(){}return e.create=function(e,t,n,r,i,o){if(n=be.sanitizeString(r,n)||Te.NotSpecified,k.isNullOrUndefined(e)||k.isNullOrUndefined(t)||k.isNullOrUndefined(n))throw Error("Input doesn't contain all required fields");var a={name:n,time:k.toISOString(new Date),iKey:"",ext:o||{},tags:[],data:{},baseType:t,baseData:e};if(!k.isNullOrUndefined(i))for(var s in i)i.hasOwnProperty(s)&&(a.data[s]=i[s]);return a},e}(),st=function(){function e(){}return e.UserExt="user",e.DeviceExt="device",e.TraceExt="trace",e.WebExt="web",e.AppExt="app",e.OSExt="os",e.SessionExt="ses",e.SDKExt="sdk",e}(),ct=new ot,ut="AppInsightsPropertiesPlugin",lt="AppInsightsChannelPlugin",dt="ApplicationInsightsAnalytics",ft=function e(t,n,r,i){B(e,this,(function(e){var o,a=k.arrForEach,s=k.isNullOrUndefined,c=null,u=[],l=!1;function d(){r&&a(r.getTransmissionControls(),(function(e){a(e,(function(e){return e.flush(!0)}))}))}r&&(o=r.logger),e.trackPageView=function(e,r){var f=e.name;if(s(f)||"string"!=typeof f){var p=h();f=e.name=p&&p.title||""}var g=e.uri;if(s(g)||"string"!=typeof g){var m=v();g=e.uri=m&&m.href||""}if(!i.isPerformanceTimingSupported())return t.sendPageViewInternal(e,r),d(),void o.throwInternal(R.WARNING,N.NavigationTimingNotSupported,"trackPageView: navigation timing API used for calculation of page duration is not supported in this browser. This page view will be collected without duration and timing info.");var y,w,b,C=!1,E=i.getPerformanceTiming().navigationStart;y=xe.GetDuration(E,+new Date),i.shouldCollectDuration(y)||(y=void 0),s(r)||s(r.duration)||(w=r.duration),!n&&isNaN(w)||(isNaN(w)&&(r||(r={}),r.duration=y),t.sendPageViewInternal(e,r),d(),C=!0),r||(r={}),b=function(){var n=!1;try{if(i.isPerformanceTimingDataReady()){n=!0;var a={name:f,uri:g};i.populatePageViewPerformanceEvent(a),a.isValid||C?(C||(r.duration=a.durationMs,t.sendPageViewInternal(e,r)),l||(t.sendPageViewPerformanceInternal(a,r),l=!0)):(r.duration=y,t.sendPageViewInternal(e,r))}else xe.GetDuration(E,+new Date)>6e4&&(n=!0,C||(r.duration=6e4,t.sendPageViewInternal(e,r)))}catch(e){o.throwInternal(R.CRITICAL,N.TrackPVFailedCalc,"trackPageView failed on page load calculation: "+Te.getExceptionName(e),{exception:Te.dump(e)})}return n},u.push(b),c||(c=setInterval((function(){var e=u.slice(0),t=!1;u=[],a(e,(function(e){e()?t=!0:u.push(e)})),0===u.length&&(clearInterval(c),c=null),t&&d()}),100))}}))},pt=function(){function e(e,t){this.prevPageVisitDataKeyName="prevPageVisitData",this.pageVisitTimeTrackingHandler=t,this._logger=e}return e.prototype.trackPreviousPageVisit=function(e,t){try{var n=this.restartPageVisitTimer(e,t);n&&this.pageVisitTimeTrackingHandler(n.pageName,n.pageUrl,n.pageVisitTime)}catch(e){this._logger.warnToConsole("Auto track page visit time failed, metric will not be collected: "+Te.dump(e))}},e.prototype.restartPageVisitTimer=function(e,t){try{var n=this.stopPageVisitTimer();return this.startPageVisitTimer(e,t),n}catch(e){return this._logger.warnToConsole("Call to restart failed: "+Te.dump(e)),null}},e.prototype.startPageVisitTimer=function(e,t){try{if(Te.canUseSessionStorage()){if(null!=Te.getSessionStorage(this._logger,this.prevPageVisitDataKeyName))throw new Error("Cannot call startPageVisit consecutively without first calling stopPageVisit");var n=new ht(e,t),r=b().stringify(n);Te.setSessionStorage(this._logger,this.prevPageVisitDataKeyName,r)}}catch(e){this._logger.warnToConsole("Call to start failed: "+Te.dump(e))}},e.prototype.stopPageVisitTimer=function(){try{if(Te.canUseSessionStorage()){var e=k.dateNow(),t=Te.getSessionStorage(this._logger,this.prevPageVisitDataKeyName);if(t&&w()){var n=b().parse(t);return n.pageVisitTime=e-n.pageVisitStartTime,Te.removeSessionStorage(this._logger,this.prevPageVisitDataKeyName),n}return null}return null}catch(e){return this._logger.warnToConsole("Stop page visit timer failed: "+Te.dump(e)),null}},e}(),ht=function(e,t){this.pageVisitStartTime=k.dateNow(),this.pageName=e,this.pageUrl=t},gt=function(){function e(e){this.MAX_DURATION_ALLOWED=36e5,e&&(this._logger=e.logger)}return e.prototype.populatePageViewPerformanceEvent=function(e){e.isValid=!1;var t=this.getPerformanceNavigationTiming(),n=this.getPerformanceTiming();if(t||n){if(t)var r=t.duration,i=xe.GetDuration(t.startTime,t.connectEnd),o=xe.GetDuration(t.requestStart,t.responseStart),a=xe.GetDuration(t.responseStart,t.responseEnd),s=xe.GetDuration(t.responseEnd,t.loadEventEnd);else r=xe.GetDuration(n.navigationStart,n.loadEventEnd),i=xe.GetDuration(n.navigationStart,n.connectEnd),o=xe.GetDuration(n.requestStart,n.responseStart),a=xe.GetDuration(n.responseStart,n.responseEnd),s=xe.GetDuration(n.responseEnd,n.loadEventEnd);0===r?this._logger.throwInternal(R.WARNING,N.ErrorPVCalc,"error calculating page view performance.",{total:r,network:i,request:o,response:a,dom:s}):this.shouldCollectDuration(r,i,o,a,s)?r<Math.floor(i)+Math.floor(o)+Math.floor(a)+Math.floor(s)?this._logger.throwInternal(R.WARNING,N.ClientPerformanceMathError,"client performance math error.",{total:r,network:i,request:o,response:a,dom:s}):(e.durationMs=r,e.perfTotal=e.duration=Te.msToTimeSpan(r),e.networkConnect=Te.msToTimeSpan(i),e.sentRequest=Te.msToTimeSpan(o),e.receivedResponse=Te.msToTimeSpan(a),e.domProcessing=Te.msToTimeSpan(s),e.isValid=!0):this._logger.throwInternal(R.WARNING,N.InvalidDurationValue,"Invalid page load duration value. Browser perf data won't be sent.",{total:r,network:i,request:o,response:a,dom:s})}},e.prototype.getPerformanceTiming=function(){return this.isPerformanceTimingSupported()?y().timing:null},e.prototype.getPerformanceNavigationTiming=function(){return this.isPerformanceNavigationTimingSupported()?y().getEntriesByType("navigation")[0]:null},e.prototype.isPerformanceNavigationTimingSupported=function(){var e=y();return e&&e.getEntriesByType&&e.getEntriesByType("navigation").length>0},e.prototype.isPerformanceTimingSupported=function(){var e=y();return e&&e.timing},e.prototype.isPerformanceTimingDataReady=function(){var e=y(),t=e?e.timing:0;return t&&t.domainLookupStart>0&&t.navigationStart>0&&t.responseStart>0&&t.requestStart>0&&t.loadEventEnd>0&&t.responseEnd>0&&t.connectEnd>0&&t.domLoading>0},e.prototype.shouldCollectDuration=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=g()||{},r=["googlebot","adsbot-google","apis-google","mediapartners-google"],i=n.userAgent,o=!1;if(i)for(var a=0;a<r.length;a++)o=o||-1!==i.toLowerCase().indexOf(r[a]);if(o)return!1;for(a=0;a<e.length;a++)if(e[a]>=this.MAX_DURATION_ALLOWED)return!1;return!0},e}();function mt(e,t){e&&e.dispatchEvent&&t&&e.dispatchEvent(t)}var vt=function(e){function t(){var t=e.call(this)||this;t.identifier=dt,t.priority=180,t.autoRoutePVDelay=500,t._trackAjaxAttempts=0;var n=v();return t._prevUri=n&&n.href||"",t}return __extends(t,e),t.getDefaultConfig=function(e){return e||(e={}),e.sessionRenewalMs=18e5,e.sessionExpirationMs=864e5,e.disableExceptionTracking=Te.stringToBoolOrDefault(e.disableExceptionTracking),e.autoTrackPageVisitTime=Te.stringToBoolOrDefault(e.autoTrackPageVisitTime),e.overridePageViewDuration=Te.stringToBoolOrDefault(e.overridePageViewDuration),e.enableUnhandledPromiseRejectionTracking=Te.stringToBoolOrDefault(e.enableUnhandledPromiseRejectionTracking),(isNaN(e.samplingPercentage)||e.samplingPercentage<=0||e.samplingPercentage>=100)&&(e.samplingPercentage=100),e.isCookieUseDisabled=Te.stringToBoolOrDefault(e.isCookieUseDisabled),e.isStorageUseDisabled=Te.stringToBoolOrDefault(e.isStorageUseDisabled),e.isBrowserLinkTrackingEnabled=Te.stringToBoolOrDefault(e.isBrowserLinkTrackingEnabled),e.enableAutoRouteTracking=Te.stringToBoolOrDefault(e.enableAutoRouteTracking),e.namePrefix=e.namePrefix||"",e},t.prototype.processTelemetry=function(e,t){var n=this;J(this.core,(function(){return n.identifier+":processTelemetry"}),(function(){var r=!1,i=n._telemetryInitializers.length;t=n._getTelCtx(t);for(var o=0;o<i;++o){var a=n._telemetryInitializers[o];if(a)try{if(!1===a.apply(null,[e])){r=!0;break}}catch(e){t.diagLog().throwInternal(R.CRITICAL,N.TelemetryInitializerFailed,"One of telemetry initializers failed, telemetry item will not be sent: "+Te.getExceptionName(e),{exception:Te.dump(e)},!0)}}r||n.processNext(e,t)}),(function(){return{item:e}}),!e.sync)},t.prototype.trackEvent=function(e,t){try{var n=at.create(e,Ve.dataType,Ve.envelopeType,this.diagLog(),t);this.core.track(n)}catch(e){this.diagLog().throwInternal(R.WARNING,N.TrackTraceFailed,"trackTrace failed, trace will not be collected: "+Te.getExceptionName(e),{exception:Te.dump(e)})}},t.prototype.startTrackEvent=function(e){try{this._eventTracking.start(e)}catch(e){this.diagLog().throwInternal(R.CRITICAL,N.StartTrackEventFailed,"startTrackEvent failed, event will not be collected: "+Te.getExceptionName(e),{exception:Te.dump(e)})}},t.prototype.stopTrackEvent=function(e,t,n){try{this._eventTracking.stop(e,void 0,t)}catch(e){this.diagLog().throwInternal(R.CRITICAL,N.StopTrackEventFailed,"stopTrackEvent failed, event will not be collected: "+Te.getExceptionName(e),{exception:Te.dump(e)})}},t.prototype.trackTrace=function(e,t){try{var n=at.create(e,tt.dataType,tt.envelopeType,this.diagLog(),t);this.core.track(n)}catch(e){this.diagLog().throwInternal(R.WARNING,N.TrackTraceFailed,"trackTrace failed, trace will not be collected: "+Te.getExceptionName(e),{exception:Te.dump(e)})}},t.prototype.trackMetric=function(e,t){try{var n=at.create(e,Je.dataType,Je.envelopeType,this.diagLog(),t);this.core.track(n)}catch(e){this.diagLog().throwInternal(R.CRITICAL,N.TrackMetricFailed,"trackMetric failed, metric will not be collected: "+Te.getExceptionName(e),{exception:Te.dump(e)})}},t.prototype.trackPageView=function(e,t){try{var n=e||{};this._pageViewManager.trackPageView(n,__assign({},n.properties,n.measurements,t)),this.config.autoTrackPageVisitTime&&this._pageVisitTimeManager.trackPreviousPageVisit(n.name,n.uri)}catch(e){this.diagLog().throwInternal(R.CRITICAL,N.TrackPVFailed,"trackPageView failed, page view will not be collected: "+Te.getExceptionName(e),{exception:Te.dump(e)})}},t.prototype.sendPageViewInternal=function(e,t,n){var r=h();r&&(e.refUri=void 0===e.refUri?r.referrer:e.refUri);var i=at.create(e,$e.dataType,$e.envelopeType,this.diagLog(),t,n);this.core.track(i),this._trackAjaxAttempts=0},t.prototype.sendPageViewPerformanceInternal=function(e,t,n){var r=at.create(e,nt.dataType,nt.envelopeType,this.diagLog(),t,n);this.core.track(r)},t.prototype.trackPageViewPerformance=function(e,t){try{this._pageViewPerformanceManager.populatePageViewPerformanceEvent(e),this.sendPageViewPerformanceInternal(e,t)}catch(e){this.diagLog().throwInternal(R.CRITICAL,N.TrackPVFailed,"trackPageViewPerformance failed, page view will not be collected: "+Te.getExceptionName(e),{exception:Te.dump(e)})}},t.prototype.startTrackPage=function(e){try{if("string"!=typeof e){var t=h();e=t&&t.title||""}this._pageTracking.start(e)}catch(e){this.diagLog().throwInternal(R.CRITICAL,N.StartTrackFailed,"startTrackPage failed, page view may not be collected: "+Te.getExceptionName(e),{exception:Te.dump(e)})}},t.prototype.stopTrackPage=function(e,t,n,r){try{if("string"!=typeof e){var i=h();e=i&&i.title||""}if("string"!=typeof t){var o=v();t=o&&o.href||""}this._pageTracking.stop(e,t,n,r),this.config.autoTrackPageVisitTime&&this._pageVisitTimeManager.trackPreviousPageVisit(e,t)}catch(e){this.diagLog().throwInternal(R.CRITICAL,N.StopTrackFailed,"stopTrackPage failed, page view will not be collected: "+Te.getExceptionName(e),{exception:Te.dump(e)})}},t.prototype.sendExceptionInternal=function(e,t,n){var r=new Be(this.diagLog(),e.exception||new Error(Te.NotSpecified),e.properties,e.measurements,e.severityLevel,e.id).toInterface(),i=at.create(r,Be.dataType,Be.envelopeType,this.diagLog(),t,n);this.core.track(i)},t.prototype.trackException=function(e,t){try{this.sendExceptionInternal(e,t)}catch(e){this.diagLog().throwInternal(R.CRITICAL,N.TrackExceptionFailed,"trackException failed, exception will not be collected: "+Te.getExceptionName(e),{exception:Te.dump(e)})}},t.prototype._onerror=function(e){try{var t={url:e&&e.url||(h()||{}).URL,lineNumber:e.lineNumber,columnNumber:e.columnNumber,message:e.message};if(Te.isCrossOriginError(e.message,e.url,e.lineNumber,e.columnNumber,e.error))this._sendCORSException(t.url);else{if(!Te.isError(e.error)){var n="window.onerror@"+t.url+":"+e.lineNumber+":"+(e.columnNumber||0);e.error=new Error(e.message),e.error.stack=n}this.trackException({exception:e.error,severityLevel:Ye.Error},t)}}catch(t){var r=e.error?e.error.name+", "+e.error.message:"null";this.diagLog().throwInternal(R.CRITICAL,N.ExceptionWhileLoggingError,"_onError threw exception while logging error, error will not be collected: "+Te.getExceptionName(t),{exception:Te.dump(t),errorString:r})}},t.prototype.addTelemetryInitializer=function(e){this._telemetryInitializers.push(e)},t.prototype.initialize=function(n,r,i,o){var a=this;if(!this.isInitialized()){if(k.isNullOrUndefined(r))throw Error("Error initializing");e.prototype.initialize.call(this,n,r,i,o),this.setInitialized(!1);var s=this._getTelCtx(),c=this.identifier;this._globalconfig={instrumentationKey:n.instrumentationKey,endpointUrl:n.endpointUrl||"https://dc.services.visualstudio.com/v2/track"},this.config=s.getExtCfg(c);var u=t.getDefaultConfig();if(void 0!==u){for(var l in u)this.config[l]=s.getConfig(c,l,u[l]);if(this._globalconfig)for(var l in u)void 0===this._globalconfig[l]&&(this._globalconfig[l]=u[l])}this.config.isCookieUseDisabled&&Te.disableCookies(),this.config.isStorageUseDisabled&&Te.disableStorage();var d={instrumentationKey:function(){return n.instrumentationKey},accountId:function(){return a.config.accountId||n.accountId},sessionRenewalMs:function(){return a.config.sessionRenewalMs||n.sessionRenewalMs},sessionExpirationMs:function(){return a.config.sessionExpirationMs||n.sessionExpirationMs},sampleRate:function(){return a.config.samplingPercentage||n.samplingPercentage},cookieDomain:function(){return a.config.cookieDomain||n.cookieDomain},sdkExtension:function(){return a.config.sdkExtension||n.sdkExtension},isBrowserLinkTrackingEnabled:function(){return a.config.isBrowserLinkTrackingEnabled||n.isBrowserLinkTrackingEnabled},appId:function(){return a.config.appId||n.appId}};this._pageViewPerformanceManager=new gt(this.core),this._pageViewManager=new ft(this,this.config.overridePageViewDuration,this.core,this._pageViewPerformanceManager),this._pageVisitTimeManager=new pt(this.diagLog(),(function(e,t,n){return a.trackPageVisitTime(e,t,n)})),this._telemetryInitializers=this._telemetryInitializers||[],this._addDefaultTelemetryInitializers(d),this._eventTracking=new yt(this.diagLog(),"trackEvent"),this._eventTracking.action=function(e,t,n,r){r||(r={}),r.duration=n.toString(),a.trackEvent({name:e,properties:r})},this._pageTracking=new yt(this.diagLog(),"trackPageView"),this._pageTracking.action=function(e,t,n,r,i){k.isNullOrUndefined(r)&&(r={}),r.duration=n.toString();var o={name:e,uri:t,properties:r,measurements:i};a.sendPageViewInternal(o,r)};var p,h=f(),g=m(),y=v(),w=this;if(!1===this.config.disableExceptionTracking&&!this.config.autoExceptionInstrumented&&h){var b=h.onerror;h.onerror=function(e,t,n,r,i){var o=b&&b(e,t,n,r,i);return!0!==o&&w._onerror({message:e,url:t,lineNumber:n,columnNumber:r,error:i}),o},this.config.autoExceptionInstrumented=!0}if(!1===this.config.disableExceptionTracking&&!0===this.config.enableUnhandledPromiseRejectionTracking&&!this.config.autoUnhandledPromiseInstrumented&&h){var C=h.onunhandledrejection;h.onunhandledrejection=function(e){var t=C&&C.call(h,e);return!0!==t&&w._onerror({message:e.reason.toString(),error:e.reason instanceof Error?e.reason:new Error(e.reason.toString()),url:y?y.href:"",lineNumber:0,columnNumber:0}),t},this.config.autoUnhandledPromiseInstrumented=!0}if(!0===this.config.enableAutoRouteTracking&&g&&k.isFunction(g.pushState)&&k.isFunction(g.replaceState)&&h&&"undefined"!=typeof Event){var E=this;k.arrForEach(i,(function(e){e.identifier===ut&&(a._properties=e)})),g.pushState=(p=g.pushState,function(){var e=p.apply(this,arguments);return mt(h,Te.createDomEvent(E.config.namePrefix+"pushState")),mt(h,Te.createDomEvent(E.config.namePrefix+"locationchange")),e}),g.replaceState=function(e){return function(){var t=e.apply(this,arguments);return mt(h,Te.createDomEvent(E.config.namePrefix+"replaceState")),mt(h,Te.createDomEvent(E.config.namePrefix+"locationchange")),t}}(g.replaceState),h.addEventListener&&(h.addEventListener(E.config.namePrefix+"popstate",(function(){mt(h,Te.createDomEvent(E.config.namePrefix+"locationchange"))})),h.addEventListener(E.config.namePrefix+"locationchange",(function(){E._properties&&E._properties.context&&E._properties.context.telemetryTrace&&(E._properties.context.telemetryTrace.traceID=Te.generateW3CId(),E._properties.context.telemetryTrace.name=y&&y.pathname||"_unknown_"),a._currUri?(a._prevUri=a._currUri,a._currUri=y&&y.href||""):a._currUri=y&&y.href||"",setTimeout(function(e){E.trackPageView({refUri:e,properties:{duration:0}})}.bind(a,a._prevUri),E.autoRoutePVDelay)})))}this.setInitialized(!0)}},t.prototype.trackPageVisitTime=function(e,t,n){var r={PageName:e,PageUrl:t};this.trackMetric({name:"PageVisitTime",average:n,max:n,min:n,sampleCount:1},r)},t.prototype._addDefaultTelemetryInitializers=function(e){if(!e.isBrowserLinkTrackingEnabled()){var t=["/browserLinkSignalR/","/__browserLink/"];this._addTelemetryInitializer((function(e){if(e.baseType===et.dataType){var n=e.baseData;if(n)for(var r=0;r<t.length;r++)if(n.target&&n.target.indexOf(t[r])>=0)return!1}return!0}))}},t.prototype._addTelemetryInitializer=function(e){this._telemetryInitializers.push(e)},t.prototype._sendCORSException=function(e){var t={message:"Script error: The browser's same-origin policy prevents us from getting the details of this exception. Consider using the 'crossorigin' attribute.",url:e,lineNumber:0,columnNumber:0,error:void 0},n=at.create(t,Be.dataType,Be.envelopeType,this.diagLog(),{url:e});this.core.track(n)},t.Version="2.5.8",t}(ie),yt=function(){function e(e,t){this._name=t,this._events={},this._logger=e}return e.prototype.start=function(e){void 0!==this._events[e]&&this._logger.throwInternal(R.WARNING,N.StartCalledMoreThanOnce,"start was called more than once for this event without calling stop.",{name:this._name,key:e},!0),this._events[e]=+new Date},e.prototype.stop=function(e,t,n,r){var i=this._events[e];if(isNaN(i))this._logger.throwInternal(R.WARNING,N.StopCalledWithoutStart,"stop was called without a corresponding start.",{name:this._name,key:e},!0);else{var o=+new Date,a=xe.GetDuration(i,o);this.action(e,t,a,n,r)}delete this._events[e],this._events[e]=void 0},e}(),wt=function e(t){var n=[];B(e,this,(function(e){e.enqueue=function(e){n.push(e)},e.count=function(){return n.length},e.clear=function(){n.length=0},e.getItems=function(){return n.slice(0)},e.batchPayloads=function(e){return e&&e.length>0?t.emitLineDelimitedJson()?e.join("\n"):"["+e.join(",")+"]":null},e.markAsSent=function(t){e.clear()},e.clearSent=function(e){}}))},bt=function(){function e(t,n){var r,i=!1;B(e,this,(function(o){var a=u(e.BUFFER_KEY),s=u(e.SENT_BUFFER_KEY);function c(e,t){var n=[];return k.arrForEach(t,(function(t){k.isFunction(t)||-1!==k.arrIndexOf(e,t)||n.push(t)})),n}function u(e){var r=e;try{r=n.namePrefix&&n.namePrefix()?n.namePrefix()+"_"+r:r;var i=Te.getSessionStorage(t,r);if(i){var o=b().parse(i);if(k.isString(o)&&(o=b().parse(o)),o&&Te.isArray(o))return o}}catch(e){t.throwInternal(R.CRITICAL,N.FailedToRestoreStorageBuffer," storage key: "+r+", "+Te.getExceptionName(e),{exception:Te.dump(e)})}return[]}function l(e,r){var i=e;try{i=n.namePrefix&&n.namePrefix()?n.namePrefix()+"_"+i:i;var o=JSON.stringify(r);Te.setSessionStorage(t,i,o)}catch(e){Te.setSessionStorage(t,i,JSON.stringify([])),t.throwInternal(R.WARNING,N.FailedToSetStorageBuffer," storage key: "+i+", "+Te.getExceptionName(e)+". Buffer cleared",{exception:Te.dump(e)})}}(r=a.concat(s)).length>e.MAX_BUFFER_SIZE&&(r.length=e.MAX_BUFFER_SIZE),l(e.SENT_BUFFER_KEY,[]),l(e.BUFFER_KEY,r),o.enqueue=function(n){r.length>=e.MAX_BUFFER_SIZE?i||(t.throwInternal(R.WARNING,N.SessionStorageBufferFull,"Maximum buffer size reached: "+r.length,!0),i=!0):(r.push(n),l(e.BUFFER_KEY,r))},o.count=function(){return r.length},o.clear=function(){r=[],l(e.BUFFER_KEY,[]),l(e.SENT_BUFFER_KEY,[]),i=!1},o.getItems=function(){return r.slice(0)},o.batchPayloads=function(e){return e&&e.length>0?n.emitLineDelimitedJson()?e.join("\n"):"["+e.join(",")+"]":null},o.markAsSent=function(n){r=c(n,r),l(e.BUFFER_KEY,r);var i=u(e.SENT_BUFFER_KEY);i instanceof Array&&n instanceof Array&&((i=i.concat(n)).length>e.MAX_BUFFER_SIZE&&(t.throwInternal(R.CRITICAL,N.SessionStorageBufferFull,"Sent buffer reached its maximum size: "+i.length,!0),i.length=e.MAX_BUFFER_SIZE),l(e.SENT_BUFFER_KEY,i))},o.clearSent=function(t){var n=u(e.SENT_BUFFER_KEY);n=c(t,n),l(e.SENT_BUFFER_KEY,n)}}))}return e.BUFFER_KEY="AI_buffer",e.SENT_BUFFER_KEY="AI_sentBuffer",e.MAX_BUFFER_SIZE=2e3,e}(),Ct=k.arrForEach,Et=k.objKeys,It=k.isNullOrUndefined;function Tt(e,t,n){return e&&n?(e[t]=n,e[t]):null}var St=function(){function e(){}return e.extractPropsAndMeasurements=function(e,t,n){It(e)||Ct(Et(e),(function(r){var i=e[r];k.isNumber(i)?n[r]=i:k.isString(i)?t[r]=i:w()&&(t[r]=b().stringify(i))}))},e.createEnvelope=function(t,n,r,i){var o=new Ue(t,i,n);Tt(o,"sampleRate",r[ke]),(r.baseData||{}).startTime&&(o.time=k.toISOString(r.baseData.startTime)),o.iKey=r.iKey;var a=r.iKey.replace(/-/g,"");return o.name=o.name.replace("{0}",a),e.extractPartAExtensions(r,o),r.tags=r.tags||[],o},e.extractPartAExtensions=function(t,n){var r=n.tags=n.tags||{},i=t.ext=t.ext||{},o=t.tags=t.tags||[],a=i.user;a&&(Tt(r,ct.userAuthUserId,a.authId),Tt(r,ct.userId,a.id||a.localId));var s=i.app;s&&Tt(r,ct.sessionId,s.sesId);var c=i.device;c&&(Tt(r,ct.deviceId,c.id||c.localId),Tt(r,ct.deviceType,c.deviceClass),Tt(r,ct.deviceIp,c.ip),Tt(r,ct.deviceModel,c.model),Tt(r,ct.deviceType,c.deviceType));var u=t.ext.web;if(u){Tt(r,ct.deviceLanguage,u.browserLang),Tt(r,ct.deviceBrowserVersion,u.browserVer),Tt(r,ct.deviceBrowser,u.browser);var l=n.data=n.data||{},d=l.baseData=l.baseData||{},f=d.properties=d.properties||{};Tt(f,"domain",u.domain),Tt(f,"isManual",u.isManual?"true":null),Tt(f,"screenRes",u.screenRes),Tt(f,"userConsent",u.userConsent?"true":null)}var p=i.os;p&&Tt(r,ct.deviceOS,p.name);var h=i.trace;h&&(Tt(r,ct.operationParentId,h.parentID),Tt(r,ct.operationName,h.name),Tt(r,ct.operationId,h.traceID));for(var g={},m=function(e){var t=o[e];Ct(Et(t),(function(e){g[e]=t[e]})),o.splice(e,1)},v=o.length-1;v>=0;v--)m(v);Ct(Et(o),(function(e){g[e]=o[e]})),n.tags=__assign({},r,g),n.tags[ct.internalSdkVersion]||(n.tags[ct.internalSdkVersion]="javascript:"+e.Version)},e.prototype.Init=function(e,t){this._logger=e,It(t.baseData)&&this._logger.throwInternal(R.CRITICAL,N.TelemetryEnvelopeInvalid,"telemetryItem.baseData cannot be null.")},e.Version="2.5.8",e}(),_t=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Create=function(t,n){e.prototype.Init.call(this,t,n);var r=n.baseData.measurements||{},i=n.baseData.properties||{};St.extractPropsAndMeasurements(n.data,i,r);var o=n.baseData;if(It(o))return t.warnToConsole("Invalid input for dependency data"),null;var a=o.properties&&o.properties[Oe]?o.properties[Oe]:"GET",s=new et(t,o.id,o.target,o.name,o.duration,o.success,o.responseCode,a,o.type,o.correlationContext,i,r),c=new rt(et.dataType,s);return St.createEnvelope(t,et.envelopeType,n,c)},t.DependencyEnvelopeCreator=new t,t}(St),At=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Create=function(t,n){e.prototype.Init.call(this,t,n);var r={},i={};n.baseType!==Ve.dataType&&(r.baseTypeSource=n.baseType),n.baseType===Ve.dataType?(r=n.baseData.properties||{},i=n.baseData.measurements||{}):n.baseData&&St.extractPropsAndMeasurements(n.baseData,r,i),St.extractPropsAndMeasurements(n.data,r,i);var o=n.baseData.name,a=new Ve(t,o,r,i),s=new rt(Ve.dataType,a);return St.createEnvelope(t,Ve.envelopeType,n,s)},t.EventEnvelopeCreator=new t,t}(St),xt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Create=function(t,n){e.prototype.Init.call(this,t,n);var r=n.baseData.measurements||{},i=n.baseData.properties||{};St.extractPropsAndMeasurements(n.data,i,r);var o=n.baseData,a=Be.CreateFromInterface(t,o,i,r),s=new rt(Be.dataType,a);return St.createEnvelope(t,Be.envelopeType,n,s)},t.ExceptionEnvelopeCreator=new t,t}(St),Rt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Create=function(t,n){e.prototype.Init.call(this,t,n);var r=n.baseData,i=r.properties||{},o=r.measurements||{};St.extractPropsAndMeasurements(n.data,i,o);var a=new Je(t,r.name,r.average,r.sampleCount,r.min,r.max,i,o),s=new rt(Je.dataType,a);return St.createEnvelope(t,Je.envelopeType,n,s)},t.MetricEnvelopeCreator=new t,t}(St),kt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Create=function(t,n){e.prototype.Init.call(this,t,n);var r,i=n.baseData;It(i)||It(i.properties)||It(i.properties.duration)?It(n.data)||It(n.data.duration)||(r=n.data.duration,delete n.data.duration):(r=i.properties.duration,delete i.properties.duration);var o,a=n.baseData;((n.ext||{}).trace||{}).traceID&&(o=n.ext.trace.traceID);var s=a.id||o,c=a.name,u=a.uri,l=a.properties||{},d=a.measurements||{};if(It(a.refUri)||(l.refUri=a.refUri),It(a.pageType)||(l.pageType=a.pageType),It(a.isLoggedIn)||(l.isLoggedIn=a.isLoggedIn.toString()),!It(a.properties)){var f=a.properties;Ct(Et(f),(function(e){l[e]=f[e]}))}St.extractPropsAndMeasurements(n.data,l,d);var p=new $e(t,c,u,r,l,d,s),h=new rt($e.dataType,p);return St.createEnvelope(t,$e.envelopeType,n,h)},t.PageViewEnvelopeCreator=new t,t}(St),Pt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Create=function(t,n){e.prototype.Init.call(this,t,n);var r=n.baseData,i=r.name,o=r.uri||r.url,a=r.properties||{},s=r.measurements||{};St.extractPropsAndMeasurements(n.data,a,s);var c=new nt(t,i,o,void 0,a,s,r),u=new rt(nt.dataType,c);return St.createEnvelope(t,nt.envelopeType,n,u)},t.PageViewPerformanceEnvelopeCreator=new t,t}(St),Ot=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Create=function(t,n){e.prototype.Init.call(this,t,n);var r=n.baseData.message,i=n.baseData.severityLevel,o=n.baseData.properties||{},a=n.baseData.measurements||{};St.extractPropsAndMeasurements(n.data,o,a);var s=new tt(t,r,i,o,a),c=new rt(tt.dataType,s);return St.createEnvelope(t,tt.envelopeType,n,c)},t.TraceEnvelopeCreator=new t,t}(St),Nt=function e(t){B(e,this,(function(e){function n(e,o){var a={};if(!e)return t.throwInternal(R.CRITICAL,N.CannotSerializeObject,"cannot serialize object because it is null or undefined",{name:o},!0),a;if(e.__aiCircularRefCheck)return t.throwInternal(R.WARNING,N.CircularReferenceDetected,"Circular reference detected while serializing object",{name:o},!0),a;if(!e.aiDataContract){if("measurements"===o)a=i(e,"number",o);else if("properties"===o)a=i(e,"string",o);else if("tags"===o)a=i(e,"string",o);else if(Te.isArray(e))a=r(e,o);else{t.throwInternal(R.WARNING,N.CannotSerializeObjectNonSerializable,"Attempting to serialize an object which does not implement ISerializable",{name:o},!0);try{b().stringify(e),a=e}catch(e){t.throwInternal(R.CRITICAL,N.CannotSerializeObject,e&&k.isFunction(e.toString)?e.toString():"Error serializing object",null,!0)}}return a}for(var s in e.__aiCircularRefCheck=!0,e.aiDataContract){var c=e.aiDataContract[s],u=k.isFunction(c)?c()&ue.Required:c&ue.Required,l=k.isFunction(c)?c()&ue.Hidden:c&ue.Hidden,d=c&ue.Array,f=void 0!==e[s],p=k.isObject(e[s])&&null!==e[s];if(!u||f||d){if(!l){var h=void 0;void 0!==(h=p?d?r(e[s],s):n(e[s],s):e[s])&&(a[s]=h)}}else t.throwInternal(R.CRITICAL,N.MissingRequiredFieldSpecification,"Missing required field specification. The field is required but not present on source",{field:s,name:o})}return delete e.__aiCircularRefCheck,a}function r(e,r){var i;if(e)if(Te.isArray(e)){i=[];for(var o=0;o<e.length;o++){var a=n(e[o],r+"["+o+"]");i.push(a)}}else t.throwInternal(R.CRITICAL,N.ItemNotInArray,"This field was specified as an array in the contract but the item is not an array.\r\n",{name:r},!0);return i}function i(e,n,r){var i;if(e)for(var o in i={},e){var a=e[o];if("string"===n)void 0===a?i[o]="undefined":null===a?i[o]="null":a.toString?i[o]=a.toString():i[o]="invalid field: toString() is not defined.";else if("number"===n)if(void 0===a)i[o]="undefined";else if(null===a)i[o]="null";else{var s=parseFloat(a);isNaN(s)?i[o]="NaN":i[o]=s}else i[o]="invalid field: "+r+" is of unknown type.",t.throwInternal(R.CRITICAL,i[o],null,!0)}return i}e.serialize=function(e){var r=n(e,"root");try{return b().stringify(r)}catch(e){t.throwInternal(R.CRITICAL,N.CannotSerializeObject,e&&k.isFunction(e.toString)?e.toString():"Error serializing object",null,!0)}}}))},Mt=function(){function e(){var t=f(),n=h(),r=!1,i=!0;B(e,this,(function(e){try{if(t&&O.Attach(t,"online",a)&&(O.Attach(t,"offline",s),r=!0),n){var o=n.body||n;k.isUndefined(o.ononline)||(o.ononline=a,o.onoffline=s,r=!0)}}catch(e){r=!1}function a(){i=!0}function s(){i=!1}e.isListening=r,e.isOnline=function(){var e=!0,t=g();return r?e=i:t&&!k.isNullOrUndefined(t.onLine)&&(e=t.onLine),e},e.isOffline=function(){return!e.isOnline()}}))}return e.Offline=new e,e}().Offline,Dt=function(){function e(){}return e.prototype.getHashCodeScore=function(t){return 100*(this.getHashCode(t)/e.INT_MAX_VALUE)},e.prototype.getHashCode=function(t){if(""===t)return 0;for(;t.length<e.MIN_INPUT_LENGTH;)t=t.concat(t);for(var n=5381,r=0;r<t.length;++r)n=(n<<5)+n+t.charCodeAt(r),n&=n;return Math.abs(n)},e.INT_MAX_VALUE=2147483647,e.MIN_INPUT_LENGTH=8,e}(),Lt=function(){function e(){this.hashCodeGeneragor=new Dt,this.keys=new ot}return e.prototype.getSamplingScore=function(e){return e.tags&&e.tags[this.keys.userId]?this.hashCodeGeneragor.getHashCodeScore(e.tags[this.keys.userId]):e.ext&&e.ext.user&&e.ext.user.id?this.hashCodeGeneragor.getHashCodeScore(e.ext.user.id):e.tags&&e.tags[this.keys.operationId]?this.hashCodeGeneragor.getHashCodeScore(e.tags[this.keys.operationId]):e.ext&&e.ext.telemetryTrace&&e.ext.telemetryTrace.traceID?this.hashCodeGeneragor.getHashCodeScore(e.ext.telemetryTrace.traceID):100*Math.random()},e}(),Ut=function(){function e(e,t){this.INT_MAX_VALUE=2147483647,this._logger=k.isNullOrUndefined(t)?new X:t,(e>100||e<0)&&(this._logger.throwInternal(R.WARNING,N.SampleRateOutOfRange,"Sampling rate is out of range (0..100). Sampling will be disabled, you may be sending too much data which may affect your AI service level.",{samplingRate:e},!0),this.sampleRate=100),this.sampleRate=e,this.samplingScoreGenerator=new Lt}return e.prototype.isSampledIn=function(e){var t=this.sampleRate;return null==t||t>=100||(e.baseType===Je.dataType||this.samplingScoreGenerator.getSamplingScore(e)<t)},e}();
/*!
 * Application Insights JavaScript SDK - Channel, 2.5.8
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
function Ft(e){try{return e.responseText}catch(e){}return null}var qt=function(e){function t(){var n,r,i,o,a=e.call(this)||this;return a.priority=1001,a.identifier=lt,a._XMLHttpRequestSupported=!1,B(t,a,(function(e,s){function c(){throw new Error("Method not implemented.")}function u(t,n){var r=e._senderConfig.endpointUrl(),i=e._buffer.batchPayloads(t),o=new Blob([i],{type:"text/plain;charset=UTF-8"});g().sendBeacon(r,o)?(e._buffer.markAsSent(t),e._onSuccess(t,t.length)):(d(t,!0),e.diagLog().throwInternal(R.WARNING,N.TransmissionFailed,". Failed to send telemetry with Beacon API, retried with xhrSender."))}function d(t,n){var r=new XMLHttpRequest,i=e._senderConfig.endpointUrl();try{r[Re]=!0}catch(e){}r.open("POST",i,n),r.setRequestHeader("Content-type","application/json"),Te.isInternalApplicationInsightsEndpoint(i)&&r.setRequestHeader(we.sdkContextHeader,we.sdkContextHeaderAppIdRequest),r.onreadystatechange=function(){return e._xhrReadyStateChange(r,t,t.length)},r.onerror=function(n){return e._onError(t,y(r),n)};var o=e._buffer.batchPayloads(t);r.send(o),e._buffer.markAsSent(t)}function p(t){try{if(t&&""!==t){var n=b().parse(t);if(n&&n.itemsReceived&&n.itemsReceived>=n.itemsAccepted&&n.itemsReceived-n.itemsAccepted===n.errors.length)return n}}catch(n){e.diagLog().throwInternal(R.CRITICAL,N.InvalidBackendResponse,"Cannot parse the response. "+Te.getExceptionName(n),{response:t})}return null}function h(t,i){if(void 0===i&&(i=1),t&&0!==t.length){e._buffer.clearSent(t),n++;for(var o=0,a=t;o<a.length;o++){var s=a[o];e._buffer.enqueue(s)}!function(e){var t;if(n<=1)t=10;else{var i=(Math.pow(2,n)-1)/2,o=Math.floor(Math.random()*i*10)+1;o*=e,t=Math.max(Math.min(o,3600),10)}var a=k.dateNow()+1e3*t;r=a}(i),m()}}function m(){if(!i){var t=r?Math.max(0,r-k.dateNow()):0,n=Math.max(e._senderConfig.maxBatchInterval(),t);i=setTimeout((function(){e.triggerSend(!0,null,1)}),n)}}function v(e){return 408===e||429===e||500===e||503===e}function y(e,t){return e?"XMLHttpRequest,Status:"+e.status+",Response:"+Ft(e)||!1:t}function w(t,n){var r=f(),i=new XDomainRequest;i.onload=function(){return e._xdrOnLoad(i,t)},i.onerror=function(n){return e._onError(t,C(i),n)};var o=r&&r.location&&r.location.protocol||"";if(0!==e._senderConfig.endpointUrl().lastIndexOf(o,0))return e.diagLog().throwInternal(R.WARNING,N.TransmissionFailed,". Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol."),void e._buffer.clear();var a=e._senderConfig.endpointUrl().replace(/^(https?:)/,"");i.open("POST",a);var s=e._buffer.batchPayloads(t);i.send(s),e._buffer.markAsSent(t)}function C(e,t){return e?"XDomainRequest,Response:"+Ft(e)||!1:t}e.pause=c,e.resume=c,e.flush=function(){try{e.triggerSend(!0,null,1)}catch(t){e.diagLog().throwInternal(R.CRITICAL,N.FlushFailed,"flush failed, telemetry will not be collected: "+Te.getExceptionName(t),{exception:Te.dump(t)})}},e.onunloadFlush=function(){if(!1!==e._senderConfig.onunloadDisableBeacon()&&!1!==e._senderConfig.isBeaconApiDisabled()||!Te.IsBeaconApiSupported())e.flush();else try{e.triggerSend(!0,u,2)}catch(t){e.diagLog().throwInternal(R.CRITICAL,N.FailedToSendQueuedTelemetry,"failed to flush with beacon sender on page unload, telemetry will not be collected: "+Te.getExceptionName(t),{exception:Te.dump(t)})}},e.teardown=c,e.initialize=function(i,a,c,f){s.initialize(i,a,c,f);var p=e._getTelCtx(),h=e.identifier;o=new Nt(a.logger),n=0,r=null,0,e._sender=null;var g=t._getDefaultAppInsightsChannelConfig();e._senderConfig=t._getEmptyAppInsightsChannelConfig();var m=function(t){e._senderConfig[t]=function(){return p.getConfig(h,t,g[t]())}};for(var v in g)m(v);if(e._buffer=e._senderConfig.enableSessionStorageBuffer&&Te.canUseSessionStorage()?new bt(e.diagLog(),e._senderConfig):new wt(e._senderConfig),e._sample=new Ut(e._senderConfig.samplingPercentage(),e.diagLog()),function(e){if(!k.isNullOrUndefined(e.disableInstrumentaionKeyValidation)&&e.disableInstrumentaionKeyValidation)return!0;return new RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(e.instrumentationKey)}(i)||e.diagLog().throwInternal(R.CRITICAL,N.InvalidInstrumentationKey,"Invalid Instrumentation key "+i.instrumentationKey),!e._senderConfig.isBeaconApiDisabled()&&Te.IsBeaconApiSupported())e._sender=u;else if(void 0!==typeof XMLHttpRequest){var y=l("XMLHttpRequest");if(y)"withCredentials"in new y?(e._sender=d,e._XMLHttpRequestSupported=!0):void 0!==typeof XDomainRequest&&(e._sender=w)}},e.processTelemetry=function(n,r){r=e._getTelCtx(r);try{if(e._senderConfig.disableTelemetry())return;if(!n)return void r.diagLog().throwInternal(R.CRITICAL,N.CannotSendEmptyTelemetry,"Cannot send empty telemetry");if(n.baseData&&!n.baseType)return void r.diagLog().throwInternal(R.CRITICAL,N.InvalidEvent,"Cannot send telemetry without baseData and baseType");if(n.baseType||(n.baseType="EventData"),!e._sender)return void r.diagLog().throwInternal(R.CRITICAL,N.SenderNotInitialized,"Sender was not initialized");if(l=n,!e._sample.isSampledIn(l))return void r.diagLog().throwInternal(R.WARNING,N.TelemetrySampledAndNotSent,"Telemetry item was sampled out and not sent",{SampleRate:e._sample.sampleRate});n[ke]=e._sample.sampleRate;var i=t.constructEnvelope(n,e._senderConfig.instrumentationKey(),r.diagLog());if(!i)return void r.diagLog().throwInternal(R.CRITICAL,N.CreateEnvelopeError,"Unable to create an AppInsights envelope");var a=!1;if(n.tags&&n.tags[Pe]&&(k.arrForEach(n.tags[Pe],(function(e){try{e&&!1===e(i)&&(a=!0,r.diagLog().warnToConsole("Telemetry processor check returns false"))}catch(e){r.diagLog().throwInternal(R.CRITICAL,N.TelemetryInitializerFailed,"One of telemetry initializers failed, telemetry item will not be sent: "+Te.getExceptionName(e),{exception:Te.dump(e)},!0)}})),delete n.tags[Pe]),a)return;var s=o.serialize(i),c=e._buffer.getItems(),u=e._buffer.batchPayloads(c);u&&u.length+s.length>e._senderConfig.maxBatchSizeInBytes()&&e.triggerSend(!0,null,10),e._buffer.enqueue(s),m()}catch(e){r.diagLog().throwInternal(R.WARNING,N.FailedAddingTelemetryToBuffer,"Failed adding telemetry to the sender's buffer, some telemetry will be lost: "+Te.getExceptionName(e),{exception:Te.dump(e)})}var l;e.processNext(n,r)},e._xhrReadyStateChange=function(t,r,i){if(4===t.readyState){var o=null;if(e._appId||(o=p(Ft(t)||t.response))&&o.appId&&(e._appId=o.appId),(t.status<200||t.status>=300)&&0!==t.status)!e._senderConfig.isRetryDisabled()&&v(t.status)?(h(r),e.diagLog().throwInternal(R.WARNING,N.TransmissionFailed,". Response code "+t.status+". Will retry to send "+r.length+" items.")):e._onError(r,y(t));else if(Mt.isOffline()){if(!e._senderConfig.isRetryDisabled()){h(r,10),e.diagLog().throwInternal(R.WARNING,N.TransmissionFailed,". Offline - Response Code: "+t.status+". Offline status: "+Mt.isOffline()+". Will retry to send "+r.length+" items.")}}else 206===t.status?(o||(o=p(Ft(t)||t.response)),o&&!e._senderConfig.isRetryDisabled()?e._onPartialSuccess(r,o):e._onError(r,y(t))):(n=0,e._onSuccess(r,i))}},e.triggerSend=function(t,n,o){void 0===t&&(t=!0);try{if(e._senderConfig.disableTelemetry())e._buffer.clear();else{if(e._buffer.count()>0){var s=e._buffer.getItems();!function(t,n){var r=function(){if(e.core.getNotifyMgr)return e.core.getNotifyMgr();return e.core._notificationManager}();if(r&&r.eventsSendRequest)try{r.eventsSendRequest(t,n)}catch(t){e.diagLog().throwInternal(R.CRITICAL,N.NotificationException,"send request notification failed: "+Te.getExceptionName(t),{exception:Te.dump(t)})}}(o||0,t),n?n.call(a,s,t):e._sender(s,t)}+new Date}clearTimeout(i),i=null,r=null}catch(t){var c=Te.getIEVersion();(!c||c>9)&&e.diagLog().throwInternal(R.CRITICAL,N.TransmissionFailed,"Telemetry transmission failed, some telemetry will be lost: "+Te.getExceptionName(t),{exception:Te.dump(t)})}},e._onError=function(t,n,r){e.diagLog().throwInternal(R.WARNING,N.OnError,"Failed to send telemetry.",{message:n}),e._buffer.clearSent(t)},e._onPartialSuccess=function(t,n){for(var r=[],i=[],o=0,a=n.errors.reverse();o<a.length;o++){var s=a[o],c=t.splice(s.index,1)[0];v(s.statusCode)?i.push(c):r.push(c)}t.length>0&&e._onSuccess(t,n.itemsAccepted),r.length>0&&e._onError(r,y(null,["partial success",n.itemsAccepted,"of",n.itemsReceived].join(" "))),i.length>0&&(h(i),e.diagLog().throwInternal(R.WARNING,N.TransmissionFailed,"Partial success. Delivered: "+t.length+", Failed: "+r.length+". Will retry to send "+i.length+" our of "+n.itemsReceived+" items"))},e._onSuccess=function(t,n){e._buffer.clearSent(t)},e._xdrOnLoad=function(t,r){var i=Ft(t);if(!t||i+""!="200"&&""!==i){var o=p(i);o&&o.itemsReceived&&o.itemsReceived>o.itemsAccepted&&!e._senderConfig.isRetryDisabled()?e._onPartialSuccess(r,o):e._onError(r,C(t))}else n=0,e._onSuccess(r,0)}})),a}return __extends(t,e),t.constructEnvelope=function(e,t,n){var r;switch((r=t===e.iKey||k.isNullOrUndefined(t)?e:__assign({},e,{iKey:t})).baseType){case Ve.dataType:return At.EventEnvelopeCreator.Create(n,r);case tt.dataType:return Ot.TraceEnvelopeCreator.Create(n,r);case $e.dataType:return kt.PageViewEnvelopeCreator.Create(n,r);case nt.dataType:return Pt.PageViewPerformanceEnvelopeCreator.Create(n,r);case Be.dataType:return xt.ExceptionEnvelopeCreator.Create(n,r);case Je.dataType:return Rt.MetricEnvelopeCreator.Create(n,r);case et.dataType:return _t.DependencyEnvelopeCreator.Create(n,r);default:return At.EventEnvelopeCreator.Create(n,r)}},t._getDefaultAppInsightsChannelConfig=function(){return{endpointUrl:function(){return"https://dc.services.visualstudio.com/v2/track"},emitLineDelimitedJson:function(){return!1},maxBatchInterval:function(){return 15e3},maxBatchSizeInBytes:function(){return 102400},disableTelemetry:function(){return!1},enableSessionStorageBuffer:function(){return!0},isRetryDisabled:function(){return!1},isBeaconApiDisabled:function(){return!0},onunloadDisableBeacon:function(){return!1},instrumentationKey:function(){},namePrefix:function(){},samplingPercentage:function(){return 100}}},t._getEmptyAppInsightsChannelConfig=function(){return{endpointUrl:void 0,emitLineDelimitedJson:void 0,maxBatchInterval:void 0,maxBatchSizeInBytes:void 0,disableTelemetry:void 0,enableSessionStorageBuffer:void 0,isRetryDisabled:void 0,isBeaconApiDisabled:void 0,onunloadDisableBeacon:void 0,instrumentationKey:void 0,namePrefix:void 0,samplingPercentage:void 0}},t}(ie),Vt=function(){},Gt=function(){function e(t,n){var r=this;k.isNullOrUndefined(n)?this._logger=new X:this._logger=n,t||(t={}),"function"!=typeof t.sessionExpirationMs&&(t.sessionExpirationMs=function(){return e.acquisitionSpan}),"function"!=typeof t.sessionRenewalMs&&(t.sessionRenewalMs=function(){return e.renewalSpan}),this.config=t,this._storageNamePrefix=function(){return r.config.namePrefix&&r.config.namePrefix()?e.cookieNameConst+r.config.namePrefix():e.cookieNameConst},this.automaticSession=new Vt}return e.prototype.update=function(){this.automaticSession.id||this.initializeAutomaticSession();var t=xe.Now(),n=0!==this.config.sessionExpirationMs()&&t-this.automaticSession.acquisitionDate>this.config.sessionExpirationMs(),r=0!==this.config.sessionExpirationMs()&&t-this.automaticSession.renewalDate>this.config.sessionRenewalMs();n||r?this.renew():(!this.cookieUpdatedTimestamp||t-this.cookieUpdatedTimestamp>e.cookieUpdateInterval)&&(this.automaticSession.renewalDate=t,this.setCookie(this.automaticSession.id,this.automaticSession.acquisitionDate,this.automaticSession.renewalDate))},e.prototype.backup=function(){this.setStorage(this.automaticSession.id,this.automaticSession.acquisitionDate,this.automaticSession.renewalDate)},e.prototype.initializeAutomaticSession=function(){var e=Te.getCookie(this._logger,this._storageNamePrefix());if(e&&"function"==typeof e.split)this.initializeAutomaticSessionWithData(e);else{var t=Te.getStorage(this._logger,this._storageNamePrefix());t&&this.initializeAutomaticSessionWithData(t)}this.automaticSession.id||this.renew()},e.prototype.initializeAutomaticSessionWithData=function(e){var t=e.split("|");t.length>0&&(this.automaticSession.id=t[0]);try{if(t.length>1){var n=+t[1];this.automaticSession.acquisitionDate=+new Date(n),this.automaticSession.acquisitionDate=this.automaticSession.acquisitionDate>0?this.automaticSession.acquisitionDate:0}if(t.length>2){var r=+t[2];this.automaticSession.renewalDate=+new Date(r),this.automaticSession.renewalDate=this.automaticSession.renewalDate>0?this.automaticSession.renewalDate:0}}catch(e){this._logger.throwInternal(R.CRITICAL,N.ErrorParsingAISessionCookie,"Error parsing ai_session cookie, session will be reset: "+Te.getExceptionName(e),{exception:Te.dump(e)})}0===this.automaticSession.renewalDate&&this._logger.throwInternal(R.WARNING,N.SessionRenewalDateIsZero,"AI session renewal date is 0, session will be reset.")},e.prototype.renew=function(){var e=xe.Now();this.automaticSession.id=Te.newId(),this.automaticSession.acquisitionDate=e,this.automaticSession.renewalDate=e,this.setCookie(this.automaticSession.id,this.automaticSession.acquisitionDate,this.automaticSession.renewalDate),Te.canUseLocalStorage()||this._logger.throwInternal(R.WARNING,N.BrowserDoesNotSupportLocalStorage,"Browser does not support local storage. Session durations will be inaccurate.")},e.prototype.setCookie=function(e,t,n){var r=t+this.config.sessionExpirationMs(),i=n+this.config.sessionRenewalMs(),o=new Date,a=[e,t,n];r<i?o.setTime(r):o.setTime(i);var s=this.config.cookieDomain?this.config.cookieDomain():null,c=0===this.config.sessionExpirationMs()?"0":o.toUTCString();Te.setCookie(this._logger,this._storageNamePrefix(),a.join("|")+";expires="+c,s),this.cookieUpdatedTimestamp=xe.Now()},e.prototype.setStorage=function(e,t,n){Te.setStorage(this._logger,this._storageNamePrefix(),[e,t,n].join("|"))},e.acquisitionSpan=864e5,e.renewalSpan=18e5,e.cookieUpdateInterval=6e4,e.cookieNameConst="ai_session",e}(),Ht=function(){},jt=function(){this.id="browser",this.deviceClass="Browser"},zt=function(e){this.sdkVersion=(e.sdkExtension&&e.sdkExtension()?e.sdkExtension()+"_":"")+"javascript:2.5.8"},Bt=function(){function e(t,n){this.isNewUser=!1,this._logger=n;var r=Te.getCookie(this._logger,e.userCookieName);if(r){this.isNewUser=!1;var i=r.split(e.cookieSeparator);i.length>0&&(this.id=i[0])}if(this.config=t,!this.id){this.id=Te.newId();var o=new Date,a=k.toISOString(o);this.accountAcquisitionDate=a,this.isNewUser=!0,o.setTime(o.getTime()+31536e6);var s=[this.id,a],c=this.config.cookieDomain?this.config.cookieDomain():void 0;Te.setCookie(this._logger,e.userCookieName,s.join(e.cookieSeparator)+";expires="+o.toUTCString(),c);var u=t.namePrefix&&t.namePrefix()?t.namePrefix()+"ai_session":"ai_session";Te.removeStorage(this._logger,u)}this.accountId=t.accountId?t.accountId():void 0;var l=Te.getCookie(this._logger,e.authUserCookieName);if(l){var d=(l=decodeURI(l)).split(e.cookieSeparator);d[0]&&(this.authenticatedId=d[0]),d.length>1&&d[1]&&(this.accountId=d[1])}}return e.prototype.setAuthenticatedUserContext=function(t,n,r){if(void 0===r&&(r=!1),!this.validateUserInput(t)||n&&!this.validateUserInput(n))this._logger.throwInternal(R.WARNING,N.SetAuthContextFailedAccountName,"Setting auth user context failed. User auth/account id should be of type string, and not contain commas, semi-colons, equal signs, spaces, or vertical-bars.",!0);else{this.authenticatedId=t;var i=this.authenticatedId;n&&(this.accountId=n,i=[this.authenticatedId,this.accountId].join(e.cookieSeparator)),r&&Te.setCookie(this._logger,e.authUserCookieName,encodeURI(i),this.config.cookieDomain())}},e.prototype.clearAuthenticatedUserContext=function(){this.authenticatedId=null,this.accountId=null,Te.deleteCookie(this._logger,e.authUserCookieName)},e.prototype.validateUserInput=function(e){return!("string"!=typeof e||!e||e.match(/,|;|=| |\|/))},e.cookieSeparator="|",e.userCookieName="ai_user",e.authUserCookieName="ai_authUser",e}(),Kt=function(){},Wt=function(e,t,n,r){this.traceID=e||Te.generateW3CId(),this.parentID=t,this.name=n;var i=v();!n&&i&&i.pathname&&(this.name=i.pathname),this.name=be.sanitizeString(r,this.name)},Xt=function(){function e(e,t){this.application=new Ht,this.internal=new zt(t),d()&&(this.sessionManager=new Gt(t,e),this.device=new jt,this.location=new Kt,this.user=new Bt(t,e),this.telemetryTrace=new Wt(void 0,void 0,void 0,e),this.session=new Vt),this.appId=function(){return null}}return e.prototype.applySessionContext=function(e,t){var n=this.session,r=this.sessionManager,i=n||r&&r.automaticSession;i&&k.isString(i.id)&&(e.ext.app.sesId=i.id),n&&(k.isString(n.id)?e.ext.app.sesId=n.id:e.ext.app.sesId=r.automaticSession.id)},e.prototype.applyOperatingSystemContxt=function(e,t){var n=this.os;n&&n.name&&(e.ext.os=n)},e.prototype.applyApplicationContext=function(e,t){var n=this.application;n&&(k.isString(n.ver)&&(e.tags[ct.applicationVersion]=n.ver),k.isString(n.build)&&(e.tags[ct.applicationBuild]=n.build))},e.prototype.applyDeviceContext=function(e,t){var n=this.device;n&&(k.isString(n.id)&&(e.ext.device.localId=n.id),k.isString(n.ip)&&(e.ext.device.ip=n.ip),k.isString(n.model)&&(e.ext.device.model=n.model),k.isString(n.deviceClass)&&(e.ext.device.deviceClass=n.deviceClass))},e.prototype.applyInternalContext=function(e,t){var n=this.internal;n&&(k.isString(n.agentVersion)&&(e.tags[ct.internalAgentVersion]=n.agentVersion),k.isString(n.sdkVersion)&&(e.tags[ct.internalSdkVersion]=n.sdkVersion),e.baseType!==W.dataType&&e.baseType!==$e.dataType||(k.isString(n.snippetVer)&&(e.tags[ct.internalSnippet]=n.snippetVer),k.isString(n.sdkSrc)&&(e.tags[ct.internalSdkSrc]=n.sdkSrc)))},e.prototype.applyLocationContext=function(e,t){var n=this.location;n&&k.isString(n.ip)&&(e.tags[ct.locationIp]=n.ip)},e.prototype.applyOperationContext=function(e,t){var n=this.telemetryTrace;if(n){var r=e.ext.trace||{traceID:void 0,parentID:void 0};k.isString(n.traceID)&&(r.traceID=n.traceID),k.isString(n.name)&&(r.name=n.name),k.isString(n.parentID)&&(r.parentID=n.parentID),e.ext.trace=r}},e.prototype.applyWebContext=function(e,t){var n=this.web;n&&(e.ext.web=e.ext.web||{},e.ext.web=n)},e.prototype.applyUserContext=function(e,t){var n=this.user;n&&(e.tags||(e.tags=[]),k.isString(n.accountId)&&(e.tags[ct.userAccountId]=n.accountId),k.isString(n.id)&&(e.ext.user.id=n.id),k.isString(n.authenticatedId)&&(e.ext.user.authId=n.authenticatedId))},e.prototype.cleanUp=function(e,t){e.ext[st.DeviceExt]&&0===k.objKeys(e.ext[st.DeviceExt]).length&&delete e.ext[st.DeviceExt],e.ext[st.UserExt]&&0===k.objKeys(e.ext[st.UserExt]).length&&delete e.ext[st.UserExt],e.ext[st.WebExt]&&0===k.objKeys(e.ext[st.WebExt]).length&&delete e.ext[st.WebExt],e.ext[st.OSExt]&&0===k.objKeys(e.ext[st.OSExt]).length&&delete e.ext[st.OSExt],e.ext[st.AppExt]&&0===k.objKeys(e.ext[st.AppExt]).length&&delete e.ext[st.AppExt],e.ext[st.TraceExt]&&0===k.objKeys(e.ext[st.TraceExt]).length&&delete e.ext[st.TraceExt]},e}(),Yt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.priority=110,t.identifier=ut,t}return __extends(t,e),t.getDefaultConfig=function(){return{instrumentationKey:function(){},accountId:function(){return null},sessionRenewalMs:function(){return 18e5},samplingPercentage:function(){return 100},sessionExpirationMs:function(){return 864e5},cookieDomain:function(){return null},sdkExtension:function(){return null},isBrowserLinkTrackingEnabled:function(){return!1},appId:function(){return null},namePrefix:function(){}}},t.prototype.initialize=function(n,r,i,o){var a=this;e.prototype.initialize.call(this,n,r,i,o);var s=this._getTelCtx(),c=this.identifier,u=t.getDefaultConfig();this._extensionConfig=this._extensionConfig||t.getDefaultConfig();var l=function(e){d._extensionConfig[e]=function(){return s.getConfig(c,e,u[e]())}},d=this;for(var f in u)l(f);this.context=new Xt(r.logger,this._extensionConfig),this._breezeChannel=Te.getExtension(i,lt),this.context.appId=function(){return a._breezeChannel?a._breezeChannel._appId:null}},t.prototype.processTelemetry=function(e,t){if(k.isNullOrUndefined(e));else{if(t=this._getTelCtx(t),e.name===$e.envelopeType&&t.diagLog().resetInternalMessageCount(),this.context.session&&"string"!=typeof this.context.session.id&&this.context.sessionManager.update(),this._processTelemetryInternal(e,t),this.context&&this.context.user&&this.context.user.isNewUser){this.context.user.isNewUser=!1;var n=new W(N.SendBrowserInfoOnUserInit,(g()||{}).userAgent||"");t.diagLog().logInternalMessage(R.CRITICAL,n)}this.processNext(e,t)}},t.prototype._processTelemetryInternal=function(e,t){e.tags||(e.tags=[]),e.ext||(e.ext={});var n=e.ext;n[st.DeviceExt]=n[st.DeviceExt]||{},n[st.WebExt]=n[st.WebExt]||{},n[st.UserExt]=n[st.UserExt]||{},n[st.OSExt]=n[st.OSExt]||{},n[st.AppExt]=n[st.AppExt]||{},n[st.TraceExt]=n[st.TraceExt]||{};var r=this.context;r.applySessionContext(e,t),r.applyApplicationContext(e,t),r.applyDeviceContext(e,t),r.applyOperationContext(e,t),r.applyUserContext(e,t),r.applyOperatingSystemContxt(e,t),r.applyWebContext(e,t),r.applyLocationContext(e,t),r.applyInternalContext(e,t),r.cleanUp(e,t)},t}(ie),Qt=["req","rsp","hkErr","fnErr"];function Jt(e,t){if(e)for(var n=0;n<e.length&&!t(e[n],n);n++);}function Zt(e,t,n,r,i){i>=0&&i<=2&&Jt(e,(function(e,o){var a=e.cbks,s=a[Qt[i]];if(s){t.ctx=function(){return r[o]=r[o]||{}};try{s.apply(t.inst,n)}catch(e){var c=t.err;try{var u=a[Qt[2]];u&&(t.err=e,u.apply(t.inst,n))}catch(e){}finally{t.err=c}}}}))}var $t=Object.getPrototypeOf;function en(e,t,n){var r=null;return e&&(k.hasOwnProperty(e,t)?r=e:n&&(r=en(function(e){if(e){if($t)return $t(e);var t=e.__proto__||e[s]||e.constructor;if(t)return t}return null}(e),t,!1))),r}function tn(e,t,n,r){if(void 0===r&&(r=!0),e&&t&&n){var i=en(e,t,r);if(i){var o=i[t];if(typeof o===c){var a=o._aiHooks;if(!a){var s=(l=a={i:0,n:t,f:o,h:[]},function(){var e=this,t=arguments,n=l.h,r={name:l.n,inst:e,ctx:null,set:s},i=[],o=a([r],t);function a(e,t){return Jt(t,(function(t){e.push(t)})),e}function s(e,n){(t=a([],t))[e]=n,o=a([r],t)}Zt(n,r,o,i,0);var c=l.f;try{r.rslt=c.apply(e,t)}catch(e){throw r.err=e,Zt(n,r,o,i,3),e}return Zt(n,r,o,i,1),r.rslt});s._aiHooks=a,i[t]=s}var u={id:a.i,cbks:n,rm:function(){var e=this.id;Jt(a.h,(function(t,n){if(t.id===e)return a.h.splice(n,1),1}))}};return a.i++,a.h.push(u),u}}}var l;return null}
/*!
 * Application Insights JavaScript SDK - Dependencies Plugin, 2.5.8
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
var nn=k.objKeys,rn=k.arrForEach;function on(e,t,n){var r=0,i=e[t],o=e[n];return i&&o&&(r=xe.GetDuration(i,o)),r}function an(e,t,n,r,i){var o=0,a=on(n,r,i);return a&&(o=sn(e,t,Te.msToTimeSpan(a))),o}function sn(e,t,n){var r=0;e&&t&&n&&((e.ajaxPerf=e.ajaxPerf||{})[t]=n,r=1);return r}var cn=function(){this.openDone=!1,this.setRequestHeaderDone=!1,this.sendDone=!1,this.abortDone=!1,this.stateChangeAttached=!1},un=function e(t,n,r){var i=r;this.perfMark=null,this.completed=!1,this.requestHeadersSize=null,this.requestHeaders=null,this.responseReceivingDuration=null,this.callbackDuration=null,this.ajaxTotalDuration=null,this.aborted=0,this.pageUrl=null,this.requestUrl=null,this.requestSize=0,this.method=null,this.status=null,this.requestSentTime=null,this.responseStartedTime=null,this.responseFinishedTime=null,this.callbackFinishedTime=null,this.endTime=null,this.xhrMonitoringState=new cn,this.clientFailure=0,this.traceID=t,this.spanID=n,B(e,this,(function(e){e.getAbsoluteUrl=function(){return e.requestUrl?Se.getAbsoluteUrl(e.requestUrl):null},e.getPathName=function(){return e.requestUrl?be.sanitizeUrl(i,Se.getCompleteUrl(e.method,e.requestUrl)):null},e.CreateTrackItem=function(t,n,r){if(e.ajaxTotalDuration=Math.round(1e3*xe.GetDuration(e.requestSentTime,e.responseFinishedTime))/1e3,e.ajaxTotalDuration<0)return null;var i,o=((i={id:"|"+e.traceID+"."+e.spanID,target:e.getAbsoluteUrl(),name:e.getPathName(),type:t,duration:e.ajaxTotalDuration,success:+e.status>=200&&+e.status<400,responseCode:+e.status,method:e.method}).properties={HttpMethod:e.method},i);if(function(e,t){var n=e.perfTiming,r=t.properties||{},i=0,o=k.isString,a="redirect",s=a+"Start",c=a="End";if(n){i|=an(r,a,n,s,c),i|=an(r,"domainLookup",n,"domainLookupStart","domainLookupEnd"),i|=an(r,"connect",n,"connectStart","connectEnd"),i|=an(r,"request",n,"requestStart","requestEnd"),i|=an(r,"response",n,"responseStart","responseEnd"),i|=an(r,"networkConnect",n,"startTime","connectEnd"),i|=an(r,"sentRequest",n,"requestStart","responseEnd");var u=n.duration;u||(u=on(n,"startTime","responseEnd")||0),i|=sn(r,"duration",u),i|=sn(r,"perfTotal",u);var l=n.serverTiming;if(l){var d={};rn(l,(function(e,t){var n=function(e){var t=e,n=/([^\w\d_$])/g;return n.test(e)&&(t=e.replace(n,"_")),t}(e.name||""+t),r=d[n]||{};rn(nn(e),(function(t){var n=e[t];("name"!==t&&o(n)||k.isNumber(n))&&(r[t]&&(n=r[t]+";"+n),!n&&o(n)||(r[t]=n))})),d[n]=r})),i|=sn(r,"serverTiming",d)}i|=sn(r,"transferSize",n.transferSize),i|=sn(r,"encodedBodySize",n.encodedBodySize),i|=sn(r,"decodedBodySize",n.decodedBodySize)}else e.perfMark&&(i|=sn(r,"missing",e.perfAttempts));i&&(t.properties=r)}(e,o),n&&nn(e.requestHeaders).length>0&&(o.properties=o.properties||{},o.properties.requestHeaders=e.requestHeaders),r){var a=r();if(a){var s=a.correlationContext;if(s&&(o.correlationContext=s),a.headerMap&&nn(a.headerMap).length>0&&(o.properties=o.properties||{},o.properties.responseHeaders=a.headerMap),e.status>=400){var c=a.type;o.properties=o.properties||{},""!==c&&"text"!==c||(o.properties.responseText=a.responseText?a.statusText+" - "+a.responseText:a.statusText),"json"===c&&(o.properties.responseText=a.response?a.statusText+" - "+JSON.stringify(a.response):a.statusText)}}}return o}}))},ln=function(){function e(t,n){this.traceFlag=e.DEFAULT_TRACE_FLAG,this.version=e.DEFAULT_VERSION,t&&e.isValidTraceId(t)?this.traceId=t:this.traceId=Te.generateW3CId(),n&&e.isValidSpanId(n)?this.spanId=n:this.spanId=Te.generateW3CId().substr(0,16)}return e.isValidTraceId=function(e){return e.match(/^[0-9a-f]{32}$/)&&"00000000000000000000000000000000"!==e},e.isValidSpanId=function(e){return e.match(/^[0-9a-f]{16}$/)&&"0000000000000000"!==e},e.prototype.toString=function(){return this.version+"-"+this.traceId+"-"+this.spanId+"-"+this.traceFlag},e.DEFAULT_TRACE_FLAG="01",e.DEFAULT_VERSION="00",e}(),dn=k.isNullOrUndefined,fn=k.arrForEach,pn=k.objKeys,hn=0;function gn(e){var t="";try{dn(e)||dn(e.ajaxData)||dn(e.ajaxData.requestUrl)||(t+="(url: '"+e.ajaxData.requestUrl+"')")}catch(e){}return t}function mn(e,t,n,r,i){e.diagLog().throwInternal(R.CRITICAL,t,n,r,i)}function vn(e,t,n,r,i){e.diagLog().throwInternal(R.WARNING,t,n,r,i)}function yn(e,t,n){return function(r){mn(e,t,n,{ajaxDiagnosticsMessage:gn(r.inst),exception:Te.dump(r.err)})}}function wn(e,t){return e&&t?e.indexOf(t):-1}var bn,Cn=function(e){function t(){var n=e.call(this)||this;n.identifier=t.identifier,n.priority=120;var r,i,a,c,l=v(),d=!1,f=!1,p=l&&l.host&&l.host.toLowerCase(),h=t.getEmptyConfig(),g=!1,m=0,w=!1,b=0,C=!1,E=[],I={};return B(t,n,(function(e,n){function l(e,t,n){E.push(function(e,t,n){return e?tn(e[s],t,n,!1):null}(e,t,n))}function v(e,t,n){var r=!1,i=((k.isString(t)?t:(t||{}).url||"")||"").toLowerCase(),o=wn(i,"?"),a=wn(i,"#");return(-1===o||-1!==a&&a<o)&&(o=a),-1!==o&&(i=i.substring(0,o)),dn(e)?dn(t)||(r="object"==typeof t&&!0===t[Re]||!!n&&!0===n[Re]):r=!0===e[Re]||!0===i[Re],r?I[i]||(I[i]=1):I[i]&&(r=!0),r}function T(e,t){var n=!0,r=f;return dn(e)||(n=!0===t||!dn(e.ajaxData)),r&&n}function S(e){try{var t=e.responseType;if(""===t||"text"===t)return e.responseText}catch(e){}return null}function _(t){try{var n=t.getAllResponseHeaders();if(null!==n)if(-1!==wn(n.toLowerCase(),we.requestContextHeaderLowerCase)){var r=t.getResponseHeader(we.requestContextHeader);return _e.getCorrelationContext(r)}}catch(n){vn(e,N.FailedMonitorAjaxGetCorrelationHeader,"Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",{ajaxDiagnosticsMessage:gn(t),exception:Te.dump(n)})}}function A(e,t){if(t.requestUrl&&c&&w){var n=y();if(n&&k.isFunction(n.mark)){hn++;var r=c+e+"#"+hn;n.mark(r);var i=n.getEntriesByName(r);i&&1===i.length&&(t.perfMark=i[0])}}}function x(e,t,n,r){var i=t.perfMark,o=y(),a=h.maxAjaxPerfLookupAttempts,s=h.ajaxPerfLookupDelay,c=t.requestUrl,u=0;!function l(){try{if(o&&i){u++;for(var d=null,f=o.getEntries(),p=f.length-1;p>=0;p--){var h=f[p];if(h){if("resource"===h.entryType)h.initiatorType!==e||-1===wn(h.name,c)&&-1===wn(c,h.name)||(d=h);else if("mark"===h.entryType&&h.name===i.name){t.perfTiming=d;break}if(h.startTime<i.startTime-1e3)break}}}!i||t.perfTiming||u>=a||!1===t.async?(i&&k.isFunction(o.clearMarks)&&o.clearMarks(i.name),t.perfAttempts=u,n()):setTimeout(l,s)}catch(e){r(e)}}()}function R(t){var n="";try{dn(t)||(n+="string"==typeof t?"(url: '"+t+"')":"(url: '"+t.url+"')")}catch(t){mn(e,N.FailedMonitorAjaxOpen,"Failed to grab failed fetch diagnostics message",{exception:Te.dump(t)})}return n}function P(t,n,r,i,o,a){function s(t,n,i){var o=i||{};o.fetchDiagnosticsMessage=R(r),n&&(o.exception=Te.dump(n)),vn(e,t,"Failed to calculate the duration of the fetch call, monitoring data for this fetch call won't be sent.",o)}i&&(i.responseFinishedTime=xe.Now(),i.status=n,x("fetch",i,(function(){var t=i.CreateTrackItem("Fetch",g,o);t?e.trackDependencyDataInternal(t):s(N.FailedMonitorAjaxDur,null,{requestSentTime:i.requestSentTime,responseFinishedTime:i.responseFinishedTime})}),(function(e){s(N.FailedMonitorAjaxGetCorrelationHeader,e,null)})))}function M(t){if(t&&t.headers)try{var n=t.headers.get(we.requestContextHeader);return _e.getCorrelationContext(n)}catch(n){vn(e,N.FailedMonitorAjaxGetCorrelationHeader,"Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",{fetchDiagnosticsMessage:R(t),exception:Te.dump(n)})}}e.initialize=function(p,m,y,I){if(!e.isInitialized()){n.initialize(p,m,y,I);var R=e._getTelCtx(),D=t.getDefaultConfig();fn(pn(D),(function(e){h[e]=R.getConfig(t.identifier,e,D[e])}));var L=h.distributedTracingMode;if(g=h.enableRequestHeaderTracking,w=h.enableAjaxPerfTracking,b=h.maxAjaxCallsPerView,C=h.enableResponseHeaderTracking,a=L===le.AI||L===le.AI_AND_W3C,i=L===le.AI_AND_W3C||L===le.W3C,w){var U=p.instrumentationKey||"unkwn";c=U.length>5?"ai.ajxmn."+U.substring(U.length-5)+".":"ai.ajxmn."+U+"."}if(!1===h.disableAjaxTracking&&function(e){var t=!1;if(typeof XMLHttpRequest!==o&&!dn(XMLHttpRequest)){var n=XMLHttpRequest[s];t=!(dn(n)||dn(n.open)||dn(n.send)||dn(n.abort))}var r=Te.getIEVersion();if(r&&r<9&&(t=!1),t)try{(new XMLHttpRequest).ajaxData={};var i=XMLHttpRequest[s].open;XMLHttpRequest[s].open=i}catch(n){t=!1,mn(e,N.FailedMonitorAjaxOpen,"Failed to enable XMLHttpRequest monitoring, extension is not supported",{exception:Te.dump(n)})}return t}(e)&&!f&&(l(XMLHttpRequest,"open",{req:function(t,n,i,o){var a=t.inst,s=a.ajaxData;v(a,i)||!T(a,!0)||s&&s.xhrMonitoringState.openDone||function(t,n,i,o){var a=r&&r.telemetryTrace&&r.telemetryTrace.traceID||Te.generateW3CId(),s=Te.generateW3CId().substr(0,16),c=new un(a,s,e.diagLog());c.method=n,c.requestUrl=i,c.xhrMonitoringState.openDone=!0,c.requestHeaders={},c.async=o,t.ajaxData=c,function(t){t.ajaxData.xhrMonitoringState.stateChangeAttached=O.Attach(t,"readystatechange",(function(){try{t&&4===t.readyState&&T(t)&&function(t){var n=t.ajaxData;function r(n,r){var i=r||{};i.ajaxDiagnosticsMessage=gn(t),n&&(i.exception=Te.dump(n)),vn(e,N.FailedMonitorAjaxDur,"Failed to calculate the duration of the ajax call, monitoring data for this ajax call won't be sent.",i)}n.responseFinishedTime=xe.Now(),n.status=t.status,x("xmlhttprequest",n,(function(){try{var i=n.CreateTrackItem("Ajax",g,(function(){var e={statusText:t.statusText,headerMap:null,correlationContext:_(t),type:t.responseType,responseText:S(t),response:t.response};if(C){var n=t.getAllResponseHeaders();if(n){var r=k.strTrim(n).split(/[\r\n]+/),i={};fn(r,(function(e){var t=e.split(": "),n=t.shift(),r=t.join(": ");i[n]=r})),e.headerMap=i}}return e}));i?e.trackDependencyDataInternal(i):r(null,{requestSentTime:n.requestSentTime,responseFinishedTime:n.responseFinishedTime})}finally{try{t.ajaxData=null}catch(e){}}}),(function(e){r(e,null)}))}(t)}catch(r){var n=Te.dump(r);n&&-1!==wn(n.toLowerCase(),"c00c023f")||mn(e,N.FailedMonitorAjaxRSC,"Failed to monitor XMLHttpRequest 'readystatechange' event handler, monitoring data for this ajax call may be incorrect.",{ajaxDiagnosticsMessage:gn(t),exception:n})}}))}(t)}(a,n,i,o)},hkErr:yn(e,N.FailedMonitorAjaxOpen,"Failed to monitor XMLHttpRequest.open, monitoring data for this ajax call may be incorrect.")}),l(XMLHttpRequest,"send",{req:function(t,n){var r=t.inst,i=r.ajaxData;T(r)&&!i.xhrMonitoringState.sendDone&&(A("xhr",i),i.requestSentTime=xe.Now(),r=e.includeCorrelationHeaders(i,void 0,void 0,r),i.xhrMonitoringState.sendDone=!0)},hkErr:yn(e,N.FailedMonitorAjaxSend,"Failed to monitor XMLHttpRequest, monitoring data for this ajax call may be incorrect.")}),l(XMLHttpRequest,"abort",{req:function(e){var t=e.inst,n=t.ajaxData;T(t)&&!n.xhrMonitoringState.abortDone&&(n.aborted=1,n.xhrMonitoringState.abortDone=!0)},hkErr:yn(e,N.FailedMonitorAjaxAbort,"Failed to monitor XMLHttpRequest.abort, monitoring data for this ajax call may be incorrect.")}),g&&l(XMLHttpRequest,"setRequestHeader",{req:function(e,t,n){var r=e.inst;T(r)&&(r.ajaxData.requestHeaders[t]=n)},hkErr:yn(e,N.FailedMonitorAjaxSetRequestHeader,"Failed to monitor XMLHttpRequest.setRequestHeader, monitoring data for this ajax call may be incorrect.")}),f=!0),function(){var t=(n=u(),!n||dn(n.Request)||dn(n.Request[s])||dn(n.fetch)?null:n.fetch);var n;if(!t)return;var i=u(),o=t.polyfill;!1===h.disableFetchTracking?(E.push(tn(i,"fetch",{req:function(t,n,i){var a;if(d&&!v(null,n,i)&&(!o||!f)){var s=t.ctx();a=function(t,n){var i=r&&r.telemetryTrace&&r.telemetryTrace.traceID||Te.generateW3CId(),o=Te.generateW3CId().substr(0,16),a=new un(i,o,e.diagLog());a.requestSentTime=xe.Now(),t instanceof Request?a.requestUrl=t?t.url:"":a.requestUrl=t;var s="GET";n&&n.method?s=n.method:t&&t instanceof Request&&(s=t.method);a.method=s;var c={};if(g){new Headers((n?n.headers:0)||t instanceof Request&&t.headers||{}).forEach((function(e,t){c[t]=e}))}return a.requestHeaders=c,A("fetch",a),a}(n,i);var c=e.includeCorrelationHeaders(a,n,i);c!==i&&t.set(1,c),s.data=a}},rsp:function(e,t){var n=e.ctx().data;n&&(e.rslt=e.rslt.then((function(t){return P(e,(t||{}).status,t,n,(function(){var e={statusText:t.statusText,headerMap:null,correlationContext:M(t)};if(C){var n={};t.headers.forEach((function(e,t){n[t]=e})),e.headerMap=n}return e})),t})).catch((function(r){throw P(e,0,t,n,null,{error:r.message}),r})))},hkErr:yn(e,N.FailedMonitorAjaxOpen,"Failed to monitor Window.fetch, monitoring data for this fetch call may be incorrect.")})),d=!0):o&&E.push(tn(i,"fetch",{req:function(e,t,n){v(null,t,n)}}));o&&(i.fetch.polyfill=o)}(),y.length>0&&y){for(var F=void 0,q=0;!F&&q<y.length;)y[q]&&y[q].identifier===ut&&(F=y[q]),q++;F&&(r=F.context)}}},e.teardown=function(){fn(E,(function(e){e.rm()})),E=[],d=!1,f=!1,e.setInitialized(!1)},e.trackDependencyData=function(t,n){e.trackDependencyDataInternal(t,n)},e.includeCorrelationHeaders=function(t,n,o,s){var c=e._currentWindowHost||p;if(n){if(_e.canIncludeCorrelationHeader(h,t.getAbsoluteUrl(),c)){if(o||(o={}),o.headers=new Headers(o.headers||n instanceof Request&&n.headers||{}),a){var u="|"+t.traceID+"."+t.spanID;o.headers.set(we.requestIdHeader,u),g&&(t.requestHeaders[we.requestIdHeader]=u)}if((d=h.appId||r&&r.appId())&&(o.headers.set(we.requestContextHeader,we.requestContextAppIdFormat+d),g&&(t.requestHeaders[we.requestContextHeader]=we.requestContextAppIdFormat+d)),i){var l=new ln(t.traceID,t.spanID);o.headers.set(we.traceParentHeader,l.toString()),g&&(t.requestHeaders[we.traceParentHeader]=l.toString())}}return o}if(s){if(_e.canIncludeCorrelationHeader(h,t.getAbsoluteUrl(),c)){if(a){u="|"+t.traceID+"."+t.spanID;s.setRequestHeader(we.requestIdHeader,u),g&&(t.requestHeaders[we.requestIdHeader]=u)}var d;if((d=h.appId||r&&r.appId())&&(s.setRequestHeader(we.requestContextHeader,we.requestContextAppIdFormat+d),g&&(t.requestHeaders[we.requestContextHeader]=we.requestContextAppIdFormat+d)),i){l=new ln(t.traceID,t.spanID);s.setRequestHeader(we.traceParentHeader,l.toString()),g&&(t.requestHeaders[we.traceParentHeader]=l.toString())}}return s}},e.trackDependencyDataInternal=function(t,n,r){if(-1===b||m<b){h.distributedTracingMode!==le.W3C&&h.distributedTracingMode!==le.AI_AND_W3C||"string"!=typeof t.id||"."===t.id[t.id.length-1]||(t.id+="."),k.isNullOrUndefined(t.startTime)&&(t.startTime=new Date);var i=at.create(t,et.dataType,et.envelopeType,e.diagLog(),n,r);e.core.track(i)}else m===b&&mn(e,N.MaxAjaxPerPVExceeded,"Maximum ajax per page view limit reached, ajax monitoring is paused until the next trackPageView(). In order to increase the limit set the maxAjaxCallsPerView configuration parameter.",!0);++m}})),n}return __extends(t,e),t.getDefaultConfig=function(){return{maxAjaxCallsPerView:500,disableAjaxTracking:!1,disableFetchTracking:!0,disableCorrelationHeaders:!1,distributedTracingMode:le.AI,correlationHeaderExcludedDomains:["*.blob.core.windows.net","*.blob.core.chinacloudapi.cn","*.blob.core.cloudapi.de","*.blob.core.usgovcloudapi.net"],correlationHeaderDomains:void 0,appId:void 0,enableCorsCorrelation:!1,enableRequestHeaderTracking:!1,enableResponseHeaderTracking:!1,enableAjaxErrorStatusText:!1,enableAjaxPerfTracking:!1,maxAjaxPerfLookupAttempts:3,ajaxPerfLookupDelay:25}},t.getEmptyConfig=function(){var e=this.getDefaultConfig();return fn(pn(e),(function(t){e[t]=void 0})),e},t.prototype.processTelemetry=function(e,t){this.processNext(e,t)},t.identifier="AjaxDependencyPlugin",t}(ie),En=r,In=function(){function e(e){this._snippetVersion=""+(e.sv||e.version||""),e.queue=e.queue||[],e.version=e.version||2;var t=e.config||{};if(t.connectionString){var n=Me.parse(t.connectionString),r=n.ingestionendpoint;t.endpointUrl=r?r+"/v2/track":t.endpointUrl,t.instrumentationKey=n.instrumentationkey||t.instrumentationKey}this.appInsights=new vt,this.properties=new Yt,this.dependencies=new Cn,this.core=new ye,this.snippet=e,this.config=t,this.getSKUDefaults()}return e.prototype.trackEvent=function(e,t){this.appInsights.trackEvent(e,t)},e.prototype.trackPageView=function(e){var t=e||{};this.appInsights.trackPageView(t)},e.prototype.trackPageViewPerformance=function(e){var t=e||{};this.appInsights.trackPageViewPerformance(t)},e.prototype.trackException=function(e){!e.exception&&e.error&&(e.exception=e.error),this.appInsights.trackException(e)},e.prototype._onerror=function(e){this.appInsights._onerror(e)},e.prototype.trackTrace=function(e,t){this.appInsights.trackTrace(e,t)},e.prototype.trackMetric=function(e,t){this.appInsights.trackMetric(e,t)},e.prototype.startTrackPage=function(e){this.appInsights.startTrackPage(e)},e.prototype.stopTrackPage=function(e,t,n,r){this.appInsights.stopTrackPage(e,t,n,r)},e.prototype.startTrackEvent=function(e){this.appInsights.startTrackEvent(e)},e.prototype.stopTrackEvent=function(e,t,n){this.appInsights.stopTrackEvent(e,t,n)},e.prototype.addTelemetryInitializer=function(e){return this.appInsights.addTelemetryInitializer(e)},e.prototype.setAuthenticatedUserContext=function(e,t,n){void 0===n&&(n=!1),this.properties.context.user.setAuthenticatedUserContext(e,t,n)},e.prototype.clearAuthenticatedUserContext=function(){this.properties.context.user.clearAuthenticatedUserContext()},e.prototype.trackDependencyData=function(e){this.dependencies.trackDependencyData(e)},e.prototype.flush=function(e){var t=this;void 0===e&&(e=!0),J(this.core,(function(){return"AISKU.flush"}),(function(){k.arrForEach(t.core.getTransmissionControls(),(function(t){k.arrForEach(t,(function(t){t.flush(e)}))}))}),null,e)},e.prototype.onunloadFlush=function(e){void 0===e&&(e=!0),k.arrForEach(this.core.getTransmissionControls(),(function(t){k.arrForEach(t,(function(t){t.onunloadFlush?t.onunloadFlush():t.flush(e)}))}))},e.prototype.loadAppInsights=function(e){var t=this;void 0===e&&(e=!1);var n=this;if(e&&n.config.extensions&&n.config.extensions.length>0)throw new Error("Extensions not allowed in legacy mode");return J(n.core,(function(){return"AISKU.loadAppInsights"}),(function(){var r=[],i=new qt;r.push(i),r.push(n.properties),r.push(n.dependencies),r.push(n.appInsights),n.core.initialize(n.config,r),n.context=n.properties.context,bn&&n.context&&(n.context.internal.sdkSrc=bn),function(t){if(t){var r="";for(var i in k.isNullOrUndefined(n._snippetVersion)||(r+=n._snippetVersion),e&&(r+=".lg"),n.context&&n.context.internal&&(n.context.internal.snippetVer=r||"-"),n)k.isString(i)&&!k.isFunction(n[i])&&"_"!==i.substring(0,1)&&(t[i]=n[i])}}(n.snippet),n.emptyQueue(),n.pollInternalLogs(),n.addHousekeepingBeforeUnload(t)})),n},e.prototype.updateSnippetDefinitions=function(e){for(var t in this)k.isString(t)&&(e[t]=this[t])},e.prototype.emptyQueue=function(){try{if(Te.isArray(this.snippet.queue)){for(var e=this.snippet.queue.length,t=0;t<e;t++){(0,this.snippet.queue[t])()}this.snippet.queue=void 0,delete this.snippet.queue}}catch(e){e&&k.isFunction(e.toString)&&e.toString()}},e.prototype.pollInternalLogs=function(){this.core.pollInternalLogs()},e.prototype.addHousekeepingBeforeUnload=function(e){if(d()||p()){var t=function(){e.onunloadFlush(!1);var t=e.appInsights.core._extensions[ut];t&&t.context&&t.context._sessionManager&&t.context._sessionManager.backup()};if(!e.appInsights.config.disableFlushOnBeforeUnload){var n=k.addEventHandler("beforeunload",t);(n=k.addEventHandler("pagehide",t)||n)||(r=g())&&r.product&&"ReactNative"===r.product||e.appInsights.core.logger.throwInternal(R.CRITICAL,N.FailedToAddHandlerForOnBeforeUnload,"Could not add handler for beforeunload and pagehide")}e.appInsights.config.disableFlushOnUnload||k.addEventHandler("pagehide",t)}var r},e.prototype.getSKUDefaults=function(){this.config.diagnosticLogInterval=this.config.diagnosticLogInterval&&this.config.diagnosticLogInterval>0?this.config.diagnosticLogInterval:1e4},e}();
/*!
 * Application Insights JavaScript SDK - Web, 2.5.8
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */!function(){var e=null,t=["://az416426.vo.msecnd.net/"];try{var n=(document||{}).currentScript;n&&(e=n.src)}catch(e){}if(e)try{var r=e.toLowerCase();if(r)for(var i="",o=0;o<t.length;o++)if(-1!==r.indexof(t[o])){i="cdn"+(o+1),-1===r.indexOf("/scripts/")&&(-1!==r.indexOf("/next/")?i+="-next":-1!==r.indexOf("/beta/")&&(i+="-beta")),bn=i+"";break}}catch(e){}}();
/*!
 * Application Insights JavaScript SDK - Web, 2.5.8
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
var Tn=function(){function e(t,n){this._hasLegacyInitializers=!1,this._queue=[],this.config=e.getDefaultConfig(t.config),this.appInsightsNew=n,this.context={addTelemetryInitializer:this.addTelemetryInitializers.bind(this)}}return e.getDefaultConfig=function(e){return e||(e={}),e.endpointUrl=e.endpointUrl||"https://dc.services.visualstudio.com/v2/track",e.sessionRenewalMs=18e5,e.sessionExpirationMs=864e5,e.maxBatchSizeInBytes=e.maxBatchSizeInBytes>0?e.maxBatchSizeInBytes:102400,e.maxBatchInterval=isNaN(e.maxBatchInterval)?15e3:e.maxBatchInterval,e.enableDebug=Te.stringToBoolOrDefault(e.enableDebug),e.disableExceptionTracking=Te.stringToBoolOrDefault(e.disableExceptionTracking),e.disableTelemetry=Te.stringToBoolOrDefault(e.disableTelemetry),e.verboseLogging=Te.stringToBoolOrDefault(e.verboseLogging),e.emitLineDelimitedJson=Te.stringToBoolOrDefault(e.emitLineDelimitedJson),e.diagnosticLogInterval=e.diagnosticLogInterval||1e4,e.autoTrackPageVisitTime=Te.stringToBoolOrDefault(e.autoTrackPageVisitTime),(isNaN(e.samplingPercentage)||e.samplingPercentage<=0||e.samplingPercentage>=100)&&(e.samplingPercentage=100),e.disableAjaxTracking=Te.stringToBoolOrDefault(e.disableAjaxTracking),e.maxAjaxCallsPerView=isNaN(e.maxAjaxCallsPerView)?500:e.maxAjaxCallsPerView,e.isBeaconApiDisabled=Te.stringToBoolOrDefault(e.isBeaconApiDisabled,!0),e.disableCorrelationHeaders=Te.stringToBoolOrDefault(e.disableCorrelationHeaders),e.correlationHeaderExcludedDomains=e.correlationHeaderExcludedDomains||["*.blob.core.windows.net","*.blob.core.chinacloudapi.cn","*.blob.core.cloudapi.de","*.blob.core.usgovcloudapi.net"],e.disableFlushOnBeforeUnload=Te.stringToBoolOrDefault(e.disableFlushOnBeforeUnload),e.disableFlushOnUnload=Te.stringToBoolOrDefault(e.disableFlushOnUnload,e.disableFlushOnBeforeUnload),e.enableSessionStorageBuffer=Te.stringToBoolOrDefault(e.enableSessionStorageBuffer,!0),e.isRetryDisabled=Te.stringToBoolOrDefault(e.isRetryDisabled),e.isCookieUseDisabled=Te.stringToBoolOrDefault(e.isCookieUseDisabled),e.isStorageUseDisabled=Te.stringToBoolOrDefault(e.isStorageUseDisabled),e.isBrowserLinkTrackingEnabled=Te.stringToBoolOrDefault(e.isBrowserLinkTrackingEnabled),e.enableCorsCorrelation=Te.stringToBoolOrDefault(e.enableCorsCorrelation),e},e.prototype.addTelemetryInitializers=function(e){var t=this;this._hasLegacyInitializers||(this.appInsightsNew.addTelemetryInitializer((function(e){t._processLegacyInitializers(e)})),this._hasLegacyInitializers=!0),this._queue.push(e)},e.prototype.startTrackPage=function(e){this.appInsightsNew.startTrackPage(e)},e.prototype.stopTrackPage=function(e,t,n,r){this.appInsightsNew.stopTrackPage(e,t,n)},e.prototype.trackPageView=function(e,t,n,r,i){var o={name:e,uri:t,properties:n,measurements:r};this.appInsightsNew.trackPageView(o)},e.prototype.trackEvent=function(e,t,n){this.appInsightsNew.trackEvent({name:e})},e.prototype.trackDependency=function(e,t,n,r,i,o,a){this.appInsightsNew.trackDependencyData({id:e,target:n,type:r,duration:i,properties:{HttpMethod:t},success:o,responseCode:a})},e.prototype.trackException=function(e,t,n,r,i){this.appInsightsNew.trackException({exception:e})},e.prototype.trackMetric=function(e,t,n,r,i,o){this.appInsightsNew.trackMetric({name:e,average:t,sampleCount:n,min:r,max:i})},e.prototype.trackTrace=function(e,t,n){this.appInsightsNew.trackTrace({message:e,severityLevel:n})},e.prototype.flush=function(e){this.appInsightsNew.flush(e)},e.prototype.setAuthenticatedUserContext=function(e,t,n){this.appInsightsNew.context.user.setAuthenticatedUserContext(e,t,n)},e.prototype.clearAuthenticatedUserContext=function(){this.appInsightsNew.context.user.clearAuthenticatedUserContext()},e.prototype._onerror=function(e,t,n,r,i){this.appInsightsNew._onerror({message:e,url:t,lineNumber:n,columnNumber:r,error:i})},e.prototype.startTrackEvent=function(e){this.appInsightsNew.startTrackEvent(e)},e.prototype.stopTrackEvent=function(e,t,n){this.appInsightsNew.stopTrackEvent(e,t,n)},e.prototype.downloadAndSetup=function(e){throw new Error("downloadAndSetup not implemented in web SKU")},e.prototype.updateSnippetDefinitions=function(e){for(var t in this)"string"==typeof t&&(e[t]=this[t])},e.prototype.loadAppInsights=function(){var e=this;if(this.config.iKey){var t=this.trackPageView;this.trackPageView=function(n,r,i){t.apply(e,[null,n,r,i])}}"function"==typeof this.snippet.logPageView&&(this.logPageView=function(t,n,r){e.trackPageView(null,t,n,r)});return"function"==typeof this.snippet.logEvent&&(this.logEvent=function(t,n,r){e.trackEvent(t,n,r)}),this},e.prototype._processLegacyInitializers=function(e){return e.tags[Pe]=this._queue,e},e}(),Sn=function(){function e(){}return e.getAppInsights=function(e,t){var n=new In(e),r=2!==t;if(2===t)return n.updateSnippetDefinitions(e),n.loadAppInsights(r),n;var i=new Tn(e,n);return i.updateSnippetDefinitions(e),n.loadAppInsights(r),i},e}();
/*!
 * Application Insights JavaScript SDK - Web, 2.5.8
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */},32:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.hashBlob=t.isGraphHostedContentUrl=t.storage=t.isUnknownObject=t.fixMessageLink=t.delay=t.safeStringify=t.cancellationNoThrow=t.cancellation=t.OperationCancelled=t.nop=t.filterNull=t.assert1=t.assertT=t.assert=void 0;const a=n(34),s=o(n(207));t.assert=function(e,t="value"){if(null==e)throw new Error(t+" must not be null or undefined");return e},t.assertT=function(e,t,n="value"){if("string"==typeof t&&typeof e!==t)throw new Error(`${n} is not of type ${t}`);if("function"==typeof t&&!t(e))throw new Error(n+" is not of the expected type");return e},t.assert1=function(e,t="value"){if(null==e)throw new Error(t+" must not be null or undefined")},t.filterNull=function(e){return null!==e},t.nop=function(){};class c extends Error{constructor(){super("Cancelled by user request")}}t.OperationCancelled=c,t.cancellation=function(){let e=!1;return[function(){e=!0},function(){if(e)throw new c}]},t.cancellationNoThrow=function(){let e=!1;return[function(){e=!0},function(){return e}]},t.safeStringify=function(e){if("string"==typeof e)return e;const t=new WeakSet,n=(e,n)=>{if("object"==typeof n&&null!==n){if(t.has(n))return"[already seen]";t.add(n)}return n};try{return JSON.stringify(e,n,4)}catch(e){return"[safeStringify: error]"}},t.delay=(e,t)=>new Promise((n,r)=>{let i=-1,o=-1,a=!1;const s=()=>{a&&(i>=0&&clearTimeout(i),o>=0&&clearInterval(o),i=o=-1)};if(t){const e=()=>{try{if(t())return a=!0,n(),!0}catch(e){return a=!0,r(new c),!0}finally{s()}return!1};if(e())return;o=setInterval(e,50)}i=setTimeout(()=>{a=!0,n(),s()},e)}),t.fixMessageLink=function(e){if("string"!=typeof e||""===e.trim())return"";try{const t=new URL(e);return t.pathname=decodeURIComponent(t.pathname),t.toString()}catch(e){return a.warn("invalid url",e),""}},t.isUnknownObject=function(e){return null!==e&&"object"==typeof e},t.storage=(()=>{const e="firefox"===s.getParser(navigator.userAgent).getBrowserName(!0),n=navigator.storage&&"function"==typeof navigator.storage.persist&&"function"==typeof navigator.storage.persisted,r=function(){try{return window.self!==window.top}catch(e){return!0}}();let i=!0;return async function(){if(n&&!await navigator.storage.persisted())for(i=!1;!(i=await navigator.storage.persisted());)e||(i=await navigator.storage.persist()),await t.delay(2e4)}().catch(a.error),Object.freeze({granted:()=>i,askForPermission:n&&e,needNewWindow:r&&e})})();const u=/^https:\/\/graph\.microsoft\.com\/beta\/teams\/[a-zA-Z0-9-]{36}\/channels\/[^/]+\/messages\/[0-9]+\/(replies\/[0-9]+\/)?hostedContents\//i.compile(),l=/^https:\/\/graph\.microsoft\.com\/beta\/chats\/[^/]+\/messages\/[0-9]+\/hostedContents\//i.compile();t.isGraphHostedContentUrl=function(e){try{new URL(e)}catch(e){return!1}return u.test(e)||l.test(e)},t.hashBlob=async function(e){const t=await function(e){if(e.arrayBuffer)return e.arrayBuffer();{const t=new FileReader;return t.readAsArrayBuffer(e),new Promise((function(e,n){t.onload=t.onerror=function(r){t.onload=t.onerror=null,"load"===r.type&&t.result instanceof ArrayBuffer?e(t.result):n(new Error("Failed to read the blob"))}}))}}(e);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",t))).map(e=>e.toString(16).padStart(2,"0")).join("")}},34:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.traceAsync=t.trace=t.error=t.warn=t.info=void 0;const r=n(32),i=n(53);t.info=function(...e){console.log(...e),e.filter(r.isUnknownObject).forEach(console.dir)},t.warn=function(...e){console.warn(...e),e.filter(r.isUnknownObject).forEach(console.dir)},t.error=function(...e){console.error(...e),e.filter(r.isUnknownObject).forEach(console.dir)},t.trace=function(e,t,n){const i=n.value,o=n.value.name;return n.value=function(...e){console.group(o);const t=performance.now();try{const n=i.apply(this,e);return r.isUnknownObject(n)&&"function"==typeof n.then&&console.warn(`trace: ${o} returned a promise. measured execution time may be wrong.`),n}finally{const e=(performance.now()-t).toFixed(1);console.info(`${o} took ${e}ms`),console.groupEnd()}},n},t.traceAsync=function(e=!1){return function(t,n,r){const o=r.value,a=r.value.name;return r.value=async function(...t){console.group(a);const n=performance.now();try{e&&i.AI.startTrackEvent(a);return await o.apply(this,t)}finally{e&&i.AI.stopTrackEvent(a);const t=(performance.now()-n).toFixed(1);console.info(`${a} took ${t}ms`),console.groupEnd()}},r}}},484:function(e,t,n){e.exports=n(485)},485:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const a=o(n(54)),s=n(32),c=n(129),u=n(53);a.initialize((async function(){try{const e=await c.client.handleRedirectPromise();null===e?(a.authentication.notifyFailure("no redirect resonse"),u.AI.trackEvent({name:"AuthResponseNull"})):a.authentication.notifySuccess(JSON.stringify(e))}catch(e){u.AI.trackException({error:e}),s.isUnknownObject(e)&&"name"in e&&"message"in e?a.authentication.notifyFailure(`${e.name}: ${e.message}`):a.authentication.notifyFailure("Unexpected error")}}))},53:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AI=void 0;const r=n(212);const i=function(){{const e={config:{instrumentationKey:"0b53b004-005f-46be-8fc1-63b98d9654e4",maxBatchInterval:5e3,maxAjaxCallsPerView:-1,disableDataLossAnalysis:!1,enableUnhandledPromiseRejectionTracking:!0,disableFetchTracking:!1}},t=new r.ApplicationInsights(e);return t.loadAppInsights(),t.trackPageView(),t}}();t.AI=Object.freeze({custom:function(e){i&&e&&e(i)},trackException:function(e){null==i||i.trackException(e)},trackEvent:function(e,t){null==i||i.trackEvent(e,t)},trackMetric:function(e,t){null==i||i.trackMetric(e,t)},trackTrace:function(e,t){null==i||i.trackTrace(e,t)},startTrackEvent:function(e){null==i||i.startTrackEvent(e)},stopTrackEvent:function(e,t,n){null==i||i.stopTrackEvent(e,t,n)},flushBuffer:function(){null==i||i.flush()},setAuthenticatedUserContext:function(e,t){null==i||i.setAuthenticatedUserContext(e,t,!0)}})},54:function(e,t,n){window,e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=8)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.initializeCalled=!1,e.initializeCompleted=!1,e.additionalValidOrigins=[],e.additionalValidOriginsRegexp=null,e.initializeCallbacks=[],e.isFramelessWindow=!1,e.parentMessageQueue=[],e.childMessageQueue=[],e.nextMessageId=0,e.handlers={},e.callbacks={},e.printCapabilityEnabled=!1,e}();t.GlobalVars=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=n(3),o=n(0),a=n(2);function s(e){if("id"in e.data&&"number"==typeof e.data.id){var t=e.data,n=o.GlobalVars.callbacks[t.id];n&&(n.apply(null,t.args),delete o.GlobalVars.callbacks[t.id])}else if("func"in e.data&&"string"==typeof e.data.func){t=e.data;var r=o.GlobalVars.handlers[t.func];r&&r.apply(this,t.args)}}function c(e){return e===o.GlobalVars.parentWindow?o.GlobalVars.parentMessageQueue:e===o.GlobalVars.childWindow?o.GlobalVars.childMessageQueue:[]}function u(e){return e===o.GlobalVars.parentWindow?o.GlobalVars.parentOrigin:e===o.GlobalVars.childWindow?o.GlobalVars.childOrigin:null}function l(e){for(var t=u(e),n=c(e);e&&t&&n.length>0;)e.postMessage(n.shift(),t)}function d(e,t){var n=o.GlobalVars.parentWindow,r=function(e,t){return{id:o.GlobalVars.nextMessageId++,func:e,args:t||[]}}(e,t);if(o.GlobalVars.isFramelessWindow)o.GlobalVars.currentWindow&&o.GlobalVars.currentWindow.nativeInterface&&o.GlobalVars.currentWindow.nativeInterface.framelessPostMessage(JSON.stringify(r));else{var i=u(n);n&&i?n.postMessage(r,i):c(n).push(r)}return r.id}function f(e,t){var n=o.GlobalVars.childWindow,r=function(e,t){return{id:e,args:t||[]}}(e,t),i=u(n);n&&i&&n.postMessage(r,i)}function p(e,t){var n=o.GlobalVars.childWindow,r=function(e,t){return{func:e,args:t||[]}}(e,t),i=u(n);n&&i?n.postMessage(r,i):c(n).push(r)}o.GlobalVars.handlers.themeChange=function(e){o.GlobalVars.themeChangeHandler&&o.GlobalVars.themeChangeHandler(e),o.GlobalVars.childWindow&&p("themeChange",[e])},o.GlobalVars.handlers.fullScreenChange=function(e){o.GlobalVars.fullScreenChangeHandler&&o.GlobalVars.fullScreenChangeHandler(e)},o.GlobalVars.handlers.backButtonPress=function(){o.GlobalVars.backButtonPressHandler&&o.GlobalVars.backButtonPressHandler()||r.navigateBack()},o.GlobalVars.handlers.load=function(e){o.GlobalVars.loadHandler&&o.GlobalVars.loadHandler(e),o.GlobalVars.childWindow&&p("load",[e])},o.GlobalVars.handlers.beforeUnload=function(){var e=function(){d("readyToUnload",[])};o.GlobalVars.beforeUnloadHandler&&o.GlobalVars.beforeUnloadHandler(e)||e()},o.GlobalVars.handlers.changeSettings=function(){o.GlobalVars.changeSettingsHandler&&o.GlobalVars.changeSettingsHandler()},o.GlobalVars.handlers.startConversation=function(e,t,n,r){o.GlobalVars.onStartConversationHandler&&o.GlobalVars.onStartConversationHandler({subEntityId:e,conversationId:t,channelId:n,entityId:r})},o.GlobalVars.handlers.closeConversation=function(e,t,n,r){o.GlobalVars.onCloseConversationHandler&&o.GlobalVars.onCloseConversationHandler({subEntityId:e,conversationId:t,channelId:n,entityId:r})},t.ensureInitialized=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!o.GlobalVars.initializeCalled)throw new Error("The library has not yet been initialized");if(o.GlobalVars.frameContext&&e&&e.length>0){for(var n=!1,r=0;r<e.length;r++)if(e[r]===o.GlobalVars.frameContext){n=!0;break}if(!n)throw new Error("This call is not allowed in the '"+o.GlobalVars.frameContext+"' context")}},t.isAPISupportedByPlatform=function(e){void 0===e&&(e=i.defaultSDKVersionForCompatCheck);var t=a.compareSDKVersions(o.GlobalVars.clientSupportedSDKVersion,e);return!isNaN(t)&&t>=0},t.processMessage=function(e){if(e&&e.data&&"object"==typeof e.data){var t=e.source||e.originalEvent&&e.originalEvent.source,n=e.origin||e.originalEvent&&e.originalEvent.origin;(function(e,t){return!(o.GlobalVars.currentWindow&&e===o.GlobalVars.currentWindow||!(o.GlobalVars.currentWindow&&o.GlobalVars.currentWindow.location&&t&&t===o.GlobalVars.currentWindow.location.origin)&&!(i.validOriginRegExp.test(t.toLowerCase())||o.GlobalVars.additionalValidOriginsRegexp&&o.GlobalVars.additionalValidOriginsRegexp.test(t.toLowerCase())))})(t,n)&&(function(e,t){!o.GlobalVars.parentWindow||o.GlobalVars.parentWindow.closed||e===o.GlobalVars.parentWindow?(o.GlobalVars.parentWindow=e,o.GlobalVars.parentOrigin=t):o.GlobalVars.childWindow&&!o.GlobalVars.childWindow.closed&&e!==o.GlobalVars.childWindow||(o.GlobalVars.childWindow=e,o.GlobalVars.childOrigin=t),o.GlobalVars.parentWindow&&o.GlobalVars.parentWindow.closed&&(o.GlobalVars.parentWindow=null,o.GlobalVars.parentOrigin=null),o.GlobalVars.childWindow&&o.GlobalVars.childWindow.closed&&(o.GlobalVars.childWindow=null,o.GlobalVars.childOrigin=null),l(o.GlobalVars.parentWindow),l(o.GlobalVars.childWindow)}(t,n),t===o.GlobalVars.parentWindow?s(e):t===o.GlobalVars.childWindow&&function(e){if("id"in e.data&&"func"in e.data){var t=e.data,n=t.func?o.GlobalVars.handlers[t.func]:null;if(n){var r=n.apply(this,t.args);void 0!==r&&f(t.id,Array.isArray(r)?r:[r])}else{var i=d(t.func,t.args);o.GlobalVars.callbacks[i]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];o.GlobalVars.childWindow&&f(t.id,e)}}}}(e))}},t.handleParentMessage=s,t.processAdditionalValidOrigins=function(e){var t=o.GlobalVars.additionalValidOrigins.concat(e.filter((function(e){return"string"==typeof e&&i.userOriginUrlValidationRegExp.test(e)}))),n={};t=t.filter((function(e){return!n[e]&&(n[e]=!0,!0)})),o.GlobalVars.additionalValidOrigins=t,o.GlobalVars.additionalValidOrigins.length>0?o.GlobalVars.additionalValidOriginsRegexp=a.generateRegExpFromUrls(o.GlobalVars.additionalValidOrigins):o.GlobalVars.additionalValidOriginsRegexp=null},t.waitForMessageQueue=function(e,t){var n=o.GlobalVars.currentWindow.setInterval((function(){0===c(e).length&&(clearInterval(n),t())}),100)},t.sendMessageRequestToParent=d,t.sendMessageEventToChild=p},function(e,t,n){"use strict";function r(e){for(var t="^",n=e.split("."),r=0;r<n.length;r++)t+=(r>0?"[.]":"")+n[r].replace("*","[^/^.]+");return t+"$"}Object.defineProperty(t,"__esModule",{value:!0}),t.generateRegExpFromUrls=function(e){for(var t="",n=0;n<e.length;n++)t+=(0===n?"":"|")+r(e[n]);return new RegExp(t)},t.getGenericOnCompleteHandler=function(e){return function(t,n){if(!t)throw new Error(e||n)}},t.compareSDKVersions=function(e,t){if("string"!=typeof e||"string"!=typeof t)return NaN;var n=e.split("."),r=t.split(".");function i(e){return/^\d+$/.test(e)}if(!n.every(i)||!r.every(i))return NaN;for(;n.length<r.length;)n.push("0");for(;r.length<n.length;)r.push("0");for(var o=0;o<n.length;++o)if(n[o]!=r[o])return n[o]>r[o]?1:-1;return 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2);t.version="1.7.0",t.defaultSDKVersionForCompatCheck="1.6.0",t.validOrigins=["https://teams.microsoft.com","https://teams.microsoft.us","https://gov.teams.microsoft.us","https://dod.teams.microsoft.us","https://int.teams.microsoft.com","https://devspaces.skype.com","https://ssauth.skype.com","https://local.teams.office.com","https://local.teams.office.com:8080","https://msft.spoppe.com","https://*.sharepoint.com","https://*.sharepoint-df.com","https://*.sharepointonline.com","https://outlook.office.com","https://outlook-sdf.office.com","https://*.teams.microsoft.com","https://www.office.com","https://word.office.com","https://excel.office.com","https://powerpoint.office.com","https://www.officeppe.com","https://*.www.office.com","http://127.0.0.1:5000"],t.validOriginRegExp=r.generateRegExpFromUrls(t.validOrigins),t.userOriginUrlValidationRegExp=/^https\:\/\//},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=n(0),o=n(3),a=n(5),s=n(2),c=n(6);function u(e,t){if(!i.GlobalVars.initializeCalled){i.GlobalVars.initializeCalled=!0;var n=function(e){return r.processMessage(e)};i.GlobalVars.currentWindow=i.GlobalVars.currentWindow||window,i.GlobalVars.parentWindow=i.GlobalVars.currentWindow.parent!==i.GlobalVars.currentWindow.self?i.GlobalVars.currentWindow.parent:i.GlobalVars.currentWindow.opener,i.GlobalVars.parentWindow?i.GlobalVars.currentWindow.addEventListener("message",n,!1):(i.GlobalVars.isFramelessWindow=!0,window.onNativeMessage=r.handleParentMessage);try{i.GlobalVars.parentOrigin="*";var s=r.sendMessageRequestToParent("initialize",[o.version]);i.GlobalVars.callbacks[s]=function(e,t,n){void 0===n&&(n=o.defaultSDKVersionForCompatCheck),i.GlobalVars.frameContext=e,i.GlobalVars.hostClientType=t,i.GlobalVars.clientSupportedSDKVersion=n,i.GlobalVars.initializeCallbacks.forEach((function(e){return e()})),i.GlobalVars.initializeCallbacks=[],i.GlobalVars.initializeCompleted=!0}}finally{i.GlobalVars.parentOrigin=null}this._uninitialize=function(){i.GlobalVars.frameContext&&(d(null),f(null),p(null),g(null),h(null),c.logs.registerGetLogHandler(null)),"settings"===i.GlobalVars.frameContext&&a.settings.registerOnSaveHandler(null),"remove"===i.GlobalVars.frameContext&&a.settings.registerOnRemoveHandler(null),i.GlobalVars.isFramelessWindow||i.GlobalVars.currentWindow.removeEventListener("message",n,!1),i.GlobalVars.initializeCalled=!1,i.GlobalVars.initializeCompleted=!1,i.GlobalVars.initializeCallbacks=[],i.GlobalVars.additionalValidOrigins=[],i.GlobalVars.parentWindow=null,i.GlobalVars.parentOrigin=null,i.GlobalVars.parentMessageQueue=[],i.GlobalVars.childWindow=null,i.GlobalVars.childOrigin=null,i.GlobalVars.childMessageQueue=[],i.GlobalVars.nextMessageId=0,i.GlobalVars.callbacks={},i.GlobalVars.frameContext=null,i.GlobalVars.hostClientType=null,i.GlobalVars.isFramelessWindow=!1}}Array.isArray(t)&&r.processAdditionalValidOrigins(t),e&&(i.GlobalVars.initializeCompleted?e():i.GlobalVars.initializeCallbacks.push(e))}function l(){window.print()}function d(e){r.ensureInitialized(),i.GlobalVars.themeChangeHandler=e,e&&r.sendMessageRequestToParent("registerHandler",["themeChange"])}function f(e){r.ensureInitialized(),i.GlobalVars.fullScreenChangeHandler=e,e&&r.sendMessageRequestToParent("registerHandler",["fullScreen"])}function p(e){r.ensureInitialized(),i.GlobalVars.backButtonPressHandler=e,e&&r.sendMessageRequestToParent("registerHandler",["backButton"])}function h(e){r.ensureInitialized(),i.GlobalVars.loadHandler=e,e&&r.sendMessageRequestToParent("registerHandler",["load"])}function g(e){r.ensureInitialized(),i.GlobalVars.beforeUnloadHandler=e,e&&r.sendMessageRequestToParent("registerHandler",["beforeUnload"])}function m(e){r.ensureInitialized("content"),r.sendMessageRequestToParent("setFrameContext",[e])}t.initialize=u,t._initialize=function(e){i.GlobalVars.currentWindow=e},t._uninitialize=function(){},t.enablePrintCapability=function(){i.GlobalVars.printCapabilityEnabled||(i.GlobalVars.printCapabilityEnabled=!0,r.ensureInitialized(),document.addEventListener("keydown",(function(e){(e.ctrlKey||e.metaKey)&&80===e.keyCode&&(l(),e.cancelBubble=!0,e.preventDefault(),e.stopImmediatePropagation())})))},t.print=l,t.getContext=function(e){r.ensureInitialized();var t=r.sendMessageRequestToParent("getContext");i.GlobalVars.callbacks[t]=function(t){t.frameContext||(t.frameContext=i.GlobalVars.frameContext),e(t)}},t.registerOnThemeChangeHandler=d,t.registerFullScreenHandler=f,t.registerBackButtonHandler=p,t.navigateBack=function(e){r.ensureInitialized();var t=r.sendMessageRequestToParent("navigateBack",[]);i.GlobalVars.callbacks[t]=e||s.getGenericOnCompleteHandler("Back navigation is not supported in the current client or context.")},t.registerOnLoadHandler=h,t.registerBeforeUnloadHandler=g,t.registerChangeSettingsHandler=function(e){r.ensureInitialized("content"),i.GlobalVars.changeSettingsHandler=e,e&&r.sendMessageRequestToParent("registerHandler",["changeSettings"])},t.navigateCrossDomain=function(e,t){r.ensureInitialized("content","sidePanel","settings","remove","task");var n=r.sendMessageRequestToParent("navigateCrossDomain",[e]);i.GlobalVars.callbacks[n]=t||s.getGenericOnCompleteHandler("Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.")},t.getTabInstances=function(e,t){r.ensureInitialized();var n=r.sendMessageRequestToParent("getTabInstances",[t]);i.GlobalVars.callbacks[n]=e},t.getMruTabInstances=function(e,t){r.ensureInitialized();var n=r.sendMessageRequestToParent("getMruTabInstances",[t]);i.GlobalVars.callbacks[n]=e},t.shareDeepLink=function(e){r.ensureInitialized("content","sidePanel"),r.sendMessageRequestToParent("shareDeepLink",[e.subEntityId,e.subEntityLabel,e.subEntityWebUrl])},t.executeDeepLink=function(e,t){r.ensureInitialized("content","sidePanel","task");var n=r.sendMessageRequestToParent("executeDeepLink",[e]);i.GlobalVars.callbacks[n]=t||s.getGenericOnCompleteHandler()},t.navigateToTab=function(e,t){r.ensureInitialized();var n=r.sendMessageRequestToParent("navigateToTab",[e]);i.GlobalVars.callbacks[n]=t||s.getGenericOnCompleteHandler("Invalid internalTabInstanceId and/or channelId were/was provided")},t.setFrameContext=m,t.initializeWithFrameContext=function(e,t,n){u(t,n),m(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=n(0),o=n(2);!function(e){var t,n;i.GlobalVars.handlers["settings.save"]=function(e){var n=new a(e);t?t(n):n.notifySuccess()},i.GlobalVars.handlers["settings.remove"]=function(){var e=new s;n?n(e):e.notifySuccess()},e.setValidityState=function(e){r.ensureInitialized("settings","remove"),r.sendMessageRequestToParent("settings.setValidityState",[e])},e.getSettings=function(e){r.ensureInitialized("content","settings","remove");var t=r.sendMessageRequestToParent("settings.getSettings");i.GlobalVars.callbacks[t]=e},e.setSettings=function(e,t){r.ensureInitialized("content","settings");var n=r.sendMessageRequestToParent("settings.setSettings",[e]);i.GlobalVars.callbacks[n]=t||o.getGenericOnCompleteHandler()},e.registerOnSaveHandler=function(e){r.ensureInitialized("settings"),t=e,e&&r.sendMessageRequestToParent("registerHandler",["save"])},e.registerOnRemoveHandler=function(e){r.ensureInitialized("remove"),n=e,e&&r.sendMessageRequestToParent("registerHandler",["remove"])};var a=function(){function e(e){this.notified=!1,this.result=e||{}}return e.prototype.notifySuccess=function(){this.ensureNotNotified(),r.sendMessageRequestToParent("settings.save.success"),this.notified=!0},e.prototype.notifyFailure=function(e){this.ensureNotNotified(),r.sendMessageRequestToParent("settings.save.failure",[e]),this.notified=!0},e.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The SaveEvent may only notify success or failure once.")},e}(),s=function(){function e(){this.notified=!1}return e.prototype.notifySuccess=function(){this.ensureNotNotified(),r.sendMessageRequestToParent("settings.remove.success"),this.notified=!0},e.prototype.notifyFailure=function(e){this.ensureNotNotified(),r.sendMessageRequestToParent("settings.remove.failure",[e]),this.notified=!0},e.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The removeEvent may only notify success or failure once.")},e}()}(t.settings||(t.settings={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=n(0);!function(e){i.GlobalVars.handlers["log.request"]=function(){if(i.GlobalVars.getLogHandler){var e=i.GlobalVars.getLogHandler();r.sendMessageRequestToParent("log.receive",[e])}},e.registerGetLogHandler=function(e){r.ensureInitialized(),i.GlobalVars.getLogHandler=e,e&&r.sendMessageRequestToParent("registerHandler",["log.request"])}}(t.logs||(t.logs={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=n(0),o=n(2),a=function(){function e(){}return e.prototype.postMessage=function(e,t){r.ensureInitialized();var n=r.sendMessageRequestToParent("messageForChild",[e]);i.GlobalVars.callbacks[n]=t||o.getGenericOnCompleteHandler()},e.prototype.addEventListener=function(e,t){"message"===e&&(i.GlobalVars.handlers.messageForParent=t)},e}();t.ChildAppWindow=a;var s=function(){function e(){}return Object.defineProperty(e,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),e.prototype.postMessage=function(e,t){r.ensureInitialized("task");var n=r.sendMessageRequestToParent("messageForParent",[e]);i.GlobalVars.callbacks[n]=t||o.getGenericOnCompleteHandler()},e.prototype.addEventListener=function(e,t){"message"===e&&(i.GlobalVars.handlers.messageForChild=t)},e}();t.ParentAppWindow=s},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(9)),r(n(14))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(10);t.bot=r.bot;var i=n(11);t.menus=i.menus;var o=n(6);t.logs=o.logs;var a=n(12);t.enterFullscreen=a.enterFullscreen,t.exitFullscreen=a.exitFullscreen,t.getChatMembers=a.getChatMembers,t.getConfigSetting=a.getConfigSetting,t.getUserJoinedTeams=a.getUserJoinedTeams,t.openFilePreview=a.openFilePreview,t.sendCustomMessage=a.sendCustomMessage,t.showNotification=a.showNotification,t.sendCustomEvent=a.sendCustomEvent,t.registerCustomHandler=a.registerCustomHandler,t.uploadCustomApp=a.uploadCustomApp;var s=n(13);t.conversations=s.conversations},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(1);!function(e){e.sendQuery=function(e,t,n){i.ensureInitialized();var o=i.sendMessageRequestToParent("bot.executeQuery",[e]);r.GlobalVars.callbacks[o]=function(e,r){e?t(r):n(r)}},e.getSupportedCommands=function(e,t){i.ensureInitialized();var n=i.sendMessageRequestToParent("bot.getSupportedCommands");r.GlobalVars.callbacks[n]=function(n,r){n?e(r):t(r)}},e.authenticate=function(e,t,n){i.ensureInitialized();var o=i.sendMessageRequestToParent("bot.authenticate",[e]);r.GlobalVars.callbacks[o]=function(e,r){e?t(r):n(r)}},function(e){e.Results="Results",e.Auth="Auth"}(e.ResponseType||(e.ResponseType={}))}(t.bot||(t.bot={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=n(0);!function(e){var t,n,o,a=function(){this.enabled=!0};e.MenuItem=a,function(e){e.dropDown="dropDown",e.popOver="popOver"}(e.MenuListType||(e.MenuListType={})),i.GlobalVars.handlers.navBarMenuItemPress=function(e){t&&t(e)||(r.ensureInitialized(),r.sendMessageRequestToParent("handleNavBarMenuItemPress",[e]))},i.GlobalVars.handlers.actionMenuItemPress=function(e){n&&n(e)||(r.ensureInitialized(),r.sendMessageRequestToParent("handleActionMenuItemPress",[e]))},i.GlobalVars.handlers.setModuleView=function(e){o&&o(e)||(r.ensureInitialized(),r.sendMessageRequestToParent("viewConfigItemPress",[e]))},e.setUpViews=function(e,t){r.ensureInitialized(),o=t,r.sendMessageRequestToParent("setUpViews",[e])},e.setNavBarMenu=function(e,n){r.ensureInitialized(),t=n,r.sendMessageRequestToParent("setNavBarMenu",[e])},e.showActionMenu=function(e,t){r.ensureInitialized(),n=t,r.sendMessageRequestToParent("showActionMenu",[e])}}(t.menus||(t.menus={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=n(0),o=n(2);t.getUserJoinedTeams=function(e,t){r.ensureInitialized();var n=r.sendMessageRequestToParent("getUserJoinedTeams",[t]);i.GlobalVars.callbacks[n]=e},t.enterFullscreen=function(){r.ensureInitialized("content"),r.sendMessageRequestToParent("enterFullscreen",[])},t.exitFullscreen=function(){r.ensureInitialized("content"),r.sendMessageRequestToParent("exitFullscreen",[])},t.openFilePreview=function(e){r.ensureInitialized("content");var t=[e.entityId,e.title,e.description,e.type,e.objectUrl,e.downloadUrl,e.webPreviewUrl,e.webEditUrl,e.baseUrl,e.editFile,e.subEntityId];r.sendMessageRequestToParent("openFilePreview",t)},t.showNotification=function(e){r.ensureInitialized("content");var t=[e.message,e.notificationType];r.sendMessageRequestToParent("showNotification",t)},t.uploadCustomApp=function(e,t){r.ensureInitialized();var n=r.sendMessageRequestToParent("uploadCustomApp",[e]);i.GlobalVars.callbacks[n]=t||o.getGenericOnCompleteHandler()},t.sendCustomMessage=function(e,t,n){r.ensureInitialized();var o=r.sendMessageRequestToParent(e,t);return"function"==typeof n&&(i.GlobalVars.callbacks[o]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];n.apply(null,e)}),o},t.sendCustomEvent=function(e,t){if(r.ensureInitialized(),!i.GlobalVars.childWindow)throw new Error("The child window has not yet been initialized or is not present");r.sendMessageEventToChild(e,t)},t.registerCustomHandler=function(e,t){var n=this;r.ensureInitialized(),i.GlobalVars.handlers[e]=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t.apply(n,e)}},t.getChatMembers=function(e){r.ensureInitialized();var t=r.sendMessageRequestToParent("getChatMembers");i.GlobalVars.callbacks[t]=e},t.getConfigSetting=function(e,t){r.ensureInitialized();var n=r.sendMessageRequestToParent("getConfigSetting",[t]);i.GlobalVars.callbacks[n]=e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=n(0);!function(e){e.openConversation=function(e){r.ensureInitialized("content");var t=r.sendMessageRequestToParent("conversations.openConversation",[{title:e.title,subEntityId:e.subEntityId,conversationId:e.conversationId,channelId:e.channelId,entityId:e.entityId}]);i.GlobalVars.onCloseConversationHandler=e.onCloseConversation,i.GlobalVars.onStartConversationHandler=e.onStartConversation,i.GlobalVars.callbacks[t]=function(e,t){if(!e)throw new Error(t)}},e.closeConversation=function(){r.ensureInitialized("content"),r.sendMessageRequestToParent("conversations.closeConversation"),i.GlobalVars.onCloseConversationHandler=null,i.GlobalVars.onStartConversationHandler=null}}(t.conversations||(t.conversations={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(15);t.appInitialization=r.appInitialization;var i=n(16);t.authentication=i.authentication;var o=n(4);t.enablePrintCapability=o.enablePrintCapability,t.executeDeepLink=o.executeDeepLink,t.getContext=o.getContext,t.getMruTabInstances=o.getMruTabInstances,t.getTabInstances=o.getTabInstances,t.initialize=o.initialize,t.initializeWithFrameContext=o.initializeWithFrameContext,t.navigateBack=o.navigateBack,t.navigateCrossDomain=o.navigateCrossDomain,t.navigateToTab=o.navigateToTab,t.print=o.print,t.registerBackButtonHandler=o.registerBackButtonHandler,t.registerBeforeUnloadHandler=o.registerBeforeUnloadHandler,t.registerChangeSettingsHandler=o.registerChangeSettingsHandler,t.registerFullScreenHandler=o.registerFullScreenHandler,t.registerOnLoadHandler=o.registerOnLoadHandler,t.registerOnThemeChangeHandler=o.registerOnThemeChangeHandler,t.setFrameContext=o.setFrameContext,t.shareDeepLink=o.shareDeepLink;var a=n(5);t.settings=a.settings;var s=n(17);t.tasks=s.tasks;var c=n(7);t.ChildAppWindow=c.ChildAppWindow,t.ParentAppWindow=c.ParentAppWindow;var u=n(18);t.captureImage=u.captureImage,t.FileFormat=u.FileFormat},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=n(3);!function(e){e.notifyAppLoaded=function(){r.ensureInitialized(),r.sendMessageRequestToParent("appInitialization.appLoaded",[i.version])},e.notifySuccess=function(){r.ensureInitialized(),r.sendMessageRequestToParent("appInitialization.success",[i.version])},e.notifyFailure=function(e){r.ensureInitialized(),r.sendMessageRequestToParent("appInitialization.failure",[e.reason,e.message])}}(t.appInitialization||(t.appInitialization={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=n(0);!function(e){var t,n;function o(){s();try{i.GlobalVars.childWindow&&i.GlobalVars.childWindow.close()}finally{i.GlobalVars.childWindow=null,i.GlobalVars.childOrigin=null}}function a(e){t=e,o();var n=t.width||600,r=t.height||400;n=Math.min(n,i.GlobalVars.currentWindow.outerWidth-400),r=Math.min(r,i.GlobalVars.currentWindow.outerHeight-200);var a=document.createElement("a");a.href=t.url;var s=void 0!==i.GlobalVars.currentWindow.screenLeft?i.GlobalVars.currentWindow.screenLeft:i.GlobalVars.currentWindow.screenX,l=void 0!==i.GlobalVars.currentWindow.screenTop?i.GlobalVars.currentWindow.screenTop:i.GlobalVars.currentWindow.screenY;s+=i.GlobalVars.currentWindow.outerWidth/2-n/2,l+=i.GlobalVars.currentWindow.outerHeight/2-r/2,i.GlobalVars.childWindow=i.GlobalVars.currentWindow.open(a.href,"_blank","toolbar=no, location=yes, status=no, menubar=no, scrollbars=yes, top="+l+", left="+s+", width="+n+", height="+r),i.GlobalVars.childWindow?c():u("FailedToOpenWindow")}function s(){n&&(clearInterval(n),n=0),delete i.GlobalVars.handlers.initialize,delete i.GlobalVars.handlers.navigateCrossDomain}function c(){s(),n=i.GlobalVars.currentWindow.setInterval((function(){if(!i.GlobalVars.childWindow||i.GlobalVars.childWindow.closed)u("CancelledByUser");else{var e=i.GlobalVars.childOrigin;try{i.GlobalVars.childOrigin="*",r.sendMessageEventToChild("ping")}finally{i.GlobalVars.childOrigin=e}}}),100),i.GlobalVars.handlers.initialize=function(){return["authentication",i.GlobalVars.hostClientType]},i.GlobalVars.handlers.navigateCrossDomain=function(){return!1}}function u(e){try{t&&t.failureCallback&&t.failureCallback(e)}finally{t=null,o()}}function l(e,t,n){if(e){var r=document.createElement("a");r.href=decodeURIComponent(e),r.host&&r.host!==window.location.host&&"outlook.office.com"===r.host&&r.search.indexOf("client_type=Win32_Outlook")>-1&&(t&&"result"===t&&(n&&(r.href=d(r.href,"result",n)),i.GlobalVars.currentWindow.location.assign(d(r.href,"authSuccess",""))),t&&"reason"===t&&(n&&(r.href=d(r.href,"reason",n)),i.GlobalVars.currentWindow.location.assign(d(r.href,"authFailure",""))))}}function d(e,t,n){var r=e.indexOf("#"),i=-1===r?"#":e.substr(r);return i=i+"&"+t+(""!==n?"="+n:""),(e=-1===r?e:e.substr(0,r))+i}i.GlobalVars.handlers["authentication.authenticate.success"]=function(e){try{t&&t.successCallback&&t.successCallback(e)}finally{t=null,o()}},i.GlobalVars.handlers["authentication.authenticate.failure"]=u,e.registerAuthenticationHandlers=function(e){t=e},e.authenticate=function(e){var n=void 0!==e?e:t;if(r.ensureInitialized("content","sidePanel","settings","remove","task"),"desktop"===i.GlobalVars.hostClientType||"android"===i.GlobalVars.hostClientType||"ios"===i.GlobalVars.hostClientType||"rigel"===i.GlobalVars.hostClientType){var o=document.createElement("a");o.href=n.url;var s=r.sendMessageRequestToParent("authentication.authenticate",[o.href,n.width,n.height]);i.GlobalVars.callbacks[s]=function(e,t){e?n.successCallback(t):n.failureCallback(t)}}else a(n)},e.getAuthToken=function(e){r.ensureInitialized();var t=r.sendMessageRequestToParent("authentication.getAuthToken",[e.resources,e.claims,e.silent]);i.GlobalVars.callbacks[t]=function(t,n){t?e.successCallback(n):e.failureCallback(n)}},e.getUser=function(e){r.ensureInitialized();var t=r.sendMessageRequestToParent("authentication.getUser");i.GlobalVars.callbacks[t]=function(t,n){t?e.successCallback(n):e.failureCallback(n)}},e.notifySuccess=function(e,t){l(t,"result",e),r.ensureInitialized("authentication"),r.sendMessageRequestToParent("authentication.authenticate.success",[e]),r.waitForMessageQueue(i.GlobalVars.parentWindow,(function(){return setTimeout((function(){return i.GlobalVars.currentWindow.close()}),200)}))},e.notifyFailure=function(e,t){l(t,"reason",e),r.ensureInitialized("authentication"),r.sendMessageRequestToParent("authentication.authenticate.failure",[e]),r.waitForMessageQueue(i.GlobalVars.parentWindow,(function(){return setTimeout((function(){return i.GlobalVars.currentWindow.close()}),200)}))}}(t.authentication||(t.authentication={}))},function(e,t,n){"use strict";var r=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&(n[r[i]]=e[r[i]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=n(0),a=n(7);!function(e){e.startTask=function(e,t){i.ensureInitialized("content","sidePanel");var n=i.sendMessageRequestToParent("tasks.startTask",[e]);return o.GlobalVars.callbacks[n]=t,new a.ChildAppWindow},e.updateTask=function(e){i.ensureInitialized("content","sidePanel","task"),e.width,e.height;var t=r(e,["width","height"]);if(Object.keys(t).length)throw new Error("updateTask requires a taskInfo argument containing only width and height");i.sendMessageRequestToParent("tasks.updateTask",[e])},e.submitTask=function(e,t){i.ensureInitialized("content","sidePanel","task"),i.sendMessageRequestToParent("tasks.completeTask",[e,Array.isArray(t)?t:[t]])}}(t.tasks||(t.tasks={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(1);!function(e){e.Base64="base64"}(t.FileFormat||(t.FileFormat={})),t.captureImage=function(e){if(!e)throw new Error("[captureImage] Callback cannot be null");if(i.ensureInitialized("content","task"),r.GlobalVars.isFramelessWindow)if(i.isAPISupportedByPlatform("1.7.0")){var t=i.sendMessageRequestToParent("captureImage");r.GlobalVars.callbacks[t]=e}else e({errorCode:9e3},void 0);else e({errorCode:100},void 0)}}])}})}));
//# sourceMappingURL=authEnd.js.map