!function webpackUniversalModuleDefinition(n,s){"object"==typeof exports&&"object"==typeof module?module.exports=s():"function"==typeof define&&define.amd?define([],s):"object"==typeof exports?exports.tased=s():n.tased=s()}(window,(function(){return function(n){var s={};function __webpack_require__(m){if(s[m])return s[m].exports;var y=s[m]={i:m,l:!1,exports:{}};return n[m].call(y.exports,y,y.exports,__webpack_require__),y.l=!0,y.exports}return __webpack_require__.m=n,__webpack_require__.c=s,__webpack_require__.d=function(n,s,m){__webpack_require__.o(n,s)||Object.defineProperty(n,s,{enumerable:!0,get:m})},__webpack_require__.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},__webpack_require__.t=function(n,s){if(1&s&&(n=__webpack_require__(n)),8&s)return n;if(4&s&&"object"==typeof n&&n&&n.__esModule)return n;var m=Object.create(null);if(__webpack_require__.r(m),
Object.defineProperty(m,"default",{enumerable:!0,value:n}),2&s&&"string"!=typeof n)for(var y in n)__webpack_require__.d(m,y,function(s){return n[s]}.bind(null,y));return m},__webpack_require__.n=function(n){var s=n&&n.__esModule?function getDefault(){return n.default}:function getModuleExports(){return n};return __webpack_require__.d(s,"a",s),s},__webpack_require__.o=function(n,s){return Object.prototype.hasOwnProperty.call(n,s)},__webpack_require__.p="/scripts/",__webpack_require__(__webpack_require__.s=476)}({104:function(n,s,m){"use strict";m.r(s),m.d(s,"AuthError",(function(){return _})),m.d(s,"AuthErrorMessage",(function(){return C})),m.d(s,"BrowserAuthError",(function(){return ir})),m.d(s,"BrowserAuthErrorMessage",(function(){return nr})),m.d(s,"BrowserConfigurationAuthError",(function(){return dr})),m.d(s,"BrowserConfigurationAuthErrorMessage",(function(){return lr})),m.d(s,"InteractionRequiredAuthError",(function(){return Ut})),m.d(s,"LogLevel",(function(){return y})),
m.d(s,"Logger",(function(){return he})),m.d(s,"PublicClientApplication",(function(){return Tr}));var extendStatics=function(n,s){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var m in s)s.hasOwnProperty(m)&&(n[m]=s[m])})(n,s)};function __extends(n,s){function __(){this.constructor=n}extendStatics(n,s),n.prototype=null===s?Object.create(s):(__.prototype=s.prototype,new __)}var __assign=function(){return(__assign=Object.assign||function __assign(n){for(var s,m=1,y=arguments.length;m<y;m++)for(var C in s=arguments[m])Object.prototype.hasOwnProperty.call(s,C)&&(n[C]=s[C]);return n}).apply(this,arguments)};function __awaiter(n,s,m,y){return new(m||(m=Promise))((function(C,_){function fulfilled(n){try{step(y.next(n))}catch(n){_(n)}}function rejected(n){try{step(y.throw(n))}catch(n){_(n)}}function step(n){n.done?C(n.value):new m((function(s){s(n.value)})).then(fulfilled,rejected)}step((y=y.apply(n,s||[])).next())}))
}function __generator(n,s){var m,y,C,_,E={label:0,sent:function(){if(1&C[0])throw C[1];return C[1]},trys:[],ops:[]};return _={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(_[Symbol.iterator]=function(){return this}),_;function verb(_){return function(w){return function step(_){if(m)throw new TypeError("Generator is already executing.");for(;E;)try{if(m=1,y&&(C=2&_[0]?y.return:_[0]?y.throw||((C=y.return)&&C.call(y),0):y.next)&&!(C=C.call(y,_[1])).done)return C;switch(y=0,C&&(_=[2&_[0],C.value]),_[0]){case 0:case 1:C=_;break;case 4:return E.label++,{value:_[1],done:!1};case 5:E.label++,y=_[1],_=[0];continue;case 7:_=E.ops.pop(),E.trys.pop();continue;default:if(!(C=E.trys,(C=C.length>0&&C[C.length-1])||6!==_[0]&&2!==_[0])){E=0;continue}if(3===_[0]&&(!C||_[1]>C[0]&&_[1]<C[3])){E.label=_[1];break}if(6===_[0]&&E.label<C[1]){E.label=C[1],C=_;break}if(C&&E.label<C[2]){E.label=C[2],E.ops.push(_);break}C[2]&&E.ops.pop(),E.trys.pop();continue}_=s.call(n,E)}catch(n){
_=[6,n],y=0}finally{m=C=0}if(5&_[0])throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}([_,w])}}}function __spreadArrays(){for(var n=0,s=0,m=arguments.length;s<m;s++)n+=arguments[s].length;var y=Array(n),C=0;for(s=0;s<m;s++)for(var _=arguments[s],E=0,w=_.length;E<w;E++,C++)y[C]=_[E];return y}var extendStatics$1=function(n,s){return(extendStatics$1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var m in s)s.hasOwnProperty(m)&&(n[m]=s[m])})(n,s)};function __extends$1(n,s){function __(){this.constructor=n}extendStatics$1(n,s),n.prototype=null===s?Object.create(s):(__.prototype=s.prototype,new __)}var __assign$1=function(){return(__assign$1=Object.assign||function __assign(n){for(var s,m=1,y=arguments.length;m<y;m++)for(var C in s=arguments[m])Object.prototype.hasOwnProperty.call(s,C)&&(n[C]=s[C]);return n}).apply(this,arguments)};function __awaiter$1(n,s,m,y){return new(m||(m=Promise))((function(C,_){function fulfilled(n){try{
step(y.next(n))}catch(n){_(n)}}function rejected(n){try{step(y.throw(n))}catch(n){_(n)}}function step(n){n.done?C(n.value):new m((function(s){s(n.value)})).then(fulfilled,rejected)}step((y=y.apply(n,s||[])).next())}))}function __generator$1(n,s){var m,y,C,_,E={label:0,sent:function(){if(1&C[0])throw C[1];return C[1]},trys:[],ops:[]};return _={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(_[Symbol.iterator]=function(){return this}),_;function verb(_){return function(w){return function step(_){if(m)throw new TypeError("Generator is already executing.");for(;E;)try{if(m=1,y&&(C=2&_[0]?y.return:_[0]?y.throw||((C=y.return)&&C.call(y),0):y.next)&&!(C=C.call(y,_[1])).done)return C;switch(y=0,C&&(_=[2&_[0],C.value]),_[0]){case 0:case 1:C=_;break;case 4:return E.label++,{value:_[1],done:!1};case 5:E.label++,y=_[1],_=[0];continue;case 7:_=E.ops.pop(),E.trys.pop();continue;default:if(!(C=E.trys,(C=C.length>0&&C[C.length-1])||6!==_[0]&&2!==_[0])){E=0;continue}
if(3===_[0]&&(!C||_[1]>C[0]&&_[1]<C[3])){E.label=_[1];break}if(6===_[0]&&E.label<C[1]){E.label=C[1],C=_;break}if(C&&E.label<C[2]){E.label=C[2],E.ops.push(_);break}C[2]&&E.ops.pop(),E.trys.pop();continue}_=s.call(n,E)}catch(n){_=[6,n],y=0}finally{m=C=0}if(5&_[0])throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}([_,w])}}}var y,C={unexpectedError:{code:"unexpected_error",desc:"Unexpected error in authentication."}},_=function(n){function AuthError(s,m){var y=this,C=m?s+": "+m:s;return y=n.call(this,C)||this,Object.setPrototypeOf(y,AuthError.prototype),y.errorCode=s,y.errorMessage=m,y.name="AuthError",y}return __extends$1(AuthError,n),AuthError.createUnexpectedError=function(n){return new AuthError(C.unexpectedError.code,C.unexpectedError.desc+": "+n)},AuthError}(Error),E="1.2.0",w={code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},S={code:"client_info_empty_error",
desc:"The client info was empty. Please review the trace to determine the root cause."},I={code:"id_token_parsing_error",desc:"ID token cannot be parsed. Please review stack trace to determine root cause."},T={code:"null_or_empty_id_token",desc:"The idToken is null or empty. Please review the trace to determine the root cause."},A={code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},x={code:"invalid_authority_type",desc:"The given authority is not a valid type of authority supported by MSAL. Please review the trace to determine the root cause."},P={code:"hash_not_deserialized",desc:"The hash parameters could not be deserialized. Please review the trace to determine the root cause."},R={code:"invalid_state",desc:"State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState()."},k={code:"state_mismatch",
desc:"State mismatch error. Please check your network. Continued requests may cause cache overflow."},M={code:"nonce_mismatch",desc:"Nonce mismatch error. This may be caused by a race condition in concurrent requests."},O={code:"account_mismatch",desc:"The cached account and account which made the token request do not match."},N={code:"invalid_id_token",desc:"Invalid ID token format."},D={code:"no_tokens_found",desc:"No tokens were found for the given scopes, and no authorization code was passed to acquireToken. You must retrieve an authorization code before making a call to acquireToken()."},U={code:"cache_parse_error",desc:"Could not parse cache key."},L={code:"user_login_error",desc:"User login is required."},F={code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account."},q={code:"multiple_matching_accounts",
desc:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account"},H={code:"request_cannot_be_made",desc:"Token request cannot be made without authorization code or refresh token."},B={code:"cannot_append_empty_scope",desc:"Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info."},z={code:"cannot_remove_empty_scope",desc:"Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info."},j={code:"cannot_append_scopeset",desc:"Cannot append ScopeSet due to error."},W={code:"empty_input_scopeset",desc:"Empty input ScopeSet cannot be processed."},K={code:"device_code_polling_cancelled",desc:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true."},X={code:"device_code_expired",desc:"Device code is expired."},Y={code:"no_account_in_silent_request",
desc:"Please pass an account object, silent flow is not supported without account information"},J={code:"invalid_cache_record",desc:"Cache record object was null or undefined."},$={code:"invalid_cache_environment",desc:"Invalid environment when attempting to create cache entry"},Q={code:"no_account_found",desc:"No account found in cache for given key."},Z={code:"no cache plugin set on CacheManager",desc:"ICachePlugin needs to be set before using readFromStorage or writeFromStorage"},ee={code:"no_crypto_object",desc:"No crypto object detected. This is required for the following operation: "},te={code:"invalid_cache_type",desc:"Invalid cache type"},re={code:"unexpected_account_type",desc:"Unexpected account type."},ne={code:"unexpected_credential_type",desc:"Unexpected credential type."},ie={code:"invalid_assertion",desc:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515"},oe={code:"invalid_client_credential",
desc:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential"},ae=function(n){function ClientAuthError(s,m){var y=n.call(this,s,m)||this;return y.name="ClientAuthError",Object.setPrototypeOf(y,ClientAuthError.prototype),y}return __extends$1(ClientAuthError,n),ClientAuthError.createClientInfoDecodingError=function(n){return new ClientAuthError(w.code,w.desc+" Failed with error: "+n)},ClientAuthError.createClientInfoEmptyError=function(n){return new ClientAuthError(S.code,S.desc+" Given Object: "+n)},ClientAuthError.createIdTokenParsingError=function(n){return new ClientAuthError(I.code,I.desc+" Failed with error: "+n)},ClientAuthError.createIdTokenNullOrEmptyError=function(n){return new ClientAuthError(T.code,T.desc+" Raw ID Token Value: "+n)},ClientAuthError.createEndpointDiscoveryIncompleteError=function(n){return new ClientAuthError(A.code,A.desc+" Detail: "+n)},
ClientAuthError.createInvalidAuthorityTypeError=function(n){return new ClientAuthError(x.code,x.desc+" Given Url: "+n)},ClientAuthError.createHashNotDeserializedError=function(n){return new ClientAuthError(P.code,P.desc+" Given Object: "+n)},ClientAuthError.createInvalidStateError=function(n,s){return new ClientAuthError(R.code,R.desc+" Invalid State: "+n+", Root Err: "+s)},ClientAuthError.createStateMismatchError=function(){return new ClientAuthError(k.code,k.desc)},ClientAuthError.createNonceMismatchError=function(){return new ClientAuthError(M.code,M.desc)},ClientAuthError.createAccountMismatchError=function(){return new ClientAuthError(O.code,O.desc)},ClientAuthError.createInvalidIdTokenError=function(n){return new ClientAuthError(N.code,N.desc+" Given token: "+JSON.stringify(n))},ClientAuthError.createNoTokensFoundError=function(){return new ClientAuthError(D.code,D.desc)},ClientAuthError.createCacheParseError=function(n){return new ClientAuthError(U.code,U.desc+" Cache key: "+n)
},ClientAuthError.createUserLoginRequiredError=function(){return new ClientAuthError(L.code,L.desc)},ClientAuthError.createMultipleMatchingTokensInCacheError=function(n){return new ClientAuthError(F.code,"Cache error for scope "+n+": "+F.desc+".")},ClientAuthError.createMultipleMatchingAccountsInCacheError=function(){return new ClientAuthError(q.code,q.desc)},ClientAuthError.createTokenRequestCannotBeMadeError=function(){return new ClientAuthError(H.code,H.desc)},ClientAuthError.createAppendEmptyScopeToSetError=function(n){return new ClientAuthError(B.code,B.desc+" Given Scope: "+n)},ClientAuthError.createRemoveEmptyScopeFromSetError=function(n){return new ClientAuthError(z.code,z.desc+" Given Scope: "+n)},ClientAuthError.createAppendScopeSetError=function(n){return new ClientAuthError(j.code,j.desc+" Detail Error: "+n)},ClientAuthError.createEmptyInputScopeSetError=function(n){return new ClientAuthError(W.code,W.desc+" Given ScopeSet: "+n)},
ClientAuthError.createDeviceCodeCancelledError=function(){return new ClientAuthError(K.code,""+K.desc)},ClientAuthError.createDeviceCodeExpiredError=function(){return new ClientAuthError(X.code,""+X.desc)},ClientAuthError.createNoAccountInSilentRequestError=function(){return new ClientAuthError(Y.code,""+Y.desc)},ClientAuthError.createNullOrUndefinedCacheRecord=function(){return new ClientAuthError(J.code,J.desc)},ClientAuthError.createInvalidCacheEnvironmentError=function(){return new ClientAuthError($.code,$.desc)},ClientAuthError.createNoAccountFoundError=function(){return new ClientAuthError(Q.code,Q.desc)},ClientAuthError.createCachePluginError=function(){return new ClientAuthError(Z.code,""+Z.desc)},ClientAuthError.createNoCryptoObjectError=function(n){return new ClientAuthError(ee.code,""+ee.desc+n)},ClientAuthError.createInvalidCacheTypeError=function(){return new ClientAuthError(te.code,""+te.desc)},ClientAuthError.createUnexpectedAccountTypeError=function(){
return new ClientAuthError(re.code,""+re.desc)},ClientAuthError.createUnexpectedCredentialTypeError=function(){return new ClientAuthError(ne.code,""+ne.desc)},ClientAuthError.createInvalidAssertionError=function(){return new ClientAuthError(ie.code,""+ie.desc)},ClientAuthError.createInvalidCredentialError=function(){return new ClientAuthError(oe.code,""+oe.desc)},ClientAuthError}(_),se=function(){function StringUtils(){}return StringUtils.decodeJwt=function(n){if(StringUtils.isEmpty(n))throw ae.createIdTokenNullOrEmptyError(n);var s=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(n);if(!s||s.length<4)throw ae.createIdTokenParsingError("Given token is malformed: "+JSON.stringify(n));return{header:s[1],JWSPayload:s[2],JWSSig:s[3]}},StringUtils.isEmpty=function(n){return void 0===n||!n||0===n.length},StringUtils.startsWith=function(n,s){return 0===n.indexOf(s)},StringUtils.endsWith=function(n,s){return n.length>=s.length&&n.lastIndexOf(s)===n.length-s.length},
StringUtils.queryStringToObject=function(n){var s,m=/\+/g,y=/([^&=]+)=([^&]*)/g,decode=function(n){return decodeURIComponent(decodeURIComponent(n.replace(m," ")))},C={};for(s=y.exec(n);s;)C[decode(s[1])]=decode(s[2]),s=y.exec(n);return C},StringUtils.trimArrayEntries=function(n){return n.map((function(n){return n.trim()}))},StringUtils.removeEmptyStringsFromArray=function(n){return n.filter((function(n){return!StringUtils.isEmpty(n)}))},StringUtils}();!function(n){n[n.Error=0]="Error",n[n.Warning=1]="Warning",n[n.Info=2]="Info",n[n.Verbose=3]="Verbose"}(y||(y={}));var ce,ue,le,de,pe,fe,he=function(){function Logger(n){this.level=y.Info,n&&(this.localCallback=n.loggerCallback,this.piiLoggingEnabled=n.piiLoggingEnabled,this.level=n.logLevel)}return Logger.prototype.logMessage=function(n,s){if(!(s.logLevel>this.level||!this.piiLoggingEnabled&&s.containsPii)){
var m=(new Date).toUTCString(),C=(se.isEmpty(this.correlationId)?"["+m+"] : ":"["+m+"] : ["+this.correlationId+"]")+" : "+E+" : "+y[s.logLevel]+" - "+n;this.executeCallback(s.logLevel,C,s.containsPii)}},Logger.prototype.executeCallback=function(n,s,m){this.localCallback&&this.localCallback(n,s,m)},Logger.prototype.error=function(n,s){this.logMessage(n,{logLevel:y.Error,containsPii:!1,correlationId:s||""})},Logger.prototype.errorPii=function(n,s){this.logMessage(n,{logLevel:y.Error,containsPii:!0,correlationId:s||""})},Logger.prototype.warning=function(n,s){this.logMessage(n,{logLevel:y.Warning,containsPii:!1,correlationId:s||""})},Logger.prototype.warningPii=function(n,s){this.logMessage(n,{logLevel:y.Warning,containsPii:!0,correlationId:s||""})},Logger.prototype.info=function(n,s){this.logMessage(n,{logLevel:y.Info,containsPii:!1,correlationId:s||""})},Logger.prototype.infoPii=function(n,s){this.logMessage(n,{logLevel:y.Info,containsPii:!0,correlationId:s||""})},
Logger.prototype.verbose=function(n,s){this.logMessage(n,{logLevel:y.Verbose,containsPii:!1,correlationId:s||""})},Logger.prototype.verbosePii=function(n,s){this.logMessage(n,{logLevel:y.Verbose,containsPii:!0,correlationId:s||""})},Logger.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},Logger}(),ge="MSAL.JS",me="msal.js.common",ye="msal",ve="https://login.microsoftonline.com/common/",Ce="adfs",_e="https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",Ee="|",we="openid",Se="profile",be="offline_access",Ie="code",Te="S256",Ae="application/x-www-form-urlencoded;charset=utf-8",xe="authorization_pending",Pe="not_defined";!function(n){n.CONTENT_TYPE="Content-Type",n.X_CLIENT_CURR_TELEM="x-client-current-telemetry",n.X_CLIENT_LAST_TELEM="x-client-last-telemetry"}(ce||(ce={})),function(n){n.ID_TOKEN="idtoken",n.CLIENT_INFO="client.info",n.ADAL_ID_TOKEN="adal.idtoken",n.ERROR="error",n.ERROR_DESC="error.description"
}(ue||(ue={})),function(n){n.COMMON="common",n.ORGANIZATIONS="organizations",n.CONSUMERS="consumers"}(le||(le={})),function(n){n.CLIENT_ID="client_id",n.REDIRECT_URI="redirect_uri",n.RESPONSE_TYPE="response_type",n.RESPONSE_MODE="response_mode",n.GRANT_TYPE="grant_type",n.CLAIMS="claims",n.SCOPE="scope",n.ERROR="error",n.ERROR_DESCRIPTION="error_description",n.ACCESS_TOKEN="access_token",n.ID_TOKEN="id_token",n.REFRESH_TOKEN="refresh_token",n.EXPIRES_IN="expires_in",n.STATE="state",n.NONCE="nonce",n.PROMPT="prompt",n.SESSION_STATE="session_state",n.CLIENT_INFO="client_info",n.CODE="code",n.CODE_CHALLENGE="code_challenge",n.CODE_CHALLENGE_METHOD="code_challenge_method",n.CODE_VERIFIER="code_verifier",n.CLIENT_REQUEST_ID="client-request-id",n.X_CLIENT_SKU="x-client-SKU",n.X_CLIENT_VER="x-client-VER",n.X_CLIENT_OS="x-client-OS",n.X_CLIENT_CPU="x-client-CPU",n.POST_LOGOUT_URI="post_logout_redirect_uri",n.DEVICE_CODE="device_code",n.CLIENT_SECRET="client_secret",
n.CLIENT_ASSERTION="client_assertion",n.CLIENT_ASSERTION_TYPE="client_assertion_type"}(de||(de={})),function(n){n.ISSUER="iss",n.OBJID="oid",n.SUBJECT="sub",n.TENANTID="tid",n.VERSION="ver",n.PREF_USERNAME="preferred_username",n.NAME="name",n.NONCE="nonce",n.EXPIRATION="exp",n.HOME_OBJID="home_oid",n.SESSIONID="sid",n.CLOUD_INSTANCE_HOSTNAME="cloud_instance_host_name"}(pe||(pe={})),function(n){n.ACCESS_TOKEN="access_token",n.XMS_CC="xms_cc"}(fe||(fe={}));var Re,ke={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"};!function(n){n.ACCOUNT="account",n.SID="sid",n.LOGIN_HINT="login_hint",n.ID_TOKEN="id_token",n.DOMAIN_HINT="domain_hint",n.ORGANIZATIONS="organizations",n.CONSUMERS="consumers",n.ACCOUNT_ID="accountIdentifier",n.HOMEACCOUNT_ID="homeAccountIdentifier"}(Re||(Re={}));Re.SID,Re.LOGIN_HINT;var Me,Oe,Ne,De,Ue,Le,Fe,qe={PLAIN:"plain",S256:"S256"};!function(n){n.QUERY="query",n.FRAGMENT="fragment",n.FORM_POST="form_post"}(Me||(Me={})),function(n){
n.IMPLICIT_GRANT="implicit",n.AUTHORIZATION_CODE_GRANT="authorization_code",n.CLIENT_CREDENTIALS_GRANT="client_credentials",n.RESOURCE_OWNER_PASSWORD_GRANT="password",n.REFRESH_TOKEN_GRANT="refresh_token",n.DEVICE_CODE_GRANT="device_code"}(Oe||(Oe={})),function(n){n.MSSTS_ACCOUNT_TYPE="MSSTS",n.ADFS_ACCOUNT_TYPE="ADFS",n.MSAV1_ACCOUNT_TYPE="MSA",n.GENERIC_ACCOUNT_TYPE="Generic"}(Ne||(Ne={})),function(n){n.CACHE_KEY_SEPARATOR="-",n.CLIENT_INFO_SEPARATOR="."}(De||(De={})),function(n){n.ID_TOKEN="IdToken",n.ACCESS_TOKEN="AccessToken",n.REFRESH_TOKEN="RefreshToken"}(Ue||(Ue={})),function(n){n.ACCOUNT="Account",n.CREDENTIAL="Credential",n.APP_METADATA="AppMetadata",n.TEMPORARY="TempCache",n.TELEMETRY="Telemetry"}(Le||(Le={})),function(n){n[n.ADFS=1001]="ADFS",n[n.MSA=1002]="MSA",n[n.MSSTS=1003]="MSSTS",n[n.GENERIC=1004]="GENERIC",n[n.ACCESS_TOKEN=2001]="ACCESS_TOKEN",n[n.REFRESH_TOKEN=2002]="REFRESH_TOKEN",n[n.ID_TOKEN=2003]="ID_TOKEN",n[n.APP_METADATA=3001]="APP_METADATA"}(Fe||(Fe={}))
;var Ve={SCHEMA_VERSION:2,FAILURE_LIMIT:3,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:","},He=function(){function CredentialEntity(){}return CredentialEntity.prototype.generateAccountId=function(){return CredentialEntity.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},CredentialEntity.prototype.generateCredentialId=function(){return CredentialEntity.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},CredentialEntity.prototype.generateTarget=function(){return CredentialEntity.generateTargetForCacheKey(this.target)},CredentialEntity.prototype.generateCredentialKey=function(){return CredentialEntity.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId)},CredentialEntity.prototype.generateType=function(){switch(this.credentialType){case Ue.ID_TOKEN:return Fe.ID_TOKEN;case Ue.ACCESS_TOKEN:return Fe.ACCESS_TOKEN
;case Ue.REFRESH_TOKEN:return Fe.REFRESH_TOKEN;default:throw ae.createUnexpectedCredentialTypeError()}},CredentialEntity.getCredentialType=function(n){return-1!==n.indexOf(Ue.ACCESS_TOKEN.toLowerCase())?Ue.ACCESS_TOKEN:-1!==n.indexOf(Ue.ID_TOKEN.toLowerCase())?Ue.ID_TOKEN:-1!==n.indexOf(Ue.REFRESH_TOKEN.toLowerCase())?Ue.REFRESH_TOKEN:Pe},CredentialEntity.generateCredentialCacheKey=function(n,s,m,y,C,_,E){return[this.generateAccountIdForCacheKey(n,s),this.generateCredentialIdForCacheKey(m,y,C,E),this.generateTargetForCacheKey(_)].join(De.CACHE_KEY_SEPARATOR).toLowerCase()},CredentialEntity.generateAccountIdForCacheKey=function(n,s){return[n,s].join(De.CACHE_KEY_SEPARATOR).toLowerCase()},CredentialEntity.generateCredentialIdForCacheKey=function(n,s,m,y){return[n,n===Ue.REFRESH_TOKEN&&y||s,m||""].join(De.CACHE_KEY_SEPARATOR).toLowerCase()},CredentialEntity.generateTargetForCacheKey=function(n){return(n||"").toLowerCase()},CredentialEntity}(),Be={code:"redirect_uri_empty",
desc:"A redirect URI is required for all calls, and none has been set."},Ge={code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},ze={code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},je={code:"authority_uri_insecure",desc:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},We={code:"url_parse_error",desc:"URL could not be parsed into appropriate segments."},Ke={code:"empty_url_error",desc:"URL was empty or null."},Xe={code:"empty_input_scopes_error",desc:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token."},Ye={code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},Je={code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},$e={
code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent' and 'none'.  Please see here for valid configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},Qe={code:"invalid_claims",desc:"Given claims parameter must be a stringified JSON object."},Ze={code:"token_request_empty",desc:"Token request was empty and not found in cache."},et={code:"logout_request_empty",desc:"The logout request was null or undefined."},tt={code:"invalid_code_challenge_method",desc:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".'},rt={code:"pkce_params_missing",desc:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request"},nt={code:"invalid_known_authorities",
desc:"knownAuthorities and cloudDiscoveryMetadata cannot both be provided. Please provide cloudDiscoveryMetadata object for AAD, knownAuthorities otherwise."},it={code:"invalid_cloud_discovery_metadata",desc:"Invalid cloudDiscoveryMetadata provided. Must be a JSON object containing tenant_discovery_endpoint and metadata fields"},ot={code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter."},at=function(n){function ClientConfigurationError(s,m){var y=n.call(this,s,m)||this;return y.name="ClientConfigurationError",Object.setPrototypeOf(y,ClientConfigurationError.prototype),y}return __extends$1(ClientConfigurationError,n),ClientConfigurationError.createRedirectUriEmptyError=function(){return new ClientConfigurationError(Be.code,Be.desc)},ClientConfigurationError.createPostLogoutRedirectUriEmptyError=function(){return new ClientConfigurationError(Ge.code,Ge.desc)},
ClientConfigurationError.createClaimsRequestParsingError=function(n){return new ClientConfigurationError(ze.code,ze.desc+" Given value: "+n)},ClientConfigurationError.createInsecureAuthorityUriError=function(n){return new ClientConfigurationError(je.code,je.desc+" Given URI: "+n)},ClientConfigurationError.createUrlParseError=function(n){return new ClientConfigurationError(We.code,We.desc+" Given Error: "+n)},ClientConfigurationError.createUrlEmptyError=function(){return new ClientConfigurationError(Ke.code,Ke.desc)},ClientConfigurationError.createScopesNonArrayError=function(n){return new ClientConfigurationError(Ye.code,Ye.desc+" Given Scopes: "+n)},ClientConfigurationError.createEmptyScopesArrayError=function(n){return new ClientConfigurationError(Xe.code,Xe.desc+" Given Scopes: "+n)},ClientConfigurationError.createClientIdSingleScopeError=function(n){return new ClientConfigurationError(Je.code,Je.desc+" Given Scopes: "+n)},
ClientConfigurationError.createInvalidPromptError=function(n){return new ClientConfigurationError($e.code,$e.desc+" Given value: "+n)},ClientConfigurationError.createInvalidClaimsRequestError=function(){return new ClientConfigurationError(Qe.code,Qe.desc)},ClientConfigurationError.createEmptyLogoutRequestError=function(){return new ClientConfigurationError(et.code,et.desc)},ClientConfigurationError.createEmptyTokenRequestError=function(){return new ClientConfigurationError(Ze.code,Ze.desc)},ClientConfigurationError.createInvalidCodeChallengeMethodError=function(){return new ClientConfigurationError(tt.code,tt.desc)},ClientConfigurationError.createInvalidCodeChallengeParamsError=function(){return new ClientConfigurationError(rt.code,rt.desc)},ClientConfigurationError.createKnownAuthoritiesCloudDiscoveryMetadataError=function(){return new ClientConfigurationError(nt.code,nt.desc)},ClientConfigurationError.createInvalidCloudDiscoveryMetadataError=function(){
return new ClientConfigurationError(it.code,it.desc)},ClientConfigurationError.createUntrustedAuthorityError=function(){return new ClientConfigurationError(ot.code,ot.desc)},ClientConfigurationError}(ae),st=function(){function ScopeSet(n){var s=this,m=n?se.trimArrayEntries(function __spreadArrays$1(){for(var n=0,s=0,m=arguments.length;s<m;s++)n+=arguments[s].length;var y=Array(n),C=0;for(s=0;s<m;s++)for(var _=arguments[s],E=0,w=_.length;E<w;E++,C++)y[C]=_[E];return y}(n)):[],y=m?se.removeEmptyStringsFromArray(m):[];this.validateInputScopes(y),this.scopes=new Set,y.forEach((function(n){return s.scopes.add(n)}))}return ScopeSet.fromString=function(n){return new ScopeSet((n=n||"").split(" "))},ScopeSet.prototype.validateInputScopes=function(n){if(!n||n.length<1)throw at.createEmptyScopesArrayError(n)},ScopeSet.prototype.containsScope=function(n){return!se.isEmpty(n)&&this.scopes.has(n)},ScopeSet.prototype.containsScopeSet=function(n){var s=this
;return!(!n||n.scopes.size<=0)&&(this.scopes.size>=n.scopes.size&&n.asArray().every((function(n){return s.containsScope(n)})))},ScopeSet.prototype.appendScope=function(n){se.isEmpty(n)||this.scopes.add(n.trim())},ScopeSet.prototype.appendScopes=function(n){var s=this;try{n.forEach((function(n){return s.appendScope(n)}))}catch(n){throw ae.createAppendScopeSetError(n)}},ScopeSet.prototype.removeScope=function(n){if(se.isEmpty(n))throw ae.createRemoveEmptyScopeFromSetError(n);this.scopes.delete(n.trim())},ScopeSet.prototype.unionScopeSets=function(n){if(!n)throw ae.createEmptyInputScopeSetError(n);var s=new Set;return n.scopes.forEach((function(n){return s.add(n)})),this.scopes.forEach((function(n){return s.add(n)})),s},ScopeSet.prototype.intersectingScopeSets=function(n){if(!n)throw ae.createEmptyInputScopeSetError(n);var s=this.unionScopeSets(n),m=n.getScopeCount(),y=this.getScopeCount();return s.size<y+m},ScopeSet.prototype.getScopeCount=function(){return this.scopes.size},
ScopeSet.prototype.asArray=function(){var n=[];return this.scopes.forEach((function(s){return n.push(s)})),n},ScopeSet.prototype.printScopes=function(){return this.scopes?this.asArray().join(" "):""},ScopeSet.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()},ScopeSet}();function buildClientInfo(n,s){if(se.isEmpty(n))throw ae.createClientInfoEmptyError(n);try{var m=s.base64Decode(n);return JSON.parse(m)}catch(n){throw ae.createClientInfoDecodingError(n)}}var ct=function(){function UrlString(n){if(this._urlString=n,se.isEmpty(this._urlString))throw at.createUrlEmptyError();se.isEmpty(this.getHash())&&(this._urlString=UrlString.canonicalizeUri(n))}return Object.defineProperty(UrlString.prototype,"urlString",{get:function(){return this._urlString},enumerable:!0,configurable:!0}),UrlString.canonicalizeUri=function(n){return n&&(n=n.toLowerCase()),n&&!se.endsWith(n,"/")&&(n+="/"),n},UrlString.prototype.validateAsUri=function(){var n;try{
n=this.getUrlComponents()}catch(n){throw at.createUrlParseError(n)}if(!n.HostNameAndPort||!n.PathSegments||n.PathSegments.length<1)throw at.createUrlParseError("Given url string: "+this.urlString);if(!n.Protocol||"https:"!==n.Protocol.toLowerCase())throw at.createInsecureAuthorityUriError(this.urlString)},UrlString.prototype.urlRemoveQueryStringParameter=function(n){var s=new RegExp("(\\&"+n+"=)[^&]+");return this._urlString=this.urlString.replace(s,""),s=new RegExp("("+n+"=)[^&]+&"),this._urlString=this.urlString.replace(s,""),s=new RegExp("("+n+"=)[^&]+"),this._urlString=this.urlString.replace(s,""),this.urlString},UrlString.removeHashFromUrl=function(n){return UrlString.canonicalizeUri(n.split("#")[0])},UrlString.prototype.replaceTenantPath=function(n){var s=this.getUrlComponents(),m=s.PathSegments;return!n||0===m.length||m[0]!==le.COMMON&&m[0]!==le.ORGANIZATIONS||(m[0]=n),UrlString.constructAuthorityUriFromObject(s)},UrlString.prototype.getHash=function(){
return UrlString.parseHash(this.urlString)},UrlString.prototype.getUrlComponents=function(){var n=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),s=this.urlString.match(n);if(!s)throw at.createUrlParseError("Given url string: "+this.urlString);var m={Protocol:s[1],HostNameAndPort:s[4],AbsolutePath:s[5]},y=m.AbsolutePath.split("/");return y=y.filter((function(n){return n&&n.length>0})),m.PathSegments=y,m},UrlString.getDomainFromUrl=function(n){var s=RegExp("^([^:/?#]+://)?([^/?#]*)"),m=n.match(s);if(!m)throw at.createUrlParseError("Given url string: "+n);return m[2]},UrlString.parseHash=function(n){var s=n.indexOf("#"),m=n.indexOf("#/");return m>-1?n.substring(m+2):s>-1?n.substring(s+1):""},UrlString.constructAuthorityUriFromObject=function(n){return new UrlString(n.Protocol+"//"+n.HostNameAndPort+"/"+n.PathSegments.join("/"))},UrlString.getDeserializedHash=function(n){if(se.isEmpty(n))return{};var s=UrlString.parseHash(n),m=se.queryStringToObject(se.isEmpty(s)?n:s)
;if(!m)throw ae.createHashNotDeserializedError(JSON.stringify(m));return m},UrlString.hashContainsKnownProperties=function(n){if(se.isEmpty(n))return!1;var s=UrlString.getDeserializedHash(n);return!!(s.code||s.error_description||s.error||s.state)},UrlString}(),ut=function(){function TrustedAuthority(){}return TrustedAuthority.setTrustedAuthoritiesFromConfig=function(n,s){if(!this.getTrustedHostList().length){if(n.length>0&&!se.isEmpty(s))throw at.createKnownAuthoritiesCloudDiscoveryMetadataError();this.createCloudDiscoveryMetadataFromKnownAuthorities(n);try{if(s){var m=JSON.parse(s);this.saveCloudDiscoveryMetadata(m.metadata)}}catch(n){throw at.createInvalidCloudDiscoveryMetadataError()}}},TrustedAuthority.setTrustedAuthoritiesFromNetwork=function(n,s){return __awaiter$1(this,void 0,void 0,(function(){var m,y,C,_;return __generator$1(this,(function(E){switch(E.label){case 0:m=""+_e+n.urlString+"oauth2/v2.0/authorize",E.label=1;case 1:return E.trys.push([1,3,,4]),
[4,s.sendGetRequestAsync(m)];case 2:return y=E.sent(),C=y.body.metadata,this.saveCloudDiscoveryMetadata(C),[3,4];case 3:return E.sent(),[2];case 4:return _=n.getUrlComponents().HostNameAndPort,this.getTrustedHostList().length>0&&!this.IsInTrustedHostList(_)&&this.createCloudDiscoveryMetadataFromKnownAuthorities([_]),[2]}}))}))},TrustedAuthority.saveCloudDiscoveryMetadata=function(n){n.forEach((function(n){n.aliases.forEach((function(s){TrustedAuthority.TrustedHostList[s.toLowerCase()]=n}))}))},TrustedAuthority.createCloudDiscoveryMetadataFromKnownAuthorities=function(n){var s=this;n.forEach((function(n){var m=ct.getDomainFromUrl(n).toLowerCase();s.TrustedHostList[m]={preferred_cache:m,preferred_network:m,aliases:[m]}}))},TrustedAuthority.getTrustedHostList=function(){return Object.keys(this.TrustedHostList)},TrustedAuthority.getCloudDiscoveryMetadata=function(n){return this.TrustedHostList[n.toLowerCase()]||null},TrustedAuthority.IsInTrustedHostList=function(n){
return Object.keys(this.TrustedHostList).indexOf(n.toLowerCase())>-1},TrustedAuthority.TrustedHostList={},TrustedAuthority}(),lt=function(){function AccountEntity(){}return AccountEntity.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(De.CACHE_KEY_SEPARATOR).toLowerCase()},AccountEntity.prototype.generateAccountKey=function(){return AccountEntity.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username})},AccountEntity.prototype.generateType=function(){switch(this.authorityType){case Ne.ADFS_ACCOUNT_TYPE:return Fe.ADFS;case Ne.MSAV1_ACCOUNT_TYPE:return Fe.MSA;case Ne.MSSTS_ACCOUNT_TYPE:return Fe.MSSTS;case Ne.GENERIC_ACCOUNT_TYPE:return Fe.GENERIC;default:throw ae.createUnexpectedAccountTypeError()}},AccountEntity.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username}},
AccountEntity.generateAccountCacheKey=function(n){return[n.homeAccountId,n.environment||"",n.tenantId||""].join(De.CACHE_KEY_SEPARATOR).toLowerCase()},AccountEntity.createAccount=function(n,s,m,y){var C=new AccountEntity;C.authorityType=Ne.MSSTS_ACCOUNT_TYPE,C.clientInfo=n;var _=buildClientInfo(n,y);C.homeAccountId=""+_.uid+De.CLIENT_INFO_SEPARATOR+_.utid;var E=s.canonicalAuthorityUrlComponents.HostNameAndPort,w=ut.getCloudDiscoveryMetadata(E)?ut.getCloudDiscoveryMetadata(E).preferred_cache:"";if(se.isEmpty(w))throw ae.createInvalidCacheEnvironmentError();if(C.environment=w,C.realm=m.claims.tid,m){var S=se.isEmpty(m.claims.oid)?m.claims.sid:m.claims.oid;C.localAccountId=S,C.username=m.claims.preferred_username||(m.claims.emails?m.claims.emails[0]:""),C.name=m.claims.name}return C},AccountEntity.createADFSAccount=function(n,s){var m=new AccountEntity;m.authorityType=Ne.ADFS_ACCOUNT_TYPE,m.homeAccountId=s.claims.sub
;var y=n.canonicalAuthorityUrlComponents.HostNameAndPort,C=ut.getCloudDiscoveryMetadata(y)?ut.getCloudDiscoveryMetadata(y).preferred_cache:"";if(se.isEmpty(C))throw ae.createInvalidCacheEnvironmentError();return m.environment=C,m.username=s.claims.upn,m},AccountEntity.isAccountEntity=function(n){return n.hasOwnProperty("homeAccountId")&&n.hasOwnProperty("environment")&&n.hasOwnProperty("realm")&&n.hasOwnProperty("localAccountId")&&n.hasOwnProperty("username")&&n.hasOwnProperty("authorityType")},AccountEntity}(),dt=function(){function CacheManager(){}return CacheManager.prototype.getAllAccounts=function(){var n=this.getAccountsFilteredBy(),s=Object.keys(n).map((function(s){return n[s]}));return s.length<1?[]:s.map((function(n){var s=new lt;return(s=CacheManager.toObject(s,n)).getAccountInfo()}))},CacheManager.prototype.saveCacheRecord=function(n){if(!n)throw ae.createNullOrUndefinedCacheRecord();n.account&&this.saveAccount(n.account),n.idToken&&this.saveCredential(n.idToken),
n.accessToken&&this.saveAccessToken(n.accessToken),n.refreshToken&&this.saveCredential(n.refreshToken)},CacheManager.prototype.saveAccount=function(n){var s=n.generateAccountKey();this.setItem(s,n,Le.ACCOUNT)},CacheManager.prototype.saveCredential=function(n){var s=n.generateCredentialKey();this.setItem(s,n,Le.CREDENTIAL)},CacheManager.prototype.saveAccessToken=function(n){var s=this,m=this.getCredentialsFilteredBy({clientId:n.clientId,credentialType:Ue.ACCESS_TOKEN,environment:n.environment,homeAccountId:n.homeAccountId,realm:n.realm}),y=st.fromString(n.target),C=Object.keys(m.accessTokens).map((function(n){return m.accessTokens[n]}));C&&C.forEach((function(n){st.fromString(n.target).intersectingScopeSets(y)&&s.removeCredential(n)})),this.saveCredential(n)},CacheManager.prototype.getAccount=function(n){return this.getItem(n,Le.ACCOUNT)},CacheManager.prototype.getCredential=function(n){return this.getItem(n,Le.CREDENTIAL)},CacheManager.prototype.getAccountsFilteredBy=function(n){
return this.getAccountsFilteredByInternal(n?n.homeAccountId:"",n?n.environment:"",n?n.realm:"")},CacheManager.prototype.getAccountsFilteredByInternal=function(n,s,m){var y=this,C=this.getKeys(),_={};return C.forEach((function(C){var E=y.getAccountEntity(C);if(!E)return null;(se.isEmpty(n)||y.matchHomeAccountId(E,n))&&(se.isEmpty(s)||y.matchEnvironment(E,s))&&(se.isEmpty(m)||y.matchRealm(E,m))&&(_[C]=E)})),_},CacheManager.prototype.getCredentialsFilteredBy=function(n){return this.getCredentialsFilteredByInternal(n.homeAccountId,n.environment,n.credentialType,n.clientId,n.realm,n.target)},CacheManager.prototype.getCredentialsFilteredByInternal=function(n,s,m,y,C,_){var E=this,w=this.getKeys(),S={idTokens:{},accessTokens:{},refreshTokens:{}};return w.forEach((function(w){var I,T=He.getCredentialType(w);if(T!==Pe){try{I=E.getItem(w,Le.CREDENTIAL)}catch(n){return}
if((se.isEmpty(n)||E.matchHomeAccountId(I,n))&&(se.isEmpty(s)||E.matchEnvironment(I,s))&&(se.isEmpty(C)||E.matchRealm(I,C))&&(se.isEmpty(m)||E.matchCredentialType(I,m))&&(se.isEmpty(y)||E.matchClientId(I,y))&&(se.isEmpty(_)||E.matchTarget(I,_)))switch(T){case Ue.ID_TOKEN:S.idTokens[w]=I;break;case Ue.ACCESS_TOKEN:S.accessTokens[w]=I;break;case Ue.REFRESH_TOKEN:S.refreshTokens[w]=I}}})),S},CacheManager.prototype.removeAppMetadata=function(){var n=this;return this.getKeys().forEach((function(s){n.isAppMetadata(s)&&n.removeItem(s,Le.APP_METADATA)})),!0},CacheManager.prototype.removeAllAccounts=function(){var n=this;return this.getKeys().forEach((function(s){n.getAccountEntity(s)&&n.removeAccount(s)})),!0},CacheManager.prototype.removeAccount=function(n){var s=this.getAccount(n);if(!s)throw ae.createNoAccountFoundError();return this.removeAccountContext(s)&&this.removeItem(n,Le.ACCOUNT)},CacheManager.prototype.removeAccountContext=function(n){
var s=this,m=this.getKeys(),y=n.generateAccountId();return m.forEach((function(n){if(He.getCredentialType(n)!==Pe){var m=s.getItem(n,Le.CREDENTIAL);m&&y===m.generateAccountId()&&s.removeCredential(m)}})),!0},CacheManager.prototype.removeCredential=function(n){var s=n.generateCredentialKey();return this.removeItem(s,Le.CREDENTIAL)},CacheManager.prototype.matchHomeAccountId=function(n,s){return n.homeAccountId&&s===n.homeAccountId},CacheManager.prototype.matchEnvironment=function(n,s){var m=ut.getCloudDiscoveryMetadata(s);return!!(m&&m.aliases.indexOf(n.environment)>-1)},CacheManager.prototype.matchCredentialType=function(n,s){return n.credentialType&&s.toLowerCase()===n.credentialType.toLowerCase()},CacheManager.prototype.matchClientId=function(n,s){return n.clientId&&s===n.clientId},CacheManager.prototype.matchRealm=function(n,s){return n.realm&&s===n.realm},CacheManager.prototype.matchTarget=function(n,s){if(n.credentialType!==Ue.ACCESS_TOKEN||se.isEmpty(n.target))return!1
;var m=st.fromString(n.target),y=st.fromString(s);return m.removeScope(be),y.removeScope(be),m.containsScopeSet(y)},CacheManager.prototype.getAccountEntity=function(n){if(He.getCredentialType(n)!==Pe||this.isAppMetadata(n))return null;var s;try{s=this.getItem(n,Le.ACCOUNT)}catch(n){return null}return!s||se.isEmpty(s.authorityType)?null:s},CacheManager.prototype.isAppMetadata=function(n){return-1!==n.indexOf("appmetadata")},CacheManager.toObject=function(n,s){for(var m in s)n[m]=s[m];return n},CacheManager}(),pt=function(n){function DefaultStorageClass(){return null!==n&&n.apply(this,arguments)||this}return __extends$1(DefaultStorageClass,n),DefaultStorageClass.prototype.setItem=function(){throw _.createUnexpectedError("Storage interface - setItem() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getItem=function(){throw _.createUnexpectedError("Storage interface - getItem() has not been implemented for the cacheStorage interface.")},
DefaultStorageClass.prototype.removeItem=function(){throw _.createUnexpectedError("Storage interface - removeItem() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.containsKey=function(){throw _.createUnexpectedError("Storage interface - containsKey() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getKeys=function(){throw _.createUnexpectedError("Storage interface - getKeys() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.clear=function(){throw _.createUnexpectedError("Storage interface - clear() has not been implemented for the cacheStorage interface.")},DefaultStorageClass}(dt),ft={clientId:"",authority:null,knownAuthorities:[],cloudDiscoveryMetadata:"",clientCapabilities:[]},ht={tokenRenewalOffsetSeconds:300},gt={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:y.Info},mt={sendGetRequestAsync:function(){
return __awaiter$1(this,void 0,void 0,(function(){return __generator$1(this,(function(n){throw"Network interface - sendGetRequestAsync() has not been implemented",_.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented")}))}))},sendPostRequestAsync:function(){return __awaiter$1(this,void 0,void 0,(function(){return __generator$1(this,(function(n){throw"Network interface - sendPostRequestAsync() has not been implemented",_.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented")}))}))}},yt={createNewGuid:function(){throw _.createUnexpectedError("Crypto interface - createNewGuid() has not been implemented")},base64Decode:function(){throw _.createUnexpectedError("Crypto interface - base64Decode() has not been implemented")},base64Encode:function(){throw _.createUnexpectedError("Crypto interface - base64Encode() has not been implemented")},generatePkceCodes:function(){return __awaiter$1(this,void 0,void 0,(function(){
return __generator$1(this,(function(n){throw"Crypto interface - generatePkceCodes() has not been implemented",_.createUnexpectedError("Crypto interface - generatePkceCodes() has not been implemented")}))}))}},vt={sku:me,version:"1.2.0",cpu:"",os:""},Ct={clientSecret:"",clientAssertion:null};var _t,Et=function(){function BaseClient(n){this.config=function buildClientConfiguration(n){var s=n.authOptions,m=n.systemOptions,y=n.loggerOptions,C=n.storageInterface,_=n.networkInterface,E=n.cryptoInterface,w=n.clientCredentials,S=n.libraryInfo,I=n.serverTelemetryManager;return{authOptions:__assign$1(__assign$1({},ft),s),systemOptions:__assign$1(__assign$1({},ht),m),loggerOptions:__assign$1(__assign$1({},gt),y),storageInterface:C||new pt,networkInterface:_||mt,cryptoInterface:E||yt,clientCredentials:w||Ct,libraryInfo:__assign$1(__assign$1({},vt),S),serverTelemetryManager:I||null}}(n),this.logger=new he(this.config.loggerOptions),this.cryptoUtils=this.config.cryptoInterface,
this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,ut.setTrustedAuthoritiesFromConfig(this.config.authOptions.knownAuthorities,this.config.authOptions.cloudDiscoveryMetadata),this.authority=this.config.authOptions.authority}return BaseClient.prototype.createDefaultTokenRequestHeaders=function(){var n=this.createDefaultLibraryHeaders();return n[ce.CONTENT_TYPE]=Ae,this.serverTelemetryManager&&(n[ce.X_CLIENT_CURR_TELEM]=this.serverTelemetryManager.generateCurrentRequestHeaderValue(),n[ce.X_CLIENT_LAST_TELEM]=this.serverTelemetryManager.generateLastRequestHeaderValue()),n},BaseClient.prototype.createDefaultLibraryHeaders=function(){var n={};return n[de.X_CLIENT_SKU]=this.config.libraryInfo.sku,n[de.X_CLIENT_VER]=this.config.libraryInfo.version,n[de.X_CLIENT_OS]=this.config.libraryInfo.os,n[de.X_CLIENT_CPU]=this.config.libraryInfo.cpu,n},
BaseClient.prototype.executePostToTokenEndpoint=function(n,s,m){return __awaiter$1(this,void 0,void 0,(function(){var y;return __generator$1(this,(function(C){switch(C.label){case 0:return[4,this.networkClient.sendPostRequestAsync(n,{body:s,headers:m})];case 1:return y=C.sent(),this.config.serverTelemetryManager&&y.status<500&&429!==y.status&&this.config.serverTelemetryManager.clearTelemetryCache(),[2,y]}}))}))},BaseClient}(),wt=function(){function RequestValidator(){}return RequestValidator.validateRedirectUri=function(n){if(se.isEmpty(n))throw at.createRedirectUriEmptyError()},RequestValidator.validatePrompt=function(n){if([ke.LOGIN,ke.SELECT_ACCOUNT,ke.CONSENT,ke.NONE].indexOf(n)<0)throw at.createInvalidPromptError(n)},RequestValidator.validateClaims=function(n){try{JSON.parse(n)}catch(n){throw at.createInvalidClaimsRequestError()}},RequestValidator.validateCodeChallengeParams=function(n,s){if(se.isEmpty(n)||se.isEmpty(s))throw at.createInvalidCodeChallengeParamsError()
;this.validateCodeChallengeMethod(s)},RequestValidator.validateCodeChallengeMethod=function(n){if([qe.PLAIN,qe.S256].indexOf(n)<0)throw at.createInvalidCodeChallengeMethodError()},RequestValidator.sanitizeEQParams=function(n,s){return n?(s.forEach((function(s,m){n[m]&&delete n[m]})),n):null},RequestValidator}(),St=function(){function RequestParameterBuilder(){this.parameters=new Map}return RequestParameterBuilder.prototype.addResponseTypeCode=function(){this.parameters.set(de.RESPONSE_TYPE,encodeURIComponent(Ie))},RequestParameterBuilder.prototype.addResponseMode=function(n){this.parameters.set(de.RESPONSE_MODE,encodeURIComponent(n||Me.QUERY))},RequestParameterBuilder.prototype.addScopes=function(n){this.parameters.set(de.SCOPE,encodeURIComponent(n.printScopes()))},RequestParameterBuilder.prototype.addClientId=function(n){this.parameters.set(de.CLIENT_ID,encodeURIComponent(n))},RequestParameterBuilder.prototype.addRedirectUri=function(n){wt.validateRedirectUri(n),
this.parameters.set(de.REDIRECT_URI,encodeURIComponent(n))},RequestParameterBuilder.prototype.addDomainHint=function(n){this.parameters.set(Re.DOMAIN_HINT,encodeURIComponent(n))},RequestParameterBuilder.prototype.addLoginHint=function(n){this.parameters.set(Re.LOGIN_HINT,encodeURIComponent(n))},RequestParameterBuilder.prototype.addSid=function(n){this.parameters.set(Re.SID,encodeURIComponent(n))},RequestParameterBuilder.prototype.addClaims=function(n,s){var m=this.addClientCapabilitiesToClaims(n,s);wt.validateClaims(m),this.parameters.set(de.CLAIMS,encodeURIComponent(m))},RequestParameterBuilder.prototype.addCorrelationId=function(n){this.parameters.set(de.CLIENT_REQUEST_ID,encodeURIComponent(n))},RequestParameterBuilder.prototype.addLibraryInfo=function(n){this.parameters.set(de.X_CLIENT_SKU,n.sku),this.parameters.set(de.X_CLIENT_VER,n.version),this.parameters.set(de.X_CLIENT_OS,n.os),this.parameters.set(de.X_CLIENT_CPU,n.cpu)},RequestParameterBuilder.prototype.addPrompt=function(n){
wt.validatePrompt(n),this.parameters.set(""+de.PROMPT,encodeURIComponent(n))},RequestParameterBuilder.prototype.addState=function(n){se.isEmpty(n)||this.parameters.set(de.STATE,encodeURIComponent(n))},RequestParameterBuilder.prototype.addNonce=function(n){this.parameters.set(de.NONCE,encodeURIComponent(n))},RequestParameterBuilder.prototype.addCodeChallengeParams=function(n,s){if(wt.validateCodeChallengeParams(n,s),!n||!s)throw at.createInvalidCodeChallengeParamsError();this.parameters.set(de.CODE_CHALLENGE,encodeURIComponent(n)),this.parameters.set(de.CODE_CHALLENGE_METHOD,encodeURIComponent(s))},RequestParameterBuilder.prototype.addAuthorizationCode=function(n){this.parameters.set(de.CODE,encodeURIComponent(n))},RequestParameterBuilder.prototype.addDeviceCode=function(n){this.parameters.set(de.DEVICE_CODE,encodeURIComponent(n))},RequestParameterBuilder.prototype.addRefreshToken=function(n){this.parameters.set(de.REFRESH_TOKEN,encodeURIComponent(n))},
RequestParameterBuilder.prototype.addCodeVerifier=function(n){this.parameters.set(de.CODE_VERIFIER,encodeURIComponent(n))},RequestParameterBuilder.prototype.addClientSecret=function(n){this.parameters.set(de.CLIENT_SECRET,encodeURIComponent(n))},RequestParameterBuilder.prototype.addClientAssertion=function(n){this.parameters.set(de.CLIENT_ASSERTION,encodeURIComponent(n))},RequestParameterBuilder.prototype.addClientAssertionType=function(n){this.parameters.set(de.CLIENT_ASSERTION_TYPE,encodeURIComponent(n))},RequestParameterBuilder.prototype.addGrantType=function(n){this.parameters.set(de.GRANT_TYPE,encodeURIComponent(n))},RequestParameterBuilder.prototype.addClientInfo=function(){this.parameters.set("client_info","1")},RequestParameterBuilder.prototype.addExtraQueryParameters=function(n){var s=this;wt.sanitizeEQParams(n,this.parameters),Object.keys(n).forEach((function(m){s.parameters.set(m,n[m])}))},RequestParameterBuilder.prototype.addClientCapabilitiesToClaims=function(n,s){var m
;if(se.isEmpty(n))m={};else try{m=JSON.parse(n)}catch(n){throw at.createInvalidClaimsRequestError()}return s&&s.length>0&&(m.hasOwnProperty(fe.ACCESS_TOKEN)||(m[fe.ACCESS_TOKEN]={}),m[fe.ACCESS_TOKEN][fe.XMS_CC]={values:s}),JSON.stringify(m)},RequestParameterBuilder.prototype.createQueryString=function(){var n=new Array;return this.parameters.forEach((function(s,m){n.push(m+"="+s)})),n.join("&")},RequestParameterBuilder}(),bt=function(n){function ServerError(s,m,y){var C=n.call(this,s,m)||this;return C.name="ServerError",C.subError=y,Object.setPrototypeOf(C,ServerError.prototype),C}return __extends$1(ServerError,n),ServerError}(_),It=function(){function IdToken(n,s){if(se.isEmpty(n))throw ae.createIdTokenNullOrEmptyError(n);this.rawIdToken=n,this.claims=IdToken.extractIdToken(n,s)}return IdToken.extractIdToken=function(n,s){var m=se.decodeJwt(n);if(!m)return null;try{var y=m.JWSPayload,C=s.base64Decode(y);return JSON.parse(C)}catch(n){throw ae.createIdTokenParsingError(n)}},IdToken
}(),Tt=function(){function TimeUtils(){}return TimeUtils.nowSeconds=function(){return Math.round((new Date).getTime()/1e3)},TimeUtils.isTokenExpired=function(n,s){var m=Number(n)||0;return TimeUtils.nowSeconds()+s>m},TimeUtils}();!function(n){n[n.Default=0]="Default",n[n.Adfs=1]="Adfs"}(_t||(_t={}));var At,xt,Pt,Rt,kt=function(n){function IdTokenEntity(){return null!==n&&n.apply(this,arguments)||this}return __extends$1(IdTokenEntity,n),IdTokenEntity.createIdTokenEntity=function(n,s,m,y,C){var _=new IdTokenEntity;return _.credentialType=Ue.ID_TOKEN,_.homeAccountId=n,_.environment=s,_.clientId=y,_.secret=m,_.realm=C,_},IdTokenEntity.isIdTokenEntity=function(n){return n.hasOwnProperty("homeAccountId")&&n.hasOwnProperty("environment")&&n.hasOwnProperty("credentialType")&&n.hasOwnProperty("realm")&&n.hasOwnProperty("clientId")&&n.hasOwnProperty("secret")&&n.credentialType===Ue.ID_TOKEN},IdTokenEntity}(He),Mt=function(n){function AccessTokenEntity(){
return null!==n&&n.apply(this,arguments)||this}return __extends$1(AccessTokenEntity,n),AccessTokenEntity.createAccessTokenEntity=function(n,s,m,y,C,_,E,w){var S=new AccessTokenEntity;S.homeAccountId=n,S.credentialType=Ue.ACCESS_TOKEN,S.secret=m;var I=Tt.nowSeconds();return S.cachedAt=I.toString(),S.expiresOn=E.toString(),S.extendedExpiresOn=w.toString(),S.environment=s,S.clientId=y,S.realm=C,S.target=_,S},AccessTokenEntity.isAccessTokenEntity=function(n){return n.hasOwnProperty("homeAccountId")&&n.hasOwnProperty("environment")&&n.hasOwnProperty("credentialType")&&n.hasOwnProperty("realm")&&n.hasOwnProperty("clientId")&&n.hasOwnProperty("secret")&&n.hasOwnProperty("target")&&n.credentialType===Ue.ACCESS_TOKEN},AccessTokenEntity}(He),Ot=function(n){function RefreshTokenEntity(){return null!==n&&n.apply(this,arguments)||this}return __extends$1(RefreshTokenEntity,n),RefreshTokenEntity.createRefreshTokenEntity=function(n,s,m,y,C){var _=new RefreshTokenEntity;return _.clientId=y,
_.credentialType=Ue.REFRESH_TOKEN,_.environment=s,_.homeAccountId=n,_.secret=m,C&&(_.familyId=C),_},RefreshTokenEntity.isRefreshTokenEntity=function(n){return n.hasOwnProperty("homeAccountId")&&n.hasOwnProperty("environment")&&n.hasOwnProperty("credentialType")&&n.hasOwnProperty("clientId")&&n.hasOwnProperty("secret")&&n.credentialType===Ue.REFRESH_TOKEN},RefreshTokenEntity}(He),Nt=["interaction_required","consent_required","login_required"],Dt=["message_only","additional_action","basic_action","user_password_expired","consent_required"],Ut=function(n){function InteractionRequiredAuthError(s,m,y){var C=n.call(this,s,m,y)||this;return C.name="InteractionRequiredAuthError",Object.setPrototypeOf(C,InteractionRequiredAuthError.prototype),C}return __extends$1(InteractionRequiredAuthError,n),InteractionRequiredAuthError.isInteractionRequiredError=function(n,s,m){var y=!se.isEmpty(n)&&Nt.indexOf(n)>-1,C=!se.isEmpty(m)&&Dt.indexOf(m)>-1,_=!se.isEmpty(s)&&Nt.some((function(n){
return s.indexOf(n)>-1}));return y||_||C},InteractionRequiredAuthError}(bt),Lt=function Lt(n,s,m,y){this.account=n,this.idToken=s,this.accessToken=m,this.refreshToken=y},Ft=function(){function ProtocolUtils(){}return ProtocolUtils.setRequestState=function(n,s,m){var y=ProtocolUtils.generateLibraryState(n,m);return se.isEmpty(s)?y:""+y+Ee+s},ProtocolUtils.generateLibraryState=function(n,s){if(!n)throw ae.createNoCryptoObjectError("generateLibraryState");var m={id:n.createNewGuid(),ts:Tt.nowSeconds()};s&&(m.meta=s);var y=JSON.stringify(m);return n.base64Encode(y)},ProtocolUtils.parseRequestState=function(n,s){if(!n)throw ae.createNoCryptoObjectError("parseRequestState");if(se.isEmpty(s))throw ae.createInvalidStateError(s,"Null, undefined or empty state");try{var m=decodeURIComponent(s).split(Ee),y=m[0],C=m.length>1?m.slice(1).join(Ee):"",_=n.base64Decode(y),E=JSON.parse(_);return{userRequestState:se.isEmpty(C)?"":C,libraryState:E}}catch(n){throw ae.createInvalidStateError(s,n)}},
ProtocolUtils}(),qt=function(){function ResponseHandler(n,s,m,y){this.clientId=n,this.cacheStorage=s,this.cryptoObj=m,this.logger=y}return ResponseHandler.prototype.validateServerAuthorizationCodeResponse=function(n,s,m){if(decodeURIComponent(n.state)!==decodeURIComponent(s))throw ae.createStateMismatchError();if(n.error||n.error_description||n.suberror){if(Ut.isInteractionRequiredError(n.error,n.error_description,n.suberror))throw new Ut(n.error,n.error_description,n.suberror);throw new bt(n.error,n.error_description,n.suberror)}n.client_info&&buildClientInfo(n.client_info,m)},ResponseHandler.prototype.validateTokenResponse=function(n){if(n.error||n.error_description||n.suberror){if(Ut.isInteractionRequiredError(n.error,n.error_description,n.suberror))throw new Ut(n.error,n.error_description,n.suberror);var s=n.error_codes+" - ["+n.timestamp+"]: "+n.error_description+" - Correlation ID: "+n.correlation_id+" - Trace ID: "+n.trace_id;throw new bt(n.error,s)}},
ResponseHandler.prototype.handleServerTokenResponse=function(n,s,m,y,C){n.client_info?(this.clientInfo=buildClientInfo(n.client_info,this.cryptoObj),se.isEmpty(this.clientInfo.uid)||se.isEmpty(this.clientInfo.utid)||(this.homeAccountIdentifier=this.clientInfo.uid+"."+this.clientInfo.utid)):this.homeAccountIdentifier="";var _=null;if(!se.isEmpty(n.id_token)&&(_=new It(n.id_token,this.cryptoObj),!se.isEmpty(m)&&_.claims.nonce!==m))throw ae.createNonceMismatchError();var E=null;se.isEmpty(y)||(E=Ft.parseRequestState(this.cryptoObj,y));var w=this.generateCacheRecord(n,_,s,E&&E.libraryState,C);return this.cacheStorage.saveCacheRecord(w),ResponseHandler.generateAuthenticationResult(w,_,!1,E)},ResponseHandler.prototype.generateCacheRecord=function(n,s,m,y,C){var _=m.canonicalAuthorityUrlComponents.HostNameAndPort,E=ut.getCloudDiscoveryMetadata(_)?ut.getCloudDiscoveryMetadata(_).preferred_cache:"";if(se.isEmpty(E))throw ae.createInvalidCacheEnvironmentError();var w=null,S=null
;se.isEmpty(n.id_token)||(w=kt.createIdTokenEntity(this.homeAccountIdentifier,E,n.id_token,this.clientId,s.claims.tid),S=this.generateAccountEntity(n,s,m));var I=null;if(!se.isEmpty(n.access_token)){var T=n.scope?st.fromString(n.scope):new st(C||[]),A=Tt.nowSeconds(),x=(y?y.ts:A)+n.expires_in,P=x+n.ext_expires_in;I=Mt.createAccessTokenEntity(this.homeAccountIdentifier,E,n.access_token,this.clientId,s?s.claims.tid:m.tenant,T.printScopesLowerCase(),x,P)}var R=null;return se.isEmpty(n.refresh_token)||(R=Ot.createRefreshTokenEntity(this.homeAccountIdentifier,E,n.refresh_token,this.clientId,n.foci)),new Lt(S,w,I,R)},ResponseHandler.prototype.generateAccountEntity=function(n,s,m){if(m.authorityType===_t.Adfs)return lt.createADFSAccount(m,s);if(se.isEmpty(n.client_info))throw ae.createClientInfoEmptyError(n.client_info);return lt.createAccount(n.client_info,m,s,this.cryptoObj)},ResponseHandler.generateAuthenticationResult=function(n,s,m,y){var C="",_=[],E=null,w=null,S=null
;return n.accessToken&&(C=n.accessToken.secret,_=st.fromString(n.accessToken.target).asArray(),E=new Date(1e3*Number(n.accessToken.expiresOn)),w=new Date(1e3*Number(n.accessToken.extendedExpiresOn))),n.refreshToken&&(S=n.refreshToken.familyId||null),{uniqueId:s?s.claims.oid||s.claims.sub:"",tenantId:s?s.claims.tid:"",scopes:_,account:n.account?n.account.getAccountInfo():null,idToken:s?s.rawIdToken:"",idTokenClaims:s?s.claims:null,accessToken:C,fromCache:m,expiresOn:E,extExpiresOn:w,familyId:S,state:y?y.userRequestState:""}},ResponseHandler}(),Vt=function(n){function AuthorizationCodeClient(s){return n.call(this,s)||this}return __extends$1(AuthorizationCodeClient,n),AuthorizationCodeClient.prototype.getAuthCodeUrl=function(n){return __awaiter$1(this,void 0,void 0,(function(){var s;return __generator$1(this,(function(m){return s=this.createAuthCodeUrlQueryString(n),[2,this.authority.authorizationEndpoint+"?"+s]}))}))},AuthorizationCodeClient.prototype.acquireToken=function(n,s,m){
return __awaiter$1(this,void 0,void 0,(function(){var y,C;return __generator$1(this,(function(_){switch(_.label){case 0:if(this.logger.info("in acquireToken call"),!n||se.isEmpty(n.code))throw ae.createTokenRequestCannotBeMadeError();return[4,this.executeTokenRequest(this.authority,n)];case 1:return y=_.sent(),(C=new qt(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger)).validateTokenResponse(y.body),[2,C.handleServerTokenResponse(y.body,this.authority,s,m)]}}))}))},AuthorizationCodeClient.prototype.handleFragmentResponse=function(n,s){var m=new qt(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger),y=new ct(n),C=ct.getDeserializedHash(y.getHash());return m.validateServerAuthorizationCodeResponse(C,s,this.cryptoUtils),C.code},AuthorizationCodeClient.prototype.getLogoutUri=function(n){if(!n)throw at.createEmptyLogoutRequestError()
;n.account?this.cacheManager.removeAccount(lt.generateAccountCacheKey(n.account)):this.cacheManager.clear();var s=n.postLogoutRedirectUri?"?"+de.POST_LOGOUT_URI+"="+encodeURIComponent(n.postLogoutRedirectUri):"",m=n.correlationId?"&"+de.CLIENT_REQUEST_ID+"="+encodeURIComponent(n.correlationId):"";return""+this.authority.endSessionEndpoint+s+m},AuthorizationCodeClient.prototype.executeTokenRequest=function(n,s){return __awaiter$1(this,void 0,void 0,(function(){var m,y;return __generator$1(this,(function(C){return m=this.createTokenRequestBody(s),y=this.createDefaultTokenRequestHeaders(),[2,this.executePostToTokenEndpoint(n.tokenEndpoint,m,y)]}))}))},AuthorizationCodeClient.prototype.createTokenRequestBody=function(n){var s=new St;s.addClientId(this.config.authOptions.clientId),s.addRedirectUri(n.redirectUri);var m=new st(n.scopes||[]);if(s.addScopes(m),s.addAuthorizationCode(n.code),n.codeVerifier&&s.addCodeVerifier(n.codeVerifier),
this.config.clientCredentials.clientSecret&&s.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){var y=this.config.clientCredentials.clientAssertion;s.addClientAssertion(y.assertion),s.addClientAssertionType(y.assertionType)}s.addGrantType(Oe.AUTHORIZATION_CODE_GRANT),s.addClientInfo();var C=n.correlationId||this.config.cryptoInterface.createNewGuid();return s.addCorrelationId(C),(!se.isEmpty(n.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&s.addClaims(n.claims,this.config.authOptions.clientCapabilities),s.createQueryString()},AuthorizationCodeClient.prototype.createAuthCodeUrlQueryString=function(n){var s=new St;s.addClientId(this.config.authOptions.clientId);var m=new st(n.scopes||[]);n.extraScopesToConsent&&m.appendScopes(n.extraScopesToConsent),s.addScopes(m),s.addRedirectUri(n.redirectUri);var y=n.correlationId||this.config.cryptoInterface.createNewGuid()
;return s.addCorrelationId(y),s.addResponseMode(n.responseMode),s.addResponseTypeCode(),s.addLibraryInfo(this.config.libraryInfo),s.addClientInfo(),n.codeChallenge&&s.addCodeChallengeParams(n.codeChallenge,n.codeChallengeMethod),n.prompt&&s.addPrompt(n.prompt),n.loginHint&&s.addLoginHint(n.loginHint),n.domainHint&&s.addDomainHint(n.domainHint),n.sid&&s.addSid(n.sid),n.nonce&&s.addNonce(n.nonce),n.state&&s.addState(n.state),(!se.isEmpty(n.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&s.addClaims(n.claims,this.config.authOptions.clientCapabilities),n.extraQueryParameters&&s.addExtraQueryParameters(n.extraQueryParameters),s.createQueryString()},AuthorizationCodeClient}(Et),Ht=(function(n){function DeviceCodeClient(s){return n.call(this,s)||this}__extends$1(DeviceCodeClient,n),DeviceCodeClient.prototype.acquireToken=function(n){return __awaiter$1(this,void 0,void 0,(function(){var s,m,y;return __generator$1(this,(function(C){
switch(C.label){case 0:return[4,this.getDeviceCode(n)];case 1:return s=C.sent(),n.deviceCodeCallback(s),[4,this.acquireTokenWithDeviceCode(n,s)];case 2:return m=C.sent(),(y=new qt(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger)).validateTokenResponse(m),[2,y.handleServerTokenResponse(m,this.authority)]}}))}))},DeviceCodeClient.prototype.getDeviceCode=function(n){return __awaiter$1(this,void 0,void 0,(function(){var s,m;return __generator$1(this,(function(y){return s=this.createQueryString(n),m=this.createDefaultLibraryHeaders(),[2,this.executePostRequestToDeviceCodeEndpoint(this.authority.deviceCodeEndpoint,s,m)]}))}))},DeviceCodeClient.prototype.executePostRequestToDeviceCodeEndpoint=function(n,s,m){return __awaiter$1(this,void 0,void 0,(function(){var y,C,_,E,w,S,I;return __generator$1(this,(function(T){switch(T.label){case 0:return[4,this.networkClient.sendPostRequestAsync(n,{body:s,headers:m})];case 1:return y=T.sent().body,C=y.user_code,
_=y.device_code,E=y.verification_uri,w=y.expires_in,S=y.interval,I=y.message,[2,{userCode:C,deviceCode:_,verificationUri:E,expiresIn:w,interval:S,message:I}]}}))}))},DeviceCodeClient.prototype.createQueryString=function(n){var s=new St,m=new st(n.scopes||[]);return s.addScopes(m),s.addClientId(this.config.authOptions.clientId),(!se.isEmpty(n.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&s.addClaims(n.claims,this.config.authOptions.clientCapabilities),s.createQueryString()},DeviceCodeClient.prototype.acquireTokenWithDeviceCode=function(n,s){return __awaiter$1(this,void 0,void 0,(function(){var m,y,C,_,E=this;return __generator$1(this,(function(w){return m=this.createTokenRequestBody(n,s),y=this.createDefaultTokenRequestHeaders(),C=Tt.nowSeconds()+s.expiresIn,_=1e3*s.interval,[2,new Promise((function(s,w){var S=setInterval((function(){return __awaiter$1(E,void 0,void 0,(function(){var _,E;return __generator$1(this,(function(I){
switch(I.label){case 0:return I.trys.push([0,5,,6]),n.cancel?(this.logger.error("Token request cancelled by setting DeviceCodeRequest.cancel = true"),clearInterval(S),w(ae.createDeviceCodeCancelledError()),[3,4]):[3,1];case 1:return Tt.nowSeconds()>C?(this.logger.error("Device code expired. Expiration time of device code was "+C),clearInterval(S),w(ae.createDeviceCodeExpiredError()),[3,4]):[3,2];case 2:return[4,this.executePostToTokenEndpoint(this.authority.tokenEndpoint,m,y)];case 3:(_=I.sent()).body&&_.body.error==xe?this.logger.info(_.body.error_description):(clearInterval(S),s(_.body)),I.label=4;case 4:return[3,6];case 5:return E=I.sent(),clearInterval(S),w(E),[3,6];case 6:return[2]}}))}))}),_)}))]}))}))},DeviceCodeClient.prototype.createTokenRequestBody=function(n,s){var m=new St,y=new st(n.scopes||[]);m.addScopes(y),m.addClientId(this.config.authOptions.clientId),m.addGrantType(Oe.DEVICE_CODE_GRANT),m.addDeviceCode(s.deviceCode)
;var C=n.correlationId||this.config.cryptoInterface.createNewGuid();return m.addCorrelationId(C),m.addClientInfo(),(!se.isEmpty(n.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&m.addClaims(n.claims,this.config.authOptions.clientCapabilities),m.createQueryString()}}(Et),function(n){function RefreshTokenClient(s){return n.call(this,s)||this}return __extends$1(RefreshTokenClient,n),RefreshTokenClient.prototype.acquireToken=function(n){return __awaiter$1(this,void 0,void 0,(function(){var s,m;return __generator$1(this,(function(y){switch(y.label){case 0:return[4,this.executeTokenRequest(n,this.authority)];case 1:return s=y.sent(),(m=new qt(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger)).validateTokenResponse(s.body),[2,m.handleServerTokenResponse(s.body,this.authority)]}}))}))},RefreshTokenClient.prototype.executeTokenRequest=function(n,s){return __awaiter$1(this,void 0,void 0,(function(){var m,y
;return __generator$1(this,(function(C){return m=this.createTokenRequestBody(n),y=this.createDefaultTokenRequestHeaders(),[2,this.executePostToTokenEndpoint(s.tokenEndpoint,m,y)]}))}))},RefreshTokenClient.prototype.createTokenRequestBody=function(n){var s=new St;s.addClientId(this.config.authOptions.clientId);var m=new st(n.scopes||[]);s.addScopes(m),s.addGrantType(Oe.REFRESH_TOKEN_GRANT),s.addClientInfo();var y=n.correlationId||this.config.cryptoInterface.createNewGuid();if(s.addCorrelationId(y),s.addRefreshToken(n.refreshToken),this.config.clientCredentials.clientSecret&&s.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){var C=this.config.clientCredentials.clientAssertion;s.addClientAssertion(C.assertion),s.addClientAssertionType(C.assertionType)}
return(!se.isEmpty(n.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&s.addClaims(n.claims,this.config.authOptions.clientCapabilities),s.createQueryString()},RefreshTokenClient}(Et)),Bt=(function(n){function ClientCredentialClient(s){return n.call(this,s)||this}__extends$1(ClientCredentialClient,n),ClientCredentialClient.prototype.acquireToken=function(n){return __awaiter$1(this,void 0,void 0,(function(){var s;return __generator$1(this,(function(m){switch(m.label){case 0:return this.scopeSet=new st(n.scopes||[]),n.skipCache?[4,this.executeTokenRequest(n,this.authority)]:[3,2];case 1:return[2,m.sent()];case 2:return null==(s=this.getCachedAuthenticationResult())?[3,3]:[2,s];case 3:return[4,this.executeTokenRequest(n,this.authority)];case 4:return[2,m.sent()]}}))}))},ClientCredentialClient.prototype.getCachedAuthenticationResult=function(){var n=this.readAccessTokenFromCache()
;return!n||Tt.isTokenExpired(n.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds)?null:qt.generateAuthenticationResult({account:null,accessToken:n,idToken:null,refreshToken:null},null,!0)},ClientCredentialClient.prototype.readAccessTokenFromCache=function(){var n={homeAccountId:"",environment:this.authority.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:Ue.ACCESS_TOKEN,clientId:this.config.authOptions.clientId,realm:this.authority.tenant,target:this.scopeSet.printScopesLowerCase()},s=this.cacheManager.getCredentialsFilteredBy(n),m=Object.keys(s.accessTokens).map((function(n){return s.accessTokens[n]}));return m.length<1?null:m[0]},ClientCredentialClient.prototype.executeTokenRequest=function(n,s){return __awaiter$1(this,void 0,void 0,(function(){var m,y,C,_;return __generator$1(this,(function(E){switch(E.label){case 0:return m=this.createTokenRequestBody(n),y=this.createDefaultTokenRequestHeaders(),[4,this.executePostToTokenEndpoint(s.tokenEndpoint,m,y)]
;case 1:return C=E.sent(),(_=new qt(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger)).validateTokenResponse(C.body),[2,_.handleServerTokenResponse(C.body,this.authority,null,null,n.scopes)]}}))}))},ClientCredentialClient.prototype.createTokenRequestBody=function(n){var s=new St;s.addClientId(this.config.authOptions.clientId),s.addScopes(this.scopeSet),s.addGrantType(Oe.CLIENT_CREDENTIALS_GRANT);var m=n.correlationId||this.config.cryptoInterface.createNewGuid();if(s.addCorrelationId(m),this.config.clientCredentials.clientSecret&&s.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){var y=this.config.clientCredentials.clientAssertion;s.addClientAssertion(y.assertion),s.addClientAssertionType(y.assertionType)}return(!se.isEmpty(n.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&s.addClaims(n.claims,this.config.authOptions.clientCapabilities),
s.createQueryString()}}(Et),function(n){function SilentFlowClient(s){return n.call(this,s)||this}return __extends$1(SilentFlowClient,n),SilentFlowClient.prototype.acquireToken=function(n){return __awaiter$1(this,void 0,void 0,(function(){var s,m,y,C,_,E,w,S,I,T,A;return __generator$1(this,(function(x){if(!n)throw at.createEmptyTokenRequestError();if(!n.account)throw ae.createNoAccountInSilentRequestError();if(s=new st(n.scopes||[]),m=lt.generateAccountCacheKey(n.account),y=this.cacheManager.getAccount(m),C=y.homeAccountId,_=y.environment,E=this.readAccessTokenFromCache(C,_,s,y.realm),w=this.readRefreshTokenFromCache(C,_),this.isRefreshRequired(n,E)){if(!w)throw ae.createNoTokensFoundError();return S=new Ht(this.config),I=__assign$1(__assign$1({},n),{refreshToken:w.secret}),[2,S.acquireToken(I)]}return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),T=this.readIdTokenFromCache(C,_,y.realm),A=new It(T.secret,this.config.cryptoInterface),
[2,qt.generateAuthenticationResult({account:y,accessToken:E,idToken:T,refreshToken:w},A,!0)]}))}))},SilentFlowClient.prototype.isRefreshRequired=function(n,s){return!(!n.forceRefresh&&!n.claims)||!(s&&!Tt.isTokenExpired(s.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))},SilentFlowClient.prototype.readIdTokenFromCache=function(n,s,m){var y=He.generateCredentialCacheKey(n,s,Ue.ID_TOKEN,this.config.authOptions.clientId,m);return this.cacheManager.getCredential(y)},SilentFlowClient.prototype.readAccessTokenFromCache=function(n,s,m,y){var C={homeAccountId:n,environment:s,credentialType:Ue.ACCESS_TOKEN,clientId:this.config.authOptions.clientId,realm:y,target:m.printScopesLowerCase()},_=this.cacheManager.getCredentialsFilteredBy(C),E=Object.keys(_.accessTokens).map((function(n){return _.accessTokens[n]}));if(E.length>1);else if(E.length<1)return null;return E[0]},SilentFlowClient.prototype.readRefreshTokenFromCache=function(n,s){
var m=He.generateCredentialCacheKey(n,s,Ue.REFRESH_TOKEN,this.config.authOptions.clientId);return this.cacheManager.getCredential(m)},SilentFlowClient}(Et)),Gt=function(){function Authority(n,s){this.canonicalAuthority=n,this._canonicalAuthority.validateAsUri(),this.networkInterface=s}return Object.defineProperty(Authority.prototype,"authorityType",{get:function(){var n=this.canonicalAuthorityUrlComponents.PathSegments;return n.length&&n[0].toLowerCase()===Ce?_t.Adfs:_t.Default},enumerable:!0,configurable:!0}),Object.defineProperty(Authority.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(n){this._canonicalAuthority=new ct(n),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!0,configurable:!0}),Object.defineProperty(Authority.prototype,"canonicalAuthorityUrlComponents",{get:function(){
return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!0,configurable:!0}),Object.defineProperty(Authority.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(Authority.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete())return this.replaceTenant(this.tenantDiscoveryResponse.authorization_endpoint);throw ae.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(Authority.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete())return this.replaceTenant(this.tenantDiscoveryResponse.token_endpoint);throw ae.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(Authority.prototype,"deviceCodeEndpoint",{
get:function(){if(this.discoveryComplete())return this.tenantDiscoveryResponse.token_endpoint.replace("/token","/devicecode");throw ae.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(Authority.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete())return this.replaceTenant(this.tenantDiscoveryResponse.end_session_endpoint);throw ae.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(Authority.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete())return this.replaceTenant(this.tenantDiscoveryResponse.issuer);throw ae.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Authority.prototype.replaceTenant=function(n){return n.replace(/{tenant}|{tenantid}/g,this.tenant)},Object.defineProperty(Authority.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){
return this.authorityType===_t.Adfs?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!0,configurable:!0}),Authority.prototype.discoveryComplete=function(){return!!this.tenantDiscoveryResponse},Authority.prototype.discoverEndpoints=function(n){return __awaiter$1(this,void 0,void 0,(function(){return __generator$1(this,(function(s){return[2,this.networkInterface.sendGetRequestAsync(n)]}))}))},Object.defineProperty(Authority.prototype,"aadInstanceDiscoveryEndpointUrl",{get:function(){return""+_e+this.canonicalAuthority+"oauth2/v2.0/authorize"},enumerable:!0,configurable:!0}),Authority.prototype.validateAndSetPreferredNetwork=function(){return __awaiter$1(this,void 0,void 0,(function(){var n,s;return __generator$1(this,(function(m){switch(m.label){case 0:return n=this.canonicalAuthorityUrlComponents.HostNameAndPort,
0!==ut.getTrustedHostList().length?[3,2]:[4,ut.setTrustedAuthoritiesFromNetwork(this._canonicalAuthority,this.networkInterface)];case 1:m.sent(),m.label=2;case 2:if(!ut.IsInTrustedHostList(n))throw at.createUntrustedAuthorityError();return s=ut.getCloudDiscoveryMetadata(n).preferred_network,n!==s&&(this.canonicalAuthority=this.canonicalAuthority.replace(n,s)),[2]}}))}))},Authority.prototype.resolveEndpointsAsync=function(){return __awaiter$1(this,void 0,void 0,(function(){var n,s;return __generator$1(this,(function(m){switch(m.label){case 0:return[4,this.validateAndSetPreferredNetwork()];case 1:return m.sent(),n=this.defaultOpenIdConfigurationEndpoint,[4,this.discoverEndpoints(n)];case 2:return s=m.sent(),this.tenantDiscoveryResponse=s.body,[2]}}))}))},Authority}(),zt=function(){function AuthorityFactory(){}return AuthorityFactory.createDiscoveredInstance=function(n,s){return __awaiter$1(this,void 0,void 0,(function(){var m,y;return __generator$1(this,(function(C){switch(C.label){
case 0:if((m=AuthorityFactory.createInstance(n,s)).discoveryComplete())return[2,m];C.label=1;case 1:return C.trys.push([1,3,,4]),[4,m.resolveEndpointsAsync()];case 2:return C.sent(),[2,m];case 3:throw y=C.sent(),ae.createEndpointDiscoveryIncompleteError(y);case 4:return[2]}}))}))},AuthorityFactory.createInstance=function(n,s){if(se.isEmpty(n))throw at.createUrlEmptyError();return new Gt(n,s)},AuthorityFactory}(),jt=function(){function ServerTelemetryManager(n,s){this.cacheManager=s,this.apiId=n.apiId,this.correlationId=n.correlationId,this.forceRefresh=n.forceRefresh||!1,this.telemetryCacheKey=Ve.CACHE_KEY+De.CACHE_KEY_SEPARATOR+n.clientId}return ServerTelemetryManager.prototype.generateCurrentRequestHeaderValue=function(){var n=this.forceRefresh?1:0,s=""+this.apiId+Ve.VALUE_SEPARATOR+n;return[Ve.SCHEMA_VERSION,s,""].join(Ve.CATEGORY_SEPARATOR)},ServerTelemetryManager.prototype.generateLastRequestHeaderValue=function(){
var n=this.getLastRequests(),s=n.failedRequests.join(Ve.VALUE_SEPARATOR),m=n.errors.join(Ve.VALUE_SEPARATOR),y=n.errorCount;return[Ve.SCHEMA_VERSION,n.cacheHits,s,m,y].join(Ve.CATEGORY_SEPARATOR)},ServerTelemetryManager.prototype.cacheFailedRequest=function(n){var s=this.getLastRequests();s.failedRequests.push(this.apiId,this.correlationId),s.errors.push(n.errorCode),s.errorCount+=1,s.errors.length>Ve.FAILURE_LIMIT&&(s.failedRequests.shift(),s.failedRequests.shift(),s.errors.shift()),this.cacheManager.setItem(this.telemetryCacheKey,s,Le.TELEMETRY)},ServerTelemetryManager.prototype.incrementCacheHits=function(){var n=this.getLastRequests();return n.cacheHits+=1,this.cacheManager.setItem(this.telemetryCacheKey,n,Le.TELEMETRY),n.cacheHits},ServerTelemetryManager.prototype.getLastRequests=function(){return this.cacheManager.getItem(this.telemetryCacheKey,Le.TELEMETRY)||{failedRequests:[],errors:[],errorCount:0,cacheHits:0}},ServerTelemetryManager.prototype.clearTelemetryCache=function(){
this.cacheManager.removeItem(this.telemetryCacheKey)},ServerTelemetryManager}(),Wt="localStorage",Kt="sessionStorage",Xt="interaction.status",Yt="interaction_in_progress",Jt="invalid_grant",$t=483,Qt=600,Zt=50,er="msal.js.browser";!function(n){n.GET="GET",n.POST="POST"}(At||(At={})),function(n){n.AUTHORITY="authority",n.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",n.SESSION_STATE="session.state",n.REQUEST_STATE="request.state",n.NONCE_IDTOKEN="nonce.id_token",n.ORIGIN_URI="request.origin",n.RENEW_STATUS="token.renew.status",n.URL_HASH="urlHash",n.REQUEST_PARAMS="request.params",n.SCOPES="scopes"}(xt||(xt={})),function(n){n[n.acquireTokenRedirect=861]="acquireTokenRedirect",n[n.acquireTokenPopup=862]="acquireTokenPopup",n[n.ssoSilent=863]="ssoSilent",n[n.acquireTokenSilent_authCode=864]="acquireTokenSilent_authCode",n[n.handleRedirectPromise=865]="handleRedirectPromise",n[n.acquireTokenSilent_silentFlow=61]="acquireTokenSilent_silentFlow"}(Pt||(Pt={})),function(n){n.REDIRECT="redirect",
n.POPUP="popup",n.SILENT="silent"}(Rt||(Rt={}));var tr={scopes:[we,Se]},rr=function(){function FetchClient(){}return FetchClient.prototype.sendGetRequestAsync=function(n,s){return __awaiter(this,void 0,void 0,(function(){var m,y;return __generator(this,(function(C){switch(C.label){case 0:return[4,fetch(n,{method:At.GET,headers:this.getFetchHeaders(s)})];case 1:return m=C.sent(),y={headers:this.getHeaderDict(m.headers)},[4,m.json()];case 2:return[2,(y.body=C.sent(),y.status=m.status,y)]}}))}))},FetchClient.prototype.sendPostRequestAsync=function(n,s){return __awaiter(this,void 0,void 0,(function(){var m,y,C;return __generator(this,(function(_){switch(_.label){case 0:return m=s&&s.body||"",[4,fetch(n,{method:At.POST,headers:this.getFetchHeaders(s),body:m})];case 1:return y=_.sent(),C={headers:this.getHeaderDict(y.headers)},[4,y.json()];case 2:return[2,(C.body=_.sent(),C.status=y.status,C)]}}))}))},FetchClient.prototype.getFetchHeaders=function(n){var s=new Headers
;return n&&n.headers?(Object.keys(n.headers).forEach((function(m){s.append(m,n.headers[m])})),s):s},FetchClient.prototype.getHeaderDict=function(n){var s={};return n.forEach((function(n,m){s[m]=n})),s},FetchClient}(),nr={noWindowObjectError:{code:"no_window_object",desc:"No window object detected."},pkceNotGenerated:{code:"pkce_not_created",desc:"The PKCE code challenge and verifier could not be generated."},cryptoDoesNotExist:{code:"crypto_nonexistent",desc:"The crypto object or function is not available."},httpMethodNotImplementedError:{code:"http_method_not_implemented",desc:"The HTTP method given has not been implemented in this library."},emptyNavigateUriError:{code:"empty_navigate_uri",desc:"Navigation URI is empty. Please check stack trace for more info."},hashEmptyError:{code:"hash_empty_error",desc:"Hash value cannot be processed because it is empty."},interactionInProgress:{code:"interaction_in_progress",
desc:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API."},popUpWindowError:{code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},emptyWindowError:{code:"empty_window_error",desc:"window.open returned null or undefined window object."},userCancelledError:{code:"user_cancelled",desc:"User cancelled the flow."},monitorWindowTimeoutError:{code:"monitor_window_timeout",desc:"Token acquisition in popup failed due to timeout."},redirectInIframeError:{code:"redirect_in_iframe",desc:"Code flow is not supported inside an iframe. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs."},blockTokenRequestsInHiddenIframeError:{code:"block_iframe_reload",
desc:"Request was blocked inside an iframe because MSAL detected an authentication response. Please ensure monitorWindowForHash was called."},iframeClosedPrematurelyError:{code:"iframe_closed_prematurely",desc:"The iframe being monitored was closed prematurely."},silentSSOInsufficientInfoError:{code:"silent_sso_error",desc:"Silent SSO could not be completed - insufficient information was provided. Please provide either a loginHint or sid."},silentPromptValueError:{code:"silent_prompt_value_error",desc:"The value given for the prompt value is not valid for silent requests - must be set to 'none'."},tokenRequestCacheError:{code:"token_request_cache_error",desc:"The token request could not be fetched from the cache correctly."},invalidCacheType:{code:"invalid_cache_type",desc:"Invalid cache type"}},ir=function(n){function BrowserAuthError(s,m){var y=n.call(this,s,m)||this;return Object.setPrototypeOf(y,BrowserAuthError.prototype),y.name="BrowserAuthError",y}
return __extends(BrowserAuthError,n),BrowserAuthError.createNoWindowObjectError=function(){return new BrowserAuthError(nr.noWindowObjectError.code,nr.noWindowObjectError.desc)},BrowserAuthError.createPkceNotGeneratedError=function(n){return new BrowserAuthError(nr.pkceNotGenerated.code,nr.pkceNotGenerated.desc+" Detail:"+n)},BrowserAuthError.createCryptoNotAvailableError=function(n){return new BrowserAuthError(nr.cryptoDoesNotExist.code,nr.cryptoDoesNotExist.desc+" Detail:"+n)},BrowserAuthError.createHttpMethodNotImplementedError=function(n){return new BrowserAuthError(nr.httpMethodNotImplementedError.code,nr.httpMethodNotImplementedError.desc+" Given Method: "+n)},BrowserAuthError.createEmptyNavigationUriError=function(){return new BrowserAuthError(nr.emptyNavigateUriError.code,nr.emptyNavigateUriError.desc)},BrowserAuthError.createEmptyHashError=function(n){return new BrowserAuthError(nr.hashEmptyError.code,nr.hashEmptyError.desc+" Given Url: "+n)},
BrowserAuthError.createInteractionInProgressError=function(){return new BrowserAuthError(nr.interactionInProgress.code,nr.interactionInProgress.desc)},BrowserAuthError.createPopupWindowError=function(n){var s=nr.popUpWindowError.desc;return s=se.isEmpty(n)?s:s+" Details: "+n,new BrowserAuthError(nr.popUpWindowError.code,s)},BrowserAuthError.createEmptyWindowCreatedError=function(){return new BrowserAuthError(nr.emptyWindowError.code,nr.emptyWindowError.desc)},BrowserAuthError.createUserCancelledError=function(){return new BrowserAuthError(nr.userCancelledError.code,nr.userCancelledError.desc)},BrowserAuthError.createMonitorWindowTimeoutError=function(){return new BrowserAuthError(nr.monitorWindowTimeoutError.code,nr.monitorWindowTimeoutError.desc)},BrowserAuthError.createRedirectInIframeError=function(n){return new BrowserAuthError(nr.redirectInIframeError.code,nr.redirectInIframeError.desc+" (window.parent !== window) => "+n)},
BrowserAuthError.createBlockReloadInHiddenIframeError=function(){return new BrowserAuthError(nr.blockTokenRequestsInHiddenIframeError.code,nr.blockTokenRequestsInHiddenIframeError.desc)},BrowserAuthError.createIframeClosedPrematurelyError=function(){return new BrowserAuthError(nr.iframeClosedPrematurelyError.code,nr.iframeClosedPrematurelyError.desc)},BrowserAuthError.createSilentSSOInsufficientInfoError=function(){return new BrowserAuthError(nr.silentSSOInsufficientInfoError.code,nr.silentSSOInsufficientInfoError.desc)},BrowserAuthError.createSilentPromptValueError=function(n){return new BrowserAuthError(nr.silentPromptValueError.code,nr.silentPromptValueError.desc+" Given value: "+n)},BrowserAuthError.createTokenRequestCacheError=function(n){return new BrowserAuthError(nr.tokenRequestCacheError.code,nr.tokenRequestCacheError.desc+" Error Detail: "+n)},BrowserAuthError.createInvalidCacheTypeError=function(){
return new BrowserAuthError(nr.invalidCacheType.code,""+nr.invalidCacheType.desc)},BrowserAuthError}(_),or=function(){function XhrClient(){}return XhrClient.prototype.sendGetRequestAsync=function(n,s){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(m){return[2,this.sendRequestAsync(n,At.GET,s)]}))}))},XhrClient.prototype.sendPostRequestAsync=function(n,s){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(m){return[2,this.sendRequestAsync(n,At.POST,s)]}))}))},XhrClient.prototype.sendRequestAsync=function(n,s,m){var y=this;return new Promise((function(C,_){var E=new XMLHttpRequest;if(E.open(s,n,!0),y.setXhrHeaders(E,m),E.onload=function(){(E.status<200||E.status>=300)&&_(E.responseText);try{var n=JSON.parse(E.responseText),s={headers:y.getHeaderDict(E),body:n,status:E.status};C(s)}catch(n){_(E.responseText)}},E.onerror=function(){_(E.status)},"POST"===s&&m.body)E.send(m.body);else{
if("GET"!==s)throw ir.createHttpMethodNotImplementedError(s);E.send()}}))},XhrClient.prototype.setXhrHeaders=function(n,s){s&&s.headers&&Object.keys(s.headers).forEach((function(m){n.setRequestHeader(m,s.headers[m])}))},XhrClient.prototype.getHeaderDict=function(n){var s=n.getAllResponseHeaders().trim().split(/[\r\n]+/),m={};return s.forEach((function(n){var s=n.split(": "),y=s.shift(),C=s.join(": ");m[y]=C})),m},XhrClient}(),ar=function(){function BrowserUtils(){}return BrowserUtils.navigateWindow=function(n,s){s?window.location.replace(n):window.location.assign(n)},BrowserUtils.clearHash=function(){window.location.hash=""},BrowserUtils.replaceHash=function(n){var s=n.split("#");s.shift(),window.location.hash=s.length>0?s.join("#"):""},BrowserUtils.isInIframe=function(){return window.parent!==window},BrowserUtils.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},BrowserUtils.getHomepage=function(){var n=new ct(window.location.href).getUrlComponents()
;return n.Protocol+"//"+n.HostNameAndPort+"/"},BrowserUtils.getBrowserNetworkClient=function(){return window.fetch?new rr:new or},BrowserUtils.blockReloadInHiddenIframes=function(){if(ct.hashContainsKnownProperties(window.location.hash)&&BrowserUtils.isInIframe())throw ir.createBlockReloadInHiddenIframeError()},BrowserUtils.detectIEOrEdge=function(){var n=window.navigator.userAgent,s=n.indexOf("MSIE "),m=n.indexOf("Trident/"),y=n.indexOf("Edge/");return s>0||m>0||y>0},BrowserUtils}(),sr={clientId:"",authority:""+ve,knownAuthorities:[],cloudDiscoveryMetadata:"",redirectUri:"",postLogoutRedirectUri:"",navigateToLoginRequestUrl:!0,clientCapabilities:[]},cr={cacheLocation:Kt,storeAuthStateInCookie:!1},ur=__assign(__assign({},ht),{loggerOptions:{loggerCallback:function(){},piiLoggingEnabled:!1},networkClient:ar.getBrowserNetworkClient(),windowHashTimeout:6e4,iframeHashTimeout:6e3,loadFrameTimeout:ar.detectIEOrEdge()?500:0,asyncPopups:!1});var lr={redirectUriNotSet:{
code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},postLogoutUriNotSet:{code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},storageNotSupportedError:{code:"storage_not_supported",desc:"Given storage configuration option was not supported."},noRedirectCallbacksSet:{code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},invalidCallbackObject:{code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."}},dr=function(n){function BrowserConfigurationAuthError(s,m){var y=n.call(this,s,m)||this;return y.name="BrowserConfigurationAuthError",
Object.setPrototypeOf(y,BrowserConfigurationAuthError.prototype),y}return __extends(BrowserConfigurationAuthError,n),BrowserConfigurationAuthError.createRedirectUriEmptyError=function(){return new BrowserConfigurationAuthError(lr.redirectUriNotSet.code,lr.redirectUriNotSet.desc)},BrowserConfigurationAuthError.createPostLogoutRedirectUriEmptyError=function(){return new BrowserConfigurationAuthError(lr.postLogoutUriNotSet.code,lr.postLogoutUriNotSet.desc)},BrowserConfigurationAuthError.createStorageNotSupportedError=function(n){return new BrowserConfigurationAuthError(lr.storageNotSupportedError.code,lr.storageNotSupportedError.desc+" Given Location: "+n)},BrowserConfigurationAuthError.createInvalidCallbackObjectError=function(n){return new BrowserConfigurationAuthError(lr.invalidCallbackObject.code,lr.invalidCallbackObject.desc+" Given value for callback function: "+n)},BrowserConfigurationAuthError.createRedirectCallbacksNotSetError=function(){
return new BrowserConfigurationAuthError(lr.noRedirectCallbacksSet.code,lr.noRedirectCallbacksSet.desc)},BrowserConfigurationAuthError}(_),pr=function(n){function BrowserStorage(s,m){var y=n.call(this)||this;return y.validateWindowStorage(m.cacheLocation),y.cacheConfig=m,y.windowStorage=window[y.cacheConfig.cacheLocation],y.clientId=s,y.migrateCacheEntries(),y}return __extends(BrowserStorage,n),BrowserStorage.prototype.validateWindowStorage=function(n){if("undefined"==typeof window||!window)throw ir.createNoWindowObjectError();if(n!==Wt&&n!==Kt)throw dr.createStorageNotSupportedError(n);if(!!!window[n])throw dr.createStorageNotSupportedError(n)},BrowserStorage.prototype.migrateCacheEntries=function(){var n=this,s=ye+"."+ue.ID_TOKEN,m=ye+"."+ue.CLIENT_INFO,y=ye+"."+ue.ERROR,C=ye+"."+ue.ERROR_DESC,_=[this.windowStorage.getItem(s),this.windowStorage.getItem(m),this.windowStorage.getItem(y),this.windowStorage.getItem(C)]
;[ue.ID_TOKEN,ue.CLIENT_INFO,ue.ERROR,ue.ERROR_DESC].forEach((function(s,m){return n.migrateCacheEntry(s,_[m])}))},BrowserStorage.prototype.migrateCacheEntry=function(n,s){s&&this.setItem(this.generateCacheKey(n),s,Le.TEMPORARY)},BrowserStorage.prototype.validateObjectKey=function(n){JSON.parse(n)},BrowserStorage.prototype.setItem=function(n,s,m){switch(m){case Le.ACCOUNT:case Le.CREDENTIAL:case Le.APP_METADATA:this.windowStorage.setItem(n,JSON.stringify(s));break;case Le.TEMPORARY:var y=s;this.windowStorage.setItem(n,y),this.cacheConfig.storeAuthStateInCookie&&this.setItemCookie(n,y);break;case Le.TELEMETRY:this.windowStorage.setItem(n,JSON.stringify(s));break;default:throw ir.createInvalidCacheTypeError()}},BrowserStorage.prototype.getItem=function(n,s){var m=this.windowStorage.getItem(n);if(se.isEmpty(m))return null;switch(s){case Le.ACCOUNT:var y=new lt;return dt.toObject(y,JSON.parse(m));case Le.CREDENTIAL:switch(He.getCredentialType(n)){case Ue.ID_TOKEN:var C=new kt
;return dt.toObject(C,JSON.parse(m));case Ue.ACCESS_TOKEN:var _=new Mt;return dt.toObject(_,JSON.parse(m));case Ue.REFRESH_TOKEN:var E=new Ot;return dt.toObject(E,JSON.parse(m))}case Le.APP_METADATA:return JSON.parse(m);case Le.TEMPORARY:var w=this.getItemCookie(n);return this.cacheConfig.storeAuthStateInCookie?w:m;case Le.TELEMETRY:return JSON.parse(m);default:throw ir.createInvalidCacheTypeError()}},BrowserStorage.prototype.removeItem=function(n){return this.windowStorage.removeItem(n),this.cacheConfig.storeAuthStateInCookie&&this.clearItemCookie(n),!0},BrowserStorage.prototype.containsKey=function(n){return this.windowStorage.hasOwnProperty(n)},BrowserStorage.prototype.getKeys=function(){return Object.keys(this.windowStorage)},BrowserStorage.prototype.clear=function(){var n;for(n in this.removeAllAccounts(),this.removeAppMetadata(),this.windowStorage)!this.windowStorage.hasOwnProperty(n)||-1===n.indexOf(ye)&&-1===n.indexOf(this.clientId)||this.removeItem(n)},
BrowserStorage.prototype.setItemCookie=function(n,s,m){var y=encodeURIComponent(n)+"="+encodeURIComponent(s)+";path=/;";m&&(y+="expires="+this.getCookieExpirationTime(m)+";");document.cookie=y},BrowserStorage.prototype.getItemCookie=function(n){for(var s=encodeURIComponent(n)+"=",m=document.cookie.split(";"),y=0;y<m.length;y++){for(var C=m[y];" "===C.charAt(0);)C=C.substring(1);if(0===C.indexOf(s))return decodeURIComponent(C.substring(s.length,C.length))}return""},BrowserStorage.prototype.clearItemCookie=function(n){this.setItemCookie(n,"",-1)},BrowserStorage.prototype.clearMsalCookie=function(n){var s=n?xt.NONCE_IDTOKEN+"|"+n:xt.NONCE_IDTOKEN;this.clearItemCookie(this.generateCacheKey(s)),this.clearItemCookie(this.generateCacheKey(xt.REQUEST_STATE)),this.clearItemCookie(this.generateCacheKey(xt.ORIGIN_URI))},BrowserStorage.prototype.getCookieExpirationTime=function(n){var s=new Date;return new Date(s.getTime()+864e5*n).toUTCString()},BrowserStorage.prototype.getCache=function(){
return this.windowStorage},BrowserStorage.prototype.setCache=function(){},BrowserStorage.prototype.generateCacheKey=function(n){try{return this.validateObjectKey(n),n}catch(s){return se.startsWith(n,ye)||se.startsWith(n,ue.ADAL_ID_TOKEN)?n:ye+"."+this.clientId+"."+n}},BrowserStorage.prototype.generateAuthorityKey=function(n){return""+xt.AUTHORITY+Ee+n},BrowserStorage.prototype.generateNonceKey=function(n){return""+xt.NONCE_IDTOKEN+Ee+n},BrowserStorage.prototype.setAuthorityCache=function(n,s){var m=this.generateAuthorityKey(s);this.setItem(this.generateCacheKey(m),n,Le.TEMPORARY)},BrowserStorage.prototype.getCachedAuthority=function(){var n=this.getItem(this.generateCacheKey(xt.REQUEST_STATE),Le.TEMPORARY);return n?this.getItem(this.generateCacheKey(this.generateAuthorityKey(n)),Le.TEMPORARY):null},BrowserStorage.prototype.updateCacheEntries=function(n,s,m){this.setItem(this.generateCacheKey(xt.REQUEST_STATE),n,Le.TEMPORARY),
this.setItem(this.generateCacheKey(this.generateNonceKey(n)),s,Le.TEMPORARY),this.setAuthorityCache(m,n)},BrowserStorage.prototype.resetRequestCache=function(n){var s=this;this.getKeys().forEach((function(m){se.isEmpty(n)||-1===m.indexOf(n)||s.removeItem(m)})),this.removeItem(this.generateCacheKey(xt.REQUEST_STATE)),this.removeItem(this.generateCacheKey(xt.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(xt.ORIGIN_URI)),this.removeItem(this.generateCacheKey(xt.URL_HASH))},BrowserStorage.prototype.cleanRequest=function(){this.removeItem(this.generateCacheKey(Xt));var n=this.getItem(this.generateCacheKey(xt.REQUEST_STATE),Le.TEMPORARY);this.resetRequestCache(n||"")},BrowserStorage.prototype.cacheCodeRequest=function(n,s){this.setItem(this.generateCacheKey(xt.REQUEST_PARAMS),s.base64Encode(JSON.stringify(n)),Le.TEMPORARY)},BrowserStorage.prototype.getCachedRequest=function(n,s){try{
var m=this.getItem(this.generateCacheKey(xt.REQUEST_PARAMS),Le.TEMPORARY),y=JSON.parse(s.base64Decode(m));if(this.removeItem(this.generateCacheKey(xt.REQUEST_PARAMS)),se.isEmpty(y.authority)){var C=this.generateAuthorityKey(n),_=this.getItem(this.generateCacheKey(C),Le.TEMPORARY);y.authority=_}return y}catch(n){throw ir.createTokenRequestCacheError(n)}},BrowserStorage}(dt),fr=function(){function MathUtils(){}return MathUtils.decimalToHex=function(n){for(var s=n.toString(16);s.length<2;)s="0"+s;return s},MathUtils}(),hr=function(){function GuidGenerator(n){this.cryptoObj=n}return GuidGenerator.prototype.generateGuid=function(){try{var n=new Uint8Array(16);return this.cryptoObj.getRandomValues(n),n[6]|=64,n[6]&=79,n[8]|=128,n[8]&=191,
fr.decimalToHex(n[0])+fr.decimalToHex(n[1])+fr.decimalToHex(n[2])+fr.decimalToHex(n[3])+"-"+fr.decimalToHex(n[4])+fr.decimalToHex(n[5])+"-"+fr.decimalToHex(n[6])+fr.decimalToHex(n[7])+"-"+fr.decimalToHex(n[8])+fr.decimalToHex(n[9])+"-"+fr.decimalToHex(n[10])+fr.decimalToHex(n[11])+fr.decimalToHex(n[12])+fr.decimalToHex(n[13])+fr.decimalToHex(n[14])+fr.decimalToHex(n[15])}catch(n){for(var s="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",m="0123456789abcdef",y=0,C="",_=0;_<36;_++)"-"!==s[_]&&"4"!==s[_]&&(y=16*Math.random()|0),"x"===s[_]?C+=m[y]:"y"===s[_]?(y&=3,C+=m[y|=8]):C+=s[_];return C}},GuidGenerator.isGuid=function(n){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(n)},GuidGenerator}(),gr=function(){function BrowserStringUtils(){}return BrowserStringUtils.stringToUtf8Arr=function(n){for(var s,m=0,y=n.length,C=0;C<y;C++)m+=(s=n.charCodeAt(C))<128?1:s<2048?2:s<65536?3:s<2097152?4:s<67108864?5:6
;for(var _=new Uint8Array(m),E=0,w=0;E<m;w++)(s=n.charCodeAt(w))<128?_[E++]=s:s<2048?(_[E++]=192+(s>>>6),_[E++]=128+(63&s)):s<65536?(_[E++]=224+(s>>>12),_[E++]=128+(s>>>6&63),_[E++]=128+(63&s)):s<2097152?(_[E++]=240+(s>>>18),_[E++]=128+(s>>>12&63),_[E++]=128+(s>>>6&63),_[E++]=128+(63&s)):s<67108864?(_[E++]=248+(s>>>24),_[E++]=128+(s>>>18&63),_[E++]=128+(s>>>12&63),_[E++]=128+(s>>>6&63),_[E++]=128+(63&s)):(_[E++]=252+(s>>>30),_[E++]=128+(s>>>24&63),_[E++]=128+(s>>>18&63),_[E++]=128+(s>>>12&63),_[E++]=128+(s>>>6&63),_[E++]=128+(63&s));return _},BrowserStringUtils.utf8ArrToString=function(n){for(var s="",m=void 0,y=n.length,C=0;C<y;C++)m=n[C],
s+=String.fromCharCode(m>251&&m<254&&C+5<y?1073741824*(m-252)+(n[++C]-128<<24)+(n[++C]-128<<18)+(n[++C]-128<<12)+(n[++C]-128<<6)+n[++C]-128:m>247&&m<252&&C+4<y?(m-248<<24)+(n[++C]-128<<18)+(n[++C]-128<<12)+(n[++C]-128<<6)+n[++C]-128:m>239&&m<248&&C+3<y?(m-240<<18)+(n[++C]-128<<12)+(n[++C]-128<<6)+n[++C]-128:m>223&&m<240&&C+2<y?(m-224<<12)+(n[++C]-128<<6)+n[++C]-128:m>191&&m<224&&C+1<y?(m-192<<6)+n[++C]-128:m);return s},BrowserStringUtils}(),mr=function(){function Base64Encode(){}return Base64Encode.prototype.urlEncode=function(n){return encodeURIComponent(this.encode(n).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))},Base64Encode.prototype.urlEncodeArr=function(n){return this.base64EncArr(n).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},Base64Encode.prototype.encode=function(n){var s=gr.stringToUtf8Arr(n);return this.base64EncArr(s)},Base64Encode.prototype.base64EncArr=function(n){for(var s=(3-n.length%3)%3,m="",y=void 0,C=n.length,_=0,E=0;E<C;E++)y=E%3,
_|=n[E]<<(16>>>y&24),2!==y&&n.length-E!=1||(m+=String.fromCharCode(this.uint6ToB64(_>>>18&63),this.uint6ToB64(_>>>12&63),this.uint6ToB64(_>>>6&63),this.uint6ToB64(63&_)),_=0);return 0===s?m:m.substring(0,m.length-s)+(1===s?"=":"==")},Base64Encode.prototype.uint6ToB64=function(n){return n<26?n+65:n<52?n+71:n<62?n-4:62===n?43:63===n?47:65},Base64Encode}(),yr=function(){function Base64Decode(){}return Base64Decode.prototype.decode=function(n){var s=n.replace(/-/g,"+").replace(/_/g,"/");switch(s.length%4){case 0:break;case 2:s+="==";break;case 3:s+="=";break;default:throw new Error("Invalid base64 string")}var m=this.base64DecToArr(s);return decodeURIComponent(gr.utf8ArrToString(m))},Base64Decode.prototype.base64DecToArr=function(n,s){for(var m=n.replace(/[^A-Za-z0-9\+\/]/g,""),y=m.length,C=s?Math.ceil((3*y+1>>>2)/s)*s:3*y+1>>>2,_=new Uint8Array(C),E=void 0,w=void 0,S=0,I=0,T=0;T<y;T++)if(w=3&T,S|=this.b64ToUint6(m.charCodeAt(T))<<18-6*w,3===w||y-T==1){for(E=0;E<3&&I<C;E++,
I++)_[I]=S>>>(16>>>E&24)&255;S=0}return _},Base64Decode.prototype.b64ToUint6=function(n){return n>64&&n<91?n-65:n>96&&n<123?n-71:n>47&&n<58?n+4:43===n?62:47===n?63:0},Base64Decode}(),vr=function(){function PkceGenerator(n){this.base64Encode=new mr,this.cryptoObj=n}return PkceGenerator.prototype.generateCodes=function(){return __awaiter(this,void 0,void 0,(function(){var n,s;return __generator(this,(function(m){switch(m.label){case 0:return n=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(n)];case 1:return s=m.sent(),[2,{verifier:n,challenge:s}]}}))}))},PkceGenerator.prototype.generateCodeVerifier=function(){try{var n=new Uint8Array(32);return this.cryptoObj.getRandomValues(n),this.base64Encode.urlEncodeArr(n)}catch(n){throw ir.createPkceNotGeneratedError(n)}},PkceGenerator.prototype.generateCodeChallengeFromVerifier=function(n){return __awaiter(this,void 0,void 0,(function(){var s,m;return __generator(this,(function(y){switch(y.label){case 0:
return y.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(n)];case 1:return s=y.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(s))];case 2:throw m=y.sent(),ir.createPkceNotGeneratedError(m);case 3:return[2]}}))}))},PkceGenerator}(),Cr=function(){function BrowserCrypto(){if(!this.hasCryptoAPI())throw ir.createCryptoNotAvailableError("Browser crypto or msCrypto object not available.")}return BrowserCrypto.prototype.sha256Digest=function(n){return __awaiter(this,void 0,void 0,(function(){var s;return __generator(this,(function(m){return s=gr.stringToUtf8Arr(n),[2,this.hasIECrypto()?this.getMSCryptoDigest("SHA-256",s):this.getSubtleCryptoDigest("SHA-256",s)]}))}))},BrowserCrypto.prototype.getRandomValues=function(n){var s=window.msCrypto||window.crypto;if(!s.getRandomValues)throw ir.createCryptoNotAvailableError("getRandomValues does not exist.");s.getRandomValues(n)},BrowserCrypto.prototype.hasIECrypto=function(){return!!window.msCrypto},
BrowserCrypto.prototype.hasBrowserCrypto=function(){return!!window.crypto},BrowserCrypto.prototype.hasCryptoAPI=function(){return this.hasIECrypto()||this.hasBrowserCrypto()},BrowserCrypto.prototype.getSubtleCryptoDigest=function(n,s){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(m){return[2,window.crypto.subtle.digest(n,s)]}))}))},BrowserCrypto.prototype.getMSCryptoDigest=function(n,s){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(m){return[2,new Promise((function(m,y){var C=window.msCrypto.subtle.digest(n,s.buffer);C.addEventListener("complete",(function(n){m(n.target.result)})),C.addEventListener("error",(function(n){y(n)}))}))]}))}))},BrowserCrypto}(),_r=function(){function CryptoOps(){this.browserCrypto=new Cr,this.b64Encode=new mr,this.b64Decode=new yr,this.guidGenerator=new hr(this.browserCrypto),this.pkceGenerator=new vr(this.browserCrypto)}return CryptoOps.prototype.createNewGuid=function(){
return this.guidGenerator.generateGuid()},CryptoOps.prototype.base64Encode=function(n){return this.b64Encode.encode(n)},CryptoOps.prototype.base64Decode=function(n){return this.b64Decode.decode(n)},CryptoOps.prototype.generatePkceCodes=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(n){return[2,this.pkceGenerator.generateCodes()]}))}))},CryptoOps}(),Er=function(){function InteractionHandler(n,s){this.authModule=n,this.browserStorage=s}return InteractionHandler.prototype.handleCodeResponse=function(n){return __awaiter(this,void 0,void 0,(function(){var s,m,y,C,_;return __generator(this,(function(E){switch(E.label){case 0:if(se.isEmpty(n))throw ir.createEmptyHashError(n);return s=this.browserStorage.getItem(this.browserStorage.generateCacheKey(xt.REQUEST_STATE),Le.TEMPORARY),m=this.authModule.handleFragmentResponse(n,s),y=this.browserStorage.generateNonceKey(s),
C=this.browserStorage.getItem(this.browserStorage.generateCacheKey(y),Le.TEMPORARY),this.authCodeRequest.code=m,[4,this.authModule.acquireToken(this.authCodeRequest,C,s)];case 1:return _=E.sent(),this.browserStorage.cleanRequest(),[2,_]}}))}))},InteractionHandler}(),wr=function(n){function RedirectHandler(){return null!==n&&n.apply(this,arguments)||this}return __extends(RedirectHandler,n),RedirectHandler.prototype.initiateAuthRequest=function(n,s,m,y){if(se.isEmpty(n))throw this.authModule.logger.info("Navigate url is empty"),ir.createEmptyNavigationUriError();m&&this.browserStorage.setItem(this.browserStorage.generateCacheKey(xt.ORIGIN_URI),m,Le.TEMPORARY),this.browserStorage.setItem(this.browserStorage.generateCacheKey(Xt),Yt,Le.TEMPORARY),this.browserStorage.cacheCodeRequest(s,y),this.authModule.logger.infoPii("Navigate to:"+n);var C=ar.isInIframe();if(C)throw ir.createRedirectInIframeError(C);return ar.navigateWindow(n),window},
RedirectHandler.prototype.handleCodeResponse=function(n,s){return __awaiter(this,void 0,void 0,(function(){var m,y,C,_,E;return __generator(this,(function(w){switch(w.label){case 0:if(se.isEmpty(n))throw ir.createEmptyHashError(n);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Xt)),m=this.browserStorage.getItem(this.browserStorage.generateCacheKey(xt.REQUEST_STATE),Le.TEMPORARY),y=this.authModule.handleFragmentResponse(n,m),C=this.browserStorage.generateNonceKey(m),_=this.browserStorage.getItem(this.browserStorage.generateCacheKey(C),Le.TEMPORARY),this.authCodeRequest=this.browserStorage.getCachedRequest(m,s),this.authCodeRequest.code=y,[4,this.authModule.acquireToken(this.authCodeRequest,_,m)];case 1:return E=w.sent(),this.browserStorage.cleanRequest(),[2,E]}}))}))},RedirectHandler}(Er),Sr=function(n){function PopupHandler(s,m){var y=n.call(this,s,m)||this;return y.unloadWindow=y.unloadWindow.bind(y),y}return __extends(PopupHandler,n),
PopupHandler.prototype.initiateAuthRequest=function(n,s,m){if(se.isEmpty(n))throw this.authModule.logger.error("Navigate url is empty"),ir.createEmptyNavigationUriError();return this.authCodeRequest=s,this.browserStorage.setItem(this.browserStorage.generateCacheKey(Xt),Yt,Le.TEMPORARY),this.authModule.logger.infoPii("Navigate to:"+n),this.openPopup(n,m)},PopupHandler.prototype.monitorPopupForHash=function(n,s){var m=this;return new Promise((function(y,C){var _=s/Zt,E=0,w=setInterval((function(){if(n.closed)return m.cleanPopup(),clearInterval(w),void C(ir.createUserCancelledError());var s;try{s=n.location.href}catch(n){}if(!se.isEmpty(s)&&"about:blank"!==s){E++;var S=n.location.hash;return ct.hashContainsKnownProperties(S)?(m.cleanPopup(n),clearInterval(w),void y(S)):E>_?(m.cleanPopup(n),clearInterval(w),void C(ir.createMonitorWindowTimeoutError())):void 0}}),Zt)}))},PopupHandler.prototype.openPopup=function(n,s){try{var m=void 0
;if(s?(m=s).location.assign(n):void 0===s&&(m=PopupHandler.openSizedPopup(n)),!m)throw ir.createEmptyWindowCreatedError();return m.focus&&m.focus(),this.currentWindow=m,window.addEventListener("beforeunload",this.unloadWindow),m}catch(n){throw this.authModule.logger.error("error opening popup "+n.message),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Xt)),ir.createPopupWindowError(n.toString())}},PopupHandler.openSizedPopup=function(n){void 0===n&&(n="about:blank");var s=window.screenLeft?window.screenLeft:window.screenX,m=window.screenTop?window.screenTop:window.screenY,y=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,C=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,_=Math.max(0,y/2-$t/2+s),E=Math.max(0,C/2-Qt/2+m);return window.open(n,ge,"width="+$t+", height="+Qt+", top="+E+", left="+_)},PopupHandler.prototype.unloadWindow=function(n){this.browserStorage.cleanRequest(),
this.currentWindow.close(),delete n.returnValue},PopupHandler.prototype.cleanPopup=function(n){n&&n.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Xt))},PopupHandler}(Er),br=function(n){function SilentHandler(s,m,y){var C=n.call(this,s,m)||this;return C.loadFrameTimeout=y,C}return __extends(SilentHandler,n),SilentHandler.prototype.initiateAuthRequest=function(n,s,m){return __awaiter(this,void 0,void 0,(function(){var y,C;return __generator(this,(function(_){switch(_.label){case 0:if(se.isEmpty(n))throw this.authModule.logger.info("Navigate url is empty"),ir.createEmptyNavigationUriError();return this.authCodeRequest=s,y=m?"msalTokenFrame"+m:"msalTokenFrame",this.loadFrameTimeout?[4,this.loadFrame(n,y)]:[3,2];case 1:return C=_.sent(),[3,3];case 2:C=this.loadFrameSync(n,y),_.label=3;case 3:return[2,C]}}))}))},SilentHandler.prototype.monitorIframeForHash=function(n,s){var m=this
;return new Promise((function(y,C){var _=window.performance.now()+s,E=setInterval((function(){if(window.performance.now()>_)return m.removeHiddenIframe(n),clearInterval(E),void C(ir.createMonitorWindowTimeoutError());var s;try{s=n.contentWindow.location.href}catch(n){}if(!se.isEmpty(s)){var w=n.contentWindow.location.hash;return ct.hashContainsKnownProperties(w)?(m.removeHiddenIframe(n),clearInterval(E),void y(w)):void 0}}),Zt)}))},SilentHandler.prototype.loadFrame=function(n,s){var m=this;return new Promise((function(y,C){setTimeout((function(){var _=m.loadFrameSync(n,s);_?y(_):C("Unable to load iframe with name: "+s)}),m.loadFrameTimeout)}))},SilentHandler.prototype.loadFrameSync=function(n,s){var m=this.getHiddenIframe(s);return m?(""!==m.src&&"about:blank"!==m.src||(m.src=n),m):null},SilentHandler.prototype.getHiddenIframe=function(n){if(void 0===n)return null;var s=document.getElementById(n);if(!s){
if(document.createElement&&document.documentElement&&-1===window.navigator.userAgent.indexOf("MSIE 5.0")){var m=document.createElement("iframe");m.setAttribute("id",n),m.style.visibility="hidden",m.style.position="absolute",m.style.width=m.style.height="0",m.style.border="0",m.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),s=document.getElementsByTagName("body")[0].appendChild(m)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeend","<iframe name='"+n+"' id='"+n+"' style='display:none'></iframe>");window.frames&&window.frames[n]&&(s=window.frames[n])}return s},SilentHandler.prototype.removeHiddenIframe=function(n){document.body===n.parentNode&&document.body.removeChild(n)},SilentHandler}(Er),Ir=function(){function BrowserProtocolUtils(){}return BrowserProtocolUtils.extractBrowserRequestState=function(n,s){if(se.isEmpty(s))return null;try{return Ft.parseRequestState(n,s).libraryState.meta}catch(n){
throw ae.createInvalidStateError(s,n)}},BrowserProtocolUtils}(),Tr=function(){function PublicClientApplication(n){this.config=function buildConfiguration(n){var s=n.auth,m=n.cache,y=n.system;return{auth:__assign(__assign({},sr),s),cache:__assign(__assign({},cr),m),system:__assign(__assign({},ur),y)}}(n),this.browserCrypto=new _r,this.networkClient=this.config.system.networkClient,this.browserStorage=new pr(this.config.auth.clientId,this.config.cache),this.logger=new he(this.config.system.loggerOptions),ut.setTrustedAuthoritiesFromConfig(this.config.auth.knownAuthorities,this.config.auth.cloudDiscoveryMetadata),this.defaultAuthority=null}return PublicClientApplication.prototype.handleRedirectPromise=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(n){return[2,this.handleRedirectResponse()]}))}))},PublicClientApplication.prototype.handleRedirectResponse=function(){return __awaiter(this,void 0,void 0,(function(){var n,s,m,y,C,_
;return __generator(this,(function(E){return n=this.getRedirectResponseHash(),se.isEmpty(n)?[2,null]:(s=this.browserStorage.getItem(this.browserStorage.generateCacheKey(xt.ORIGIN_URI),Le.TEMPORARY),m=ct.removeHashFromUrl(s||""),y=ct.removeHashFromUrl(window.location.href),m===y&&this.config.auth.navigateToLoginRequestUrl?(s.indexOf("#")>-1&&ar.replaceHash(s),[2,this.handleHash(n)]):this.config.auth.navigateToLoginRequestUrl?(ar.isInIframe()||(C=this.browserStorage.generateCacheKey(xt.URL_HASH),this.browserStorage.setItem(C,n,Le.TEMPORARY),s&&"null"!==s?ar.navigateWindow(s,!0):(_=ar.getHomepage(),this.browserStorage.setItem(this.browserStorage.generateCacheKey(xt.ORIGIN_URI),_,Le.TEMPORARY),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),ar.navigateWindow(_,!0))),[2,null]):[2,this.handleHash(n)])}))}))},PublicClientApplication.prototype.getRedirectResponseHash=function(){
var n=window.location.hash,s=ct.hashContainsKnownProperties(n),m=this.browserStorage.getItem(this.browserStorage.generateCacheKey(xt.URL_HASH),Le.TEMPORARY);this.browserStorage.removeItem(this.browserStorage.generateCacheKey(xt.URL_HASH));var y=s?n:m;if(y){var C=ct.getDeserializedHash(y);return Ir.extractBrowserRequestState(this.browserCrypto,C.state).interactionType!==Rt.REDIRECT?null:(ar.clearHash(),y)}return this.browserStorage.cleanRequest(),null},PublicClientApplication.prototype.handleHash=function(n){return __awaiter(this,void 0,void 0,(function(){var s,m,y,C,_,E;return __generator(this,(function(w){switch(w.label){case 0:s=this.browserStorage.getItem(this.browserStorage.generateCacheKey(xt.REQUEST_PARAMS),Le.TEMPORARY),m=JSON.parse(this.browserCrypto.base64Decode(s)),y=this.initializeServerTelemetryManager(Pt.handleRedirectPromise,m.correlationId),w.label=1;case 1:return w.trys.push([1,4,,5]),C=this.browserStorage.getCachedAuthority(),[4,this.createAuthCodeClient(y,C)];case 2:
return _=w.sent(),[4,new wr(_,this.browserStorage).handleCodeResponse(n,this.browserCrypto)];case 3:return[2,w.sent()];case 4:throw E=w.sent(),y.cacheFailedRequest(E),this.browserStorage.cleanRequest(),E;case 5:return[2]}}))}))},PublicClientApplication.prototype.loginRedirect=function(n){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(s){return[2,this.acquireTokenRedirect(n||tr)]}))}))},PublicClientApplication.prototype.acquireTokenRedirect=function(n){return __awaiter(this,void 0,void 0,(function(){var s,m,y,C,_,E,w,S;return __generator(this,(function(I){switch(I.label){case 0:s=this.preflightInteractiveRequest(n,Rt.REDIRECT),m=this.initializeServerTelemetryManager(Pt.acquireTokenRedirect,s.correlationId),I.label=1;case 1:return I.trys.push([1,5,,6]),[4,this.initializeAuthorizationCodeRequest(s)];case 2:return y=I.sent(),[4,this.createAuthCodeClient(m,s.authority)];case 3:return C=I.sent(),_=new wr(C,this.browserStorage),[4,C.getAuthCodeUrl(s)]
;case 4:return E=I.sent(),w=n&&n.redirectStartPage||window.location.href,_.initiateAuthRequest(E,y,w,this.browserCrypto),[3,6];case 5:throw S=I.sent(),m.cacheFailedRequest(S),this.browserStorage.cleanRequest(),S;case 6:return[2]}}))}))},PublicClientApplication.prototype.loginPopup=function(n){return this.acquireTokenPopup(n||tr)},PublicClientApplication.prototype.acquireTokenPopup=function(n){if(this.config.system.asyncPopups)return this.acquireTokenPopupAsync(n);var s=Sr.openSizedPopup();return this.acquireTokenPopupAsync(n,s)},PublicClientApplication.prototype.acquireTokenPopupAsync=function(n,s){return __awaiter(this,void 0,void 0,(function(){var m,y,C,_,E,w,S,I,T;return __generator(this,(function(A){switch(A.label){case 0:m=this.preflightInteractiveRequest(n,Rt.POPUP),y=this.initializeServerTelemetryManager(Pt.acquireTokenPopup,m.correlationId),A.label=1;case 1:return A.trys.push([1,7,,8]),[4,this.initializeAuthorizationCodeRequest(m)];case 2:return C=A.sent(),
[4,this.createAuthCodeClient(y,m.authority)];case 3:return[4,(_=A.sent()).getAuthCodeUrl(m)];case 4:return E=A.sent(),w=new Sr(_,this.browserStorage),S=w.initiateAuthRequest(E,C,s),[4,w.monitorPopupForHash(S,this.config.system.windowHashTimeout)];case 5:return I=A.sent(),[4,w.handleCodeResponse(I)];case 6:return[2,A.sent()];case 7:throw T=A.sent(),y.cacheFailedRequest(T),this.browserStorage.cleanRequest(),T;case 8:return[2]}}))}))},PublicClientApplication.prototype.ssoSilent=function(n){return __awaiter(this,void 0,void 0,(function(){var s,m,y,C,_,E,w;return __generator(this,(function(S){switch(S.label){case 0:if(ar.blockReloadInHiddenIframes(),se.isEmpty(n.loginHint)&&se.isEmpty(n.sid))throw ir.createSilentSSOInsufficientInfoError();if(n.prompt&&n.prompt!==ke.NONE)throw ir.createSilentPromptValueError(n.prompt);s=this.initializeAuthorizationRequest(__assign(__assign({},n),{prompt:ke.NONE}),Rt.SILENT),m=this.initializeServerTelemetryManager(Pt.ssoSilent,s.correlationId),S.label=1
;case 1:return S.trys.push([1,6,,7]),[4,this.initializeAuthorizationCodeRequest(s)];case 2:return y=S.sent(),C=s.scopes?s.scopes.join(" "):"",[4,this.createAuthCodeClient(m,s.authority)];case 3:return[4,(_=S.sent()).getAuthCodeUrl(s)];case 4:return E=S.sent(),[4,this.silentTokenHelper(E,y,_,C)];case 5:return[2,S.sent()];case 6:throw w=S.sent(),m.cacheFailedRequest(w),this.browserStorage.cleanRequest(),w;case 7:return[2]}}))}))},PublicClientApplication.prototype.acquireTokenSilent=function(n){return __awaiter(this,void 0,void 0,(function(){var s,m,y,C,_,E,w,S,I,T,A,x;return __generator(this,(function(P){switch(P.label){case 0:ar.blockReloadInHiddenIframes(),s=__assign(__assign({},n),this.initializeBaseRequest(n)),m=this.initializeServerTelemetryManager(Pt.acquireTokenSilent_silentFlow,s.correlationId),P.label=1;case 1:return P.trys.push([1,4,,12]),[4,this.createSilentFlowClient(m,s.authority)];case 2:return[4,P.sent().acquireToken(s)];case 3:return[2,P.sent()];case 4:if(y=P.sent(),
m.cacheFailedRequest(y),C=y instanceof bt,_=y instanceof Ut,E=y.errorCode===Jt,!C||!E||_)return[3,11];w=this.initializeAuthorizationRequest(__assign(__assign({},s),{redirectUri:n.redirectUri,prompt:ke.NONE}),Rt.SILENT),m=this.initializeServerTelemetryManager(Pt.acquireTokenSilent_authCode,w.correlationId),P.label=5;case 5:return P.trys.push([5,10,,11]),[4,this.initializeAuthorizationCodeRequest(w)];case 6:return S=P.sent(),[4,this.createAuthCodeClient(m,w.authority)];case 7:return[4,(I=P.sent()).getAuthCodeUrl(w)];case 8:return T=P.sent(),A=w.scopes?w.scopes.join(" "):"",[4,this.silentTokenHelper(T,S,I,A)];case 9:return[2,P.sent()];case 10:throw x=P.sent(),m.cacheFailedRequest(x),this.browserStorage.cleanRequest(),x;case 11:throw y;case 12:return[2]}}))}))},PublicClientApplication.prototype.silentTokenHelper=function(n,s,m,y){return __awaiter(this,void 0,void 0,(function(){var C,_,E;return __generator(this,(function(w){switch(w.label){case 0:
return[4,(C=new br(m,this.browserStorage,this.config.system.loadFrameTimeout)).initiateAuthRequest(n,s,y)];case 1:return _=w.sent(),[4,C.monitorIframeForHash(_,this.config.system.iframeHashTimeout)];case 2:return E=w.sent(),[2,C.handleCodeResponse(E)]}}))}))},PublicClientApplication.prototype.logout=function(n){return __awaiter(this,void 0,void 0,(function(){var s,m,y;return __generator(this,(function(C){switch(C.label){case 0:return s=this.initializeLogoutRequest(n),[4,this.createAuthCodeClient(null,s&&s.authority)];case 1:return m=C.sent(),y=m.getLogoutUri(s),ar.navigateWindow(y),[2]}}))}))},PublicClientApplication.prototype.getAllAccounts=function(){return this.browserStorage.getAllAccounts()},PublicClientApplication.prototype.getAccountByUsername=function(n){var s=this.getAllAccounts();return!se.isEmpty(n)&&s&&s.length&&s.filter((function(s){return s.username.toLowerCase()===n.toLowerCase()}))[0]||null},PublicClientApplication.prototype.getAccountByHomeId=function(n){
var s=this.getAllAccounts();return!se.isEmpty(n)&&s&&s.length&&s.filter((function(s){return s.homeAccountId===n}))[0]||null},PublicClientApplication.prototype.getRedirectUri=function(n){return n||this.config.auth.redirectUri||ar.getCurrentUri()},PublicClientApplication.prototype.getPostLogoutRedirectUri=function(n){return n||this.config.auth.postLogoutRedirectUri||ar.getCurrentUri()},PublicClientApplication.prototype.getDiscoveredDefaultAuthority=function(){return __awaiter(this,void 0,void 0,(function(){var n;return __generator(this,(function(s){switch(s.label){case 0:return this.defaultAuthority?[3,2]:(n=this,[4,zt.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient)]);case 1:n.defaultAuthority=s.sent(),s.label=2;case 2:return[2,this.defaultAuthority]}}))}))},PublicClientApplication.prototype.interactionInProgress=function(){return this.browserStorage.getItem(this.browserStorage.generateCacheKey(Xt),Le.TEMPORARY)===Yt},
PublicClientApplication.prototype.createAuthCodeClient=function(n,s){return __awaiter(this,void 0,void 0,(function(){var m;return __generator(this,(function(y){switch(y.label){case 0:return[4,this.getClientConfiguration(n,s)];case 1:return m=y.sent(),[2,new Vt(m)]}}))}))},PublicClientApplication.prototype.createSilentFlowClient=function(n,s){return __awaiter(this,void 0,void 0,(function(){var m;return __generator(this,(function(y){switch(y.label){case 0:return[4,this.getClientConfiguration(n,s)];case 1:return m=y.sent(),[2,new Bt(m)]}}))}))},PublicClientApplication.prototype.getClientConfiguration=function(n,s){return __awaiter(this,void 0,void 0,(function(){var m,y;return __generator(this,(function(C){switch(C.label){case 0:return se.isEmpty(s)||s===this.config.auth.authority?[3,2]:[4,zt.createDiscoveredInstance(s,this.config.system.networkClient)];case 1:return y=C.sent(),[3,4];case 2:return[4,this.getDiscoveredDefaultAuthority()];case 3:y=C.sent(),C.label=4;case 4:return m=y,[2,{
authOptions:{clientId:this.config.auth.clientId,authority:m,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds},loggerOptions:{loggerCallback:this.config.system.loggerOptions.loggerCallback,piiLoggingEnabled:this.config.system.loggerOptions.piiLoggingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:n,libraryInfo:{sku:er,version:"2.1.0",cpu:"",os:""}}]}}))}))},PublicClientApplication.prototype.preflightInteractiveRequest=function(n,s){if(ar.blockReloadInHiddenIframes(),this.interactionInProgress())throw ir.createInteractionInProgressError();return this.initializeAuthorizationRequest(n,s)},PublicClientApplication.prototype.initializeBaseRequest=function(n){var s=__assign({},n)
;return se.isEmpty(s.authority)&&(s.authority=this.config.auth.authority),s.correlationId=n&&n.correlationId||this.browserCrypto.createNewGuid(),s},PublicClientApplication.prototype.initializeServerTelemetryManager=function(n,s,m){var y={clientId:this.config.auth.clientId,correlationId:s,apiId:n,forceRefresh:m||!1};return new jt(y,this.browserStorage)},PublicClientApplication.prototype.setDefaultScopes=function(n){return __assign(__assign({},n),{scopes:__spreadArrays(n&&n.scopes||[],tr.scopes)})},PublicClientApplication.prototype.initializeAuthorizationRequest=function(n,s){var m=__assign({},n);if(m.redirectUri=this.getRedirectUri(m.redirectUri),se.isEmpty(m.loginHint)){var y=this.browserStorage.getItem(ue.ADAL_ID_TOKEN,Le.TEMPORARY);if(!se.isEmpty(y)){var C=new It(y,this.browserCrypto);this.browserStorage.removeItem(ue.ADAL_ID_TOKEN),C.claims&&C.claims.upn&&(m.loginHint=C.claims.upn)}}var _={interactionType:s};return m.state=Ft.setRequestState(this.browserCrypto,n&&n.state||"",_),
se.isEmpty(m.nonce)&&(m.nonce=this.browserCrypto.createNewGuid()),m.responseMode=Me.FRAGMENT,m=__assign(__assign({},m),this.initializeBaseRequest(m)),this.browserStorage.updateCacheEntries(m.state,m.nonce,m.authority),__assign(__assign({},m),this.setDefaultScopes(m))},PublicClientApplication.prototype.initializeAuthorizationCodeRequest=function(n){return __awaiter(this,void 0,void 0,(function(){var s,m;return __generator(this,(function(y){switch(y.label){case 0:return[4,this.browserCrypto.generatePkceCodes()];case 1:return s=y.sent(),m=__assign(__assign({},n),{redirectUri:n.redirectUri,code:"",codeVerifier:s.verifier}),n.codeChallenge=s.challenge,n.codeChallengeMethod=Te,[2,m]}}))}))},PublicClientApplication.prototype.initializeLogoutRequest=function(n){var s=__assign({},n);return se.isEmpty(s.authority)&&(s.authority=this.config.auth.authority),s.correlationId=s&&s.correlationId||this.browserCrypto.createNewGuid(),
s.postLogoutRedirectUri=this.getPostLogoutRedirectUri(n?n.postLogoutRedirectUri:""),s},PublicClientApplication}()},126:function(n,s,m){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.client=void 0;const y=m(104);s.client=new y.PublicClientApplication({auth:{clientId:"67dc74f0-fb8c-47a4-8435-63253a3fc3bb",authority:"https://login.microsoftonline.com/organizations/",navigateToLoginRequestUrl:!1},cache:{cacheLocation:"localStorage"}})},20:function(n,s,m){"use strict";(function(n){m.d(s,"c",(function(){return y})),m.d(s,"d",(function(){return C})),m.d(s,"f",(function(){return _})),m.d(s,"e",(function(){return E})),m.d(s,"a",(function(){return getGlobal})),m.d(s,"b",(function(){return objCreateFn}));var y="function",C="object",_="undefined",E="prototype";function getGlobal(){return typeof globalThis!==_&&globalThis?globalThis:typeof self!==_&&self?self:typeof window!==_&&window?window:typeof n!==_&&n?n:null}function objCreateFn(n){var s=Object.create;if(s)return s(n)
;if(null==n)return{};var m=typeof n;if(m!==C&&m!==y)throw new TypeError("Object prototype may only be an Object:"+n);function tmpFunc(){}return tmpFunc[E]=n,new tmpFunc}var __extendStaticsFn=function(n,s){return(__extendStaticsFn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var m in s)s.hasOwnProperty(m)&&(n[m]=s[m])})(n,s)};var w=getGlobal()||{};!function(n,s,m){n.__assign=n.__assign||Object.assign||s,n.__extends=n.__extends||m}(w,(function __assignFn(n){for(var s,m=1,y=arguments.length;m<y;m++)for(var C in s=arguments[m])Object[E].hasOwnProperty.call(s,C)&&(n[C]=s[C]);return n}),(function __extendsFn(n,s){function __(){this.constructor=n}__extendStaticsFn(n,s),n[E]=null===s?objCreateFn(s):(__[E]=s[E],new __)})),__assign=w.__assign,__extends=w.__extends}).call(this,m(99))},202:function(n,s,m){n.exports=function(n){var s={};function r(m){if(s[m])return s[m].exports;var y=s[m]={i:m,l:!1,exports:{}}
;return n[m].call(y.exports,y,y.exports,r),y.l=!0,y.exports}return r.m=n,r.c=s,r.d=function(n,s,m){r.o(n,s)||Object.defineProperty(n,s,{enumerable:!0,get:m})},r.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},r.t=function(n,s){if(1&s&&(n=r(n)),8&s)return n;if(4&s&&"object"==typeof n&&n&&n.__esModule)return n;var m=Object.create(null);if(r.r(m),Object.defineProperty(m,"default",{enumerable:!0,value:n}),2&s&&"string"!=typeof n)for(var y in n)r.d(m,y,function(s){return n[s]}.bind(null,y));return m},r.n=function(n){var s=n&&n.__esModule?function(){return n.default}:function(){return n};return r.d(s,"a",s),s},r.o=function(n,s){return Object.prototype.hasOwnProperty.call(n,s)},r.p="",r(r.s=90)}({17:function(n,s,m){"use strict";s.__esModule=!0,s.default=void 0;var y=m(18),C=function(){function e(){}return e.getFirstMatch=function(n,s){var m=s.match(n)
;return m&&m.length>0&&m[1]||""},e.getSecondMatch=function(n,s){var m=s.match(n);return m&&m.length>1&&m[2]||""},e.matchAndReturnConst=function(n,s,m){if(n.test(s))return m},e.getWindowsVersionName=function(n){switch(n){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},e.getMacOSVersionName=function(n){var s=n.split(".").splice(0,2).map((function(n){return parseInt(n,10)||0}));if(s.push(0),10===s[0])switch(s[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},e.getAndroidVersionName=function(n){var s=n.split(".").splice(0,2).map((function(n){
return parseInt(n,10)||0}));if(s.push(0),!(1===s[0]&&s[1]<5))return 1===s[0]&&s[1]<6?"Cupcake":1===s[0]&&s[1]>=6?"Donut":2===s[0]&&s[1]<2?"Eclair":2===s[0]&&2===s[1]?"Froyo":2===s[0]&&s[1]>2?"Gingerbread":3===s[0]?"Honeycomb":4===s[0]&&s[1]<1?"Ice Cream Sandwich":4===s[0]&&s[1]<4?"Jelly Bean":4===s[0]&&s[1]>=4?"KitKat":5===s[0]?"Lollipop":6===s[0]?"Marshmallow":7===s[0]?"Nougat":8===s[0]?"Oreo":9===s[0]?"Pie":void 0},e.getVersionPrecision=function(n){return n.split(".").length},e.compareVersions=function(n,s,m){void 0===m&&(m=!1);var y=e.getVersionPrecision(n),C=e.getVersionPrecision(s),_=Math.max(y,C),E=0,w=e.map([n,s],(function(n){var s=_-e.getVersionPrecision(n),m=n+new Array(s+1).join(".0");return e.map(m.split("."),(function(n){return new Array(20-n.length).join("0")+n})).reverse()}));for(m&&(E=_-Math.min(y,C)),_-=1;_>=E;){if(w[0][_]>w[1][_])return 1;if(w[0][_]===w[1][_]){if(_===E)return 0;_-=1}else if(w[0][_]<w[1][_])return-1}},e.map=function(n,s){var m,y=[]
;if(Array.prototype.map)return Array.prototype.map.call(n,s);for(m=0;m<n.length;m+=1)y.push(s(n[m]));return y},e.find=function(n,s){var m,y;if(Array.prototype.find)return Array.prototype.find.call(n,s);for(m=0,y=n.length;m<y;m+=1){var C=n[m];if(s(C,m))return C}},e.assign=function(n){for(var s,m,y=n,C=arguments.length,_=new Array(C>1?C-1:0),E=1;E<C;E++)_[E-1]=arguments[E];if(Object.assign)return Object.assign.apply(Object,[n].concat(_));var o=function(){var n=_[s];"object"==typeof n&&null!==n&&Object.keys(n).forEach((function(s){y[s]=n[s]}))};for(s=0,m=_.length;s<m;s+=1)o();return n},e.getBrowserAlias=function(n){return y.BROWSER_ALIASES_MAP[n]},e.getBrowserTypeByAlias=function(n){return y.BROWSER_MAP[n]||""},e}();s.default=C,n.exports=s.default},18:function(n,s,m){"use strict";s.__esModule=!0,s.ENGINE_MAP=s.OS_MAP=s.PLATFORMS_MAP=s.BROWSER_MAP=s.BROWSER_ALIASES_MAP=void 0,s.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",
Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},s.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",
ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},s.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},s.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},s.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(n,s,m){"use strict";s.__esModule=!0,
s.default=void 0;var y,C=(y=m(91))&&y.__esModule?y:{default:y},_=m(18);function a(n,s){for(var m=0;m<s.length;m++){var y=s[m];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(n,y.key,y)}}var E=function(){function e(){}var n,s;return e.getParser=function(n,s){if(void 0===s&&(s=!1),"string"!=typeof n)throw new Error("UserAgent should be a string");return new C.default(n,s)},e.parse=function(n){return new C.default(n).getResult()},n=e,(s=[{key:"BROWSER_MAP",get:function(){return _.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return _.ENGINE_MAP}},{key:"OS_MAP",get:function(){return _.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return _.PLATFORMS_MAP}}])&&a(n,s),e}();s.default=E,n.exports=s.default},91:function(n,s,m){"use strict";s.__esModule=!0,s.default=void 0;var y=u(m(92)),C=u(m(93)),_=u(m(94)),E=u(m(95)),w=u(m(17));function u(n){return n&&n.__esModule?n:{default:n}}var S=function(){function e(n,s){if(void 0===s&&(s=!1),
null==n||""===n)throw new Error("UserAgent parameter can't be empty");this._ua=n,this.parsedResult={},!0!==s&&this.parse()}var n=e.prototype;return n.getUA=function(){return this._ua},n.test=function(n){return n.test(this._ua)},n.parseBrowser=function(){var n=this;this.parsedResult.browser={};var s=w.default.find(y.default,(function(s){if("function"==typeof s.test)return s.test(n);if(s.test instanceof Array)return s.test.some((function(s){return n.test(s)}));throw new Error("Browser's test function is not valid")}));return s&&(this.parsedResult.browser=s.describe(this.getUA())),this.parsedResult.browser},n.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},n.getBrowserName=function(n){return n?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},n.getBrowserVersion=function(){return this.getBrowser().version},n.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},
n.parseOS=function(){var n=this;this.parsedResult.os={};var s=w.default.find(C.default,(function(s){if("function"==typeof s.test)return s.test(n);if(s.test instanceof Array)return s.test.some((function(s){return n.test(s)}));throw new Error("Browser's test function is not valid")}));return s&&(this.parsedResult.os=s.describe(this.getUA())),this.parsedResult.os},n.getOSName=function(n){var s=this.getOS().name;return n?String(s).toLowerCase()||"":s||""},n.getOSVersion=function(){return this.getOS().version},n.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},n.getPlatformType=function(n){void 0===n&&(n=!1);var s=this.getPlatform().type;return n?String(s).toLowerCase()||"":s||""},n.parsePlatform=function(){var n=this;this.parsedResult.platform={};var s=w.default.find(_.default,(function(s){if("function"==typeof s.test)return s.test(n);if(s.test instanceof Array)return s.test.some((function(s){return n.test(s)}))
;throw new Error("Browser's test function is not valid")}));return s&&(this.parsedResult.platform=s.describe(this.getUA())),this.parsedResult.platform},n.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},n.getEngineName=function(n){return n?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},n.parseEngine=function(){var n=this;this.parsedResult.engine={};var s=w.default.find(E.default,(function(s){if("function"==typeof s.test)return s.test(n);if(s.test instanceof Array)return s.test.some((function(s){return n.test(s)}));throw new Error("Browser's test function is not valid")}));return s&&(this.parsedResult.engine=s.describe(this.getUA())),this.parsedResult.engine},n.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},n.getResult=function(){return w.default.assign({},this.parsedResult)},n.satisfies=function(n){var s=this,m={},y=0,C={},_=0
;if(Object.keys(n).forEach((function(s){var E=n[s];"string"==typeof E?(C[s]=E,_+=1):"object"==typeof E&&(m[s]=E,y+=1)})),y>0){var E=Object.keys(m),S=w.default.find(E,(function(n){return s.isOS(n)}));if(S){var I=this.satisfies(m[S]);if(void 0!==I)return I}var T=w.default.find(E,(function(n){return s.isPlatform(n)}));if(T){var A=this.satisfies(m[T]);if(void 0!==A)return A}}if(_>0){var x=Object.keys(C),P=w.default.find(x,(function(n){return s.isBrowser(n,!0)}));if(void 0!==P)return this.compareVersion(C[P])}},n.isBrowser=function(n,s){void 0===s&&(s=!1);var m=this.getBrowserName().toLowerCase(),y=n.toLowerCase(),C=w.default.getBrowserTypeByAlias(y);return s&&C&&(y=C.toLowerCase()),y===m},n.compareVersion=function(n){var s=[0],m=n,y=!1,C=this.getBrowserVersion();if("string"==typeof C)return">"===n[0]||"<"===n[0]?(m=n.substr(1),"="===n[1]?(y=!0,m=n.substr(2)):s=[],">"===n[0]?s.push(1):s.push(-1)):"="===n[0]?m=n.substr(1):"~"===n[0]&&(y=!0,m=n.substr(1)),
s.indexOf(w.default.compareVersions(C,m,y))>-1},n.isOS=function(n){return this.getOSName(!0)===String(n).toLowerCase()},n.isPlatform=function(n){return this.getPlatformType(!0)===String(n).toLowerCase()},n.isEngine=function(n){return this.getEngineName(!0)===String(n).toLowerCase()},n.is=function(n){return this.isBrowser(n)||this.isOS(n)||this.isPlatform(n)},n.some=function(n){var s=this;return void 0===n&&(n=[]),n.some((function(n){return s.is(n)}))},e}();s.default=S,n.exports=s.default},92:function(n,s,m){"use strict";s.__esModule=!0,s.default=void 0;var y,C=(y=m(17))&&y.__esModule?y:{default:y},_=/version\/(\d+(\.?_?\d+)+)/i,E=[{test:[/googlebot/i],describe:function(n){var s={name:"Googlebot"},m=C.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,n)||C.default.getFirstMatch(_,n);return m&&(s.version=m),s}},{test:[/opera/i],describe:function(n){var s={name:"Opera"},m=C.default.getFirstMatch(_,n)||C.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,n);return m&&(s.version=m),s}
},{test:[/opr\/|opios/i],describe:function(n){var s={name:"Opera"},m=C.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,n)||C.default.getFirstMatch(_,n);return m&&(s.version=m),s}},{test:[/SamsungBrowser/i],describe:function(n){var s={name:"Samsung Internet for Android"},m=C.default.getFirstMatch(_,n)||C.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,n);return m&&(s.version=m),s}},{test:[/Whale/i],describe:function(n){var s={name:"NAVER Whale Browser"},m=C.default.getFirstMatch(_,n)||C.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,n);return m&&(s.version=m),s}},{test:[/MZBrowser/i],describe:function(n){var s={name:"MZ Browser"},m=C.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,n)||C.default.getFirstMatch(_,n);return m&&(s.version=m),s}},{test:[/focus/i],describe:function(n){var s={name:"Focus"},m=C.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,n)||C.default.getFirstMatch(_,n);return m&&(s.version=m),s}},{test:[/swing/i],
describe:function(n){var s={name:"Swing"},m=C.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,n)||C.default.getFirstMatch(_,n);return m&&(s.version=m),s}},{test:[/coast/i],describe:function(n){var s={name:"Opera Coast"},m=C.default.getFirstMatch(_,n)||C.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,n);return m&&(s.version=m),s}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(n){var s={name:"Opera Touch"},m=C.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,n)||C.default.getFirstMatch(_,n);return m&&(s.version=m),s}},{test:[/yabrowser/i],describe:function(n){var s={name:"Yandex Browser"},m=C.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,n)||C.default.getFirstMatch(_,n);return m&&(s.version=m),s}},{test:[/ucbrowser/i],describe:function(n){var s={name:"UC Browser"},m=C.default.getFirstMatch(_,n)||C.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,n);return m&&(s.version=m),s}},{test:[/Maxthon|mxios/i],describe:function(n){var s={
name:"Maxthon"},m=C.default.getFirstMatch(_,n)||C.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,n);return m&&(s.version=m),s}},{test:[/epiphany/i],describe:function(n){var s={name:"Epiphany"},m=C.default.getFirstMatch(_,n)||C.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,n);return m&&(s.version=m),s}},{test:[/puffin/i],describe:function(n){var s={name:"Puffin"},m=C.default.getFirstMatch(_,n)||C.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,n);return m&&(s.version=m),s}},{test:[/sleipnir/i],describe:function(n){var s={name:"Sleipnir"},m=C.default.getFirstMatch(_,n)||C.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,n);return m&&(s.version=m),s}},{test:[/k-meleon/i],describe:function(n){var s={name:"K-Meleon"},m=C.default.getFirstMatch(_,n)||C.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,n);return m&&(s.version=m),s}},{test:[/micromessenger/i],describe:function(n){var s={name:"WeChat"
},m=C.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,n)||C.default.getFirstMatch(_,n);return m&&(s.version=m),s}},{test:[/qqbrowser/i],describe:function(n){var s={name:/qqbrowserlite/i.test(n)?"QQ Browser Lite":"QQ Browser"},m=C.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,n)||C.default.getFirstMatch(_,n);return m&&(s.version=m),s}},{test:[/msie|trident/i],describe:function(n){var s={name:"Internet Explorer"},m=C.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,n);return m&&(s.version=m),s}},{test:[/\sedg\//i],describe:function(n){var s={name:"Microsoft Edge"},m=C.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,n);return m&&(s.version=m),s}},{test:[/edg([ea]|ios)/i],describe:function(n){var s={name:"Microsoft Edge"},m=C.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,n);return m&&(s.version=m),s}},{test:[/vivaldi/i],describe:function(n){var s={name:"Vivaldi"},m=C.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,n)
;return m&&(s.version=m),s}},{test:[/seamonkey/i],describe:function(n){var s={name:"SeaMonkey"},m=C.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,n);return m&&(s.version=m),s}},{test:[/sailfish/i],describe:function(n){var s={name:"Sailfish"},m=C.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,n);return m&&(s.version=m),s}},{test:[/silk/i],describe:function(n){var s={name:"Amazon Silk"},m=C.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,n);return m&&(s.version=m),s}},{test:[/phantom/i],describe:function(n){var s={name:"PhantomJS"},m=C.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,n);return m&&(s.version=m),s}},{test:[/slimerjs/i],describe:function(n){var s={name:"SlimerJS"},m=C.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,n);return m&&(s.version=m),s}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(n){var s={name:"BlackBerry"},m=C.default.getFirstMatch(_,n)||C.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,n)
;return m&&(s.version=m),s}},{test:[/(web|hpw)[o0]s/i],describe:function(n){var s={name:"WebOS Browser"},m=C.default.getFirstMatch(_,n)||C.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,n);return m&&(s.version=m),s}},{test:[/bada/i],describe:function(n){var s={name:"Bada"},m=C.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,n);return m&&(s.version=m),s}},{test:[/tizen/i],describe:function(n){var s={name:"Tizen"},m=C.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,n)||C.default.getFirstMatch(_,n);return m&&(s.version=m),s}},{test:[/qupzilla/i],describe:function(n){var s={name:"QupZilla"},m=C.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,n)||C.default.getFirstMatch(_,n);return m&&(s.version=m),s}},{test:[/firefox|iceweasel|fxios/i],describe:function(n){var s={name:"Firefox"},m=C.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,n);return m&&(s.version=m),s}},{test:[/electron/i],describe:function(n){var s={
name:"Electron"},m=C.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,n);return m&&(s.version=m),s}},{test:[/chromium/i],describe:function(n){var s={name:"Chromium"},m=C.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,n)||C.default.getFirstMatch(_,n);return m&&(s.version=m),s}},{test:[/chrome|crios|crmo/i],describe:function(n){var s={name:"Chrome"},m=C.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,n);return m&&(s.version=m),s}},{test:[/GSA/i],describe:function(n){var s={name:"Google Search"},m=C.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,n);return m&&(s.version=m),s}},{test:function(n){var s=!n.test(/like android/i),m=n.test(/android/i);return s&&m},describe:function(n){var s={name:"Android Browser"},m=C.default.getFirstMatch(_,n);return m&&(s.version=m),s}},{test:[/playstation 4/i],describe:function(n){var s={name:"PlayStation 4"},m=C.default.getFirstMatch(_,n);return m&&(s.version=m),s}},{test:[/safari|applewebkit/i],describe:function(n){
var s={name:"Safari"},m=C.default.getFirstMatch(_,n);return m&&(s.version=m),s}},{test:[/.*/i],describe:function(n){var s=-1!==n.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:C.default.getFirstMatch(s,n),version:C.default.getSecondMatch(s,n)}}}];s.default=E,n.exports=s.default},93:function(n,s,m){"use strict";s.__esModule=!0,s.default=void 0;var y,C=(y=m(17))&&y.__esModule?y:{default:y},_=m(18),E=[{test:[/Roku\/DVP/],describe:function(n){var s=C.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,n);return{name:_.OS_MAP.Roku,version:s}}},{test:[/windows phone/i],describe:function(n){var s=C.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,n);return{name:_.OS_MAP.WindowsPhone,version:s}}},{test:[/windows /i],describe:function(n){var s=C.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,n),m=C.default.getWindowsVersionName(s);return{name:_.OS_MAP.Windows,version:s,versionName:m}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(n){var s={
name:_.OS_MAP.iOS},m=C.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,n);return m&&(s.version=m),s}},{test:[/macintosh/i],describe:function(n){var s=C.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,n).replace(/[_\s]/g,"."),m=C.default.getMacOSVersionName(s),y={name:_.OS_MAP.MacOS,version:s};return m&&(y.versionName=m),y}},{test:[/(ipod|iphone|ipad)/i],describe:function(n){var s=C.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,n).replace(/[_\s]/g,".");return{name:_.OS_MAP.iOS,version:s}}},{test:function(n){var s=!n.test(/like android/i),m=n.test(/android/i);return s&&m},describe:function(n){var s=C.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,n),m=C.default.getAndroidVersionName(s),y={name:_.OS_MAP.Android,version:s};return m&&(y.versionName=m),y}},{test:[/(web|hpw)[o0]s/i],describe:function(n){var s=C.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,n),m={name:_.OS_MAP.WebOS};return s&&s.length&&(m.version=s),m}},{
test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(n){var s=C.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,n)||C.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,n)||C.default.getFirstMatch(/\bbb(\d+)/i,n);return{name:_.OS_MAP.BlackBerry,version:s}}},{test:[/bada/i],describe:function(n){var s=C.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,n);return{name:_.OS_MAP.Bada,version:s}}},{test:[/tizen/i],describe:function(n){var s=C.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,n);return{name:_.OS_MAP.Tizen,version:s}}},{test:[/linux/i],describe:function(){return{name:_.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:_.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(n){var s=C.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,n);return{name:_.OS_MAP.PlayStation4,version:s}}}];s.default=E,n.exports=s.default},94:function(n,s,m){"use strict";s.__esModule=!0,s.default=void 0;var y,C=(y=m(17))&&y.__esModule?y:{default:y
},_=m(18),E=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(n){var s=C.default.getFirstMatch(/(can-l01)/i,n)&&"Nova",m={type:_.PLATFORMS_MAP.mobile,vendor:"Huawei"};return s&&(m.model=s),m}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:_.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:_.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:_.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:_.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:_.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:_.PLATFORMS_MAP.tablet}}},{test:function(n){var s=n.test(/ipod|iphone/i),m=n.test(/like (ipod|iphone)/i);return s&&!m},describe:function(n){
var s=C.default.getFirstMatch(/(ipod|iphone)/i,n);return{type:_.PLATFORMS_MAP.mobile,vendor:"Apple",model:s}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:_.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:_.PLATFORMS_MAP.mobile}}},{test:function(n){return"blackberry"===n.getBrowserName(!0)},describe:function(){return{type:_.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(n){return"bada"===n.getBrowserName(!0)},describe:function(){return{type:_.PLATFORMS_MAP.mobile}}},{test:function(n){return"windows phone"===n.getBrowserName()},describe:function(){return{type:_.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(n){var s=Number(String(n.getOSVersion()).split(".")[0]);return"android"===n.getOSName(!0)&&s>=3},describe:function(){return{type:_.PLATFORMS_MAP.tablet}}},{test:function(n){return"android"===n.getOSName(!0)},describe:function(){return{type:_.PLATFORMS_MAP.mobile}}},{test:function(n){
return"macos"===n.getOSName(!0)},describe:function(){return{type:_.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(n){return"windows"===n.getOSName(!0)},describe:function(){return{type:_.PLATFORMS_MAP.desktop}}},{test:function(n){return"linux"===n.getOSName(!0)},describe:function(){return{type:_.PLATFORMS_MAP.desktop}}},{test:function(n){return"playstation 4"===n.getOSName(!0)},describe:function(){return{type:_.PLATFORMS_MAP.tv}}},{test:function(n){return"roku"===n.getOSName(!0)},describe:function(){return{type:_.PLATFORMS_MAP.tv}}}];s.default=E,n.exports=s.default},95:function(n,s,m){"use strict";s.__esModule=!0,s.default=void 0;var y,C=(y=m(17))&&y.__esModule?y:{default:y},_=m(18),E=[{test:function(n){return"microsoft edge"===n.getBrowserName(!0)},describe:function(n){if(/\sedg\//i.test(n))return{name:_.ENGINE_MAP.Blink};var s=C.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,n);return{name:_.ENGINE_MAP.EdgeHTML,version:s}}},{test:[/trident/i],describe:function(n){var s={
name:_.ENGINE_MAP.Trident},m=C.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,n);return m&&(s.version=m),s}},{test:function(n){return n.test(/presto/i)},describe:function(n){var s={name:_.ENGINE_MAP.Presto},m=C.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,n);return m&&(s.version=m),s}},{test:function(n){var s=n.test(/gecko/i),m=n.test(/like gecko/i);return s&&!m},describe:function(n){var s={name:_.ENGINE_MAP.Gecko},m=C.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,n);return m&&(s.version=m),s}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:_.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(n){var s={name:_.ENGINE_MAP.WebKit},m=C.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,n);return m&&(s.version=m),s}}];s.default=E,n.exports=s.default}})},206:function(n,s,m){"use strict";m.r(s),m.d(s,"ApplicationInsights",(function(){return Wt})),m.d(s,"Telemetry",(function(){return jt})),m.d(s,"ApplicationInsightsContainer",(function(){return Xt
})),m.d(s,"AppInsightsCore",(function(){return ne})),m.d(s,"LoggingSeverity",(function(){return T})),m.d(s,"_InternalMessageId",(function(){return R})),m.d(s,"Util",(function(){return ue})),m.d(s,"SeverityLevel",(function(){return Ne})),m.d(s,"Event",(function(){return Ie})),m.d(s,"Exception",(function(){return Re})),m.d(s,"Metric",(function(){return Ue})),m.d(s,"PageView",(function(){return Fe})),m.d(s,"PageViewPerformance",(function(){return He})),m.d(s,"RemoteDependencyData",(function(){return qe})),m.d(s,"Trace",(function(){return Ve})),m.d(s,"DistributedTracingModes",(function(){return Y})),m.d(s,"Sender",(function(){return Et})),m.d(s,"ApplicationAnalytics",(function(){return tt})),m.d(s,"PropertiesPlugin",(function(){return kt})),m.d(s,"DependenciesPlugin",(function(){return zt}));var y={};m.r(y),m.d(y,"Util",(function(){return ue})),m.d(y,"CorrelationIdHelper",(function(){return de})),m.d(y,"UrlHelper",(function(){return le})),m.d(y,"DateTimeUtils",(function(){return fe})),
m.d(y,"ConnectionStringParser",(function(){return Ce})),m.d(y,"FieldType",(function(){return X})),m.d(y,"RequestHeaders",(function(){return ie})),m.d(y,"DisabledPropertyName",(function(){return he})),m.d(y,"ProcessLegacy",(function(){return me})),m.d(y,"SampleRate",(function(){return ge})),m.d(y,"HttpMethod",(function(){return ye})),m.d(y,"DEFAULT_BREEZE_ENDPOINT",(function(){return ve})),m.d(y,"AIData",(function(){return Ee})),m.d(y,"AIBase",(function(){return _e})),m.d(y,"Envelope",(function(){return we})),m.d(y,"Event",(function(){return Ie})),m.d(y,"Exception",(function(){return Re})),m.d(y,"Metric",(function(){return Ue})),m.d(y,"PageView",(function(){return Fe})),m.d(y,"PageViewData",(function(){return Le})),m.d(y,"RemoteDependencyData",(function(){return qe})),m.d(y,"Trace",(function(){return Ve})),m.d(y,"PageViewPerformance",(function(){return He})),m.d(y,"Data",(function(){return Be})),m.d(y,"SeverityLevel",(function(){return Ne})),m.d(y,"ConfigurationManager",(function(){
return Ge})),m.d(y,"ContextTagKeys",(function(){return ze})),m.d(y,"DataSanitizer",(function(){return oe})),m.d(y,"TelemetryItemCreator",(function(){return je})),m.d(y,"CtxTagKeys",(function(){return Ke})),m.d(y,"Extensions",(function(){return We})),m.d(y,"DistributedTracingModes",(function(){return Y})),m.d(y,"PropertiesPluginIdentifier",(function(){return Xe})),m.d(y,"BreezeChannelIdentifier",(function(){return Ye})),m.d(y,"AnalyticsPluginIdentifier",(function(){return Je}));var C=m(20),_=C.f,E=C.d,w=C.e,S=C.c,I=C.a;function getGlobalInst(n){var s=I();return s&&s[n]?s[n]:"window"===n&&hasWindow()?window:null}function hasWindow(){return Boolean(typeof window===E&&window)}function getWindow(){return hasWindow()?window:getGlobalInst("window")}function hasDocument(){return Boolean(typeof document===E&&document)}function getDocument(){return hasDocument()?document:getGlobalInst("document")}function getNavigator(){return function hasNavigator(){
return Boolean(typeof navigator===E&&navigator)}()?navigator:getGlobalInst("navigator")}function getHistory(){return function hasHistory(){return Boolean(typeof history===E&&history)}()?history:getGlobalInst("history")}function getLocation(){return typeof location===E&&location?location:getGlobalInst("location")}function getPerformance(){return getGlobalInst("performance")}function hasJSON(){return Boolean(typeof JSON===E&&JSON||null!==getGlobalInst("JSON"))}function getJSON(){return hasJSON()?JSON||getGlobalInst("JSON"):null}C.f;function _isTypeof(n,s){return typeof n===s}function _isUndefined(n){return _isTypeof(n,C.f)||void 0===n}function _isNullOrUndefined(n){return _isUndefined(n)||null===n}function _hasOwnProperty(n,s){return n&&Object[C.e].hasOwnProperty.call(n,s)}function _isObject(n){return _isTypeof(n,C.d)}function _isFunction(n){return _isTypeof(n,C.c)}function _attachEvent(n,s,m,y){void 0===y&&(y=!1);var C=!1;if(!_isNullOrUndefined(n))try{
_isNullOrUndefined(n.addEventListener)?_isNullOrUndefined(n.attachEvent)||(n.attachEvent("on"+s,m),C=!0):(n.addEventListener(s,m,y),C=!0)}catch(n){}return C}function _detachEvent(n,s,m,y){if(void 0===y&&(y=!1),!_isNullOrUndefined(n))try{_isNullOrUndefined(n.removeEventListener)?_isNullOrUndefined(n.detachEvent)||n.detachEvent("on"+s,m):n.removeEventListener(s,m,y)}catch(n){}}var T,A=function(){function CoreUtils(){}return CoreUtils.isDate=function(n){return"[object Date]"===Object[C.e].toString.call(n)},CoreUtils.isArray=function(n){return"[object Array]"===Object[C.e].toString.call(n)},CoreUtils.isError=function(n){return"[object Error]"===Object[C.e].toString.call(n)},CoreUtils.isString=function(n){return _isTypeof(n,"string")},CoreUtils.isNumber=function(n){return _isTypeof(n,"number")},CoreUtils.isBoolean=function(n){return _isTypeof(n,"boolean")},CoreUtils.disableCookies=function(){CoreUtils._canUseCookies=!1},CoreUtils.newGuid=function(){function randomHexDigit(){
var n=function getCrypto(){return getGlobalInst("crypto")}();return n?n.getRandomValues(new Uint8Array(1))[0]%16:16*Math.random()}return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(x,(function(n){var s=0|randomHexDigit();return("x"===n?s:3&s|8).toString(16)}))},CoreUtils.toISOString=function(n){if(CoreUtils.isDate(n)){var pad=function(n){var s=String(n);return 1===s.length&&(s="0"+s),s};return n.getUTCFullYear()+"-"+pad(n.getUTCMonth()+1)+"-"+pad(n.getUTCDate())+"T"+pad(n.getUTCHours())+":"+pad(n.getUTCMinutes())+":"+pad(n.getUTCSeconds())+"."+String((n.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}},CoreUtils.arrForEach=function(n,s,m){for(var y=n.length,C=0;C<y;C++)C in n&&s.call(m||n,n[C],C,n)},CoreUtils.arrIndexOf=function(n,s,m){for(var y=n.length,C=m||0,_=Math.max(C>=0?C:y-Math.abs(C),0);_<y;_++)if(_ in n&&n[_]===s)return _;return-1},CoreUtils.arrMap=function(n,s,m){for(var y=n.length,C=m||n,_=new Array(y),E=0;E<y;E++)E in n&&(_[E]=s.call(C,n[E],n));return _},
CoreUtils.arrReduce=function(n,s,m){var y,C=n.length,_=0;if(arguments.length>=3)y=arguments[2];else{for(;_<C&&!(_ in n);)_++;y=n[_++]}for(;_<C;)_ in n&&(y=s(y,n[_],_,n)),_++;return y},CoreUtils.strTrim=function(n){return CoreUtils.isString(n)?n.replace(/^\s+|\s+$/g,""):n},CoreUtils.objKeys=function(n){var s=!{toString:null}.propertyIsEnumerable("toString");if(!(_isFunction(n)||_isObject(n)&&null!==n))throw new TypeError("objKeys called on non-object");var m=[];for(var y in n)_hasOwnProperty(n,y)&&m.push(y);if(s)for(var C=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],_=C.length,E=0;E<_;E++)_hasOwnProperty(n,C[E])&&m.push(C[E]);return m},CoreUtils.objDefineAccessors=function(n,s,m,y){var C=Object.defineProperty;if(C)try{var _={enumerable:!0,configurable:!0};return m&&(_.get=m),y&&(_.set=y),C(n,s,_),!0}catch(n){}return!1},CoreUtils.addEventHandler=function(n,s){var m=!1,y=getWindow();y&&(m=_attachEvent(y,n,s),
m=_attachEvent(y.body,n,s)||m);var C=getDocument();return C&&(m=P.Attach(C,n,s)||m),m},CoreUtils.dateNow=function(){var n=Date;return n.now?n.now():(new n).getTime()},CoreUtils.perfNow=function(){var n=getPerformance();return n&&n.now?n.now():CoreUtils.dateNow()},CoreUtils.isTypeof=_isTypeof,CoreUtils.isUndefined=_isUndefined,CoreUtils.isNullOrUndefined=_isNullOrUndefined,CoreUtils.hasOwnProperty=_hasOwnProperty,CoreUtils.isFunction=_isFunction,CoreUtils.isObject=_isObject,CoreUtils.objCreate=C.b,CoreUtils}(),x=/[xy]/g,P=function(){function EventHelper(){}return EventHelper.Attach=_attachEvent,EventHelper.AttachEvent=_attachEvent,EventHelper.Detach=_detachEvent,EventHelper.DetachEvent=_detachEvent,EventHelper}();!function(n){n[n.CRITICAL=1]="CRITICAL",n[n.WARNING=2]="WARNING"}(T||(T={}));var R={BrowserDoesNotSupportLocalStorage:0,BrowserCannotReadLocalStorage:1,BrowserCannotReadSessionStorage:2,BrowserCannotWriteLocalStorage:3,BrowserCannotWriteSessionStorage:4,
BrowserFailedRemovalFromLocalStorage:5,BrowserFailedRemovalFromSessionStorage:6,CannotSendEmptyTelemetry:7,ClientPerformanceMathError:8,ErrorParsingAISessionCookie:9,ErrorPVCalc:10,ExceptionWhileLoggingError:11,FailedAddingTelemetryToBuffer:12,FailedMonitorAjaxAbort:13,FailedMonitorAjaxDur:14,FailedMonitorAjaxOpen:15,FailedMonitorAjaxRSC:16,FailedMonitorAjaxSend:17,FailedMonitorAjaxGetCorrelationHeader:18,FailedToAddHandlerForOnBeforeUnload:19,FailedToSendQueuedTelemetry:20,FailedToReportDataLoss:21,FlushFailed:22,MessageLimitPerPVExceeded:23,MissingRequiredFieldSpecification:24,NavigationTimingNotSupported:25,OnError:26,SessionRenewalDateIsZero:27,SenderNotInitialized:28,StartTrackEventFailed:29,StopTrackEventFailed:30,StartTrackFailed:31,StopTrackFailed:32,TelemetrySampledAndNotSent:33,TrackEventFailed:34,TrackExceptionFailed:35,TrackMetricFailed:36,TrackPVFailed:37,TrackPVFailedCalc:38,TrackTraceFailed:39,TransmissionFailed:40,FailedToSetStorageBuffer:41,
FailedToRestoreStorageBuffer:42,InvalidBackendResponse:43,FailedToFixDepricatedValues:44,InvalidDurationValue:45,TelemetryEnvelopeInvalid:46,CreateEnvelopeError:47,CannotSerializeObject:48,CannotSerializeObjectNonSerializable:49,CircularReferenceDetected:50,ClearAuthContextFailed:51,ExceptionTruncated:52,IllegalCharsInName:53,ItemNotInArray:54,MaxAjaxPerPVExceeded:55,MessageTruncated:56,NameTooLong:57,SampleRateOutOfRange:58,SetAuthContextFailed:59,SetAuthContextFailedAccountName:60,StringValueTooLong:61,StartCalledMoreThanOnce:62,StopCalledWithoutStart:63,TelemetryInitializerFailed:64,TrackArgumentsNotSpecified:65,UrlTooLong:66,SessionStorageBufferFull:67,CannotAccessCookie:68,IdTooLong:69,InvalidEvent:70,FailedMonitorAjaxSetRequestHeader:71,SendBrowserInfoOnUserInit:72,PluginException:73,NotificationException:74,SnippetScriptLoadFailure:99,InvalidInstrumentationKey:100},k=Object.getPrototypeOf,M=0;function dynamicproto_js_hasOwnProperty(n,s){
return n&&Object.prototype.hasOwnProperty.call(n,s)}function dynamicproto_js_isFunction(n){return"function"==typeof n}function _isObjectOrArrayPrototype(n){return n&&(n===Object.prototype||n===Array.prototype)}function _isObjectArrayOrFunctionPrototype(n){return _isObjectOrArrayPrototype(n)||n===Function.prototype}function _getObjProto(n){if(n){if(k)return k(n);var s=n.__proto__||n.prototype||n.constructor;if(s)return s}return null}function _isDynamicCandidate(n,s,m){return"constructor"!==s&&dynamicproto_js_isFunction(n[s])&&(m||dynamicproto_js_hasOwnProperty(n,s))}function _throwTypeError(n){throw new TypeError("DynamicProto: "+n)}function _hasVisited(n,s){for(var m=n.length-1;m>=0;m--)if(n[m]===s)return!0;return!1}function _getObjName(n,s){return dynamicproto_js_hasOwnProperty(n,"prototype")?n.name||s||"_unknown_":((n||{}).constructor||{}).name||s||"_unknown_"}var O=function dynamicProto(n,s,m){
dynamicproto_js_hasOwnProperty(n,"prototype")||_throwTypeError("theClass is an invalid class definition.");var y=n.prototype;(function _checkPrototype(n,s){for(var m=_getObjProto(s);m&&!_isObjectArrayOrFunctionPrototype(m);){if(m===n)return!0;m=_getObjProto(m)}return!1})(y,s)||_throwTypeError("["+_getObjName(n)+"] is not in class heirarchy of ["+_getObjName(s)+"]");var C=null;dynamicproto_js_hasOwnProperty(y,"_dynClass")?C=y._dynClass:(C="_dynCls$"+_getObjName(n,"_")+"$"+M,M++,y._dynClass=C);var _=function _getInstanceFuncs(n){var s={};for(var m in n)!s[m]&&_isDynamicCandidate(n,m,!1)&&(s[m]=n[m]);return s}(s);m(s,function _getBaseFuncs(n,s,m){function _instFuncProxy(n,s){return function(){return s.apply(n,arguments)}}var y={};for(var C in m)y[C]=_instFuncProxy(s,m[C]);for(var _=_getObjProto(n),E=[];_&&!_isObjectArrayOrFunctionPrototype(_)&&!_hasVisited(E,_);){for(var C in _)!y[C]&&_isDynamicCandidate(_,C,!k)&&(y[C]=_instFuncProxy(s,_[C]));E.push(_),_=_getObjProto(_)}return y}(y,s,_)),
function _populatePrototype(n,s,m,y){function _createDynamicPrototype(n,s){var dynProtoProxy=function(){var m=this;if(m&&dynamicproto_js_hasOwnProperty(n,"_dynClass")){var y=((m._dynInstFuncs||{})[n._dynClass]||{})[s];if(y)return y.apply(m,arguments);_throwTypeError("Missing ["+s+"] function")}var C=n[s];return C===dynProtoProxy&&(C=_getObjProto(n)[s]),dynamicproto_js_isFunction(C)||_throwTypeError("["+s+"] is not a function"),C.apply(m,arguments)};return dynProtoProxy._isDynProxy=1,dynProtoProxy}if(!_isObjectOrArrayPrototype(n)){var C=m._dynInstFuncs=m._dynInstFuncs||{},_=C[s]=C[s]||{};for(var E in m)_isDynamicCandidate(m,E,!1)&&m[E]!==y[E]&&(_[E]=m[E],delete m[E],(!dynamicproto_js_hasOwnProperty(n,E)||n[E]&&!n[E]._isDynProxy)&&(n[E]=_createDynamicPrototype(n,E)))}}(y,C,s,_)};function _sanitizeDiagnosticText(n){return n?'"'+n.replace(/\"/g,"")+'"':""}var N=function(){function _InternalLogMessage(n,s,m,y){void 0===m&&(m=!1);this.messageId=n,this.message=(m?"AI: ":"AI (Internal): ")+n
;var C="";hasJSON()&&(C=getJSON().stringify(y));var _=(s?" message:"+_sanitizeDiagnosticText(s):"")+(y?" props:"+_sanitizeDiagnosticText(C):"");this.message+=_}return _InternalLogMessage.dataType="MessageData",_InternalLogMessage}(),D=function(){function DiagnosticLogger(n){this.identifier="DiagnosticLogger",this.queue=[];var s=0,m={};O(DiagnosticLogger,this,(function(y){var C=A.isNullOrUndefined,E=A.isUndefined,w=A.isFunction;function _getConfigValue(s,m){var y=n[s];return C(y)?m:y}C(n)&&(n={}),y.consoleLoggingLevel=function(){return _getConfigValue("loggingLevelConsole",0)},y.telemetryLoggingLevel=function(){return _getConfigValue("loggingLevelTelemetry",1)},y.maxInternalMessageLimit=function(){return _getConfigValue("maxMessageLimit",25)},y.enableDebugExceptions=function(){return _getConfigValue("enableDebugExceptions",!1)},y.throwInternal=function(n,s,C,_,w){void 0===w&&(w=!1);var S=new N(s,C,w,_);if(y.enableDebugExceptions())throw S;if(!E(S)&&S&&!E(S.message)){if(w){
var I=+S.messageId;!m[I]&&y.consoleLoggingLevel()>=T.WARNING&&(y.warnToConsole(S.message),m[I]=!0)}else y.consoleLoggingLevel()>=T.WARNING&&y.warnToConsole(S.message);y.logInternalMessage(n,S)}},y.warnToConsole=function(n){var s=function getConsole(){return typeof console!==_?console:getGlobalInst("console")}();if(s){var m="log";s.warn&&(m="warn"),w(s[m])&&s[m](n)}},y.resetInternalMessageCount=function(){s=0,m={}},y.logInternalMessage=function(n,C){if(!function _areInternalMessagesThrottled(){return s>=y.maxInternalMessageLimit()}()){var _=!0,E="AITR_"+C.messageId;if(m[E]?_=!1:m[E]=!0,_&&(n<=y.telemetryLoggingLevel()&&(y.queue.push(C),s++),s===y.maxInternalMessageLimit())){var w="Internal events throttle limit per PageView reached for this app.",S=new N(R.MessageLimitPerPVExceeded,w,!1);y.queue.push(S),y.warnToConsole(w)}}}}))}return DiagnosticLogger.prototype.enableDebugExceptions=function(){return!1},DiagnosticLogger.prototype.consoleLoggingLevel=function(){return 0},
DiagnosticLogger.prototype.telemetryLoggingLevel=function(){return 1},DiagnosticLogger.prototype.maxInternalMessageLimit=function(){return 25},DiagnosticLogger.prototype.throwInternal=function(n,s,m,y,C){void 0===C&&(C=!1)},DiagnosticLogger.prototype.warnToConsole=function(n){},DiagnosticLogger.prototype.resetInternalMessageCount=function(){},DiagnosticLogger.prototype.logInternalMessage=function(n,s){},DiagnosticLogger}(),U=function(){function PerfEvent(n,s,m){var y,C=this,_=!1;(C.start=A.dateNow(),C.name=n,C.isAsync=m,C.isChildEvt=function(){return!1},A.isFunction(s))&&(_=A.objDefineAccessors(C,"payload",(function(){return!y&&A.isFunction(s)&&(y=s(),s=null),y})));C.getCtx=function(n){return n?n===PerfEvent.ParentContextKey||n===PerfEvent.ChildrenContextKey?C[n]:(C.ctx||{})[n]:null},C.setCtx=function(n,s){if(n)if(n===PerfEvent.ParentContextKey)C[n]||(C.isChildEvt=function(){return!0}),C[n]=s;else if(n===PerfEvent.ChildrenContextKey)C[n]=s;else{(C.ctx=C.ctx||{})[n]=s}},
C.complete=function(){var n=0,m=C.getCtx(PerfEvent.ChildrenContextKey);if(A.isArray(m))for(var y=0;y<m.length;y++){var E=m[y];E&&(n+=E.time)}C.time=A.dateNow()-C.start,C.exTime=C.time-n,C.complete=function(){},!_&&A.isFunction(s)&&(C.payload=s())}}return PerfEvent.ParentContextKey="parent",PerfEvent.ChildrenContextKey="childEvts",PerfEvent}(),L=function(){function PerfManager(n){this.ctx={},O(PerfManager,this,(function(s){s.create=function(n,s,m){return new U(n,s,m)},s.fire=function(s){s&&(s.complete(),n&&n.perfEvent(s))},s.setCtx=function(n,m){n&&((s.ctx=s.ctx||{})[n]=m)},s.getCtx=function(n){return(s.ctx||{})[n]}}))}return PerfManager.prototype.create=function(n,s,m){return null},PerfManager.prototype.fire=function(n){},PerfManager.prototype.setCtx=function(n,s){},PerfManager.prototype.getCtx=function(n){},PerfManager}();function doPerf(n,s,m,y,C){if(n){var _=n;if(_&&A.isFunction(_.getPerfMgr)&&(_=_.getPerfMgr()),_){var E=void 0,w=_.getCtx("CoreUtils.doPerf");try{
if(E=_.create(s(),y,C)){if(w&&E.setCtx&&(E.setCtx(U.ParentContextKey,w),w.getCtx&&w.setCtx)){var S=w.getCtx(U.ChildrenContextKey);S||(S=[],w.setCtx(U.ChildrenContextKey,S)),S.push(E)}return _.setCtx("CoreUtils.doPerf",E),m(E)}}catch(n){E&&E.setCtx&&E.setCtx("exception",n)}finally{E&&_.fire(E),_.setCtx("CoreUtils.doPerf",w)}}}return m()}var F=A.isFunction,q=function TelemetryPluginChain(n,s){var m=this,y=null,C=F(n.processTelemetry),_=F(n.setNextPlugin);m._hasRun=!1,m.getPlugin=function(){return n},m.getNext=function(){return y},m.setNext=function(n){y=n},m.processTelemetry=function(E,w){w||(w=s);var S=n?n.identifier:"TelemetryPluginChain";doPerf(w?w.core():null,(function(){return S+":processTelemetry"}),(function(){if(n&&C){m._hasRun=!0;try{w.setNext(y),_&&n.setNextPlugin(y),y&&(y._hasRun=!1),n.processTelemetry(E,w)}catch(m){var s=y&&y._hasRun;y&&s||w.diagLog().throwInternal(T.CRITICAL,R.PluginException,"Plugin ["+n.identifier+"] failed during processTelemetry - "+m),
y&&!s&&y.processTelemetry(E,w)}}else y&&(m._hasRun=!0,y.processTelemetry(E,w))}),(function(){return{item:E}}),!E.sync)}},H=A.isNullOrUndefined;function _createProxyChain(n,s){var m=[];if(n&&n.length>0)for(var y=null,C=0;C<n.length;C++){var _=n[C];if(_&&A.isFunction(_.processTelemetry)){var E=new q(_,s);m.push(E),y&&y.setNext(E),y=E}}return m.length>0?m[0]:null}var B=function ProcessTelemetryContext(n,s,m,y){var C=this,_=null;null!==y&&(n&&A.isFunction(n.getPlugin)?_=function _copyProxyChain(n,s,m){var y=[],C=!m;if(n)for(;n;){var _=n.getPlugin();(C||_===m)&&(C=!0,y.push(_)),n=n.getNext()}return C||y.push(m),_createProxyChain(y,s)}(n,C,y||n.getPlugin()):y?_=function _copyPluginChain(n,s,m){var y=n,C=!1;return m&&n&&(y=[],A.arrForEach(n,(function(n){(C||n===m)&&(C=!0,y.push(n))}))),m&&!C&&(y||(y=[]),y.push(m)),_createProxyChain(y,s)}(n,C,y):A.isUndefined(y)&&(_=_createProxyChain(n,C))),C.core=function(){return m},C.diagLog=function(){var n=(m||{}).logger;return n||(n=new D(s||{})),n},
C.getCfg=function(){return s},C.getExtCfg=function(n,m){var y;if(void 0===m&&(m={}),s){var C=s.extensionConfig;C&&n&&(y=C[n])}return y||m},C.getConfig=function(n,m,y){var _;void 0===y&&(y=!1);var E=C.getExtCfg(n,null);return E&&!H(E[m])?_=E[m]:s&&!H(s[m])&&(_=s[m]),H(_)?y:_},C.hasNext=function(){return null!=_},C.getNext=function(){return _},C.setNext=function(n){_=n},C.processNext=function(n){var s=_;s&&(_=s.getNext(),s.processTelemetry(n,C))},C.createNew=function(n,y){return void 0===n&&(n=null),new ProcessTelemetryContext(n||_,s,m,y)}},z=A.isFunction,j=function(){function BaseTelemetryPlugin(){var n=this,s=!1,m=null,y=null;n.core=null,n.diagLog=function(s){return n._getTelCtx(s).diagLog()},n.isInitialized=function(){return s},n.setInitialized=function(n){s=n},n.setNextPlugin=function(n){y=n},n.processNext=function(n,s){s?s.processNext(n):y&&z(y.processTelemetry)&&y.processTelemetry(n,null)},n._getTelCtx=function(s){void 0===s&&(s=null);var C=s;if(!C){var _=m||new B(null,{},n.core)
;C=y&&y.getPlugin?_.createNew(null,y.getPlugin):_.createNew(null,y)}return C},n._baseTelInit=function(C,_,E,w){C&&(C.extensionConfig=C.extensionConfig||[]),!w&&_&&(w=_.getProcessTelContext().getNext());var S=y;y&&y.getPlugin&&(S=y.getPlugin()),n.core=_,m=new B(w,C,_,S),s=!0}}return BaseTelemetryPlugin.prototype.initialize=function(n,s,m,y){this._baseTelInit(n,s,m,y)},BaseTelemetryPlugin}(),W=A.isFunction;function initializePlugins(n,s){for(var m=[],y=null,C=n.getNext();C;){var _=C.getPlugin();_&&(y&&W(y.setNextPlugin)&&W(_.processTelemetry)&&y.setNextPlugin(_),W(_.isInitialized)&&_.isInitialized()||m.push(_),y=_,C=C.getNext())}A.arrForEach(m,(function(m){m.initialize(n.getCfg(),n.core(),s,n.getNext())}))}function sortPlugins(n){return n.sort((function(n,s){var m=0,y=W(s.processTelemetry);return W(n.processTelemetry)?m=y?n.priority-s.priority:1:y&&(m=-1),m}))}var K,X,Y,J=A.objDefineAccessors,$=function(n){function ChannelController(){var s=n.call(this)||this
;s.identifier="ChannelControllerPlugin",s.priority=500;var m,y=A.arrForEach;function _addChannelQueue(n){n&&n.length>0&&(function _checkQueuePriority(n){y(n,(function(n){if(n.priority<500)throw Error("Channel has invalid priority"+n.identifier)}))}(n=n.sort((function(n,s){return n.priority-s.priority}))),m.push(n))}return O(ChannelController,s,(function(n,C){n.setNextPlugin=function(n){},n.processTelemetry=function(n,C){m&&y(m,(function(m){m.length>0&&s._getTelCtx(C).createNew(m).processNext(n)}))},n.getChannelControls=function(){return m},n.initialize=function(s,_,E){n.isInitialized()||(C.initialize(s,_,E),s.isCookieUseDisabled&&A.disableCookies(),function _createChannelQueues(n,s){m=[],n&&y(n,(function(n){return _addChannelQueue(n)}));if(s){var C=[];y(s,(function(n){n.priority>500&&C.push(n)})),_addChannelQueue(C)}}((s||{}).channels,E),y(m,(function(n){return initializePlugins(new B(n,s,_),E)})))}})),s}return __extends(ChannelController,n),
ChannelController.prototype.processTelemetry=function(n,s){},ChannelController.prototype.getChannelControls=function(){return null},ChannelController.prototype.initialize=function(n,s,m){},ChannelController._staticInit=(J(ChannelController.prototype,"ChannelControls",ChannelController.prototype.getChannelControls),void J(ChannelController.prototype,"channelQueue",ChannelController.prototype.getChannelControls)),ChannelController}(j),Q=A.arrForEach,Z=A.isNullOrUndefined,ee=function(){function BaseCore(){var n,s,m,y,C=!1;O(BaseCore,this,(function(_){_._extensions=new Array,s=new $,n=[],_.isInitialized=function(){return C},_.initialize=function(n,y,E,w){if(_.isInitialized())throw Error("Core should not be initialized more than once");if(!n||Z(n.instrumentationKey))throw Error("Please provide instrumentation key");m=w,_._notificationManager=w,_.config=n||{},n.extensions=Z(n.extensions)?[]:n.extensions,(n.extensionConfig=Z(n.extensionConfig)?{}:n.extensionConfig).NotificationManager=w,
E||(E=A.objCreate({throwInternal:function(n,s,m,y,C){void 0===C&&(C=!1)},warnToConsole:function(n){},resetInternalMessageCount:function(){}})),_.logger=E;var S=[];S.push.apply(S,y.concat(n.extensions)),S=sortPlugins(S);var I=[],T=[],x={};if(Q(S,(function(n){if(Z(n)||Z(n.initialize))throw Error("Extensions must provide callback to initialize");var m=n.priority,y=n.identifier;n&&m&&(Z(x[m])?x[m]=y:E.warnToConsole("Two extensions have same priority #"+m+" - "+x[m]+", "+y)),!m||m<s.priority?I.push(n):T.push(n)})),S.push(s),I.push(s),S=sortPlugins(S),_._extensions=S,initializePlugins(new B([s],n,_),S),initializePlugins(new B(I,n,_),S),_._extensions=I,0===_.getTransmissionControls().length)throw new Error("No channels available");C=!0,_.releaseQueue()},_.getTransmissionControls=function(){return s.getChannelControls()},_.track=function(s){s.iKey||(s.iKey=_.config.instrumentationKey),s.time||(s.time=A.toISOString(new Date)),Z(s.ver)&&(s.ver="4.0"),
_.isInitialized()?_.getProcessTelContext().processNext(s):n.push(s)},_.getProcessTelContext=function(){var n=_._extensions,m=n;return n&&0!==n.length||(m=[s]),new B(m,_.config,_)},_.getNotifyMgr=function(){return m||(m=A.objCreate({addNotificationListener:function(n){},removeNotificationListener:function(n){},eventsSent:function(n){},eventsDiscarded:function(n,s){},eventsSendRequest:function(n,s){}}),_._notificationManager=m),m},_.getPerfMgr=function(){return y||_.config&&_.config.enablePerfMgr&&(y=new L(_.getNotifyMgr())),y},_.setPerfMgr=function(n){y=n},_.eventCnt=function(){return n.length},_.releaseQueue=function(){n.length>0&&(Q(n,(function(n){_.getProcessTelContext().processNext(n)})),n=[])}}))}return BaseCore.prototype.initialize=function(n,s,m,y){},BaseCore.prototype.getTransmissionControls=function(){return null},BaseCore.prototype.track=function(n){},BaseCore.prototype.getProcessTelContext=function(){return null},BaseCore.prototype.getNotifyMgr=function(){return null},
BaseCore.prototype.getPerfMgr=function(){return null},BaseCore.prototype.setPerfMgr=function(n){},BaseCore.prototype.eventCnt=function(){return 0},BaseCore.prototype.releaseQueue=function(){},BaseCore}(),te=2,re=function(){function NotificationManager(n){this.listeners=[];var s=A.arrForEach,m=!!(n||{}).perfEvtsSendAll;O(NotificationManager,this,(function(n){n.addNotificationListener=function(s){n.listeners.push(s)},n.removeNotificationListener=function(s){for(var m=A.arrIndexOf(n.listeners,s);m>-1;)n.listeners.splice(m,1),m=A.arrIndexOf(n.listeners,s)},n.eventsSent=function(m){s(n.listeners,(function(n){n&&n.eventsSent&&setTimeout((function(){return n.eventsSent(m)}),0)}))},n.eventsDiscarded=function(m,y){s(n.listeners,(function(n){n&&n.eventsDiscarded&&setTimeout((function(){return n.eventsDiscarded(m,y)}),0)}))},n.eventsSendRequest=function(m,y){s(n.listeners,(function(n){if(n&&n.eventsSendRequest)if(y)setTimeout((function(){return n.eventsSendRequest(m,y)}),0);else try{
n.eventsSendRequest(m,y)}catch(n){}}))},n.perfEvent=function(y){y&&(!m&&y.isChildEvt()||s(n.listeners,(function(n){if(n&&n.perfEvent)if(y.isAsync)setTimeout((function(){return n.perfEvent(y)}),0);else try{n.perfEvent(y)}catch(n){}})))}}))}return NotificationManager.prototype.addNotificationListener=function(n){},NotificationManager.prototype.removeNotificationListener=function(n){},NotificationManager.prototype.eventsSent=function(n){},NotificationManager.prototype.eventsDiscarded=function(n,s){},NotificationManager.prototype.eventsSendRequest=function(n,s){},NotificationManager}(),ne=function(n){function AppInsightsCore(){var s=n.call(this)||this;return O(AppInsightsCore,s,(function(n,s){function _notifyInvalidEvent(s){var m=n.getNotifyMgr();m&&m.eventsDiscarded([s],te)}n.initialize=function(n,m,y,C){s.initialize(n,m,y||new D(n),C||new re(n))},n.track=function(m){doPerf(n.getPerfMgr(),(function(){return"AppInsightsCore:track"}),(function(){if(null===m)throw _notifyInvalidEvent(m),
Error("Invalid telemetry item");!function _validateTelemetryItem(n){if(A.isNullOrUndefined(n.name))throw _notifyInvalidEvent(n),Error("telemetry name required")}(m),s.track(m)}),(function(){return{item:m}}),!m.sync)},n.addNotificationListener=function(s){var m=n.getNotifyMgr();m&&m.addNotificationListener(s)},n.removeNotificationListener=function(s){var m=n.getNotifyMgr();m&&m.removeNotificationListener(s)},n.pollInternalLogs=function(s){var m=n.config.diagnosticLogInterval;return m&&m>0||(m=1e4),setInterval((function(){var m=n.logger?n.logger.queue:[];A.arrForEach(m,(function(m){var y={name:s||"InternalMessageId: "+m.messageId,iKey:n.config.instrumentationKey,time:A.toISOString(new Date),baseType:N.dataType,baseData:{message:m.message}};n.track(y)})),m.length=0}),m)}})),s}return __extends(AppInsightsCore,n),AppInsightsCore.prototype.initialize=function(n,s,m,y){},AppInsightsCore.prototype.track=function(n){},AppInsightsCore.prototype.addNotificationListener=function(n){},
AppInsightsCore.prototype.removeNotificationListener=function(n){},AppInsightsCore.prototype.pollInternalLogs=function(n){return 0},AppInsightsCore}(ee);!function(n){n[n.LocalStorage=0]="LocalStorage",n[n.SessionStorage=1]="SessionStorage"}(K||(K={})),function(n){n[n.Default=0]="Default",n[n.Required=1]="Required",n[n.Array=2]="Array",n[n.Hidden=4]="Hidden"}(X||(X={})),function(n){n[n.AI=0]="AI",n[n.AI_AND_W3C=1]="AI_AND_W3C",n[n.W3C=2]="W3C"}(Y||(Y={}));var ie=function(){function RequestHeaders(){}return RequestHeaders.requestContextHeader="Request-Context",RequestHeaders.requestContextTargetKey="appId",RequestHeaders.requestContextAppIdFormat="appId=cid-v1:",RequestHeaders.requestIdHeader="Request-Id",RequestHeaders.traceParentHeader="traceparent",RequestHeaders.sdkContextHeader="Sdk-Context",RequestHeaders.sdkContextHeaderAppIdRequest="appId",RequestHeaders.requestContextHeaderLowerCase="request-context",RequestHeaders}(),oe=function(){function DataSanitizer(){}
return DataSanitizer.sanitizeKeyAndAddUniqueness=function(n,s,m){var y=s.length,C=DataSanitizer.sanitizeKey(n,s);if(C.length!==y){for(var _=0,E=C;void 0!==m[E];)_++,E=C.substring(0,DataSanitizer.MAX_NAME_LENGTH-3)+DataSanitizer.padNumber(_);C=E}return C},DataSanitizer.sanitizeKey=function(n,s){var m;return s&&(s=DataSanitizer.trim(s.toString())).length>DataSanitizer.MAX_NAME_LENGTH&&(m=s.substring(0,DataSanitizer.MAX_NAME_LENGTH),n.throwInternal(T.WARNING,R.NameTooLong,"name is too long.  It has been truncated to "+DataSanitizer.MAX_NAME_LENGTH+" characters.",{name:s},!0)),m||s},DataSanitizer.sanitizeString=function(n,s,m){var y;return void 0===m&&(m=DataSanitizer.MAX_STRING_LENGTH),s&&(m=m||DataSanitizer.MAX_STRING_LENGTH,(s=DataSanitizer.trim(s)).toString().length>m&&(y=s.toString().substring(0,m),n.throwInternal(T.WARNING,R.StringValueTooLong,"string value is too long. It has been truncated to "+m+" characters.",{value:s},!0))),y||s},DataSanitizer.sanitizeUrl=function(n,s){
return DataSanitizer.sanitizeInput(n,s,DataSanitizer.MAX_URL_LENGTH,R.UrlTooLong)},DataSanitizer.sanitizeMessage=function(n,s){var m;return s&&s.length>DataSanitizer.MAX_MESSAGE_LENGTH&&(m=s.substring(0,DataSanitizer.MAX_MESSAGE_LENGTH),n.throwInternal(T.WARNING,R.MessageTruncated,"message is too long, it has been truncated to "+DataSanitizer.MAX_MESSAGE_LENGTH+" characters.",{message:s},!0)),m||s},DataSanitizer.sanitizeException=function(n,s){var m;return s&&s.length>DataSanitizer.MAX_EXCEPTION_LENGTH&&(m=s.substring(0,DataSanitizer.MAX_EXCEPTION_LENGTH),n.throwInternal(T.WARNING,R.ExceptionTruncated,"exception is too long, it has been truncated to "+DataSanitizer.MAX_EXCEPTION_LENGTH+" characters.",{exception:s},!0)),m||s},DataSanitizer.sanitizeProperties=function(n,s){if(s){var m={};for(var y in s){var C=s[y];if(A.isObject(C)&&hasJSON())try{C=getJSON().stringify(C)}catch(s){n.throwInternal(T.WARNING,R.CannotSerializeObjectNonSerializable,"custom property is not valid",{exception:s
},!0)}C=DataSanitizer.sanitizeString(n,C,DataSanitizer.MAX_PROPERTY_LENGTH),m[y=DataSanitizer.sanitizeKeyAndAddUniqueness(n,y,m)]=C}s=m}return s},DataSanitizer.sanitizeMeasurements=function(n,s){if(s){var m={};for(var y in s){var C=s[y];m[y=DataSanitizer.sanitizeKeyAndAddUniqueness(n,y,m)]=C}s=m}return s},DataSanitizer.sanitizeId=function(n,s){return s?DataSanitizer.sanitizeInput(n,s,DataSanitizer.MAX_ID_LENGTH,R.IdTooLong).toString():s},DataSanitizer.sanitizeInput=function(n,s,m,y){var C;return s&&(s=DataSanitizer.trim(s)).length>m&&(C=s.substring(0,m),n.throwInternal(T.WARNING,y,"input is too long, it has been truncated to "+m+" characters.",{data:s},!0)),C||s},DataSanitizer.padNumber=function(n){var s="00"+n;return s.substr(s.length-3)},DataSanitizer.trim=function(n){return A.isString(n)?n.replace(/^\s+|\s+$/g,""):n},DataSanitizer.MAX_NAME_LENGTH=150,DataSanitizer.MAX_ID_LENGTH=128,DataSanitizer.MAX_PROPERTY_LENGTH=8192,DataSanitizer.MAX_STRING_LENGTH=1024,
DataSanitizer.MAX_URL_LENGTH=2048,DataSanitizer.MAX_MESSAGE_LENGTH=32768,DataSanitizer.MAX_EXCEPTION_LENGTH=32768,DataSanitizer}(),ae=getNavigator(),se=A.isString,ce=null;var ue=function(){function Util(){}return Util.createDomEvent=function(n){var s=null;if(A.isFunction(Event))s=new Event(n);else{var m=getDocument();m&&m.createEvent&&(s=m.createEvent("Event")).initEvent(n,!0,!0)}return s},Util.disableStorage=function(){Util._canUseLocalStorage=!1,Util._canUseSessionStorage=!1},Util._getLocalStorageObject=function(){return Util.canUseLocalStorage()?Util._getVerifiedStorageObject(K.LocalStorage):null},Util._getVerifiedStorageObject=function(n){var s,m,y=null;try{if(A.isNullOrUndefined(I()))return null;m=new Date,(y=n===K.LocalStorage?getGlobalInst("localStorage"):getGlobalInst("sessionStorage")).setItem(m.toString(),m.toString()),s=y.getItem(m.toString())!==m.toString(),y.removeItem(m.toString()),s&&(y=null)}catch(n){y=null}return y},
Util.isInternalApplicationInsightsEndpoint=function(n){return-1!==Util._internalEndpoints.indexOf(n.toLowerCase())},Util.canUseLocalStorage=function(){return void 0===Util._canUseLocalStorage&&(Util._canUseLocalStorage=!!Util._getVerifiedStorageObject(K.LocalStorage)),Util._canUseLocalStorage},Util.getStorage=function(n,s){var m=Util._getLocalStorageObject();if(null!==m)try{return m.getItem(s)}catch(s){Util._canUseLocalStorage=!1,n.throwInternal(T.WARNING,R.BrowserCannotReadLocalStorage,"Browser failed read of local storage. "+Util.getExceptionName(s),{exception:Util.dump(s)})}return null},Util.setStorage=function(n,s,m){var y=Util._getLocalStorageObject();if(null!==y)try{return y.setItem(s,m),!0}catch(s){Util._canUseLocalStorage=!1,n.throwInternal(T.WARNING,R.BrowserCannotWriteLocalStorage,"Browser failed write to local storage. "+Util.getExceptionName(s),{exception:Util.dump(s)})}return!1},Util.removeStorage=function(n,s){var m=Util._getLocalStorageObject();if(null!==m)try{
return m.removeItem(s),!0}catch(s){Util._canUseLocalStorage=!1,n.throwInternal(T.WARNING,R.BrowserFailedRemovalFromLocalStorage,"Browser failed removal of local storage item. "+Util.getExceptionName(s),{exception:Util.dump(s)})}return!1},Util._getSessionStorageObject=function(){return Util.canUseSessionStorage()?Util._getVerifiedStorageObject(K.SessionStorage):null},Util.canUseSessionStorage=function(){return void 0===Util._canUseSessionStorage&&(Util._canUseSessionStorage=!!Util._getVerifiedStorageObject(K.SessionStorage)),Util._canUseSessionStorage},Util.getSessionStorageKeys=function(){var n=[];if(Util.canUseSessionStorage())for(var s in getGlobalInst("sessionStorage"))n.push(s);return n},Util.getSessionStorage=function(n,s){var m=Util._getSessionStorageObject();if(null!==m)try{return m.getItem(s)}catch(s){Util._canUseSessionStorage=!1,n.throwInternal(T.WARNING,R.BrowserCannotReadSessionStorage,"Browser failed read of session storage. "+Util.getExceptionName(s),{
exception:Util.dump(s)})}return null},Util.setSessionStorage=function(n,s,m){var y=Util._getSessionStorageObject();if(null!==y)try{return y.setItem(s,m),!0}catch(s){Util._canUseSessionStorage=!1,n.throwInternal(T.WARNING,R.BrowserCannotWriteSessionStorage,"Browser failed write to session storage. "+Util.getExceptionName(s),{exception:Util.dump(s)})}return!1},Util.removeSessionStorage=function(n,s){var m=Util._getSessionStorageObject();if(null!==m)try{return m.removeItem(s),!0}catch(s){Util._canUseSessionStorage=!1,n.throwInternal(T.WARNING,R.BrowserFailedRemovalFromSessionStorage,"Browser failed removal of session storage item. "+Util.getExceptionName(s),{exception:Util.dump(s)})}return!1},Util.disableCookies=function(){A.disableCookies()},Util.canUseCookies=function(n){if(void 0===A._canUseCookies){A._canUseCookies=!1;try{A._canUseCookies=void 0!==Util.document.cookie}catch(s){n.throwInternal(T.WARNING,R.CannotAccessCookie,"Cannot access document.cookie - "+Util.getExceptionName(s),{
exception:Util.dump(s)})}}return A._canUseCookies},Util.disallowsSameSiteNone=function(n){return!!se(n)&&(-1!==n.indexOf("CPU iPhone OS 12")||-1!==n.indexOf("iPad; CPU OS 12")||(-1!==n.indexOf("Macintosh; Intel Mac OS X 10_14")&&-1!==n.indexOf("Version/")&&-1!==n.indexOf("Safari")||(!(-1===n.indexOf("Macintosh; Intel Mac OS X 10_14")||!function _endsWith(n,s){var m=n.length,y=m-s.length;return n.substring(y>=0?y:0,m)===s}(n,"AppleWebKit/605.1.15 (KHTML, like Gecko)"))||(-1!==n.indexOf("Chrome/5")||-1!==n.indexOf("Chrome/6")||(-1!==n.indexOf("UnrealEngine")&&-1===n.indexOf("Chrome")||(-1!==n.indexOf("UCBrowser/12")||-1!==n.indexOf("UCBrowser/11")))))))},Util.setCookie=function(n,s,m,y){if(Util.canUseCookies(n)){var C="",_="";y&&(C=";domain="+y);var E=getLocation();E&&"https:"===E.protocol&&(_=";secure",null===ce&&(ce=Util.disallowsSameSiteNone((getNavigator()||{}).userAgent)),ce||(m+=";SameSite=None")),Util.document.cookie=s+"="+m+C+";path=/"+_}},
Util.stringToBoolOrDefault=function(n,s){return void 0===s&&(s=!1),null==n?s:"true"===n.toString().toLowerCase()},Util.getCookie=function(n,s){if(Util.canUseCookies(n)){var m="";if(s&&s.length)for(var y=s+"=",C=Util.document.cookie.split(";"),_=0;_<C.length;_++){var E=C[_];if((E=Util.trim(E))&&0===E.indexOf(y)){m=E.substring(y.length,C[_].length);break}}return m}},Util.deleteCookie=function(n,s){Util.canUseCookies(n)&&(Util.document.cookie=s+"=;path=/;expires=Thu, 01 Jan 1970 00:00:01 GMT;")},Util.newId=function(){for(var n="",s=1073741824*Math.random();s>0;){n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(s%64),s=Math.floor(s/64)}return n},Util.random32=function(){return 4294967296*Math.random()|0},Util.generateW3CId=function(){for(var n,s=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],m="",y=0;y<4;y++)m+=s[15&(n=Util.random32())]+s[n>>4&15]+s[n>>8&15]+s[n>>12&15]+s[n>>16&15]+s[n>>20&15]+s[n>>24&15]+s[n>>28&15]
;var C=s[8+4*Math.random()|0];return m.substr(0,8)+m.substr(9,4)+"4"+m.substr(13,3)+C+m.substr(16,3)+m.substr(19,12)},Util.getIEVersion=function(n){void 0===n&&(n=null);var s=n?n.toLowerCase():ae?(ae.userAgent||"").toLowerCase():"";if(-1!==s.indexOf("msie"))return parseInt(s.split("msie")[1]);if(s.indexOf("trident/")){var m=parseInt(s.split("trident/")[1]);if(m)return m+4}return null},Util.msToTimeSpan=function(n){(isNaN(n)||n<0)&&(n=0);var s=""+(n=Math.round(n))%1e3,m=""+Math.floor(n/1e3)%60,y=""+Math.floor(n/6e4)%60,C=""+Math.floor(n/36e5)%24,_=Math.floor(n/864e5);return s=1===s.length?"00"+s:2===s.length?"0"+s:s,m=m.length<2?"0"+m:m,y=y.length<2?"0"+y:y,(_>0?_+".":"")+(C=C.length<2?"0"+C:C)+":"+y+":"+m+"."+s},Util.isCrossOriginError=function(n,s,m,y,C){return("Script error."===n||"Script error"===n)&&!C},Util.dump=function(n){var s=Object[w].toString.call(n),m=""
;return"[object Error]"===s?m="{ stack: '"+n.stack+"', message: '"+n.message+"', name: '"+n.name+"'":hasJSON()&&(m=getJSON().stringify(n)),s+m},Util.getExceptionName=function(n){return"[object Error]"===Object[w].toString.call(n)?n.name:""},Util.addEventHandler=function(n,s){return P.Attach(getWindow(),n,s)},Util.IsBeaconApiSupported=function(){return"sendBeacon"in ae&&ae.sendBeacon},Util.getExtension=function(n,s){for(var m=null,y=0;!m&&y<n.length;)n[y]&&n[y].identifier===s&&(m=n[y]),y++;return m},Util.document=getDocument()||{},Util._canUseLocalStorage=void 0,Util._canUseSessionStorage=void 0,Util._internalEndpoints=["https://dc.services.visualstudio.com/v2/track","https://breeze.aimon.applicationinsights.io/v2/track","https://dc-int.services.visualstudio.com/v2/track"],Util.NotSpecified="not_specified",Util.trim=A.strTrim,Util.isArray=A.isArray,Util.isError=A.isError,Util.isDate=A.isDate,Util.toISOStringForIE8=A.toISOString,Util}(),le=function(){function UrlHelper(){}
return UrlHelper.parseUrl=function(n){var s=UrlHelper._htmlAnchorIdx,m=UrlHelper._htmlAnchorElement,y=m[s];return UrlHelper.document.createElement?m[s]||(y=m[s]=UrlHelper.document.createElement("a")):y={host:UrlHelper.parseHost(n,!0)},y.href=n,++s>=m.length&&(s=0),UrlHelper._htmlAnchorIdx=s,y},UrlHelper.getAbsoluteUrl=function(n){var s,m=UrlHelper.parseUrl(n);return m&&(s=m.href),s},UrlHelper.getPathName=function(n){var s,m=UrlHelper.parseUrl(n);return m&&(s=m.pathname),s},UrlHelper.getCompleteUrl=function(n,s){return n?n.toUpperCase()+" "+s:s},UrlHelper.parseHost=function(n,s){var m=UrlHelper.parseFullHost(n,s);if(m){var y=m.match(/(www[0-9]?\.)?(.[^/:]+)(\:[\d]+)?/i);if(null!=y&&y.length>3&&se(y[2])&&y[2].length>0)return y[2]+(y[3]||"")}return m},UrlHelper.parseFullHost=function(n,s){var m=null;if(n){var y=n.match(/(\w*):\/\/(.[^/:]+)(\:[\d]+)?/i);if(null!=y&&y.length>2&&se(y[2])&&y[2].length>0&&(m=y[2]||"",s&&y.length>2)){var C=(y[1]||"").toLowerCase(),_=y[3]||""
;("http"===C&&":80"===_||"https"===C&&":443"===_)&&(_=""),m+=_}}return m},UrlHelper.document=getDocument()||{},UrlHelper._htmlAnchorIdx=0,UrlHelper._htmlAnchorElement=[null,null,null,null,null],UrlHelper}(),de=function(){function CorrelationIdHelper(){}return CorrelationIdHelper.canIncludeCorrelationHeader=function(n,s,m){if(!s||n&&n.disableCorrelationHeaders)return!1;if(n&&n.correlationHeaderExcludePatterns)for(var y=0;y<n.correlationHeaderExcludePatterns.length;y++)if(n.correlationHeaderExcludePatterns[y].test(s))return!1;var C=le.parseUrl(s).host.toLowerCase();if(!C||-1===C.indexOf(":443")&&-1===C.indexOf(":80")||(C=(le.parseFullHost(s,!0)||"").toLowerCase()),!(n&&n.enableCorsCorrelation||C===m))return!1;var _,E=n&&n.correlationHeaderDomains;if(E&&(A.arrForEach(E,(function(n){var s=new RegExp(n.toLowerCase().replace(/\./g,".").replace(/\*/g,".*"));_=_||s.test(C)})),!_))return!1;var w=n&&n.correlationHeaderExcludedDomains;if(!w||0===w.length)return!0;for(y=0;y<w.length;y++){
if(new RegExp(w[y].toLowerCase().replace(/\./g,".").replace(/\*/g,".*")).test(C))return!1}return C&&C.length>0},CorrelationIdHelper.getCorrelationContext=function(n){if(n){var s=CorrelationIdHelper.getCorrelationContextValue(n,ie.requestContextTargetKey);if(s&&s!==CorrelationIdHelper.correlationIdPrefix)return s}},CorrelationIdHelper.getCorrelationContextValue=function(n,s){if(n)for(var m=n.split(","),y=0;y<m.length;++y){var C=m[y].split("=");if(2===C.length&&C[0]===s)return C[1]}},CorrelationIdHelper.correlationIdPrefix="cid-v1:",CorrelationIdHelper}(),pe=function(){function AjaxHelper(){}return AjaxHelper.ParseDependencyPath=function(n,s,m,y){var C,_=y,E=y;if(s&&s.length>0){var w=le.parseUrl(s);if(C=w.host,!_)if(null!=w.pathname){var S=0===w.pathname.length?"/":w.pathname;"/"!==S.charAt(0)&&(S="/"+S),E=w.pathname,_=oe.sanitizeString(n,m?m+" "+S:S)}else _=oe.sanitizeString(n,s)}else C=y,_=y;return{target:C,name:_,data:E}},AjaxHelper}(),fe=function(){function DateTimeUtils(){}
return DateTimeUtils.Now=function(){var n=getPerformance();return n&&n.now&&n.timing?n.now()+n.timing.navigationStart:(new Date).getTime()},DateTimeUtils.GetDuration=function(n,s){var m=null;return 0===n||0===s||A.isNullOrUndefined(n)||A.isNullOrUndefined(s)||(m=s-n),m},DateTimeUtils}(),he="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",ge="sampleRate",me="ProcessLegacy",ye="http.method",ve="https://dc.services.visualstudio.com",Ce=function(){function ConnectionStringParser(){}return ConnectionStringParser.parse=function(n){if(!n)return{};var s=n.split(ConnectionStringParser._FIELDS_SEPARATOR),m=A.arrReduce(s,(function(n,s){var m=s.split(ConnectionStringParser._FIELD_KEY_VALUE_SEPARATOR);if(2===m.length){var y=m[0].toLowerCase(),C=m[1];n[y]=C}return n}),{});if(A.objKeys(m).length>0){if(m.endpointsuffix){var y=m.location?m.location+".":"";m.ingestionendpoint=m.ingestionendpoint||"https://"+y+"dc."+m.endpointsuffix}m.ingestionendpoint=m.ingestionendpoint||ve}return m},
ConnectionStringParser._FIELDS_SEPARATOR=";",ConnectionStringParser._FIELD_KEY_VALUE_SEPARATOR="=",ConnectionStringParser}(),_e=function _e(){},Ee=function(n){function Data(){return n.call(this)||this}return __extends(Data,n),Data}(_e),we=function(n){function Envelope(s,m,y){var C=n.call(this)||this;return C.name=oe.sanitizeString(s,y)||ue.NotSpecified,C.data=m,C.time=A.toISOString(new Date),C.aiDataContract={time:X.Required,iKey:X.Required,name:X.Required,sampleRate:function(){return 100===C.sampleRate?X.Hidden:X.Required},tags:X.Required,data:X.Required},C}return __extends(Envelope,n),Envelope}((function Envelope(){this.ver=1,this.sampleRate=100,this.tags={}})),Se=function Se(){},be=function(n){function EventData(){var s=n.call(this)||this;return s.ver=2,s.properties={},s.measurements={},s}return __extends(EventData,n),EventData}(Se),Ie=function(n){function Event(s,m,y,C){var _=n.call(this)||this;return _.aiDataContract={ver:X.Required,name:X.Required,properties:X.Default,
measurements:X.Default},_.name=oe.sanitizeString(s,m)||ue.NotSpecified,_.properties=oe.sanitizeProperties(s,y),_.measurements=oe.sanitizeMeasurements(s,C),_}return __extends(Event,n),Event.envelopeType="Microsoft.ApplicationInsights.{0}.Event",Event.dataType="EventData",Event}(be),Te=function Te(){},Ae=function(n){function ExceptionData(){var s=n.call(this)||this;return s.ver=2,s.exceptions=[],s.properties={},s.measurements={},s}return __extends(ExceptionData,n),ExceptionData}(Se),xe=function xe(){this.hasFullStack=!0,this.parsedStack=[]};var Pe,Re=function(n){function Exception(s,m,y,C,_,E){var w=n.call(this)||this;return w.aiDataContract={ver:X.Required,exceptions:X.Required,severityLevel:X.Default,properties:X.Default,measurements:X.Default},!function _isExceptionInternal(n){return"ver"in n&&"exceptions"in n&&"properties"in n}(m)?(w.exceptions=[new ke(s,m)],w.properties=oe.sanitizeProperties(s,y)||{},w.measurements=oe.sanitizeMeasurements(s,C),_&&(w.severityLevel=_),
E&&(w.id=E)):(w.exceptions=m.exceptions,w.properties=m.properties,w.measurements=m.measurements,m.severityLevel&&(w.severityLevel=m.severityLevel),m.id&&(w.id=m.id),m.problemGroup&&(w.problemGroup=m.problemGroup),w.ver=2,A.isNullOrUndefined(m.isManual)||(w.isManual=m.isManual)),w}return __extends(Exception,n),Exception.CreateFromInterface=function(n,s,m,y){var C=s.exceptions&&A.arrMap(s.exceptions,(function(s){return ke.CreateFromInterface(n,s)}));return new Exception(n,__assign({},s,{exceptions:C}),m,y)},Exception.prototype.toInterface=function(){var n=this,s=n.exceptions,m=n.properties,y=n.measurements,C=n.severityLevel,_=(n.ver,n.problemGroup),E=n.id,w=n.isManual;return{ver:"4.0",exceptions:s instanceof Array&&A.arrMap(s,(function(n){return n.toInterface()}))||void 0,severityLevel:C,properties:m,measurements:y,problemGroup:_,id:E,isManual:w}},Exception.CreateSimpleException=function(n,s,m,y,C,_){return{exceptions:[{hasFullStack:!0,message:n,stack:C,typeName:s}]}},
Exception.envelopeType="Microsoft.ApplicationInsights.{0}.Exception",Exception.dataType="ExceptionData",Exception}(Ae),ke=function(n){function _ExceptionDetails(s,m){var y=n.call(this)||this;if(y.aiDataContract={id:X.Default,outerId:X.Default,typeName:X.Required,message:X.Required,hasFullStack:X.Default,stack:X.Default,parsedStack:X.Array},function _isExceptionDetailsInternal(n){return"hasFullStack"in n&&"typeName"in n}(m))y.typeName=m.typeName,y.message=m.message,y.stack=m.stack,y.parsedStack=m.parsedStack,y.hasFullStack=m.hasFullStack;else{var C=m;ue.isError(C)||(C=C.error||C.evt||C),y.typeName=oe.sanitizeString(s,function _getErrorType(n){var s="";if(n&&!(s=n.typeName||n.name||""))try{var m=/function (.{1,})\(/.exec(n.constructor.toString());s=m&&m.length>1?m[1]:""}catch(n){}return s}(C))||ue.NotSpecified,y.message=oe.sanitizeMessage(s,m.message)||ue.NotSpecified;var _=m.stack;y.parsedStack=_ExceptionDetails.parseStack(_),y.stack=oe.sanitizeException(s,_),
y.hasFullStack=ue.isArray(y.parsedStack)&&y.parsedStack.length>0}return y}return __extends(_ExceptionDetails,n),_ExceptionDetails.prototype.toInterface=function(){var n=this.parsedStack instanceof Array&&A.arrMap(this.parsedStack,(function(n){return n.toInterface()}));return{id:this.id,outerId:this.outerId,typeName:this.typeName,message:this.message,hasFullStack:this.hasFullStack,stack:this.stack,parsedStack:n||void 0}},_ExceptionDetails.CreateFromInterface=function(n,s){var m=s.parsedStack instanceof Array&&A.arrMap(s.parsedStack,(function(n){return Me.CreateFromInterface(n)}))||s.parsedStack;return new _ExceptionDetails(n,__assign({},s,{parsedStack:m}))},_ExceptionDetails.parseStack=function(n){var s;if(A.isString(n)){var m=n.split("\n");s=[];for(var y=0,C=0,_=0;_<=m.length;_++){var E=m[_];if(Me.regex.test(E)){var w=new Me(m[_],y++);C+=w.sizeInBytes,s.push(w)}}if(C>32768)for(var S=0,I=s.length-1,T=0,x=S,P=I;S<I;){if((T+=s[S].sizeInBytes+s[I].sizeInBytes)>32768){var R=P-x+1
;s.splice(x,R);break}x=S,P=I,S++,I--}}return s},_ExceptionDetails}(xe),Me=function(n){function _StackFrame(s,m){var y=n.call(this)||this;if(y.sizeInBytes=0,y.aiDataContract={level:X.Required,method:X.Required,assembly:X.Default,fileName:X.Default,line:X.Default},"string"==typeof s){var C=s;y.level=m,y.method="<no_method>",y.assembly=ue.trim(C),y.fileName="",y.line=0;var _=C.match(_StackFrame.regex);_&&_.length>=5&&(y.method=ue.trim(_[2])||y.method,y.fileName=ue.trim(_[4]),y.line=parseInt(_[5])||0)}else y.level=s.level,y.method=s.method,y.assembly=s.assembly,y.fileName=s.fileName,y.line=s.line,y.sizeInBytes=0;return y.sizeInBytes+=y.method.length,y.sizeInBytes+=y.fileName.length,y.sizeInBytes+=y.assembly.length,y.sizeInBytes+=_StackFrame.baseSize,y.sizeInBytes+=y.level.toString().length,y.sizeInBytes+=y.line.toString().length,y}return __extends(_StackFrame,n),_StackFrame.CreateFromInterface=function(n){return new _StackFrame(n,null)},_StackFrame.prototype.toInterface=function(){return{
level:this.level,method:this.method,assembly:this.assembly,fileName:this.fileName,line:this.line}},_StackFrame.regex=/^([\s]+at)?(.*?)(\@|\s\(|\s)([^\(\@\n]+):([0-9]+):([0-9]+)(\)?)$/,_StackFrame.baseSize=58,_StackFrame}(Te),Oe=function(n){function MetricData(){var s=n.call(this)||this;return s.ver=2,s.metrics=[],s.properties={},s.measurements={},s}return __extends(MetricData,n),MetricData}(Se);!function(n){n[n.Measurement=0]="Measurement",n[n.Aggregation=1]="Aggregation"}(Pe||(Pe={}));var Ne,De=function(n){function DataPoint(){var s=null!==n&&n.apply(this,arguments)||this;return s.aiDataContract={name:X.Required,kind:X.Default,value:X.Required,count:X.Default,min:X.Default,max:X.Default,stdDev:X.Default},s}return __extends(DataPoint,n),DataPoint}((function DataPoint(){this.kind=Pe.Measurement})),Ue=function(n){function Metric(s,m,y,C,_,E,w,S){var I=n.call(this)||this;I.aiDataContract={ver:X.Required,metrics:X.Required,properties:X.Default};var T=new De;return T.count=C>0?C:void 0,
T.max=isNaN(E)||null===E?void 0:E,T.min=isNaN(_)||null===_?void 0:_,T.name=oe.sanitizeString(s,m)||ue.NotSpecified,T.value=y,I.metrics=[T],I.properties=oe.sanitizeProperties(s,w),I.measurements=oe.sanitizeMeasurements(s,S),I}return __extends(Metric,n),Metric.envelopeType="Microsoft.ApplicationInsights.{0}.Metric",Metric.dataType="MetricData",Metric}(Oe),Le=function(n){function PageViewData(){var s=n.call(this)||this;return s.ver=2,s.properties={},s.measurements={},s}return __extends(PageViewData,n),PageViewData}(be),Fe=function(n){function PageView(s,m,y,C,_,E,w){var S=n.call(this)||this;return S.aiDataContract={ver:X.Required,name:X.Default,url:X.Default,duration:X.Default,properties:X.Default,measurements:X.Default,id:X.Default},S.id=oe.sanitizeId(s,w),S.url=oe.sanitizeUrl(s,y),S.name=oe.sanitizeString(s,m)||ue.NotSpecified,isNaN(C)||(S.duration=ue.msToTimeSpan(C)),S.properties=oe.sanitizeProperties(s,_),S.measurements=oe.sanitizeMeasurements(s,E),S}return __extends(PageView,n),
PageView.envelopeType="Microsoft.ApplicationInsights.{0}.Pageview",PageView.dataType="PageviewData",PageView}(Le),qe=function(n){function RemoteDependencyData(s,m,y,C,_,E,w,S,I,T,A,x){void 0===I&&(I="Ajax");var P=n.call(this)||this;P.aiDataContract={id:X.Required,ver:X.Required,name:X.Default,resultCode:X.Default,duration:X.Default,success:X.Default,data:X.Default,target:X.Default,type:X.Default,properties:X.Default,measurements:X.Default,kind:X.Default,value:X.Default,count:X.Default,min:X.Default,max:X.Default,stdDev:X.Default,dependencyKind:X.Default,dependencySource:X.Default,commandName:X.Default,dependencyTypeName:X.Default},P.id=m,P.duration=ue.msToTimeSpan(_),P.success=E,P.resultCode=w+"",P.type=oe.sanitizeString(s,I);var R=pe.ParseDependencyPath(s,y,S,C);return P.data=oe.sanitizeUrl(s,C)||R.data,P.target=oe.sanitizeString(s,R.target),T&&(P.target=P.target+" | "+T),P.name=oe.sanitizeString(s,R.name),P.properties=oe.sanitizeProperties(s,A),
P.measurements=oe.sanitizeMeasurements(s,x),P}return __extends(RemoteDependencyData,n),RemoteDependencyData.envelopeType="Microsoft.ApplicationInsights.{0}.RemoteDependency",RemoteDependencyData.dataType="RemoteDependencyData",RemoteDependencyData}(function(n){function RemoteDependencyData(){var s=n.call(this)||this;return s.ver=2,s.success=!0,s.properties={},s.measurements={},s}return __extends(RemoteDependencyData,n),RemoteDependencyData}(Se)),Ve=function(n){function Trace(s,m,y,C,_){var E=n.call(this)||this;return E.aiDataContract={ver:X.Required,message:X.Required,severityLevel:X.Default,properties:X.Default},m=m||ue.NotSpecified,E.message=oe.sanitizeMessage(s,m),E.properties=oe.sanitizeProperties(s,C),E.measurements=oe.sanitizeMeasurements(s,_),y&&(E.severityLevel=y),E}return __extends(Trace,n),Trace.envelopeType="Microsoft.ApplicationInsights.{0}.Message",Trace.dataType="MessageData",Trace}(function(n){function MessageData(){var s=n.call(this)||this;return s.ver=2,
s.properties={},s.measurements={},s}return __extends(MessageData,n),MessageData}(Se)),He=function(n){function PageViewPerformance(s,m,y,C,_,E,w){var S=n.call(this)||this;return S.aiDataContract={ver:X.Required,name:X.Default,url:X.Default,duration:X.Default,perfTotal:X.Default,networkConnect:X.Default,sentRequest:X.Default,receivedResponse:X.Default,domProcessing:X.Default,properties:X.Default,measurements:X.Default},S.url=oe.sanitizeUrl(s,y),S.name=oe.sanitizeString(s,m)||ue.NotSpecified,S.properties=oe.sanitizeProperties(s,_),S.measurements=oe.sanitizeMeasurements(s,E),w&&(S.domProcessing=w.domProcessing,S.duration=w.duration,S.networkConnect=w.networkConnect,S.perfTotal=w.perfTotal,S.receivedResponse=w.receivedResponse,S.sentRequest=w.sentRequest),S}return __extends(PageViewPerformance,n),PageViewPerformance.envelopeType="Microsoft.ApplicationInsights.{0}.PageviewPerformance",PageViewPerformance.dataType="PageviewPerformanceData",PageViewPerformance}(function(n){
function PageViewPerfData(){var s=n.call(this)||this;return s.ver=2,s.properties={},s.measurements={},s}return __extends(PageViewPerfData,n),PageViewPerfData}(Le)),Be=function(n){function Data(s,m){var y=n.call(this)||this;return y.aiDataContract={baseType:X.Required,baseData:X.Required},y.baseType=s,y.baseData=m,y}return __extends(Data,n),Data}(Ee);!function(n){n[n.Verbose=0]="Verbose",n[n.Information=1]="Information",n[n.Warning=2]="Warning",n[n.Error=3]="Error",n[n.Critical=4]="Critical"}(Ne||(Ne={}));var Ge=function(){function ConfigurationManager(){}return ConfigurationManager.getConfig=function(n,s,m,y){var C;return void 0===y&&(y=!1),C=m&&n.extensionConfig&&n.extensionConfig[m]&&!A.isNullOrUndefined(n.extensionConfig[m][s])?n.extensionConfig[m][s]:n[s],A.isNullOrUndefined(C)?y:C},ConfigurationManager}(),ze=function ze(){this.applicationVersion="ai.application.ver",this.applicationBuild="ai.application.build",this.applicationTypeId="ai.application.typeId",
this.applicationId="ai.application.applicationId",this.applicationLayer="ai.application.layer",this.deviceId="ai.device.id",this.deviceIp="ai.device.ip",this.deviceLanguage="ai.device.language",this.deviceLocale="ai.device.locale",this.deviceModel="ai.device.model",this.deviceFriendlyName="ai.device.friendlyName",this.deviceNetwork="ai.device.network",this.deviceNetworkName="ai.device.networkName",this.deviceOEMName="ai.device.oemName",this.deviceOS="ai.device.os",this.deviceOSVersion="ai.device.osVersion",this.deviceRoleInstance="ai.device.roleInstance",this.deviceRoleName="ai.device.roleName",this.deviceScreenResolution="ai.device.screenResolution",this.deviceType="ai.device.type",this.deviceMachineName="ai.device.machineName",this.deviceVMName="ai.device.vmName",this.deviceBrowser="ai.device.browser",this.deviceBrowserVersion="ai.device.browserVersion",this.locationIp="ai.location.ip",this.locationCountry="ai.location.country",this.locationProvince="ai.location.province",
this.locationCity="ai.location.city",this.operationId="ai.operation.id",this.operationName="ai.operation.name",this.operationParentId="ai.operation.parentId",this.operationRootId="ai.operation.rootId",this.operationSyntheticSource="ai.operation.syntheticSource",this.operationCorrelationVector="ai.operation.correlationVector",this.sessionId="ai.session.id",this.sessionIsFirst="ai.session.isFirst",this.sessionIsNew="ai.session.isNew",this.userAccountAcquisitionDate="ai.user.accountAcquisitionDate",this.userAccountId="ai.user.accountId",this.userAgent="ai.user.userAgent",this.userId="ai.user.id",this.userStoreRegion="ai.user.storeRegion",this.userAuthUserId="ai.user.authUserId",this.userAnonymousUserAcquisitionDate="ai.user.anonUserAcquisitionDate",this.userAuthenticatedUserAcquisitionDate="ai.user.authUserAcquisitionDate",this.cloudName="ai.cloud.name",this.cloudRole="ai.cloud.role",this.cloudRoleVer="ai.cloud.roleVer",this.cloudRoleInstance="ai.cloud.roleInstance",
this.cloudEnvironment="ai.cloud.environment",this.cloudLocation="ai.cloud.location",this.cloudDeploymentUnit="ai.cloud.deploymentUnit",this.internalNodeName="ai.internal.nodeName",this.internalSdkVersion="ai.internal.sdkVersion",this.internalAgentVersion="ai.internal.agentVersion",this.internalSnippet="ai.internal.snippet",this.internalSdkSrc="ai.internal.sdkSrc"},je=function(){function TelemetryItemCreator(){}return TelemetryItemCreator.create=function(n,s,m,y,C,_){if(m=oe.sanitizeString(y,m)||ue.NotSpecified,A.isNullOrUndefined(n)||A.isNullOrUndefined(s)||A.isNullOrUndefined(m))throw Error("Input doesn't contain all required fields");var E={name:m,time:A.toISOString(new Date),iKey:"",ext:_||{},tags:[],data:{},baseType:s,baseData:n};if(!A.isNullOrUndefined(C))for(var w in C)C.hasOwnProperty(w)&&(E.data[w]=C[w]);return E},TelemetryItemCreator}(),We=function(){function Extensions(){}return Extensions.UserExt="user",Extensions.DeviceExt="device",Extensions.TraceExt="trace",
Extensions.WebExt="web",Extensions.AppExt="app",Extensions.OSExt="os",Extensions.SessionExt="ses",Extensions.SDKExt="sdk",Extensions}(),Ke=new ze,Xe="AppInsightsPropertiesPlugin",Ye="AppInsightsChannelPlugin",Je="ApplicationInsightsAnalytics",$e=function PageViewManager(n,s,m,y){O(PageViewManager,this,(function(C){var _,E=A.arrForEach,w=A.isNullOrUndefined,S=null,I=[],x=!1;function _flushChannels(){m&&E(m.getTransmissionControls(),(function(n){E(n,(function(n){return n.flush(!0)}))}))}m&&(_=m.logger),C.trackPageView=function(m,C){var A=m.name;if(w(A)||"string"!=typeof A){var P=getDocument();A=m.name=P&&P.title||""}var k=m.uri;if(w(k)||"string"!=typeof k){var M=getLocation();k=m.uri=M&&M.href||""}if(!y.isPerformanceTimingSupported())return n.sendPageViewInternal(m,C),_flushChannels(),
void _.throwInternal(T.WARNING,R.NavigationTimingNotSupported,"trackPageView: navigation timing API used for calculation of page duration is not supported in this browser. This page view will be collected without duration and timing info.");var O,N,D=!1,U=y.getPerformanceTiming().navigationStart;O=fe.GetDuration(U,+new Date),y.shouldCollectDuration(O)||(O=void 0),w(C)||w(C.duration)||(N=C.duration),!s&&isNaN(N)||(isNaN(N)&&(C||(C={}),C.duration=O),n.sendPageViewInternal(m,C),_flushChannels(),D=!0),C||(C={}),function _addQueue(n){I.push(n),S||(S=setInterval((function(){var n=I.slice(0),s=!1;I=[],E(n,(function(n){n()?s=!0:I.push(n)})),0===I.length&&(clearInterval(S),S=null),s&&_flushChannels()}),100))}((function(){var s=!1;try{if(y.isPerformanceTimingDataReady()){s=!0;var E={name:A,uri:k};y.populatePageViewPerformanceEvent(E),E.isValid||D?(D||(C.duration=E.durationMs,n.sendPageViewInternal(m,C)),x||(n.sendPageViewPerformanceInternal(E,C),x=!0)):(C.duration=O,n.sendPageViewInternal(m,C))
}else fe.GetDuration(U,+new Date)>6e4&&(s=!0,D||(C.duration=6e4,n.sendPageViewInternal(m,C)))}catch(n){_.throwInternal(T.CRITICAL,R.TrackPVFailedCalc,"trackPageView failed on page load calculation: "+ue.getExceptionName(n),{exception:ue.dump(n)})}return s}))}}))},Qe=function(){function PageVisitTimeManager(n,s){this.prevPageVisitDataKeyName="prevPageVisitData",this.pageVisitTimeTrackingHandler=s,this._logger=n}return PageVisitTimeManager.prototype.trackPreviousPageVisit=function(n,s){try{var m=this.restartPageVisitTimer(n,s);m&&this.pageVisitTimeTrackingHandler(m.pageName,m.pageUrl,m.pageVisitTime)}catch(n){this._logger.warnToConsole("Auto track page visit time failed, metric will not be collected: "+ue.dump(n))}},PageVisitTimeManager.prototype.restartPageVisitTimer=function(n,s){try{var m=this.stopPageVisitTimer();return this.startPageVisitTimer(n,s),m}catch(n){return this._logger.warnToConsole("Call to restart failed: "+ue.dump(n)),null}},
PageVisitTimeManager.prototype.startPageVisitTimer=function(n,s){try{if(ue.canUseSessionStorage()){if(null!=ue.getSessionStorage(this._logger,this.prevPageVisitDataKeyName))throw new Error("Cannot call startPageVisit consecutively without first calling stopPageVisit");var m=new Ze(n,s),y=getJSON().stringify(m);ue.setSessionStorage(this._logger,this.prevPageVisitDataKeyName,y)}}catch(n){this._logger.warnToConsole("Call to start failed: "+ue.dump(n))}},PageVisitTimeManager.prototype.stopPageVisitTimer=function(){try{if(ue.canUseSessionStorage()){var n=A.dateNow(),s=ue.getSessionStorage(this._logger,this.prevPageVisitDataKeyName);if(s&&hasJSON()){var m=getJSON().parse(s);return m.pageVisitTime=n-m.pageVisitStartTime,ue.removeSessionStorage(this._logger,this.prevPageVisitDataKeyName),m}return null}return null}catch(n){return this._logger.warnToConsole("Stop page visit timer failed: "+ue.dump(n)),null}},PageVisitTimeManager}(),Ze=function PageVisitData(n,s){
this.pageVisitStartTime=A.dateNow(),this.pageName=n,this.pageUrl=s},et=function(){function PageViewPerformanceManager(n){this.MAX_DURATION_ALLOWED=36e5,n&&(this._logger=n.logger)}return PageViewPerformanceManager.prototype.populatePageViewPerformanceEvent=function(n){n.isValid=!1;var s=this.getPerformanceNavigationTiming(),m=this.getPerformanceTiming();if(s||m){if(s)var y=s.duration,C=fe.GetDuration(s.startTime,s.connectEnd),_=fe.GetDuration(s.requestStart,s.responseStart),E=fe.GetDuration(s.responseStart,s.responseEnd),w=fe.GetDuration(s.responseEnd,s.loadEventEnd);else y=fe.GetDuration(m.navigationStart,m.loadEventEnd),C=fe.GetDuration(m.navigationStart,m.connectEnd),_=fe.GetDuration(m.requestStart,m.responseStart),E=fe.GetDuration(m.responseStart,m.responseEnd),w=fe.GetDuration(m.responseEnd,m.loadEventEnd);0===y?this._logger.throwInternal(T.WARNING,R.ErrorPVCalc,"error calculating page view performance.",{total:y,network:C,request:_,response:E,dom:w
}):this.shouldCollectDuration(y,C,_,E,w)?y<Math.floor(C)+Math.floor(_)+Math.floor(E)+Math.floor(w)?this._logger.throwInternal(T.WARNING,R.ClientPerformanceMathError,"client performance math error.",{total:y,network:C,request:_,response:E,dom:w}):(n.durationMs=y,n.perfTotal=n.duration=ue.msToTimeSpan(y),n.networkConnect=ue.msToTimeSpan(C),n.sentRequest=ue.msToTimeSpan(_),n.receivedResponse=ue.msToTimeSpan(E),n.domProcessing=ue.msToTimeSpan(w),n.isValid=!0):this._logger.throwInternal(T.WARNING,R.InvalidDurationValue,"Invalid page load duration value. Browser perf data won't be sent.",{total:y,network:C,request:_,response:E,dom:w})}},PageViewPerformanceManager.prototype.getPerformanceTiming=function(){return this.isPerformanceTimingSupported()?getPerformance().timing:null},PageViewPerformanceManager.prototype.getPerformanceNavigationTiming=function(){return this.isPerformanceNavigationTimingSupported()?getPerformance().getEntriesByType("navigation")[0]:null},
PageViewPerformanceManager.prototype.isPerformanceNavigationTimingSupported=function(){var n=getPerformance();return n&&n.getEntriesByType&&n.getEntriesByType("navigation").length>0},PageViewPerformanceManager.prototype.isPerformanceTimingSupported=function(){var n=getPerformance();return n&&n.timing},PageViewPerformanceManager.prototype.isPerformanceTimingDataReady=function(){var n=getPerformance(),s=n?n.timing:0;return s&&s.domainLookupStart>0&&s.navigationStart>0&&s.responseStart>0&&s.requestStart>0&&s.loadEventEnd>0&&s.responseEnd>0&&s.connectEnd>0&&s.domLoading>0},PageViewPerformanceManager.prototype.shouldCollectDuration=function(){for(var n=[],s=0;s<arguments.length;s++)n[s]=arguments[s];var m=getNavigator()||{},y=["googlebot","adsbot-google","apis-google","mediapartners-google"],C=m.userAgent,_=!1;if(C)for(var E=0;E<y.length;E++)_=_||-1!==C.toLowerCase().indexOf(y[E]);if(_)return!1;for(E=0;E<n.length;E++)if(n[E]>=this.MAX_DURATION_ALLOWED)return!1;return!0},
PageViewPerformanceManager}();function _dispatchEvent(n,s){n&&n.dispatchEvent&&s&&n.dispatchEvent(s)}var tt=function(n){function ApplicationInsights(){var s=n.call(this)||this;s.identifier=Je,s.priority=180,s.autoRoutePVDelay=500,s._trackAjaxAttempts=0;var m=getLocation();return s._prevUri=m&&m.href||"",s}return __extends(ApplicationInsights,n),ApplicationInsights.getDefaultConfig=function(n){return n||(n={}),n.sessionRenewalMs=18e5,n.sessionExpirationMs=864e5,n.disableExceptionTracking=ue.stringToBoolOrDefault(n.disableExceptionTracking),n.autoTrackPageVisitTime=ue.stringToBoolOrDefault(n.autoTrackPageVisitTime),n.overridePageViewDuration=ue.stringToBoolOrDefault(n.overridePageViewDuration),n.enableUnhandledPromiseRejectionTracking=ue.stringToBoolOrDefault(n.enableUnhandledPromiseRejectionTracking),(isNaN(n.samplingPercentage)||n.samplingPercentage<=0||n.samplingPercentage>=100)&&(n.samplingPercentage=100),n.isCookieUseDisabled=ue.stringToBoolOrDefault(n.isCookieUseDisabled),
n.isStorageUseDisabled=ue.stringToBoolOrDefault(n.isStorageUseDisabled),n.isBrowserLinkTrackingEnabled=ue.stringToBoolOrDefault(n.isBrowserLinkTrackingEnabled),n.enableAutoRouteTracking=ue.stringToBoolOrDefault(n.enableAutoRouteTracking),n.namePrefix=n.namePrefix||"",n},ApplicationInsights.prototype.processTelemetry=function(n,s){var m=this;doPerf(this.core,(function(){return m.identifier+":processTelemetry"}),(function(){var y=!1,C=m._telemetryInitializers.length;s=m._getTelCtx(s);for(var _=0;_<C;++_){var E=m._telemetryInitializers[_];if(E)try{if(!1===E.apply(null,[n])){y=!0;break}}catch(n){s.diagLog().throwInternal(T.CRITICAL,R.TelemetryInitializerFailed,"One of telemetry initializers failed, telemetry item will not be sent: "+ue.getExceptionName(n),{exception:ue.dump(n)},!0)}}y||m.processNext(n,s)}),(function(){return{item:n}}),!n.sync)},ApplicationInsights.prototype.trackEvent=function(n,s){try{var m=je.create(n,Ie.dataType,Ie.envelopeType,this.diagLog(),s);this.core.track(m)
}catch(n){this.diagLog().throwInternal(T.WARNING,R.TrackTraceFailed,"trackTrace failed, trace will not be collected: "+ue.getExceptionName(n),{exception:ue.dump(n)})}},ApplicationInsights.prototype.startTrackEvent=function(n){try{this._eventTracking.start(n)}catch(n){this.diagLog().throwInternal(T.CRITICAL,R.StartTrackEventFailed,"startTrackEvent failed, event will not be collected: "+ue.getExceptionName(n),{exception:ue.dump(n)})}},ApplicationInsights.prototype.stopTrackEvent=function(n,s,m){try{this._eventTracking.stop(n,void 0,s)}catch(n){this.diagLog().throwInternal(T.CRITICAL,R.StopTrackEventFailed,"stopTrackEvent failed, event will not be collected: "+ue.getExceptionName(n),{exception:ue.dump(n)})}},ApplicationInsights.prototype.trackTrace=function(n,s){try{var m=je.create(n,Ve.dataType,Ve.envelopeType,this.diagLog(),s);this.core.track(m)}catch(n){this.diagLog().throwInternal(T.WARNING,R.TrackTraceFailed,"trackTrace failed, trace will not be collected: "+ue.getExceptionName(n),{
exception:ue.dump(n)})}},ApplicationInsights.prototype.trackMetric=function(n,s){try{var m=je.create(n,Ue.dataType,Ue.envelopeType,this.diagLog(),s);this.core.track(m)}catch(n){this.diagLog().throwInternal(T.CRITICAL,R.TrackMetricFailed,"trackMetric failed, metric will not be collected: "+ue.getExceptionName(n),{exception:ue.dump(n)})}},ApplicationInsights.prototype.trackPageView=function(n,s){try{var m=n||{};this._pageViewManager.trackPageView(m,__assign({},m.properties,m.measurements,s)),this.config.autoTrackPageVisitTime&&this._pageVisitTimeManager.trackPreviousPageVisit(m.name,m.uri)}catch(n){this.diagLog().throwInternal(T.CRITICAL,R.TrackPVFailed,"trackPageView failed, page view will not be collected: "+ue.getExceptionName(n),{exception:ue.dump(n)})}},ApplicationInsights.prototype.sendPageViewInternal=function(n,s,m){var y=getDocument();y&&(n.refUri=void 0===n.refUri?y.referrer:n.refUri);var C=je.create(n,Fe.dataType,Fe.envelopeType,this.diagLog(),s,m);this.core.track(C),
this._trackAjaxAttempts=0},ApplicationInsights.prototype.sendPageViewPerformanceInternal=function(n,s,m){var y=je.create(n,He.dataType,He.envelopeType,this.diagLog(),s,m);this.core.track(y)},ApplicationInsights.prototype.trackPageViewPerformance=function(n,s){try{this._pageViewPerformanceManager.populatePageViewPerformanceEvent(n),this.sendPageViewPerformanceInternal(n,s)}catch(n){this.diagLog().throwInternal(T.CRITICAL,R.TrackPVFailed,"trackPageViewPerformance failed, page view will not be collected: "+ue.getExceptionName(n),{exception:ue.dump(n)})}},ApplicationInsights.prototype.startTrackPage=function(n){try{if("string"!=typeof n){var s=getDocument();n=s&&s.title||""}this._pageTracking.start(n)}catch(n){this.diagLog().throwInternal(T.CRITICAL,R.StartTrackFailed,"startTrackPage failed, page view may not be collected: "+ue.getExceptionName(n),{exception:ue.dump(n)})}},ApplicationInsights.prototype.stopTrackPage=function(n,s,m,y){try{if("string"!=typeof n){var C=getDocument()
;n=C&&C.title||""}if("string"!=typeof s){var _=getLocation();s=_&&_.href||""}this._pageTracking.stop(n,s,m,y),this.config.autoTrackPageVisitTime&&this._pageVisitTimeManager.trackPreviousPageVisit(n,s)}catch(n){this.diagLog().throwInternal(T.CRITICAL,R.StopTrackFailed,"stopTrackPage failed, page view will not be collected: "+ue.getExceptionName(n),{exception:ue.dump(n)})}},ApplicationInsights.prototype.sendExceptionInternal=function(n,s,m){var y=new Re(this.diagLog(),n.exception||new Error(ue.NotSpecified),n.properties,n.measurements,n.severityLevel,n.id).toInterface(),C=je.create(y,Re.dataType,Re.envelopeType,this.diagLog(),s,m);this.core.track(C)},ApplicationInsights.prototype.trackException=function(n,s){try{this.sendExceptionInternal(n,s)}catch(n){this.diagLog().throwInternal(T.CRITICAL,R.TrackExceptionFailed,"trackException failed, exception will not be collected: "+ue.getExceptionName(n),{exception:ue.dump(n)})}},ApplicationInsights.prototype._onerror=function(n){try{var s={
url:n&&n.url||(getDocument()||{}).URL,lineNumber:n.lineNumber,columnNumber:n.columnNumber,message:n.message};if(ue.isCrossOriginError(n.message,n.url,n.lineNumber,n.columnNumber,n.error))this._sendCORSException(s.url);else{if(!ue.isError(n.error)){var m="window.onerror@"+s.url+":"+n.lineNumber+":"+(n.columnNumber||0);n.error=new Error(n.message),n.error.stack=m}this.trackException({exception:n.error,severityLevel:Ne.Error},s)}}catch(s){var y=n.error?n.error.name+", "+n.error.message:"null";this.diagLog().throwInternal(T.CRITICAL,R.ExceptionWhileLoggingError,"_onError threw exception while logging error, error will not be collected: "+ue.getExceptionName(s),{exception:ue.dump(s),errorString:y})}},ApplicationInsights.prototype.addTelemetryInitializer=function(n){this._telemetryInitializers.push(n)},ApplicationInsights.prototype.initialize=function(s,m,y,C){var _=this;if(!this.isInitialized()){if(A.isNullOrUndefined(m))throw Error("Error initializing")
;n.prototype.initialize.call(this,s,m,y,C),this.setInitialized(!1);var E=this._getTelCtx(),w=this.identifier;this._globalconfig={instrumentationKey:s.instrumentationKey,endpointUrl:s.endpointUrl||"https://dc.services.visualstudio.com/v2/track"},this.config=E.getExtCfg(w);var S=ApplicationInsights.getDefaultConfig();if(void 0!==S){for(var I in S)this.config[I]=E.getConfig(w,I,S[I]);if(this._globalconfig)for(var I in S)void 0===this._globalconfig[I]&&(this._globalconfig[I]=S[I])}this.config.isCookieUseDisabled&&ue.disableCookies(),this.config.isStorageUseDisabled&&ue.disableStorage();var T={instrumentationKey:function(){return s.instrumentationKey},accountId:function(){return _.config.accountId||s.accountId},sessionRenewalMs:function(){return _.config.sessionRenewalMs||s.sessionRenewalMs},sessionExpirationMs:function(){return _.config.sessionExpirationMs||s.sessionExpirationMs},sampleRate:function(){return _.config.samplingPercentage||s.samplingPercentage},cookieDomain:function(){
return _.config.cookieDomain||s.cookieDomain},sdkExtension:function(){return _.config.sdkExtension||s.sdkExtension},isBrowserLinkTrackingEnabled:function(){return _.config.isBrowserLinkTrackingEnabled||s.isBrowserLinkTrackingEnabled},appId:function(){return _.config.appId||s.appId}};this._pageViewPerformanceManager=new et(this.core),this._pageViewManager=new $e(this,this.config.overridePageViewDuration,this.core,this._pageViewPerformanceManager),this._pageVisitTimeManager=new Qe(this.diagLog(),(function(n,s,m){return _.trackPageVisitTime(n,s,m)})),this._telemetryInitializers=this._telemetryInitializers||[],this._addDefaultTelemetryInitializers(T),this._eventTracking=new rt(this.diagLog(),"trackEvent"),this._eventTracking.action=function(n,s,m,y){y||(y={}),y.duration=m.toString(),_.trackEvent({name:n,properties:y})},this._pageTracking=new rt(this.diagLog(),"trackPageView"),this._pageTracking.action=function(n,s,m,y,C){A.isNullOrUndefined(y)&&(y={}),y.duration=m.toString();var E={name:n,
uri:s,properties:y,measurements:C};_.sendPageViewInternal(E,y)};var x=getWindow(),P=getHistory(),R=getLocation(),k=this;if(!1===this.config.disableExceptionTracking&&!this.config.autoExceptionInstrumented&&x){var M=x.onerror;x.onerror=function(n,s,m,y,C){var _=M&&M(n,s,m,y,C);return!0!==_&&k._onerror({message:n,url:s,lineNumber:m,columnNumber:y,error:C}),_},this.config.autoExceptionInstrumented=!0}if(!1===this.config.disableExceptionTracking&&!0===this.config.enableUnhandledPromiseRejectionTracking&&!this.config.autoUnhandledPromiseInstrumented&&x){var O=x.onunhandledrejection;x.onunhandledrejection=function(n){var s=O&&O.call(x,n);return!0!==s&&k._onerror({message:n.reason.toString(),error:n.reason instanceof Error?n.reason:new Error(n.reason.toString()),url:R?R.href:"",lineNumber:0,columnNumber:0}),s},this.config.autoUnhandledPromiseInstrumented=!0}if(!0===this.config.enableAutoRouteTracking&&P&&A.isFunction(P.pushState)&&A.isFunction(P.replaceState)&&x&&"undefined"!=typeof Event){
var N=this;A.arrForEach(y,(function(n){n.identifier===Xe&&(_._properties=n)})),P.pushState=function(n){return function pushState(){var s=n.apply(this,arguments);return _dispatchEvent(x,ue.createDomEvent(N.config.namePrefix+"pushState")),_dispatchEvent(x,ue.createDomEvent(N.config.namePrefix+"locationchange")),s}}(P.pushState),P.replaceState=function(n){return function replaceState(){var s=n.apply(this,arguments);return _dispatchEvent(x,ue.createDomEvent(N.config.namePrefix+"replaceState")),_dispatchEvent(x,ue.createDomEvent(N.config.namePrefix+"locationchange")),s}}(P.replaceState),x.addEventListener&&(x.addEventListener(N.config.namePrefix+"popstate",(function(){_dispatchEvent(x,ue.createDomEvent(N.config.namePrefix+"locationchange"))})),x.addEventListener(N.config.namePrefix+"locationchange",(function(){N._properties&&N._properties.context&&N._properties.context.telemetryTrace&&(N._properties.context.telemetryTrace.traceID=ue.generateW3CId(),
N._properties.context.telemetryTrace.name=R&&R.pathname||"_unknown_"),_._currUri?(_._prevUri=_._currUri,_._currUri=R&&R.href||""):_._currUri=R&&R.href||"",setTimeout(function(n){N.trackPageView({refUri:n,properties:{duration:0}})}.bind(_,_._prevUri),N.autoRoutePVDelay)})))}this.setInitialized(!0)}},ApplicationInsights.prototype.trackPageVisitTime=function(n,s,m){var y={PageName:n,PageUrl:s};this.trackMetric({name:"PageVisitTime",average:m,max:m,min:m,sampleCount:1},y)},ApplicationInsights.prototype._addDefaultTelemetryInitializers=function(n){if(!n.isBrowserLinkTrackingEnabled()){var s=["/browserLinkSignalR/","/__browserLink/"];this._addTelemetryInitializer((function(n){if(n.baseType===qe.dataType){var m=n.baseData;if(m)for(var y=0;y<s.length;y++)if(m.target&&m.target.indexOf(s[y])>=0)return!1}return!0}))}},ApplicationInsights.prototype._addTelemetryInitializer=function(n){this._telemetryInitializers.push(n)},ApplicationInsights.prototype._sendCORSException=function(n){var s={
message:"Script error: The browser's same-origin policy prevents us from getting the details of this exception. Consider using the 'crossorigin' attribute.",url:n,lineNumber:0,columnNumber:0,error:void 0},m=je.create(s,Re.dataType,Re.envelopeType,this.diagLog(),{url:n});this.core.track(m)},ApplicationInsights.Version="2.5.8",ApplicationInsights}(j),rt=function(){function Timing(n,s){this._name=s,this._events={},this._logger=n}return Timing.prototype.start=function(n){void 0!==this._events[n]&&this._logger.throwInternal(T.WARNING,R.StartCalledMoreThanOnce,"start was called more than once for this event without calling stop.",{name:this._name,key:n},!0),this._events[n]=+new Date},Timing.prototype.stop=function(n,s,m,y){var C=this._events[n];if(isNaN(C))this._logger.throwInternal(T.WARNING,R.StopCalledWithoutStart,"stop was called without a corresponding start.",{name:this._name,key:n},!0);else{var _=+new Date,E=fe.GetDuration(C,_);this.action(n,s,E,m,y)}delete this._events[n],
this._events[n]=void 0},Timing}(),nt=function ArraySendBuffer(n){var s=[];O(ArraySendBuffer,this,(function(m){m.enqueue=function(n){s.push(n)},m.count=function(){return s.length},m.clear=function(){s.length=0},m.getItems=function(){return s.slice(0)},m.batchPayloads=function(s){return s&&s.length>0?n.emitLineDelimitedJson()?s.join("\n"):"["+s.join(",")+"]":null},m.markAsSent=function(n){m.clear()},m.clearSent=function(n){}}))},it=function(){function SessionStorageSendBuffer(n,s){var m,y=!1;O(SessionStorageSendBuffer,this,(function(C){var _=_getBuffer(SessionStorageSendBuffer.BUFFER_KEY),E=_getBuffer(SessionStorageSendBuffer.SENT_BUFFER_KEY);function _removePayloadsFromBuffer(n,s){var m=[];return A.arrForEach(s,(function(s){A.isFunction(s)||-1!==A.arrIndexOf(n,s)||m.push(s)})),m}function _getBuffer(m){var y=m;try{y=s.namePrefix&&s.namePrefix()?s.namePrefix()+"_"+y:y;var C=ue.getSessionStorage(n,y);if(C){var _=getJSON().parse(C);if(A.isString(_)&&(_=getJSON().parse(_)),
_&&ue.isArray(_))return _}}catch(s){n.throwInternal(T.CRITICAL,R.FailedToRestoreStorageBuffer," storage key: "+y+", "+ue.getExceptionName(s),{exception:ue.dump(s)})}return[]}function _setBuffer(m,y){var C=m;try{C=s.namePrefix&&s.namePrefix()?s.namePrefix()+"_"+C:C;var _=JSON.stringify(y);ue.setSessionStorage(n,C,_)}catch(s){ue.setSessionStorage(n,C,JSON.stringify([])),n.throwInternal(T.WARNING,R.FailedToSetStorageBuffer," storage key: "+C+", "+ue.getExceptionName(s)+". Buffer cleared",{exception:ue.dump(s)})}}(m=_.concat(E)).length>SessionStorageSendBuffer.MAX_BUFFER_SIZE&&(m.length=SessionStorageSendBuffer.MAX_BUFFER_SIZE),_setBuffer(SessionStorageSendBuffer.SENT_BUFFER_KEY,[]),_setBuffer(SessionStorageSendBuffer.BUFFER_KEY,m),C.enqueue=function(s){m.length>=SessionStorageSendBuffer.MAX_BUFFER_SIZE?y||(n.throwInternal(T.WARNING,R.SessionStorageBufferFull,"Maximum buffer size reached: "+m.length,!0),y=!0):(m.push(s),_setBuffer(SessionStorageSendBuffer.BUFFER_KEY,m))},
C.count=function(){return m.length},C.clear=function(){m=[],_setBuffer(SessionStorageSendBuffer.BUFFER_KEY,[]),_setBuffer(SessionStorageSendBuffer.SENT_BUFFER_KEY,[]),y=!1},C.getItems=function(){return m.slice(0)},C.batchPayloads=function(n){return n&&n.length>0?s.emitLineDelimitedJson()?n.join("\n"):"["+n.join(",")+"]":null},C.markAsSent=function(s){m=_removePayloadsFromBuffer(s,m),_setBuffer(SessionStorageSendBuffer.BUFFER_KEY,m);var y=_getBuffer(SessionStorageSendBuffer.SENT_BUFFER_KEY);y instanceof Array&&s instanceof Array&&((y=y.concat(s)).length>SessionStorageSendBuffer.MAX_BUFFER_SIZE&&(n.throwInternal(T.CRITICAL,R.SessionStorageBufferFull,"Sent buffer reached its maximum size: "+y.length,!0),y.length=SessionStorageSendBuffer.MAX_BUFFER_SIZE),_setBuffer(SessionStorageSendBuffer.SENT_BUFFER_KEY,y))},C.clearSent=function(n){var s=_getBuffer(SessionStorageSendBuffer.SENT_BUFFER_KEY);s=_removePayloadsFromBuffer(n,s),_setBuffer(SessionStorageSendBuffer.SENT_BUFFER_KEY,s)}}))}
return SessionStorageSendBuffer.BUFFER_KEY="AI_buffer",SessionStorageSendBuffer.SENT_BUFFER_KEY="AI_sentBuffer",SessionStorageSendBuffer.MAX_BUFFER_SIZE=2e3,SessionStorageSendBuffer}(),ot=A.arrForEach,at=A.objKeys,st=A.isNullOrUndefined;function _setValueIf(n,s,m){return n&&m?(n[s]=m,n[s]):null}var ct=function(){function EnvelopeCreator(){}return EnvelopeCreator.extractPropsAndMeasurements=function(n,s,m){st(n)||ot(at(n),(function(y){var C=n[y];A.isNumber(C)?m[y]=C:A.isString(C)?s[y]=C:hasJSON()&&(s[y]=getJSON().stringify(C))}))},EnvelopeCreator.createEnvelope=function(n,s,m,y){var C=new we(n,y,s);_setValueIf(C,"sampleRate",m[ge]),(m.baseData||{}).startTime&&(C.time=A.toISOString(m.baseData.startTime)),C.iKey=m.iKey;var _=m.iKey.replace(/-/g,"");return C.name=C.name.replace("{0}",_),EnvelopeCreator.extractPartAExtensions(m,C),m.tags=m.tags||[],C},EnvelopeCreator.extractPartAExtensions=function(n,s){var m=s.tags=s.tags||{},y=n.ext=n.ext||{},C=n.tags=n.tags||[],_=y.user
;_&&(_setValueIf(m,Ke.userAuthUserId,_.authId),_setValueIf(m,Ke.userId,_.id||_.localId));var E=y.app;E&&_setValueIf(m,Ke.sessionId,E.sesId);var w=y.device;w&&(_setValueIf(m,Ke.deviceId,w.id||w.localId),_setValueIf(m,Ke.deviceType,w.deviceClass),_setValueIf(m,Ke.deviceIp,w.ip),_setValueIf(m,Ke.deviceModel,w.model),_setValueIf(m,Ke.deviceType,w.deviceType));var S=n.ext.web;if(S){_setValueIf(m,Ke.deviceLanguage,S.browserLang),_setValueIf(m,Ke.deviceBrowserVersion,S.browserVer),_setValueIf(m,Ke.deviceBrowser,S.browser);var I=s.data=s.data||{},T=I.baseData=I.baseData||{},A=T.properties=T.properties||{};_setValueIf(A,"domain",S.domain),_setValueIf(A,"isManual",S.isManual?"true":null),_setValueIf(A,"screenRes",S.screenRes),_setValueIf(A,"userConsent",S.userConsent?"true":null)}var x=y.os;x&&_setValueIf(m,Ke.deviceOS,x.name);var P=y.trace;P&&(_setValueIf(m,Ke.operationParentId,P.parentID),_setValueIf(m,Ke.operationName,P.name),_setValueIf(m,Ke.operationId,P.traceID))
;for(var R={},_loop_1=function(n){var s=C[n];ot(at(s),(function(n){R[n]=s[n]})),C.splice(n,1)},k=C.length-1;k>=0;k--)_loop_1(k);ot(at(C),(function(n){R[n]=C[n]})),s.tags=__assign({},m,R),s.tags[Ke.internalSdkVersion]||(s.tags[Ke.internalSdkVersion]="javascript:"+EnvelopeCreator.Version)},EnvelopeCreator.prototype.Init=function(n,s){this._logger=n,st(s.baseData)&&this._logger.throwInternal(T.CRITICAL,R.TelemetryEnvelopeInvalid,"telemetryItem.baseData cannot be null.")},EnvelopeCreator.Version="2.5.8",EnvelopeCreator}(),ut=function(n){function DependencyEnvelopeCreator(){return null!==n&&n.apply(this,arguments)||this}return __extends(DependencyEnvelopeCreator,n),DependencyEnvelopeCreator.prototype.Create=function(s,m){n.prototype.Init.call(this,s,m);var y=m.baseData.measurements||{},C=m.baseData.properties||{};ct.extractPropsAndMeasurements(m.data,C,y);var _=m.baseData;if(st(_))return s.warnToConsole("Invalid input for dependency data"),null
;var E=_.properties&&_.properties[ye]?_.properties[ye]:"GET",w=new qe(s,_.id,_.target,_.name,_.duration,_.success,_.responseCode,E,_.type,_.correlationContext,C,y),S=new Be(qe.dataType,w);return ct.createEnvelope(s,qe.envelopeType,m,S)},DependencyEnvelopeCreator.DependencyEnvelopeCreator=new DependencyEnvelopeCreator,DependencyEnvelopeCreator}(ct),lt=function(n){function EventEnvelopeCreator(){return null!==n&&n.apply(this,arguments)||this}return __extends(EventEnvelopeCreator,n),EventEnvelopeCreator.prototype.Create=function(s,m){n.prototype.Init.call(this,s,m);var y={},C={};m.baseType!==Ie.dataType&&(y.baseTypeSource=m.baseType),m.baseType===Ie.dataType?(y=m.baseData.properties||{},C=m.baseData.measurements||{}):m.baseData&&ct.extractPropsAndMeasurements(m.baseData,y,C),ct.extractPropsAndMeasurements(m.data,y,C);var _=m.baseData.name,E=new Ie(s,_,y,C),w=new Be(Ie.dataType,E);return ct.createEnvelope(s,Ie.envelopeType,m,w)},
EventEnvelopeCreator.EventEnvelopeCreator=new EventEnvelopeCreator,EventEnvelopeCreator}(ct),dt=function(n){function ExceptionEnvelopeCreator(){return null!==n&&n.apply(this,arguments)||this}return __extends(ExceptionEnvelopeCreator,n),ExceptionEnvelopeCreator.prototype.Create=function(s,m){n.prototype.Init.call(this,s,m);var y=m.baseData.measurements||{},C=m.baseData.properties||{};ct.extractPropsAndMeasurements(m.data,C,y);var _=m.baseData,E=Re.CreateFromInterface(s,_,C,y),w=new Be(Re.dataType,E);return ct.createEnvelope(s,Re.envelopeType,m,w)},ExceptionEnvelopeCreator.ExceptionEnvelopeCreator=new ExceptionEnvelopeCreator,ExceptionEnvelopeCreator}(ct),pt=function(n){function MetricEnvelopeCreator(){return null!==n&&n.apply(this,arguments)||this}return __extends(MetricEnvelopeCreator,n),MetricEnvelopeCreator.prototype.Create=function(s,m){n.prototype.Init.call(this,s,m);var y=m.baseData,C=y.properties||{},_=y.measurements||{};ct.extractPropsAndMeasurements(m.data,C,_)
;var E=new Ue(s,y.name,y.average,y.sampleCount,y.min,y.max,C,_),w=new Be(Ue.dataType,E);return ct.createEnvelope(s,Ue.envelopeType,m,w)},MetricEnvelopeCreator.MetricEnvelopeCreator=new MetricEnvelopeCreator,MetricEnvelopeCreator}(ct),ft=function(n){function PageViewEnvelopeCreator(){return null!==n&&n.apply(this,arguments)||this}return __extends(PageViewEnvelopeCreator,n),PageViewEnvelopeCreator.prototype.Create=function(s,m){n.prototype.Init.call(this,s,m);var y,C=m.baseData;st(C)||st(C.properties)||st(C.properties.duration)?st(m.data)||st(m.data.duration)||(y=m.data.duration,delete m.data.duration):(y=C.properties.duration,delete C.properties.duration);var _,E=m.baseData;((m.ext||{}).trace||{}).traceID&&(_=m.ext.trace.traceID);var w=E.id||_,S=E.name,I=E.uri,T=E.properties||{},A=E.measurements||{};if(st(E.refUri)||(T.refUri=E.refUri),st(E.pageType)||(T.pageType=E.pageType),st(E.isLoggedIn)||(T.isLoggedIn=E.isLoggedIn.toString()),!st(E.properties)){var x=E.properties
;ot(at(x),(function(n){T[n]=x[n]}))}ct.extractPropsAndMeasurements(m.data,T,A);var P=new Fe(s,S,I,y,T,A,w),R=new Be(Fe.dataType,P);return ct.createEnvelope(s,Fe.envelopeType,m,R)},PageViewEnvelopeCreator.PageViewEnvelopeCreator=new PageViewEnvelopeCreator,PageViewEnvelopeCreator}(ct),ht=function(n){function PageViewPerformanceEnvelopeCreator(){return null!==n&&n.apply(this,arguments)||this}return __extends(PageViewPerformanceEnvelopeCreator,n),PageViewPerformanceEnvelopeCreator.prototype.Create=function(s,m){n.prototype.Init.call(this,s,m);var y=m.baseData,C=y.name,_=y.uri||y.url,E=y.properties||{},w=y.measurements||{};ct.extractPropsAndMeasurements(m.data,E,w);var S=new He(s,C,_,void 0,E,w,y),I=new Be(He.dataType,S);return ct.createEnvelope(s,He.envelopeType,m,I)},PageViewPerformanceEnvelopeCreator.PageViewPerformanceEnvelopeCreator=new PageViewPerformanceEnvelopeCreator,PageViewPerformanceEnvelopeCreator}(ct),gt=function(n){function TraceEnvelopeCreator(){
return null!==n&&n.apply(this,arguments)||this}return __extends(TraceEnvelopeCreator,n),TraceEnvelopeCreator.prototype.Create=function(s,m){n.prototype.Init.call(this,s,m);var y=m.baseData.message,C=m.baseData.severityLevel,_=m.baseData.properties||{},E=m.baseData.measurements||{};ct.extractPropsAndMeasurements(m.data,_,E);var w=new Ve(s,y,C,_,E),S=new Be(Ve.dataType,w);return ct.createEnvelope(s,Ve.envelopeType,m,S)},TraceEnvelopeCreator.TraceEnvelopeCreator=new TraceEnvelopeCreator,TraceEnvelopeCreator}(ct),mt=function Serializer(n){O(Serializer,this,(function(s){function _serializeObject(s,m){var y={};if(!s)return n.throwInternal(T.CRITICAL,R.CannotSerializeObject,"cannot serialize object because it is null or undefined",{name:m},!0),y;if(s.__aiCircularRefCheck)return n.throwInternal(T.WARNING,R.CircularReferenceDetected,"Circular reference detected while serializing object",{name:m},!0),y;if(!s.aiDataContract){
if("measurements"===m)y=_serializeStringMap(s,"number",m);else if("properties"===m)y=_serializeStringMap(s,"string",m);else if("tags"===m)y=_serializeStringMap(s,"string",m);else if(ue.isArray(s))y=_serializeArray(s,m);else{n.throwInternal(T.WARNING,R.CannotSerializeObjectNonSerializable,"Attempting to serialize an object which does not implement ISerializable",{name:m},!0);try{getJSON().stringify(s),y=s}catch(s){n.throwInternal(T.CRITICAL,R.CannotSerializeObject,s&&A.isFunction(s.toString)?s.toString():"Error serializing object",null,!0)}}return y}for(var C in s.__aiCircularRefCheck=!0,s.aiDataContract){var _=s.aiDataContract[C],E=A.isFunction(_)?_()&X.Required:_&X.Required,w=A.isFunction(_)?_()&X.Hidden:_&X.Hidden,S=_&X.Array,I=void 0!==s[C],x=A.isObject(s[C])&&null!==s[C];if(!E||I||S){if(!w){var P=void 0;void 0!==(P=x?S?_serializeArray(s[C],C):_serializeObject(s[C],C):s[C])&&(y[C]=P)}
}else n.throwInternal(T.CRITICAL,R.MissingRequiredFieldSpecification,"Missing required field specification. The field is required but not present on source",{field:C,name:m})}return delete s.__aiCircularRefCheck,y}function _serializeArray(s,m){var y;if(s)if(ue.isArray(s)){y=[];for(var C=0;C<s.length;C++){var _=_serializeObject(s[C],m+"["+C+"]");y.push(_)}}else n.throwInternal(T.CRITICAL,R.ItemNotInArray,"This field was specified as an array in the contract but the item is not an array.\r\n",{name:m},!0);return y}function _serializeStringMap(s,m,y){var C;if(s)for(var _ in C={},s){var E=s[_];if("string"===m)void 0===E?C[_]="undefined":null===E?C[_]="null":E.toString?C[_]=E.toString():C[_]="invalid field: toString() is not defined.";else if("number"===m)if(void 0===E)C[_]="undefined";else if(null===E)C[_]="null";else{var w=parseFloat(E);isNaN(w)?C[_]="NaN":C[_]=w}else C[_]="invalid field: "+y+" is of unknown type.",n.throwInternal(T.CRITICAL,C[_],null,!0)}return C}s.serialize=function(s){
var m=_serializeObject(s,"root");try{return getJSON().stringify(m)}catch(s){n.throwInternal(T.CRITICAL,R.CannotSerializeObject,s&&A.isFunction(s.toString)?s.toString():"Error serializing object",null,!0)}}}))},yt=function(){function OfflineListener(){var n=getWindow(),s=getDocument(),m=!1,y=!0;O(OfflineListener,this,(function(C){try{if(n&&P.Attach(n,"online",_setOnline)&&(P.Attach(n,"offline",_setOffline),m=!0),s){var _=s.body||s;A.isUndefined(_.ononline)||(_.ononline=_setOnline,_.onoffline=_setOffline,m=!0)}}catch(n){m=!1}function _setOnline(){y=!0}function _setOffline(){y=!1}C.isListening=m,C.isOnline=function(){var n=!0,s=getNavigator();return m?n=y:s&&!A.isNullOrUndefined(s.onLine)&&(n=s.onLine),n},C.isOffline=function(){return!C.isOnline()}}))}return OfflineListener.Offline=new OfflineListener,OfflineListener}().Offline,vt=function(){function HashCodeScoreGenerator(){}return HashCodeScoreGenerator.prototype.getHashCodeScore=function(n){
return 100*(this.getHashCode(n)/HashCodeScoreGenerator.INT_MAX_VALUE)},HashCodeScoreGenerator.prototype.getHashCode=function(n){if(""===n)return 0;for(;n.length<HashCodeScoreGenerator.MIN_INPUT_LENGTH;)n=n.concat(n);for(var s=5381,m=0;m<n.length;++m)s=(s<<5)+s+n.charCodeAt(m),s&=s;return Math.abs(s)},HashCodeScoreGenerator.INT_MAX_VALUE=2147483647,HashCodeScoreGenerator.MIN_INPUT_LENGTH=8,HashCodeScoreGenerator}(),Ct=function(){function SamplingScoreGenerator(){this.hashCodeGeneragor=new vt,this.keys=new ze}return SamplingScoreGenerator.prototype.getSamplingScore=function(n){
return n.tags&&n.tags[this.keys.userId]?this.hashCodeGeneragor.getHashCodeScore(n.tags[this.keys.userId]):n.ext&&n.ext.user&&n.ext.user.id?this.hashCodeGeneragor.getHashCodeScore(n.ext.user.id):n.tags&&n.tags[this.keys.operationId]?this.hashCodeGeneragor.getHashCodeScore(n.tags[this.keys.operationId]):n.ext&&n.ext.telemetryTrace&&n.ext.telemetryTrace.traceID?this.hashCodeGeneragor.getHashCodeScore(n.ext.telemetryTrace.traceID):100*Math.random()},SamplingScoreGenerator}(),_t=function(){function Sample(n,s){this.INT_MAX_VALUE=2147483647,this._logger=A.isNullOrUndefined(s)?new D:s,(n>100||n<0)&&(this._logger.throwInternal(T.WARNING,R.SampleRateOutOfRange,"Sampling rate is out of range (0..100). Sampling will be disabled, you may be sending too much data which may affect your AI service level.",{samplingRate:n},!0),this.sampleRate=100),this.sampleRate=n,this.samplingScoreGenerator=new Ct}return Sample.prototype.isSampledIn=function(n){var s=this.sampleRate
;return null==s||s>=100||(n.baseType===Ue.dataType||this.samplingScoreGenerator.getSamplingScore(n)<s)},Sample}();function Sender_getResponseText(n){try{return n.responseText}catch(n){}return null}var Et=function(n){function Sender(){var s,m,y,C,_=n.call(this)||this;return _.priority=1001,_.identifier=Ye,_._XMLHttpRequestSupported=!1,O(Sender,_,(function(n,E){function _notImplemented(){throw new Error("Method not implemented.")}function _beaconSender(s,m){var y=n._senderConfig.endpointUrl(),C=n._buffer.batchPayloads(s),_=new Blob([C],{type:"text/plain;charset=UTF-8"});getNavigator().sendBeacon(y,_)?(n._buffer.markAsSent(s),n._onSuccess(s,s.length)):(_xhrSender(s,!0),n.diagLog().throwInternal(T.WARNING,R.TransmissionFailed,". Failed to send telemetry with Beacon API, retried with xhrSender."))}function _xhrSender(s,m){var y=new XMLHttpRequest,C=n._senderConfig.endpointUrl();try{y[he]=!0}catch(n){}y.open("POST",C,m),y.setRequestHeader("Content-type","application/json"),
ue.isInternalApplicationInsightsEndpoint(C)&&y.setRequestHeader(ie.sdkContextHeader,ie.sdkContextHeaderAppIdRequest),y.onreadystatechange=function(){return n._xhrReadyStateChange(y,s,s.length)},y.onerror=function(m){return n._onError(s,_formatErrorMessageXhr(y),m)};var _=n._buffer.batchPayloads(s);y.send(_),n._buffer.markAsSent(s)}function _parseResponse(s){try{if(s&&""!==s){var m=getJSON().parse(s);if(m&&m.itemsReceived&&m.itemsReceived>=m.itemsAccepted&&m.itemsReceived-m.itemsAccepted===m.errors.length)return m}}catch(m){n.diagLog().throwInternal(T.CRITICAL,R.InvalidBackendResponse,"Cannot parse the response. "+ue.getExceptionName(m),{response:s})}return null}function _resendPayload(y,C){if(void 0===C&&(C=1),y&&0!==y.length){n._buffer.clearSent(y),s++;for(var _=0,E=y;_<E.length;_++){var w=E[_];n._buffer.enqueue(w)}!function _setRetryTime(n){var y;if(s<=1)y=10;else{var C=(Math.pow(2,s)-1)/2,_=Math.floor(Math.random()*C*10)+1;_*=n,y=Math.max(Math.min(_,3600),10)}var E=A.dateNow()+1e3*y
;m=E}(C),_setupTimer()}}function _setupTimer(){if(!y){var s=m?Math.max(0,m-A.dateNow()):0,C=Math.max(n._senderConfig.maxBatchInterval(),s);y=setTimeout((function(){n.triggerSend(!0,null,1)}),C)}}function _isRetriable(n){return 408===n||429===n||500===n||503===n}function _formatErrorMessageXhr(n,s){return n?"XMLHttpRequest,Status:"+n.status+",Response:"+Sender_getResponseText(n)||!1:s}function _xdrSender(s,m){var y=getWindow(),C=new XDomainRequest;C.onload=function(){return n._xdrOnLoad(C,s)},C.onerror=function(m){return n._onError(s,_formatErrorMessageXdr(C),m)};var _=y&&y.location&&y.location.protocol||"";if(0!==n._senderConfig.endpointUrl().lastIndexOf(_,0))return n.diagLog().throwInternal(T.WARNING,R.TransmissionFailed,". Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol."),void n._buffer.clear();var E=n._senderConfig.endpointUrl().replace(/^(https?:)/,"");C.open("POST",E);var w=n._buffer.batchPayloads(s);C.send(w),n._buffer.markAsSent(s)
}function _formatErrorMessageXdr(n,s){return n?"XDomainRequest,Response:"+Sender_getResponseText(n)||!1:s}n.pause=_notImplemented,n.resume=_notImplemented,n.flush=function(){try{n.triggerSend(!0,null,1)}catch(s){n.diagLog().throwInternal(T.CRITICAL,R.FlushFailed,"flush failed, telemetry will not be collected: "+ue.getExceptionName(s),{exception:ue.dump(s)})}},n.onunloadFlush=function(){if(!1!==n._senderConfig.onunloadDisableBeacon()&&!1!==n._senderConfig.isBeaconApiDisabled()||!ue.IsBeaconApiSupported())n.flush();else try{n.triggerSend(!0,_beaconSender,2)}catch(s){n.diagLog().throwInternal(T.CRITICAL,R.FailedToSendQueuedTelemetry,"failed to flush with beacon sender on page unload, telemetry will not be collected: "+ue.getExceptionName(s),{exception:ue.dump(s)})}},n.teardown=_notImplemented,n.initialize=function(y,_,w,S){E.initialize(y,_,w,S);var I=n._getTelCtx(),x=n.identifier;C=new mt(_.logger),s=0,m=null,0,n._sender=null;var P=Sender._getDefaultAppInsightsChannelConfig()
;n._senderConfig=Sender._getEmptyAppInsightsChannelConfig();var _loop_1=function(s){n._senderConfig[s]=function(){return I.getConfig(x,s,P[s]())}};for(var k in P)_loop_1(k);if(n._buffer=n._senderConfig.enableSessionStorageBuffer&&ue.canUseSessionStorage()?new it(n.diagLog(),n._senderConfig):new nt(n._senderConfig),n._sample=new _t(n._senderConfig.samplingPercentage(),n.diagLog()),function _validateInstrumentationKey(n){if(!A.isNullOrUndefined(n.disableInstrumentaionKeyValidation)&&n.disableInstrumentaionKeyValidation)return!0;return new RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(n.instrumentationKey)}(y)||n.diagLog().throwInternal(T.CRITICAL,R.InvalidInstrumentationKey,"Invalid Instrumentation key "+y.instrumentationKey),!n._senderConfig.isBeaconApiDisabled()&&ue.IsBeaconApiSupported())n._sender=_beaconSender;else if(void 0!==typeof XMLHttpRequest){var M=getGlobalInst("XMLHttpRequest");if(M)"withCredentials"in new M?(n._sender=_xhrSender,
n._XMLHttpRequestSupported=!0):void 0!==typeof XDomainRequest&&(n._sender=_xdrSender)}},n.processTelemetry=function(s,m){m=n._getTelCtx(m);try{if(n._senderConfig.disableTelemetry())return;if(!s)return void m.diagLog().throwInternal(T.CRITICAL,R.CannotSendEmptyTelemetry,"Cannot send empty telemetry");if(s.baseData&&!s.baseType)return void m.diagLog().throwInternal(T.CRITICAL,R.InvalidEvent,"Cannot send telemetry without baseData and baseType");if(s.baseType||(s.baseType="EventData"),!n._sender)return void m.diagLog().throwInternal(T.CRITICAL,R.SenderNotInitialized,"Sender was not initialized");if(!function _isSampledIn(s){return n._sample.isSampledIn(s)}(s))return void m.diagLog().throwInternal(T.WARNING,R.TelemetrySampledAndNotSent,"Telemetry item was sampled out and not sent",{SampleRate:n._sample.sampleRate});s[ge]=n._sample.sampleRate;var y=Sender.constructEnvelope(s,n._senderConfig.instrumentationKey(),m.diagLog())
;if(!y)return void m.diagLog().throwInternal(T.CRITICAL,R.CreateEnvelopeError,"Unable to create an AppInsights envelope");var _=!1;if(s.tags&&s.tags[me]&&(A.arrForEach(s.tags[me],(function(n){try{n&&!1===n(y)&&(_=!0,m.diagLog().warnToConsole("Telemetry processor check returns false"))}catch(n){m.diagLog().throwInternal(T.CRITICAL,R.TelemetryInitializerFailed,"One of telemetry initializers failed, telemetry item will not be sent: "+ue.getExceptionName(n),{exception:ue.dump(n)},!0)}})),delete s.tags[me]),_)return;var E=C.serialize(y),w=n._buffer.getItems(),S=n._buffer.batchPayloads(w);S&&S.length+E.length>n._senderConfig.maxBatchSizeInBytes()&&n.triggerSend(!0,null,10),n._buffer.enqueue(E),_setupTimer()}catch(n){m.diagLog().throwInternal(T.WARNING,R.FailedAddingTelemetryToBuffer,"Failed adding telemetry to the sender's buffer, some telemetry will be lost: "+ue.getExceptionName(n),{exception:ue.dump(n)})}n.processNext(s,m)},n._xhrReadyStateChange=function(m,y,C){if(4===m.readyState){
var _=null;if(n._appId||(_=_parseResponse(Sender_getResponseText(m)||m.response))&&_.appId&&(n._appId=_.appId),(m.status<200||m.status>=300)&&0!==m.status)!n._senderConfig.isRetryDisabled()&&_isRetriable(m.status)?(_resendPayload(y),n.diagLog().throwInternal(T.WARNING,R.TransmissionFailed,". Response code "+m.status+". Will retry to send "+y.length+" items.")):n._onError(y,_formatErrorMessageXhr(m));else if(yt.isOffline()){if(!n._senderConfig.isRetryDisabled()){_resendPayload(y,10),n.diagLog().throwInternal(T.WARNING,R.TransmissionFailed,". Offline - Response Code: "+m.status+". Offline status: "+yt.isOffline()+". Will retry to send "+y.length+" items.")}}else 206===m.status?(_||(_=_parseResponse(Sender_getResponseText(m)||m.response)),_&&!n._senderConfig.isRetryDisabled()?n._onPartialSuccess(y,_):n._onError(y,_formatErrorMessageXhr(m))):(s=0,n._onSuccess(y,C))}},n.triggerSend=function(s,C,E){void 0===s&&(s=!0);try{if(n._senderConfig.disableTelemetry())n._buffer.clear();else{
if(n._buffer.count()>0){var w=n._buffer.getItems();!function _notifySendRequest(s,m){var y=function _getNotifyMgr(){if(n.core.getNotifyMgr)return n.core.getNotifyMgr();return n.core._notificationManager}();if(y&&y.eventsSendRequest)try{y.eventsSendRequest(s,m)}catch(s){n.diagLog().throwInternal(T.CRITICAL,R.NotificationException,"send request notification failed: "+ue.getExceptionName(s),{exception:ue.dump(s)})}}(E||0,s),C?C.call(_,w,s):n._sender(w,s)}+new Date}clearTimeout(y),y=null,m=null}catch(s){var S=ue.getIEVersion();(!S||S>9)&&n.diagLog().throwInternal(T.CRITICAL,R.TransmissionFailed,"Telemetry transmission failed, some telemetry will be lost: "+ue.getExceptionName(s),{exception:ue.dump(s)})}},n._onError=function(s,m,y){n.diagLog().throwInternal(T.WARNING,R.OnError,"Failed to send telemetry.",{message:m}),n._buffer.clearSent(s)},n._onPartialSuccess=function(s,m){for(var y=[],C=[],_=0,E=m.errors.reverse();_<E.length;_++){var w=E[_],S=s.splice(w.index,1)[0]
;_isRetriable(w.statusCode)?C.push(S):y.push(S)}s.length>0&&n._onSuccess(s,m.itemsAccepted),y.length>0&&n._onError(y,_formatErrorMessageXhr(null,["partial success",m.itemsAccepted,"of",m.itemsReceived].join(" "))),C.length>0&&(_resendPayload(C),n.diagLog().throwInternal(T.WARNING,R.TransmissionFailed,"Partial success. Delivered: "+s.length+", Failed: "+y.length+". Will retry to send "+C.length+" our of "+m.itemsReceived+" items"))},n._onSuccess=function(s,m){n._buffer.clearSent(s)},n._xdrOnLoad=function(m,y){var C=Sender_getResponseText(m);if(!m||C+""!="200"&&""!==C){var _=_parseResponse(C);_&&_.itemsReceived&&_.itemsReceived>_.itemsAccepted&&!n._senderConfig.isRetryDisabled()?n._onPartialSuccess(y,_):n._onError(y,_formatErrorMessageXdr(m))}else s=0,n._onSuccess(y,0)}})),_}return __extends(Sender,n),Sender.constructEnvelope=function(n,s,m){var y;switch((y=s===n.iKey||A.isNullOrUndefined(s)?n:__assign({},n,{iKey:s})).baseType){case Ie.dataType:return lt.EventEnvelopeCreator.Create(m,y)
;case Ve.dataType:return gt.TraceEnvelopeCreator.Create(m,y);case Fe.dataType:return ft.PageViewEnvelopeCreator.Create(m,y);case He.dataType:return ht.PageViewPerformanceEnvelopeCreator.Create(m,y);case Re.dataType:return dt.ExceptionEnvelopeCreator.Create(m,y);case Ue.dataType:return pt.MetricEnvelopeCreator.Create(m,y);case qe.dataType:return ut.DependencyEnvelopeCreator.Create(m,y);default:return lt.EventEnvelopeCreator.Create(m,y)}},Sender._getDefaultAppInsightsChannelConfig=function(){return{endpointUrl:function(){return"https://dc.services.visualstudio.com/v2/track"},emitLineDelimitedJson:function(){return!1},maxBatchInterval:function(){return 15e3},maxBatchSizeInBytes:function(){return 102400},disableTelemetry:function(){return!1},enableSessionStorageBuffer:function(){return!0},isRetryDisabled:function(){return!1},isBeaconApiDisabled:function(){return!0},onunloadDisableBeacon:function(){return!1},instrumentationKey:function(){},namePrefix:function(){},
samplingPercentage:function(){return 100}}},Sender._getEmptyAppInsightsChannelConfig=function(){return{endpointUrl:void 0,emitLineDelimitedJson:void 0,maxBatchInterval:void 0,maxBatchSizeInBytes:void 0,disableTelemetry:void 0,enableSessionStorageBuffer:void 0,isRetryDisabled:void 0,isBeaconApiDisabled:void 0,onunloadDisableBeacon:void 0,instrumentationKey:void 0,namePrefix:void 0,samplingPercentage:void 0}},Sender}(j),wt=function wt(){},St=function(){function _SessionManager(n,s){var m=this;A.isNullOrUndefined(s)?this._logger=new D:this._logger=s,n||(n={}),"function"!=typeof n.sessionExpirationMs&&(n.sessionExpirationMs=function(){return _SessionManager.acquisitionSpan}),"function"!=typeof n.sessionRenewalMs&&(n.sessionRenewalMs=function(){return _SessionManager.renewalSpan}),this.config=n,this._storageNamePrefix=function(){return m.config.namePrefix&&m.config.namePrefix()?_SessionManager.cookieNameConst+m.config.namePrefix():_SessionManager.cookieNameConst},
this.automaticSession=new wt}return _SessionManager.prototype.update=function(){this.automaticSession.id||this.initializeAutomaticSession();var n=fe.Now(),s=0!==this.config.sessionExpirationMs()&&n-this.automaticSession.acquisitionDate>this.config.sessionExpirationMs(),m=0!==this.config.sessionExpirationMs()&&n-this.automaticSession.renewalDate>this.config.sessionRenewalMs();s||m?this.renew():(!this.cookieUpdatedTimestamp||n-this.cookieUpdatedTimestamp>_SessionManager.cookieUpdateInterval)&&(this.automaticSession.renewalDate=n,this.setCookie(this.automaticSession.id,this.automaticSession.acquisitionDate,this.automaticSession.renewalDate))},_SessionManager.prototype.backup=function(){this.setStorage(this.automaticSession.id,this.automaticSession.acquisitionDate,this.automaticSession.renewalDate)},_SessionManager.prototype.initializeAutomaticSession=function(){var n=ue.getCookie(this._logger,this._storageNamePrefix())
;if(n&&"function"==typeof n.split)this.initializeAutomaticSessionWithData(n);else{var s=ue.getStorage(this._logger,this._storageNamePrefix());s&&this.initializeAutomaticSessionWithData(s)}this.automaticSession.id||this.renew()},_SessionManager.prototype.initializeAutomaticSessionWithData=function(n){var s=n.split("|");s.length>0&&(this.automaticSession.id=s[0]);try{if(s.length>1){var m=+s[1];this.automaticSession.acquisitionDate=+new Date(m),this.automaticSession.acquisitionDate=this.automaticSession.acquisitionDate>0?this.automaticSession.acquisitionDate:0}if(s.length>2){var y=+s[2];this.automaticSession.renewalDate=+new Date(y),this.automaticSession.renewalDate=this.automaticSession.renewalDate>0?this.automaticSession.renewalDate:0}}catch(n){this._logger.throwInternal(T.CRITICAL,R.ErrorParsingAISessionCookie,"Error parsing ai_session cookie, session will be reset: "+ue.getExceptionName(n),{exception:ue.dump(n)})}
0===this.automaticSession.renewalDate&&this._logger.throwInternal(T.WARNING,R.SessionRenewalDateIsZero,"AI session renewal date is 0, session will be reset.")},_SessionManager.prototype.renew=function(){var n=fe.Now();this.automaticSession.id=ue.newId(),this.automaticSession.acquisitionDate=n,this.automaticSession.renewalDate=n,this.setCookie(this.automaticSession.id,this.automaticSession.acquisitionDate,this.automaticSession.renewalDate),ue.canUseLocalStorage()||this._logger.throwInternal(T.WARNING,R.BrowserDoesNotSupportLocalStorage,"Browser does not support local storage. Session durations will be inaccurate.")},_SessionManager.prototype.setCookie=function(n,s,m){var y=s+this.config.sessionExpirationMs(),C=m+this.config.sessionRenewalMs(),_=new Date,E=[n,s,m];y<C?_.setTime(y):_.setTime(C);var w=this.config.cookieDomain?this.config.cookieDomain():null,S=0===this.config.sessionExpirationMs()?"0":_.toUTCString()
;ue.setCookie(this._logger,this._storageNamePrefix(),E.join("|")+";expires="+S,w),this.cookieUpdatedTimestamp=fe.Now()},_SessionManager.prototype.setStorage=function(n,s,m){ue.setStorage(this._logger,this._storageNamePrefix(),[n,s,m].join("|"))},_SessionManager.acquisitionSpan=864e5,_SessionManager.renewalSpan=18e5,_SessionManager.cookieUpdateInterval=6e4,_SessionManager.cookieNameConst="ai_session",_SessionManager}(),bt=function bt(){},It=function It(){this.id="browser",this.deviceClass="Browser"},Tt=function Tt(n){this.sdkVersion=(n.sdkExtension&&n.sdkExtension()?n.sdkExtension()+"_":"")+"javascript:2.5.8"},At=function(){function User(n,s){this.isNewUser=!1,this._logger=s;var m=ue.getCookie(this._logger,User.userCookieName);if(m){this.isNewUser=!1;var y=m.split(User.cookieSeparator);y.length>0&&(this.id=y[0])}if(this.config=n,!this.id){this.id=ue.newId();var C=new Date,_=A.toISOString(C);this.accountAcquisitionDate=_,this.isNewUser=!0,C.setTime(C.getTime()+31536e6)
;var E=[this.id,_],w=this.config.cookieDomain?this.config.cookieDomain():void 0;ue.setCookie(this._logger,User.userCookieName,E.join(User.cookieSeparator)+";expires="+C.toUTCString(),w);var S=n.namePrefix&&n.namePrefix()?n.namePrefix()+"ai_session":"ai_session";ue.removeStorage(this._logger,S)}this.accountId=n.accountId?n.accountId():void 0;var I=ue.getCookie(this._logger,User.authUserCookieName);if(I){var T=(I=decodeURI(I)).split(User.cookieSeparator);T[0]&&(this.authenticatedId=T[0]),T.length>1&&T[1]&&(this.accountId=T[1])}}return User.prototype.setAuthenticatedUserContext=function(n,s,m){if(void 0===m&&(m=!1),!this.validateUserInput(n)||s&&!this.validateUserInput(s))this._logger.throwInternal(T.WARNING,R.SetAuthContextFailedAccountName,"Setting auth user context failed. User auth/account id should be of type string, and not contain commas, semi-colons, equal signs, spaces, or vertical-bars.",!0);else{this.authenticatedId=n;var y=this.authenticatedId;s&&(this.accountId=s,
y=[this.authenticatedId,this.accountId].join(User.cookieSeparator)),m&&ue.setCookie(this._logger,User.authUserCookieName,encodeURI(y),this.config.cookieDomain())}},User.prototype.clearAuthenticatedUserContext=function(){this.authenticatedId=null,this.accountId=null,ue.deleteCookie(this._logger,User.authUserCookieName)},User.prototype.validateUserInput=function(n){return!("string"!=typeof n||!n||n.match(/,|;|=| |\|/))},User.cookieSeparator="|",User.userCookieName="ai_user",User.authUserCookieName="ai_authUser",User}(),xt=function xt(){},Pt=function TelemetryTrace(n,s,m,y){this.traceID=n||ue.generateW3CId(),this.parentID=s,this.name=m;var C=getLocation();!m&&C&&C.pathname&&(this.name=C.pathname),this.name=oe.sanitizeString(y,this.name)},Rt=function(){function TelemetryContext(n,s){this.application=new bt,this.internal=new Tt(s),hasWindow()&&(this.sessionManager=new St(s,n),this.device=new It,this.location=new xt,this.user=new At(s,n),this.telemetryTrace=new Pt(void 0,void 0,void 0,n),
this.session=new wt),this.appId=function(){return null}}return TelemetryContext.prototype.applySessionContext=function(n,s){var m=this.session,y=this.sessionManager,C=m||y&&y.automaticSession;C&&A.isString(C.id)&&(n.ext.app.sesId=C.id),m&&(A.isString(m.id)?n.ext.app.sesId=m.id:n.ext.app.sesId=y.automaticSession.id)},TelemetryContext.prototype.applyOperatingSystemContxt=function(n,s){var m=this.os;m&&m.name&&(n.ext.os=m)},TelemetryContext.prototype.applyApplicationContext=function(n,s){var m=this.application;m&&(A.isString(m.ver)&&(n.tags[Ke.applicationVersion]=m.ver),A.isString(m.build)&&(n.tags[Ke.applicationBuild]=m.build))},TelemetryContext.prototype.applyDeviceContext=function(n,s){var m=this.device;m&&(A.isString(m.id)&&(n.ext.device.localId=m.id),A.isString(m.ip)&&(n.ext.device.ip=m.ip),A.isString(m.model)&&(n.ext.device.model=m.model),A.isString(m.deviceClass)&&(n.ext.device.deviceClass=m.deviceClass))},TelemetryContext.prototype.applyInternalContext=function(n,s){
var m=this.internal;m&&(A.isString(m.agentVersion)&&(n.tags[Ke.internalAgentVersion]=m.agentVersion),A.isString(m.sdkVersion)&&(n.tags[Ke.internalSdkVersion]=m.sdkVersion),n.baseType!==N.dataType&&n.baseType!==Fe.dataType||(A.isString(m.snippetVer)&&(n.tags[Ke.internalSnippet]=m.snippetVer),A.isString(m.sdkSrc)&&(n.tags[Ke.internalSdkSrc]=m.sdkSrc)))},TelemetryContext.prototype.applyLocationContext=function(n,s){var m=this.location;m&&A.isString(m.ip)&&(n.tags[Ke.locationIp]=m.ip)},TelemetryContext.prototype.applyOperationContext=function(n,s){var m=this.telemetryTrace;if(m){var y=n.ext.trace||{traceID:void 0,parentID:void 0};A.isString(m.traceID)&&(y.traceID=m.traceID),A.isString(m.name)&&(y.name=m.name),A.isString(m.parentID)&&(y.parentID=m.parentID),n.ext.trace=y}},TelemetryContext.prototype.applyWebContext=function(n,s){var m=this.web;m&&(n.ext.web=n.ext.web||{},n.ext.web=m)},TelemetryContext.prototype.applyUserContext=function(n,s){var m=this.user;m&&(n.tags||(n.tags=[]),
A.isString(m.accountId)&&(n.tags[Ke.userAccountId]=m.accountId),A.isString(m.id)&&(n.ext.user.id=m.id),A.isString(m.authenticatedId)&&(n.ext.user.authId=m.authenticatedId))},TelemetryContext.prototype.cleanUp=function(n,s){n.ext[We.DeviceExt]&&0===A.objKeys(n.ext[We.DeviceExt]).length&&delete n.ext[We.DeviceExt],n.ext[We.UserExt]&&0===A.objKeys(n.ext[We.UserExt]).length&&delete n.ext[We.UserExt],n.ext[We.WebExt]&&0===A.objKeys(n.ext[We.WebExt]).length&&delete n.ext[We.WebExt],n.ext[We.OSExt]&&0===A.objKeys(n.ext[We.OSExt]).length&&delete n.ext[We.OSExt],n.ext[We.AppExt]&&0===A.objKeys(n.ext[We.AppExt]).length&&delete n.ext[We.AppExt],n.ext[We.TraceExt]&&0===A.objKeys(n.ext[We.TraceExt]).length&&delete n.ext[We.TraceExt]},TelemetryContext}(),kt=function(n){function PropertiesPlugin(){var s=null!==n&&n.apply(this,arguments)||this;return s.priority=110,s.identifier=Xe,s}return __extends(PropertiesPlugin,n),PropertiesPlugin.getDefaultConfig=function(){return{
instrumentationKey:function(){},accountId:function(){return null},sessionRenewalMs:function(){return 18e5},samplingPercentage:function(){return 100},sessionExpirationMs:function(){return 864e5},cookieDomain:function(){return null},sdkExtension:function(){return null},isBrowserLinkTrackingEnabled:function(){return!1},appId:function(){return null},namePrefix:function(){}}},PropertiesPlugin.prototype.initialize=function(s,m,y,C){var _=this;n.prototype.initialize.call(this,s,m,y,C);var E=this._getTelCtx(),w=this.identifier,S=PropertiesPlugin.getDefaultConfig();this._extensionConfig=this._extensionConfig||PropertiesPlugin.getDefaultConfig();var _loop_1=function(n){I._extensionConfig[n]=function(){return E.getConfig(w,n,S[n]())}},I=this;for(var T in S)_loop_1(T);this.context=new Rt(m.logger,this._extensionConfig),this._breezeChannel=ue.getExtension(y,Ye),this.context.appId=function(){return _._breezeChannel?_._breezeChannel._appId:null}},
PropertiesPlugin.prototype.processTelemetry=function(n,s){if(A.isNullOrUndefined(n));else{if(s=this._getTelCtx(s),n.name===Fe.envelopeType&&s.diagLog().resetInternalMessageCount(),this.context.session&&"string"!=typeof this.context.session.id&&this.context.sessionManager.update(),this._processTelemetryInternal(n,s),this.context&&this.context.user&&this.context.user.isNewUser){this.context.user.isNewUser=!1;var m=new N(R.SendBrowserInfoOnUserInit,(getNavigator()||{}).userAgent||"");s.diagLog().logInternalMessage(T.CRITICAL,m)}this.processNext(n,s)}},PropertiesPlugin.prototype._processTelemetryInternal=function(n,s){n.tags||(n.tags=[]),n.ext||(n.ext={});var m=n.ext;m[We.DeviceExt]=m[We.DeviceExt]||{},m[We.WebExt]=m[We.WebExt]||{},m[We.UserExt]=m[We.UserExt]||{},m[We.OSExt]=m[We.OSExt]||{},m[We.AppExt]=m[We.AppExt]||{},m[We.TraceExt]=m[We.TraceExt]||{};var y=this.context;y.applySessionContext(n,s),y.applyApplicationContext(n,s),y.applyDeviceContext(n,s),y.applyOperationContext(n,s),
y.applyUserContext(n,s),y.applyOperatingSystemContxt(n,s),y.applyWebContext(n,s),y.applyLocationContext(n,s),y.applyInternalContext(n,s),y.cleanUp(n,s)},PropertiesPlugin}(j),Mt=["req","rsp","hkErr","fnErr"];function _arrLoop(n,s){if(n)for(var m=0;m<n.length&&!s(n[m],m);m++);}function _doCallbacks(n,s,m,y,C){C>=0&&C<=2&&_arrLoop(n,(function(n,_){var E=n.cbks,w=E[Mt[C]];if(w){s.ctx=function(){return y[_]=y[_]||{}};try{w.apply(s.inst,m)}catch(n){var S=s.err;try{var I=E[Mt[2]];I&&(s.err=n,I.apply(s.inst,m))}catch(n){}finally{s.err=S}}}}))}var Ot=Object.getPrototypeOf;function _getOwner(n,s,m){var y=null;return n&&(A.hasOwnProperty(n,s)?y=n:m&&(y=_getOwner(function InstrumentHooks_getObjProto(n){if(n){if(Ot)return Ot(n);var s=n.__proto__||n[w]||n.constructor;if(s)return s}return null}(n),s,!1))),y}function InstrumentFunc(n,s,m,y){if(void 0===y&&(y=!0),n&&s&&m){var C=_getOwner(n,s,y);if(C){var _=C[s];if(typeof _===S){var E=_._aiHooks;if(!E){var w=function _createFunctionHook(n){
return function(){var s=this,m=arguments,y=n.h,C={name:n.n,inst:s,ctx:null,set:_replaceArg},_=[],E=_createArgs([C],m);function _createArgs(n,s){return _arrLoop(s,(function(s){n.push(s)})),n}function _replaceArg(n,s){(m=_createArgs([],m))[n]=s,E=_createArgs([C],m)}_doCallbacks(y,C,E,_,0);var w=n.f;try{C.rslt=w.apply(s,m)}catch(n){throw C.err=n,_doCallbacks(y,C,E,_,3),n}return _doCallbacks(y,C,E,_,1),C.rslt}}(E={i:0,n:s,f:_,h:[]});w._aiHooks=E,C[s]=w}var I={id:E.i,cbks:m,rm:function(){var n=this.id;_arrLoop(E.h,(function(s,m){if(s.id===n)return E.h.splice(m,1),1}))}};return E.i++,E.h.push(I),I}}}return null}var Nt=A.objKeys,Dt=A.arrForEach;function _calcPerfDuration(n,s,m){var y=0,C=n[s],_=n[m];return C&&_&&(y=fe.GetDuration(C,_)),y}function _setPerfDuration(n,s,m,y,C){var _=0,E=_calcPerfDuration(m,y,C);return E&&(_=_setPerfValue(n,s,ue.msToTimeSpan(E))),_}function _setPerfValue(n,s,m){var y=0;n&&s&&m&&((n.ajaxPerf=n.ajaxPerf||{})[s]=m,y=1);return y}var Ut=function Ut(){this.openDone=!1,
this.setRequestHeaderDone=!1,this.sendDone=!1,this.abortDone=!1,this.stateChangeAttached=!1},Lt=function ajaxRecord(n,s,m){var y=m;this.perfMark=null,this.completed=!1,this.requestHeadersSize=null,this.requestHeaders=null,this.responseReceivingDuration=null,this.callbackDuration=null,this.ajaxTotalDuration=null,this.aborted=0,this.pageUrl=null,this.requestUrl=null,this.requestSize=0,this.method=null,this.status=null,this.requestSentTime=null,this.responseStartedTime=null,this.responseFinishedTime=null,this.callbackFinishedTime=null,this.endTime=null,this.xhrMonitoringState=new Ut,this.clientFailure=0,this.traceID=n,this.spanID=s,O(ajaxRecord,this,(function(n){n.getAbsoluteUrl=function(){return n.requestUrl?le.getAbsoluteUrl(n.requestUrl):null},n.getPathName=function(){return n.requestUrl?oe.sanitizeUrl(y,le.getCompleteUrl(n.method,n.requestUrl)):null},n.CreateTrackItem=function(s,m,y){if(n.ajaxTotalDuration=Math.round(1e3*fe.GetDuration(n.requestSentTime,n.responseFinishedTime))/1e3,
n.ajaxTotalDuration<0)return null;var C,_=((C={id:"|"+n.traceID+"."+n.spanID,target:n.getAbsoluteUrl(),name:n.getPathName(),type:s,duration:n.ajaxTotalDuration,success:+n.status>=200&&+n.status<400,responseCode:+n.status,method:n.method}).properties={HttpMethod:n.method},C);if(function _populatePerfData(n,s){var m=n.perfTiming,y=s.properties||{},C=0,_=A.isString,E="redirect",w=E+"Start",S=E="End";if(m){C|=_setPerfDuration(y,E,m,w,S),C|=_setPerfDuration(y,"domainLookup",m,"domainLookupStart","domainLookupEnd"),C|=_setPerfDuration(y,"connect",m,"connectStart","connectEnd"),C|=_setPerfDuration(y,"request",m,"requestStart","requestEnd"),C|=_setPerfDuration(y,"response",m,"responseStart","responseEnd"),C|=_setPerfDuration(y,"networkConnect",m,"startTime","connectEnd"),C|=_setPerfDuration(y,"sentRequest",m,"requestStart","responseEnd");var I=m.duration;I||(I=_calcPerfDuration(m,"startTime","responseEnd")||0),C|=_setPerfValue(y,"duration",I),C|=_setPerfValue(y,"perfTotal",I)
;var T=m.serverTiming;if(T){var x={};Dt(T,(function(n,s){var m=function normalizeJsName(n){var s=n,m=/([^\w\d_$])/g;return m.test(n)&&(s=n.replace(m,"_")),s}(n.name||""+s),y=x[m]||{};Dt(Nt(n),(function(s){var m=n[s];("name"!==s&&_(m)||A.isNumber(m))&&(y[s]&&(m=y[s]+";"+m),!m&&_(m)||(y[s]=m))})),x[m]=y})),C|=_setPerfValue(y,"serverTiming",x)}C|=_setPerfValue(y,"transferSize",m.transferSize),C|=_setPerfValue(y,"encodedBodySize",m.encodedBodySize),C|=_setPerfValue(y,"decodedBodySize",m.decodedBodySize)}else n.perfMark&&(C|=_setPerfValue(y,"missing",n.perfAttempts));C&&(s.properties=y)}(n,_),m&&Nt(n.requestHeaders).length>0&&(_.properties=_.properties||{},_.properties.requestHeaders=n.requestHeaders),y){var E=y();if(E){var w=E.correlationContext;if(w&&(_.correlationContext=w),E.headerMap&&Nt(E.headerMap).length>0&&(_.properties=_.properties||{},_.properties.responseHeaders=E.headerMap),n.status>=400){var S=E.type;_.properties=_.properties||{},
""!==S&&"text"!==S||(_.properties.responseText=E.responseText?E.statusText+" - "+E.responseText:E.statusText),"json"===S&&(_.properties.responseText=E.response?E.statusText+" - "+JSON.stringify(E.response):E.statusText)}}}return _}}))},Ft=function(){function Traceparent(n,s){this.traceFlag=Traceparent.DEFAULT_TRACE_FLAG,this.version=Traceparent.DEFAULT_VERSION,n&&Traceparent.isValidTraceId(n)?this.traceId=n:this.traceId=ue.generateW3CId(),s&&Traceparent.isValidSpanId(s)?this.spanId=s:this.spanId=ue.generateW3CId().substr(0,16)}return Traceparent.isValidTraceId=function(n){return n.match(/^[0-9a-f]{32}$/)&&"00000000000000000000000000000000"!==n},Traceparent.isValidSpanId=function(n){return n.match(/^[0-9a-f]{16}$/)&&"0000000000000000"!==n},Traceparent.prototype.toString=function(){return this.version+"-"+this.traceId+"-"+this.spanId+"-"+this.traceFlag},Traceparent.DEFAULT_TRACE_FLAG="01",Traceparent.DEFAULT_VERSION="00",Traceparent
}(),qt=A.isNullOrUndefined,Vt=A.arrForEach,Ht=A.objKeys,Bt=0;function _getFailedAjaxDiagnosticsMessage(n){var s="";try{qt(n)||qt(n.ajaxData)||qt(n.ajaxData.requestUrl)||(s+="(url: '"+n.ajaxData.requestUrl+"')")}catch(n){}return s}function _throwInternalCritical(n,s,m,y,C){n.diagLog().throwInternal(T.CRITICAL,s,m,y,C)}function _throwInternalWarning(n,s,m,y,C){n.diagLog().throwInternal(T.WARNING,s,m,y,C)}function _createErrorCallbackFunc(n,s,m){return function(y){_throwInternalCritical(n,s,m,{ajaxDiagnosticsMessage:_getFailedAjaxDiagnosticsMessage(y.inst),exception:ue.dump(y.err)})}}function _indexOf(n,s){return n&&s?n.indexOf(s):-1}var Gt,zt=function(n){function AjaxMonitor(){var s=n.call(this)||this;s.identifier=AjaxMonitor.identifier,s.priority=120;var m,y,C,E,S=getLocation(),T=!1,x=!1,k=S&&S.host&&S.host.toLowerCase(),M=AjaxMonitor.getEmptyConfig(),N=!1,D=0,U=!1,L=0,F=!1,q=[],H={};return O(AjaxMonitor,s,(function(n,s){function _hookProto(n,s,m){q.push(function InstrumentProto(n,s,m){
return n?InstrumentFunc(n[w],s,m,!1):null}(n,s,m))}function _isDisabledRequest(n,s,m){var y=!1,C=((A.isString(s)?s:(s||{}).url||"")||"").toLowerCase(),_=_indexOf(C,"?"),E=_indexOf(C,"#");return(-1===_||-1!==E&&E<_)&&(_=E),-1!==_&&(C=C.substring(0,_)),qt(n)?qt(s)||(y="object"==typeof s&&!0===s[he]||!!m&&!0===m[he]):y=!0===n[he]||!0===C[he],y?H[C]||(H[C]=1):H[C]&&(y=!0),y}function _isMonitoredXhrInstance(n,s){var m=!0,y=x;return qt(n)||(m=!0===s||!qt(n.ajaxData)),y&&m}function _getResponseText(n){try{var s=n.responseType;if(""===s||"text"===s)return n.responseText}catch(n){}return null}function _getAjaxCorrelationContext(s){try{var m=s.getAllResponseHeaders();if(null!==m)if(-1!==_indexOf(m.toLowerCase(),ie.requestContextHeaderLowerCase)){var y=s.getResponseHeader(ie.requestContextHeader);return de.getCorrelationContext(y)}}catch(m){
_throwInternalWarning(n,R.FailedMonitorAjaxGetCorrelationHeader,"Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",{ajaxDiagnosticsMessage:_getFailedAjaxDiagnosticsMessage(s),exception:ue.dump(m)})}}function _createMarkId(n,s){if(s.requestUrl&&E&&U){var m=getPerformance();if(m&&A.isFunction(m.mark)){Bt++;var y=E+n+"#"+Bt;m.mark(y);var C=m.getEntriesByName(y);C&&1===C.length&&(s.perfMark=C[0])}}}function _findPerfResourceEntry(n,s,m,y){var C=s.perfMark,_=getPerformance(),E=M.maxAjaxPerfLookupAttempts,w=M.ajaxPerfLookupDelay,S=s.requestUrl,I=0;!function locateResourceTiming(){try{if(_&&C){I++;for(var T=null,x=_.getEntries(),P=x.length-1;P>=0;P--){var R=x[P];if(R){if("resource"===R.entryType)R.initiatorType!==n||-1===_indexOf(R.name,S)&&-1===_indexOf(S,R.name)||(T=R);else if("mark"===R.entryType&&R.name===C.name){s.perfTiming=T;break}if(R.startTime<C.startTime-1e3)break}}}
!C||s.perfTiming||I>=E||!1===s.async?(C&&A.isFunction(_.clearMarks)&&_.clearMarks(C.name),s.perfAttempts=I,m()):setTimeout(locateResourceTiming,w)}catch(n){y(n)}}()}function _getFailedFetchDiagnosticsMessage(s){var m="";try{qt(s)||(m+="string"==typeof s?"(url: '"+s+"')":"(url: '"+s.url+"')")}catch(s){_throwInternalCritical(n,R.FailedMonitorAjaxOpen,"Failed to grab failed fetch diagnostics message",{exception:ue.dump(s)})}return m}function _reportFetchMetrics(s,m,y,C,_,E){function _reportFetchError(s,m,C){var _=C||{};_.fetchDiagnosticsMessage=_getFailedFetchDiagnosticsMessage(y),m&&(_.exception=ue.dump(m)),_throwInternalWarning(n,s,"Failed to calculate the duration of the fetch call, monitoring data for this fetch call won't be sent.",_)}C&&(C.responseFinishedTime=fe.Now(),C.status=m,_findPerfResourceEntry("fetch",C,(function(){var s=C.CreateTrackItem("Fetch",N,_);s?n.trackDependencyDataInternal(s):_reportFetchError(R.FailedMonitorAjaxDur,null,{requestSentTime:C.requestSentTime,
responseFinishedTime:C.responseFinishedTime})}),(function(n){_reportFetchError(R.FailedMonitorAjaxGetCorrelationHeader,n,null)})))}function _getFetchCorrelationContext(s){if(s&&s.headers)try{var m=s.headers.get(ie.requestContextHeader);return de.getCorrelationContext(m)}catch(m){_throwInternalWarning(n,R.FailedMonitorAjaxGetCorrelationHeader,"Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",{fetchDiagnosticsMessage:_getFailedFetchDiagnosticsMessage(s),exception:ue.dump(m)})}}n.initialize=function(S,k,O,D){if(!n.isInitialized()){s.initialize(S,k,O,D);var H=n._getTelCtx(),B=AjaxMonitor.getDefaultConfig();Vt(Ht(B),(function(n){M[n]=H.getConfig(AjaxMonitor.identifier,n,B[n])}));var z=M.distributedTracingMode;if(N=M.enableRequestHeaderTracking,U=M.enableAjaxPerfTracking,L=M.maxAjaxCallsPerView,F=M.enableResponseHeaderTracking,C=z===Y.AI||z===Y.AI_AND_W3C,y=z===Y.AI_AND_W3C||z===Y.W3C,U){var j=S.instrumentationKey||"unkwn"
;E=j.length>5?"ai.ajxmn."+j.substring(j.length-5)+".":"ai.ajxmn."+j+"."}if(!1===M.disableAjaxTracking&&function _instrumentXhr(){(function _supportsAjaxMonitoring(n){var s=!1;if(typeof XMLHttpRequest!==_&&!qt(XMLHttpRequest)){var m=XMLHttpRequest[w];s=!(qt(m)||qt(m.open)||qt(m.send)||qt(m.abort))}var y=ue.getIEVersion();if(y&&y<9&&(s=!1),s)try{(new XMLHttpRequest).ajaxData={};var C=XMLHttpRequest[w].open;XMLHttpRequest[w].open=C}catch(m){s=!1,_throwInternalCritical(n,R.FailedMonitorAjaxOpen,"Failed to enable XMLHttpRequest monitoring, extension is not supported",{exception:ue.dump(m)})}return s})(n)&&!x&&(_hookProto(XMLHttpRequest,"open",{req:function(s,y,C,_){var E=s.inst,w=E.ajaxData;_isDisabledRequest(E,C)||!_isMonitoredXhrInstance(E,!0)||w&&w.xhrMonitoringState.openDone||function _openHandler(s,y,C,_){var E=m&&m.telemetryTrace&&m.telemetryTrace.traceID||ue.generateW3CId(),w=ue.generateW3CId().substr(0,16),S=new Lt(E,w,n.diagLog());S.method=y,S.requestUrl=C,
S.xhrMonitoringState.openDone=!0,S.requestHeaders={},S.async=_,s.ajaxData=S,function _attachToOnReadyStateChange(s){s.ajaxData.xhrMonitoringState.stateChangeAttached=P.Attach(s,"readystatechange",(function(){try{s&&4===s.readyState&&_isMonitoredXhrInstance(s)&&function _onAjaxComplete(s){var m=s.ajaxData;function _reportXhrError(m,y){var C=y||{};C.ajaxDiagnosticsMessage=_getFailedAjaxDiagnosticsMessage(s),m&&(C.exception=ue.dump(m)),_throwInternalWarning(n,R.FailedMonitorAjaxDur,"Failed to calculate the duration of the ajax call, monitoring data for this ajax call won't be sent.",C)}m.responseFinishedTime=fe.Now(),m.status=s.status,_findPerfResourceEntry("xmlhttprequest",m,(function(){try{var y=m.CreateTrackItem("Ajax",N,(function(){var n={statusText:s.statusText,headerMap:null,correlationContext:_getAjaxCorrelationContext(s),type:s.responseType,responseText:_getResponseText(s),response:s.response};if(F){var m=s.getAllResponseHeaders();if(m){var y=A.strTrim(m).split(/[\r\n]+/),C={}
;Vt(y,(function(n){var s=n.split(": "),m=s.shift(),y=s.join(": ");C[m]=y})),n.headerMap=C}}return n}));y?n.trackDependencyDataInternal(y):_reportXhrError(null,{requestSentTime:m.requestSentTime,responseFinishedTime:m.responseFinishedTime})}finally{try{s.ajaxData=null}catch(n){}}}),(function(n){_reportXhrError(n,null)}))}(s)}catch(y){var m=ue.dump(y);m&&-1!==_indexOf(m.toLowerCase(),"c00c023f")||_throwInternalCritical(n,R.FailedMonitorAjaxRSC,"Failed to monitor XMLHttpRequest 'readystatechange' event handler, monitoring data for this ajax call may be incorrect.",{ajaxDiagnosticsMessage:_getFailedAjaxDiagnosticsMessage(s),exception:m})}}))}(s)}(E,y,C,_)},hkErr:_createErrorCallbackFunc(n,R.FailedMonitorAjaxOpen,"Failed to monitor XMLHttpRequest.open, monitoring data for this ajax call may be incorrect.")}),_hookProto(XMLHttpRequest,"send",{req:function(s,m){var y=s.inst,C=y.ajaxData;_isMonitoredXhrInstance(y)&&!C.xhrMonitoringState.sendDone&&(_createMarkId("xhr",C),
C.requestSentTime=fe.Now(),y=n.includeCorrelationHeaders(C,void 0,void 0,y),C.xhrMonitoringState.sendDone=!0)},hkErr:_createErrorCallbackFunc(n,R.FailedMonitorAjaxSend,"Failed to monitor XMLHttpRequest, monitoring data for this ajax call may be incorrect.")}),_hookProto(XMLHttpRequest,"abort",{req:function(n){var s=n.inst,m=s.ajaxData;_isMonitoredXhrInstance(s)&&!m.xhrMonitoringState.abortDone&&(m.aborted=1,m.xhrMonitoringState.abortDone=!0)},hkErr:_createErrorCallbackFunc(n,R.FailedMonitorAjaxAbort,"Failed to monitor XMLHttpRequest.abort, monitoring data for this ajax call may be incorrect.")}),N&&_hookProto(XMLHttpRequest,"setRequestHeader",{req:function(n,s,m){var y=n.inst;_isMonitoredXhrInstance(y)&&(y.ajaxData.requestHeaders[s]=m)},hkErr:_createErrorCallbackFunc(n,R.FailedMonitorAjaxSetRequestHeader,"Failed to monitor XMLHttpRequest.setRequestHeader, monitoring data for this ajax call may be incorrect.")}),x=!0)}(),function _instrumentFetch(){var s=function _supportsFetch(){
var n=I();return!n||qt(n.Request)||qt(n.Request[w])||qt(n.fetch)?null:n.fetch}();if(!s)return;var y=I(),C=s.polyfill;!1===M.disableFetchTracking?(q.push(InstrumentFunc(y,"fetch",{req:function(s,y,_){var E;if(T&&!_isDisabledRequest(null,y,_)&&(!C||!x)){var w=s.ctx();E=function _createFetchRecord(s,y){var C=m&&m.telemetryTrace&&m.telemetryTrace.traceID||ue.generateW3CId(),_=ue.generateW3CId().substr(0,16),E=new Lt(C,_,n.diagLog());E.requestSentTime=fe.Now(),s instanceof Request?E.requestUrl=s?s.url:"":E.requestUrl=s;var w="GET";y&&y.method?w=y.method:s&&s instanceof Request&&(w=s.method);E.method=w;var S={};if(N){new Headers((y?y.headers:0)||s instanceof Request&&s.headers||{}).forEach((function(n,s){S[s]=n}))}return E.requestHeaders=S,_createMarkId("fetch",E),E}(y,_);var S=n.includeCorrelationHeaders(E,y,_);S!==_&&s.set(1,S),w.data=E}},rsp:function(n,s){var m=n.ctx().data;m&&(n.rslt=n.rslt.then((function(s){return _reportFetchMetrics(n,(s||{}).status,s,m,(function(){var n={
statusText:s.statusText,headerMap:null,correlationContext:_getFetchCorrelationContext(s)};if(F){var m={};s.headers.forEach((function(n,s){m[s]=n})),n.headerMap=m}return n})),s})).catch((function(y){throw _reportFetchMetrics(n,0,s,m,null,{error:y.message}),y})))},hkErr:_createErrorCallbackFunc(n,R.FailedMonitorAjaxOpen,"Failed to monitor Window.fetch, monitoring data for this fetch call may be incorrect.")})),T=!0):C&&q.push(InstrumentFunc(y,"fetch",{req:function(n,s,m){_isDisabledRequest(null,s,m)}}));C&&(y.fetch.polyfill=C)}(),O.length>0&&O){for(var W=void 0,K=0;!W&&K<O.length;)O[K]&&O[K].identifier===Xe&&(W=O[K]),K++;W&&(m=W.context)}}},n.teardown=function(){Vt(q,(function(n){n.rm()})),q=[],T=!1,x=!1,n.setInitialized(!1)},n.trackDependencyData=function(s,m){n.trackDependencyDataInternal(s,m)},n.includeCorrelationHeaders=function(s,_,E,w){var S=n._currentWindowHost||k;if(_){if(de.canIncludeCorrelationHeader(M,s.getAbsoluteUrl(),S)){if(E||(E={}),
E.headers=new Headers(E.headers||_ instanceof Request&&_.headers||{}),C){var I="|"+s.traceID+"."+s.spanID;E.headers.set(ie.requestIdHeader,I),N&&(s.requestHeaders[ie.requestIdHeader]=I)}if((A=M.appId||m&&m.appId())&&(E.headers.set(ie.requestContextHeader,ie.requestContextAppIdFormat+A),N&&(s.requestHeaders[ie.requestContextHeader]=ie.requestContextAppIdFormat+A)),y){var T=new Ft(s.traceID,s.spanID);E.headers.set(ie.traceParentHeader,T.toString()),N&&(s.requestHeaders[ie.traceParentHeader]=T.toString())}}return E}if(w){if(de.canIncludeCorrelationHeader(M,s.getAbsoluteUrl(),S)){if(C){I="|"+s.traceID+"."+s.spanID;w.setRequestHeader(ie.requestIdHeader,I),N&&(s.requestHeaders[ie.requestIdHeader]=I)}var A;if((A=M.appId||m&&m.appId())&&(w.setRequestHeader(ie.requestContextHeader,ie.requestContextAppIdFormat+A),N&&(s.requestHeaders[ie.requestContextHeader]=ie.requestContextAppIdFormat+A)),y){T=new Ft(s.traceID,s.spanID);w.setRequestHeader(ie.traceParentHeader,T.toString()),
N&&(s.requestHeaders[ie.traceParentHeader]=T.toString())}}return w}},n.trackDependencyDataInternal=function(s,m,y){if(-1===L||D<L){M.distributedTracingMode!==Y.W3C&&M.distributedTracingMode!==Y.AI_AND_W3C||"string"!=typeof s.id||"."===s.id[s.id.length-1]||(s.id+="."),A.isNullOrUndefined(s.startTime)&&(s.startTime=new Date);var C=je.create(s,qe.dataType,qe.envelopeType,n.diagLog(),m,y);n.core.track(C)}else D===L&&_throwInternalCritical(n,R.MaxAjaxPerPVExceeded,"Maximum ajax per page view limit reached, ajax monitoring is paused until the next trackPageView(). In order to increase the limit set the maxAjaxCallsPerView configuration parameter.",!0);++D}})),s}return __extends(AjaxMonitor,n),AjaxMonitor.getDefaultConfig=function(){return{maxAjaxCallsPerView:500,disableAjaxTracking:!1,disableFetchTracking:!0,disableCorrelationHeaders:!1,distributedTracingMode:Y.AI,
correlationHeaderExcludedDomains:["*.blob.core.windows.net","*.blob.core.chinacloudapi.cn","*.blob.core.cloudapi.de","*.blob.core.usgovcloudapi.net"],correlationHeaderDomains:void 0,appId:void 0,enableCorsCorrelation:!1,enableRequestHeaderTracking:!1,enableResponseHeaderTracking:!1,enableAjaxErrorStatusText:!1,enableAjaxPerfTracking:!1,maxAjaxPerfLookupAttempts:3,ajaxPerfLookupDelay:25}},AjaxMonitor.getEmptyConfig=function(){var n=this.getDefaultConfig();return Vt(Ht(n),(function(s){n[s]=void 0})),n},AjaxMonitor.prototype.processTelemetry=function(n,s){this.processNext(n,s)},AjaxMonitor.identifier="AjaxDependencyPlugin",AjaxMonitor}(j),jt=y,Wt=function(){function Initialization(n){this._snippetVersion=""+(n.sv||n.version||""),n.queue=n.queue||[],n.version=n.version||2;var s=n.config||{};if(s.connectionString){var m=Ce.parse(s.connectionString),y=m.ingestionendpoint;s.endpointUrl=y?y+"/v2/track":s.endpointUrl,s.instrumentationKey=m.instrumentationkey||s.instrumentationKey}
this.appInsights=new tt,this.properties=new kt,this.dependencies=new zt,this.core=new ne,this.snippet=n,this.config=s,this.getSKUDefaults()}return Initialization.prototype.trackEvent=function(n,s){this.appInsights.trackEvent(n,s)},Initialization.prototype.trackPageView=function(n){var s=n||{};this.appInsights.trackPageView(s)},Initialization.prototype.trackPageViewPerformance=function(n){var s=n||{};this.appInsights.trackPageViewPerformance(s)},Initialization.prototype.trackException=function(n){!n.exception&&n.error&&(n.exception=n.error),this.appInsights.trackException(n)},Initialization.prototype._onerror=function(n){this.appInsights._onerror(n)},Initialization.prototype.trackTrace=function(n,s){this.appInsights.trackTrace(n,s)},Initialization.prototype.trackMetric=function(n,s){this.appInsights.trackMetric(n,s)},Initialization.prototype.startTrackPage=function(n){this.appInsights.startTrackPage(n)},Initialization.prototype.stopTrackPage=function(n,s,m,y){
this.appInsights.stopTrackPage(n,s,m,y)},Initialization.prototype.startTrackEvent=function(n){this.appInsights.startTrackEvent(n)},Initialization.prototype.stopTrackEvent=function(n,s,m){this.appInsights.stopTrackEvent(n,s,m)},Initialization.prototype.addTelemetryInitializer=function(n){return this.appInsights.addTelemetryInitializer(n)},Initialization.prototype.setAuthenticatedUserContext=function(n,s,m){void 0===m&&(m=!1),this.properties.context.user.setAuthenticatedUserContext(n,s,m)},Initialization.prototype.clearAuthenticatedUserContext=function(){this.properties.context.user.clearAuthenticatedUserContext()},Initialization.prototype.trackDependencyData=function(n){this.dependencies.trackDependencyData(n)},Initialization.prototype.flush=function(n){var s=this;void 0===n&&(n=!0),doPerf(this.core,(function(){return"AISKU.flush"}),(function(){A.arrForEach(s.core.getTransmissionControls(),(function(s){A.arrForEach(s,(function(s){s.flush(n)}))}))}),null,n)},
Initialization.prototype.onunloadFlush=function(n){void 0===n&&(n=!0),A.arrForEach(this.core.getTransmissionControls(),(function(s){A.arrForEach(s,(function(s){s.onunloadFlush?s.onunloadFlush():s.flush(n)}))}))},Initialization.prototype.loadAppInsights=function(n){var s=this;void 0===n&&(n=!1);var m=this;if(n&&m.config.extensions&&m.config.extensions.length>0)throw new Error("Extensions not allowed in legacy mode");return doPerf(m.core,(function(){return"AISKU.loadAppInsights"}),(function(){var y=[],C=new Et;y.push(C),y.push(m.properties),y.push(m.dependencies),y.push(m.appInsights),m.core.initialize(m.config,y),m.context=m.properties.context,Gt&&m.context&&(m.context.internal.sdkSrc=Gt),function _updateSnippetProperties(s){if(s){var y="";for(var C in A.isNullOrUndefined(m._snippetVersion)||(y+=m._snippetVersion),n&&(y+=".lg"),m.context&&m.context.internal&&(m.context.internal.snippetVer=y||"-"),m)A.isString(C)&&!A.isFunction(m[C])&&"_"!==C.substring(0,1)&&(s[C]=m[C])}}(m.snippet),
m.emptyQueue(),m.pollInternalLogs(),m.addHousekeepingBeforeUnload(s)})),m},Initialization.prototype.updateSnippetDefinitions=function(n){for(var s in this)A.isString(s)&&(n[s]=this[s])},Initialization.prototype.emptyQueue=function(){try{if(ue.isArray(this.snippet.queue)){for(var n=this.snippet.queue.length,s=0;s<n;s++){(0,this.snippet.queue[s])()}this.snippet.queue=void 0,delete this.snippet.queue}}catch(n){n&&A.isFunction(n.toString)&&n.toString()}},Initialization.prototype.pollInternalLogs=function(){this.core.pollInternalLogs()},Initialization.prototype.addHousekeepingBeforeUnload=function(n){if(hasWindow()||hasDocument()){var performHousekeeping=function(){n.onunloadFlush(!1);var s=n.appInsights.core._extensions[Xe];s&&s.context&&s.context._sessionManager&&s.context._sessionManager.backup()};if(!n.appInsights.config.disableFlushOnBeforeUnload){var s=A.addEventHandler("beforeunload",performHousekeeping)
;(s=A.addEventHandler("pagehide",performHousekeeping)||s)||function isReactNative(){var n=getNavigator();return!(!n||!n.product)&&"ReactNative"===n.product}()||n.appInsights.core.logger.throwInternal(T.CRITICAL,R.FailedToAddHandlerForOnBeforeUnload,"Could not add handler for beforeunload and pagehide")}n.appInsights.config.disableFlushOnUnload||A.addEventHandler("pagehide",performHousekeeping)}},Initialization.prototype.getSKUDefaults=function(){this.config.diagnosticLogInterval=this.config.diagnosticLogInterval&&this.config.diagnosticLogInterval>0?this.config.diagnosticLogInterval:1e4},Initialization}();!function(){var n=null,s=["://az416426.vo.msecnd.net/"];try{var m=(document||{}).currentScript;m&&(n=m.src)}catch(n){}if(n)try{var y=n.toLowerCase();if(y)for(var C="",_=0;_<s.length;_++)if(-1!==y.indexof(s[_])){C="cdn"+(_+1),-1===y.indexOf("/scripts/")&&(-1!==y.indexOf("/next/")?C+="-next":-1!==y.indexOf("/beta/")&&(C+="-beta")),Gt=C+"";break}}catch(n){}}();var Kt=function(){
function AppInsightsDeprecated(n,s){this._hasLegacyInitializers=!1,this._queue=[],this.config=AppInsightsDeprecated.getDefaultConfig(n.config),this.appInsightsNew=s,this.context={addTelemetryInitializer:this.addTelemetryInitializers.bind(this)}}return AppInsightsDeprecated.getDefaultConfig=function(n){return n||(n={}),n.endpointUrl=n.endpointUrl||"https://dc.services.visualstudio.com/v2/track",n.sessionRenewalMs=18e5,n.sessionExpirationMs=864e5,n.maxBatchSizeInBytes=n.maxBatchSizeInBytes>0?n.maxBatchSizeInBytes:102400,n.maxBatchInterval=isNaN(n.maxBatchInterval)?15e3:n.maxBatchInterval,n.enableDebug=ue.stringToBoolOrDefault(n.enableDebug),n.disableExceptionTracking=ue.stringToBoolOrDefault(n.disableExceptionTracking),n.disableTelemetry=ue.stringToBoolOrDefault(n.disableTelemetry),n.verboseLogging=ue.stringToBoolOrDefault(n.verboseLogging),n.emitLineDelimitedJson=ue.stringToBoolOrDefault(n.emitLineDelimitedJson),n.diagnosticLogInterval=n.diagnosticLogInterval||1e4,
n.autoTrackPageVisitTime=ue.stringToBoolOrDefault(n.autoTrackPageVisitTime),(isNaN(n.samplingPercentage)||n.samplingPercentage<=0||n.samplingPercentage>=100)&&(n.samplingPercentage=100),n.disableAjaxTracking=ue.stringToBoolOrDefault(n.disableAjaxTracking),n.maxAjaxCallsPerView=isNaN(n.maxAjaxCallsPerView)?500:n.maxAjaxCallsPerView,n.isBeaconApiDisabled=ue.stringToBoolOrDefault(n.isBeaconApiDisabled,!0),n.disableCorrelationHeaders=ue.stringToBoolOrDefault(n.disableCorrelationHeaders),n.correlationHeaderExcludedDomains=n.correlationHeaderExcludedDomains||["*.blob.core.windows.net","*.blob.core.chinacloudapi.cn","*.blob.core.cloudapi.de","*.blob.core.usgovcloudapi.net"],n.disableFlushOnBeforeUnload=ue.stringToBoolOrDefault(n.disableFlushOnBeforeUnload),n.disableFlushOnUnload=ue.stringToBoolOrDefault(n.disableFlushOnUnload,n.disableFlushOnBeforeUnload),n.enableSessionStorageBuffer=ue.stringToBoolOrDefault(n.enableSessionStorageBuffer,!0),
n.isRetryDisabled=ue.stringToBoolOrDefault(n.isRetryDisabled),n.isCookieUseDisabled=ue.stringToBoolOrDefault(n.isCookieUseDisabled),n.isStorageUseDisabled=ue.stringToBoolOrDefault(n.isStorageUseDisabled),n.isBrowserLinkTrackingEnabled=ue.stringToBoolOrDefault(n.isBrowserLinkTrackingEnabled),n.enableCorsCorrelation=ue.stringToBoolOrDefault(n.enableCorsCorrelation),n},AppInsightsDeprecated.prototype.addTelemetryInitializers=function(n){var s=this;this._hasLegacyInitializers||(this.appInsightsNew.addTelemetryInitializer((function(n){s._processLegacyInitializers(n)})),this._hasLegacyInitializers=!0),this._queue.push(n)},AppInsightsDeprecated.prototype.startTrackPage=function(n){this.appInsightsNew.startTrackPage(n)},AppInsightsDeprecated.prototype.stopTrackPage=function(n,s,m,y){this.appInsightsNew.stopTrackPage(n,s,m)},AppInsightsDeprecated.prototype.trackPageView=function(n,s,m,y,C){var _={name:n,uri:s,properties:m,measurements:y};this.appInsightsNew.trackPageView(_)},
AppInsightsDeprecated.prototype.trackEvent=function(n,s,m){this.appInsightsNew.trackEvent({name:n})},AppInsightsDeprecated.prototype.trackDependency=function(n,s,m,y,C,_,E){this.appInsightsNew.trackDependencyData({id:n,target:m,type:y,duration:C,properties:{HttpMethod:s},success:_,responseCode:E})},AppInsightsDeprecated.prototype.trackException=function(n,s,m,y,C){this.appInsightsNew.trackException({exception:n})},AppInsightsDeprecated.prototype.trackMetric=function(n,s,m,y,C,_){this.appInsightsNew.trackMetric({name:n,average:s,sampleCount:m,min:y,max:C})},AppInsightsDeprecated.prototype.trackTrace=function(n,s,m){this.appInsightsNew.trackTrace({message:n,severityLevel:m})},AppInsightsDeprecated.prototype.flush=function(n){this.appInsightsNew.flush(n)},AppInsightsDeprecated.prototype.setAuthenticatedUserContext=function(n,s,m){this.appInsightsNew.context.user.setAuthenticatedUserContext(n,s,m)},AppInsightsDeprecated.prototype.clearAuthenticatedUserContext=function(){
this.appInsightsNew.context.user.clearAuthenticatedUserContext()},AppInsightsDeprecated.prototype._onerror=function(n,s,m,y,C){this.appInsightsNew._onerror({message:n,url:s,lineNumber:m,columnNumber:y,error:C})},AppInsightsDeprecated.prototype.startTrackEvent=function(n){this.appInsightsNew.startTrackEvent(n)},AppInsightsDeprecated.prototype.stopTrackEvent=function(n,s,m){this.appInsightsNew.stopTrackEvent(n,s,m)},AppInsightsDeprecated.prototype.downloadAndSetup=function(n){throw new Error("downloadAndSetup not implemented in web SKU")},AppInsightsDeprecated.prototype.updateSnippetDefinitions=function(n){for(var s in this)"string"==typeof s&&(n[s]=this[s])},AppInsightsDeprecated.prototype.loadAppInsights=function(){var n=this;if(this.config.iKey){var s=this.trackPageView;this.trackPageView=function(m,y,C){s.apply(n,[null,m,y,C])}}"function"==typeof this.snippet.logPageView&&(this.logPageView=function(s,m,y){n.trackPageView(null,s,m,y)})
;return"function"==typeof this.snippet.logEvent&&(this.logEvent=function(s,m,y){n.trackEvent(s,m,y)}),this},AppInsightsDeprecated.prototype._processLegacyInitializers=function(n){return n.tags[me]=this._queue,n},AppInsightsDeprecated}(),Xt=function(){function ApplicationInsightsContainer(){}return ApplicationInsightsContainer.getAppInsights=function(n,s){var m=new Wt(n),y=2!==s;if(2===s)return m.updateSnippetDefinitions(n),m.loadAppInsights(y),m;var C=new Kt(n,m);return C.updateSnippetDefinitions(n),m.loadAppInsights(y),C},ApplicationInsightsContainer}()},33:function(n,s,m){"use strict";var y=this&&this.__createBinding||(Object.create?function(n,s,m,y){void 0===y&&(y=m),Object.defineProperty(n,y,{enumerable:!0,get:function(){return s[m]}})}:function(n,s,m,y){void 0===y&&(y=m),n[y]=s[m]}),C=this&&this.__setModuleDefault||(Object.create?function(n,s){Object.defineProperty(n,"default",{enumerable:!0,value:s})}:function(n,s){n.default=s}),_=this&&this.__importStar||function(n){
if(n&&n.__esModule)return n;var s={};if(null!=n)for(var m in n)"default"!==m&&Object.hasOwnProperty.call(n,m)&&y(s,n,m);return C(s,n),s};Object.defineProperty(s,"__esModule",{value:!0}),s.storage=s.whiteSpaceRegex=s.isUnknownObject=s.fixMessageLink=s.delay=s.safeStringify=s.cancellationNoThrow=s.cancellation=s.OperationCancelled=s.nop=s.filterNull=s.assert1=s.assertT=s.assert=s.unsafeHtmlToText=void 0;const E=m(36),w=_(m(202));s.unsafeHtmlToText=function unsafeHtmlToText(n){const s=document.createElement("div");return s.innerHTML=n,s.innerText},s.assert=function assert(n,s="value"){if(null==n)throw new Error(s+" must not be null or undefined");return n},s.assertT=function assertT(n,s,m="value"){if("string"==typeof s&&typeof n!==s)throw new Error(`${m} is not of type ${s}`);if("function"==typeof s&&!s(n))throw new Error(m+" is not of the expected type");return n},s.assert1=function assert1(n,s="value"){if(null==n)throw new Error(s+" must not be null or undefined")},
s.filterNull=function filterNull(n){return null!==n},s.nop=function nop(){};class OperationCancelled extends Error{constructor(){super("Cancelled by user request")}}s.OperationCancelled=OperationCancelled,s.cancellation=function cancellation(){let n=!1;return[function cancel(){n=!0},function throwIfCancellationRequested(){if(n)throw new OperationCancelled}]},s.cancellationNoThrow=function cancellationNoThrow(){let n=!1;return[function cancel(){n=!0},function isCancellationRequested(){return n}]},s.safeStringify=function safeStringify(n){if("string"==typeof n)return n;const s=new WeakSet,replacer=(n,m)=>{if("object"==typeof m&&null!==m){if(s.has(m))return"[already seen]";s.add(m)}return m};try{return JSON.stringify(n,replacer,4)}catch(n){return"[safeStringify: error]"}},s.delay=(n,s)=>new Promise((m,y)=>{let C=-1,_=-1,E=!1;const cleanup=()=>{E&&(C>=0&&clearTimeout(C),_>=0&&clearInterval(_),C=_=-1)};if(s){const checkCancel=()=>{try{if(s())return E=!0,m(),!0}catch(n){return E=!0,
y(new OperationCancelled),!0}finally{cleanup()}return!1};if(checkCancel())return;_=setInterval(checkCancel,50)}C=setTimeout(()=>{E=!0,m(),cleanup()},n)}),s.fixMessageLink=function fixMessageLink(n){if("string"!=typeof n||""===n.trim())return"";try{const s=new URL(n);return s.pathname=decodeURIComponent(s.pathname),s.toString()}catch(n){return E.warn("invalid url",n),""}},s.isUnknownObject=function isUnknownObject(n){return null!==n&&"object"==typeof n},s.whiteSpaceRegex=/[\s\b]+/.compile(),s.storage=(()=>{const n="firefox"===w.getParser(navigator.userAgent).getBrowserName(!0),m=navigator.storage&&"function"==typeof navigator.storage.persist&&"function"==typeof navigator.storage.persisted,y=function inIframe(){try{return window.self!==window.top}catch(n){return!0}}();let C=!0;return async function check(){if(m&&!await navigator.storage.persisted())for(C=!1;!(C=await navigator.storage.persisted());)n||(C=await navigator.storage.persist()),await s.delay(2e4)}().catch(E.error),
Object.freeze({granted:()=>C,askForPermission:m&&n,needNewWindow:y&&n})})()},36:function(n,s,m){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.traceAsync=s.trace=s.error=s.warn=s.info=void 0;const y=m(33),C=m(62);s.info=function info(...n){console.log(...n),n.filter(y.isUnknownObject).forEach(console.dir)},s.warn=function warn(...n){console.warn(...n),n.filter(y.isUnknownObject).forEach(console.dir)},s.error=function error(...n){console.error(...n),n.filter(y.isUnknownObject).forEach(console.dir)},s.trace=function trace(n,s,m){const C=m.value,_=m.value.name;return m.value=function traceWrapper(...n){console.group(_);const s=performance.now();try{const m=C.apply(this,n);return y.isUnknownObject(m)&&"function"==typeof m.then&&console.warn(`trace: ${_} returned a promise. measured execution time may be wrong.`),m}finally{const n=(performance.now()-s).toFixed(1);console.info(`${_} took ${n}ms`),console.groupEnd()}},m},s.traceAsync=function traceAsync(n=!1){
return function _traceAsync(s,m,y){const _=y.value,E=y.value.name;return y.value=async function traceWrapper(...s){console.group(E);const m=performance.now();try{n&&C.AI.startTrackEvent(E);return await _.apply(this,s)}finally{n&&C.AI.stopTrackEvent(E);const s=(performance.now()-m).toFixed(1);console.info(`${E} took ${s}ms`),console.groupEnd()}},y}}},476:function(n,s,m){n.exports=m(477)},477:function(n,s,m){"use strict";var y=this&&this.__createBinding||(Object.create?function(n,s,m,y){void 0===y&&(y=m),Object.defineProperty(n,y,{enumerable:!0,get:function(){return s[m]}})}:function(n,s,m,y){void 0===y&&(y=m),n[y]=s[m]}),C=this&&this.__setModuleDefault||(Object.create?function(n,s){Object.defineProperty(n,"default",{enumerable:!0,value:s})}:function(n,s){n.default=s}),_=this&&this.__importStar||function(n){if(n&&n.__esModule)return n;var s={};if(null!=n)for(var m in n)"default"!==m&&Object.hasOwnProperty.call(n,m)&&y(s,n,m);return C(s,n),s};Object.defineProperty(s,"__esModule",{value:!0
});const E=_(m(64)),w=m(33),S=m(126);E.initialize((async function processResponse(){try{const n=await S.client.handleRedirectPromise();null===n?E.authentication.notifyFailure("no redirect resonse"):E.authentication.notifySuccess(JSON.stringify(n))}catch(n){w.isUnknownObject(n)&&"name"in n&&"message"in n?E.authentication.notifyFailure(`${n.name}: ${n.message}`):E.authentication.notifyFailure("Unexpected error")}}))},62:function(n,s,m){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.AI=void 0;const y=m(206);const C=function initAI(){{const n={config:{instrumentationKey:"0b53b004-005f-46be-8fc1-63b98d9654e4",maxBatchInterval:5e3,maxAjaxCallsPerView:-1,disableDataLossAnalysis:!1,enableUnhandledPromiseRejectionTracking:!0,disableFetchTracking:!1}},s=new y.ApplicationInsights(n);return s.loadAppInsights(),s.trackPageView(),s}}();s.AI=Object.freeze({custom:function custom(n){C&&n&&n(C)},trackException:function trackException(n){null==C||C.trackException(n)},
trackEvent:function trackEvent(n,s){null==C||C.trackEvent(n,s)},trackMetric:function trackMetric(n,s){null==C||C.trackMetric(n,s)},trackTrace:function trackTrace(n,s){null==C||C.trackTrace(n,s)},startTrackEvent:function startTrackEvent(n){null==C||C.startTrackEvent(n)},stopTrackEvent:function stopTrackEvent(n,s,m){null==C||C.stopTrackEvent(n,s,m)},flushBuffer:function flushBuffer(){null==C||C.flush()},setAuthenticatedUserContext:function setAuthenticatedUserContext(n,s){null==C||C.setAuthenticatedUserContext(n,s,!0)}})},64:function(n,s,m){window,n.exports=function(n){var s={};function t(m){if(s[m])return s[m].exports;var y=s[m]={i:m,l:!1,exports:{}};return n[m].call(y.exports,y,y.exports,t),y.l=!0,y.exports}return t.m=n,t.c=s,t.d=function(n,s,m){t.o(n,s)||Object.defineProperty(n,s,{enumerable:!0,get:m})},t.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},
t.t=function(n,s){if(1&s&&(n=t(n)),8&s)return n;if(4&s&&"object"==typeof n&&n&&n.__esModule)return n;var m=Object.create(null);if(t.r(m),Object.defineProperty(m,"default",{enumerable:!0,value:n}),2&s&&"string"!=typeof n)for(var y in n)t.d(m,y,function(s){return n[s]}.bind(null,y));return m},t.n=function(n){var s=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(s,"a",s),s},t.o=function(n,s){return Object.prototype.hasOwnProperty.call(n,s)},t.p="",t(t.s=8)}([function(n,s,m){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var y=function(){function e(){}return e.initializeCalled=!1,e.initializeCompleted=!1,e.additionalValidOrigins=[],e.additionalValidOriginsRegexp=null,e.initializeCallbacks=[],e.isFramelessWindow=!1,e.parentMessageQueue=[],e.childMessageQueue=[],e.nextMessageId=0,e.handlers={},e.callbacks={},e.printCapabilityEnabled=!1,e}();s.GlobalVars=y},function(n,s,m){"use strict";Object.defineProperty(s,"__esModule",{value:!0})
;var y=m(4),C=m(2),_=m(0),E=m(3);function u(n){if("id"in n.data&&"number"==typeof n.data.id){var s=n.data,m=_.GlobalVars.callbacks[s.id];m&&(m.apply(null,s.args),delete _.GlobalVars.callbacks[s.id])}else if("func"in n.data&&"string"==typeof n.data.func){s=n.data;var y=_.GlobalVars.handlers[s.func];y&&y.apply(this,s.args)}}function d(n){return n===_.GlobalVars.parentWindow?_.GlobalVars.parentMessageQueue:n===_.GlobalVars.childWindow?_.GlobalVars.childMessageQueue:[]}function f(n){return n===_.GlobalVars.parentWindow?_.GlobalVars.parentOrigin:n===_.GlobalVars.childWindow?_.GlobalVars.childOrigin:null}function g(n){for(var s=f(n),m=d(n);n&&s&&m.length>0;)n.postMessage(m.shift(),s)}function b(n,s){var m=_.GlobalVars.parentWindow,y=function v(n,s){return{id:_.GlobalVars.nextMessageId++,func:n,args:s||[]}}(n,s)
;if(_.GlobalVars.isFramelessWindow)_.GlobalVars.currentWindow&&_.GlobalVars.currentWindow.nativeInterface&&_.GlobalVars.currentWindow.nativeInterface.framelessPostMessage(JSON.stringify(y));else{var C=f(m);m&&C?m.postMessage(y,C):d(m).push(y)}return y.id}function p(n,s){var m=_.GlobalVars.childWindow,y=function V(n,s){return{id:n,args:s||[]}}(n,s),C=f(m);m&&C&&m.postMessage(y,C)}function h(n,s){var m=_.GlobalVars.childWindow,y=function G(n,s){return{func:n,args:s||[]}}(n,s),C=f(m);m&&C?m.postMessage(y,C):d(m).push(y)}_.GlobalVars.handlers.themeChange=function(n){_.GlobalVars.themeChangeHandler&&_.GlobalVars.themeChangeHandler(n),_.GlobalVars.childWindow&&h("themeChange",[n])},_.GlobalVars.handlers.fullScreenChange=function(n){_.GlobalVars.fullScreenChangeHandler&&_.GlobalVars.fullScreenChangeHandler(n)},_.GlobalVars.handlers.backButtonPress=function(){_.GlobalVars.backButtonPressHandler&&_.GlobalVars.backButtonPressHandler()||y.navigateBack()},_.GlobalVars.handlers.load=function(n){
_.GlobalVars.loadHandler&&_.GlobalVars.loadHandler(n),_.GlobalVars.childWindow&&h("load",[n])},_.GlobalVars.handlers.beforeUnload=function(){var e=function(){b("readyToUnload",[])};_.GlobalVars.beforeUnloadHandler&&_.GlobalVars.beforeUnloadHandler(e)||e()},_.GlobalVars.handlers.changeSettings=function(){_.GlobalVars.changeSettingsHandler&&_.GlobalVars.changeSettingsHandler()},_.GlobalVars.handlers.startConversation=function(n,s,m,y){_.GlobalVars.onStartConversationHandler&&_.GlobalVars.onStartConversationHandler({subEntityId:n,conversationId:s,channelId:m,entityId:y})},_.GlobalVars.handlers.closeConversation=function(n,s,m,y){_.GlobalVars.onCloseConversationHandler&&_.GlobalVars.onCloseConversationHandler({subEntityId:n,conversationId:s,channelId:m,entityId:y})},s.ensureInitialized=function(){for(var n=[],s=0;s<arguments.length;s++)n[s]=arguments[s];if(!_.GlobalVars.initializeCalled)throw new Error("The library has not yet been initialized")
;if(_.GlobalVars.frameContext&&n&&n.length>0){for(var m=!1,y=0;y<n.length;y++)if(n[y]===_.GlobalVars.frameContext){m=!0;break}if(!m)throw new Error("This call is not allowed in the '"+_.GlobalVars.frameContext+"' context")}},s.processMessage=function(n){if(n&&n.data&&"object"==typeof n.data){var s=n.source||n.originalEvent&&n.originalEvent.source,m=n.origin||n.originalEvent&&n.originalEvent.origin;(function o(n,s){return!(_.GlobalVars.currentWindow&&n===_.GlobalVars.currentWindow||!(_.GlobalVars.currentWindow&&_.GlobalVars.currentWindow.location&&s&&s===_.GlobalVars.currentWindow.location.origin)&&!(C.validOriginRegExp.test(s.toLowerCase())||_.GlobalVars.additionalValidOriginsRegexp&&_.GlobalVars.additionalValidOriginsRegexp.test(s.toLowerCase())))})(s,m)&&(function l(n,s){_.GlobalVars.parentWindow&&n!==_.GlobalVars.parentWindow?_.GlobalVars.childWindow&&n!==_.GlobalVars.childWindow||(_.GlobalVars.childWindow=n,_.GlobalVars.childOrigin=s):(_.GlobalVars.parentWindow=n,
_.GlobalVars.parentOrigin=s),_.GlobalVars.parentWindow&&_.GlobalVars.parentWindow.closed&&(_.GlobalVars.parentWindow=null,_.GlobalVars.parentOrigin=null),_.GlobalVars.childWindow&&_.GlobalVars.childWindow.closed&&(_.GlobalVars.childWindow=null,_.GlobalVars.childOrigin=null),g(_.GlobalVars.parentWindow),g(_.GlobalVars.childWindow)}(s,m),s===_.GlobalVars.parentWindow?u(n):s===_.GlobalVars.childWindow&&function c(n){if("id"in n.data&&"func"in n.data){var s=n.data,m=s.func?_.GlobalVars.handlers[s.func]:null;if(m){var y=m.apply(this,s.args);void 0!==y&&p(s.id,Array.isArray(y)?y:[y])}else{var C=b(s.func,s.args);_.GlobalVars.callbacks[C]=function(){for(var n=[],m=0;m<arguments.length;m++)n[m]=arguments[m];_.GlobalVars.childWindow&&p(s.id,n)}}}}(n))}},s.handleParentMessage=u,s.processAdditionalValidOrigins=function(n){var s=_.GlobalVars.additionalValidOrigins.concat(n.filter((function(n){return"string"==typeof n&&C.userOriginUrlValidationRegExp.test(n)}))),m={};s=s.filter((function(n){
return!m[n]&&(m[n]=!0,!0)})),_.GlobalVars.additionalValidOrigins=s,_.GlobalVars.additionalValidOrigins.length>0?_.GlobalVars.additionalValidOriginsRegexp=E.generateRegExpFromUrls(_.GlobalVars.additionalValidOrigins):_.GlobalVars.additionalValidOriginsRegexp=null},s.waitForMessageQueue=function(n,s){var m=_.GlobalVars.currentWindow.setInterval((function(){0===d(n).length&&(clearInterval(m),s())}),100)},s.sendMessageRequestToParent=b,s.sendMessageEventToChild=h},function(n,s,m){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var y=m(3);s.version="1.6.0",
s.validOrigins=["https://teams.microsoft.com","https://teams.microsoft.us","https://gov.teams.microsoft.us","https://dod.teams.microsoft.us","https://int.teams.microsoft.com","https://devspaces.skype.com","https://ssauth.skype.com","https://local.teams.office.com","https://local.teams.office.com:8080","https://msft.spoppe.com","https://*.sharepoint.com","https://*.sharepoint-df.com","https://*.sharepointonline.com","https://outlook.office.com","https://outlook-sdf.office.com","https://*.teams.microsoft.com"],s.frameContexts={settings:"settings",content:"content",authentication:"authentication",remove:"remove",task:"task"},s.validOriginRegExp=y.generateRegExpFromUrls(s.validOrigins),s.userOriginUrlValidationRegExp=/^https\:\/\//},function(n,s,m){"use strict";function a(n){for(var s="^",m=n.split("."),y=0;y<m.length;y++)s+=(y>0?"[.]":"")+m[y].replace("*","[^/^.]+");return s+"$"}Object.defineProperty(s,"__esModule",{value:!0}),s.generateRegExpFromUrls=function(n){
for(var s="",m=0;m<n.length;m++)s+=(0===m?"":"|")+a(n[m]);return new RegExp(s)},s.getGenericOnCompleteHandler=function(n){return function(s,m){if(!s)throw new Error(n||m)}}},function(n,s,m){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var y=m(1),C=m(0),_=m(2),E=m(5),w=m(3),S=m(6);function u(n,s){if(!C.GlobalVars.initializeCalled){C.GlobalVars.initializeCalled=!0;var t=function(n){return y.processMessage(n)};C.GlobalVars.currentWindow=C.GlobalVars.currentWindow||window,C.GlobalVars.parentWindow=C.GlobalVars.currentWindow.parent!==C.GlobalVars.currentWindow.self?C.GlobalVars.currentWindow.parent:C.GlobalVars.currentWindow.opener,C.GlobalVars.parentWindow?C.GlobalVars.currentWindow.addEventListener("message",t,!1):(C.GlobalVars.isFramelessWindow=!0,window.onNativeMessage=y.handleParentMessage);try{C.GlobalVars.parentOrigin="*";var m=y.sendMessageRequestToParent("initialize",[_.version]);C.GlobalVars.callbacks[m]=function(n,s){C.GlobalVars.frameContext=n,
C.GlobalVars.hostClientType=s,C.GlobalVars.initializeCallbacks.forEach((function(n){return n()})),C.GlobalVars.initializeCallbacks=[],C.GlobalVars.initializeCompleted=!0}}finally{C.GlobalVars.parentOrigin=null}this._uninitialize=function(){C.GlobalVars.frameContext&&(d(null),f(null),g(null),p(null),b(null),S.logs.registerGetLogHandler(null)),C.GlobalVars.frameContext===_.frameContexts.settings&&E.settings.registerOnSaveHandler(null),C.GlobalVars.frameContext===_.frameContexts.remove&&E.settings.registerOnRemoveHandler(null),C.GlobalVars.isFramelessWindow||C.GlobalVars.currentWindow.removeEventListener("message",t,!1),C.GlobalVars.initializeCalled=!1,C.GlobalVars.initializeCompleted=!1,C.GlobalVars.initializeCallbacks=[],C.GlobalVars.additionalValidOrigins=[],C.GlobalVars.parentWindow=null,C.GlobalVars.parentOrigin=null,C.GlobalVars.parentMessageQueue=[],C.GlobalVars.childWindow=null,C.GlobalVars.childOrigin=null,C.GlobalVars.childMessageQueue=[],C.GlobalVars.nextMessageId=0,
C.GlobalVars.callbacks={},C.GlobalVars.frameContext=null,C.GlobalVars.hostClientType=null,C.GlobalVars.isFramelessWindow=!1}}Array.isArray(s)&&y.processAdditionalValidOrigins(s),n&&(C.GlobalVars.initializeCompleted?n():C.GlobalVars.initializeCallbacks.push(n))}function c(){window.print()}function d(n){y.ensureInitialized(),C.GlobalVars.themeChangeHandler=n,n&&y.sendMessageRequestToParent("registerHandler",["themeChange"])}function f(n){y.ensureInitialized(),C.GlobalVars.fullScreenChangeHandler=n,n&&y.sendMessageRequestToParent("registerHandler",["fullScreen"])}function g(n){y.ensureInitialized(),C.GlobalVars.backButtonPressHandler=n,n&&y.sendMessageRequestToParent("registerHandler",["backButton"])}function b(n){y.ensureInitialized(),C.GlobalVars.loadHandler=n,n&&y.sendMessageRequestToParent("registerHandler",["load"])}function p(n){y.ensureInitialized(),C.GlobalVars.beforeUnloadHandler=n,n&&y.sendMessageRequestToParent("registerHandler",["beforeUnload"])}function h(n){
y.ensureInitialized(_.frameContexts.content),y.sendMessageRequestToParent("setFrameContext",[n])}s.initialize=u,s._initialize=function(n){C.GlobalVars.currentWindow=n},s._uninitialize=function(){},s.enablePrintCapability=function(){C.GlobalVars.printCapabilityEnabled||(C.GlobalVars.printCapabilityEnabled=!0,y.ensureInitialized(),document.addEventListener("keydown",(function(n){(n.ctrlKey||n.metaKey)&&80===n.keyCode&&(c(),n.cancelBubble=!0,n.preventDefault(),n.stopImmediatePropagation())})))},s.print=c,s.getContext=function(n){y.ensureInitialized();var s=y.sendMessageRequestToParent("getContext");C.GlobalVars.callbacks[s]=n},s.registerOnThemeChangeHandler=d,s.registerFullScreenHandler=f,s.registerBackButtonHandler=g,s.navigateBack=function(n){y.ensureInitialized();var s=y.sendMessageRequestToParent("navigateBack",[]);C.GlobalVars.callbacks[s]=n||w.getGenericOnCompleteHandler("Back navigation is not supported in the current client or context.")},s.registerOnLoadHandler=b,
s.registerBeforeUnloadHandler=p,s.registerChangeSettingsHandler=function(n){y.ensureInitialized(_.frameContexts.content),C.GlobalVars.changeSettingsHandler=n,n&&y.sendMessageRequestToParent("registerHandler",["changeSettings"])},s.navigateCrossDomain=function(n,s){y.ensureInitialized(_.frameContexts.content,_.frameContexts.settings,_.frameContexts.remove,_.frameContexts.task);var m=y.sendMessageRequestToParent("navigateCrossDomain",[n]);C.GlobalVars.callbacks[m]=s||w.getGenericOnCompleteHandler("Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.")},s.getTabInstances=function(n,s){y.ensureInitialized();var m=y.sendMessageRequestToParent("getTabInstances",[s]);C.GlobalVars.callbacks[m]=n},s.getMruTabInstances=function(n,s){y.ensureInitialized();var m=y.sendMessageRequestToParent("getMruTabInstances",[s]);C.GlobalVars.callbacks[m]=n},s.shareDeepLink=function(n){y.ensureInitialized(_.frameContexts.content),
y.sendMessageRequestToParent("shareDeepLink",[n.subEntityId,n.subEntityLabel,n.subEntityWebUrl])},s.executeDeepLink=function(n,s){y.ensureInitialized(_.frameContexts.content,_.frameContexts.task);var m=y.sendMessageRequestToParent("executeDeepLink",[n]);C.GlobalVars.callbacks[m]=s||w.getGenericOnCompleteHandler()},s.navigateToTab=function(n,s){y.ensureInitialized();var m=y.sendMessageRequestToParent("navigateToTab",[n]);C.GlobalVars.callbacks[m]=s||w.getGenericOnCompleteHandler("Invalid internalTabInstanceId and/or channelId were/was provided")},s.setFrameContext=h,s.initializeWithFrameContext=function(n,s,m){u(s,m),h(n)}},function(n,s,m){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var y=m(1),C=m(0),_=m(2),E=m(3);!function(n){var s,m;C.GlobalVars.handlers["settings.save"]=function(n){var m=new w(n);s?s(m):m.notifySuccess()},C.GlobalVars.handlers["settings.remove"]=function(){var n=new S;m?m(n):n.notifySuccess()},n.setValidityState=function(n){
y.ensureInitialized(_.frameContexts.settings,_.frameContexts.remove),y.sendMessageRequestToParent("settings.setValidityState",[n])},n.getSettings=function(n){y.ensureInitialized(_.frameContexts.content,_.frameContexts.settings,_.frameContexts.remove);var s=y.sendMessageRequestToParent("settings.getSettings");C.GlobalVars.callbacks[s]=n},n.setSettings=function(n,s){y.ensureInitialized(_.frameContexts.content,_.frameContexts.settings);var m=y.sendMessageRequestToParent("settings.setSettings",[n]);C.GlobalVars.callbacks[m]=s||E.getGenericOnCompleteHandler()},n.registerOnSaveHandler=function(n){y.ensureInitialized(_.frameContexts.settings),s=n,n&&y.sendMessageRequestToParent("registerHandler",["save"])},n.registerOnRemoveHandler=function(n){y.ensureInitialized(_.frameContexts.remove),m=n,n&&y.sendMessageRequestToParent("registerHandler",["remove"])};var w=function(){function e(n){this.notified=!1,this.result=n||{}}return e.prototype.notifySuccess=function(){this.ensureNotNotified(),
y.sendMessageRequestToParent("settings.save.success"),this.notified=!0},e.prototype.notifyFailure=function(n){this.ensureNotNotified(),y.sendMessageRequestToParent("settings.save.failure",[n]),this.notified=!0},e.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The SaveEvent may only notify success or failure once.")},e}(),S=function(){function e(){this.notified=!1}return e.prototype.notifySuccess=function(){this.ensureNotNotified(),y.sendMessageRequestToParent("settings.remove.success"),this.notified=!0},e.prototype.notifyFailure=function(n){this.ensureNotNotified(),y.sendMessageRequestToParent("settings.remove.failure",[n]),this.notified=!0},e.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The removeEvent may only notify success or failure once.")},e}()}(s.settings||(s.settings={}))},function(n,s,m){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var y=m(1),C=m(0);!function(n){
C.GlobalVars.handlers["log.request"]=function(){if(C.GlobalVars.getLogHandler){var n=C.GlobalVars.getLogHandler();y.sendMessageRequestToParent("log.receive",[n])}},n.registerGetLogHandler=function(n){y.ensureInitialized(),C.GlobalVars.getLogHandler=n,n&&y.sendMessageRequestToParent("registerHandler",["log.request"])}}(s.logs||(s.logs={}))},function(n,s,m){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var y=m(1),C=m(0),_=m(2),E=m(3),w=function(){function e(){}return e.prototype.postMessage=function(n,s){y.ensureInitialized();var m=y.sendMessageRequestToParent("messageForChild",[n]);C.GlobalVars.callbacks[m]=s||E.getGenericOnCompleteHandler()},e.prototype.addEventListener=function(n,s){"message"===n&&(C.GlobalVars.handlers.messageForParent=s)},e}();s.ChildAppWindow=w;var S=function(){function e(){}return Object.defineProperty(e,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),
e.prototype.postMessage=function(n,s){y.ensureInitialized(_.frameContexts.task);var m=y.sendMessageRequestToParent("messageForParent",[n]);C.GlobalVars.callbacks[m]=s||E.getGenericOnCompleteHandler()},e.prototype.addEventListener=function(n,s){"message"===n&&(C.GlobalVars.handlers.messageForChild=s)},e}();s.ParentAppWindow=S},function(n,s,m){"use strict";function a(n){for(var m in n)s.hasOwnProperty(m)||(s[m]=n[m])}Object.defineProperty(s,"__esModule",{value:!0}),a(m(9)),a(m(14))},function(n,s,m){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var y=m(10);s.bot=y.bot;var C=m(11);s.menus=C.menus;var _=m(6);s.logs=_.logs;var E=m(12);s.enterFullscreen=E.enterFullscreen,s.exitFullscreen=E.exitFullscreen,s.getChatMembers=E.getChatMembers,s.getConfigSetting=E.getConfigSetting,s.getUserJoinedTeams=E.getUserJoinedTeams,s.openFilePreview=E.openFilePreview,s.sendCustomMessage=E.sendCustomMessage,s.showNotification=E.showNotification,s.sendCustomEvent=E.sendCustomEvent,
s.registerCustomHandler=E.registerCustomHandler,s.uploadCustomApp=E.uploadCustomApp;var w=m(13);s.conversations=w.conversations},function(n,s,m){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var y=m(0),C=m(1);!function(n){n.sendQuery=function(n,s,m){C.ensureInitialized();var _=C.sendMessageRequestToParent("bot.executeQuery",[n]);y.GlobalVars.callbacks[_]=function(n,y){n?s(y):m(y)}},n.getSupportedCommands=function(n,s){C.ensureInitialized();var m=C.sendMessageRequestToParent("bot.getSupportedCommands");y.GlobalVars.callbacks[m]=function(m,y){m?n(y):s(y)}},n.authenticate=function(n,s,m){C.ensureInitialized();var _=C.sendMessageRequestToParent("bot.authenticate",[n]);y.GlobalVars.callbacks[_]=function(n,y){n?s(y):m(y)}},function(n){n.Results="Results",n.Auth="Auth"}(n.ResponseType||(n.ResponseType={}))}(s.bot||(s.bot={}))},function(n,s,m){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var y=m(1),C=m(0);!function(n){var s,m,_,i=function(){this.enabled=!0}
;n.MenuItem=i,function(n){n.dropDown="dropDown",n.popOver="popOver"}(n.MenuListType||(n.MenuListType={})),C.GlobalVars.handlers.navBarMenuItemPress=function(n){s&&s(n)||(y.ensureInitialized(),y.sendMessageRequestToParent("handleNavBarMenuItemPress",[n]))},C.GlobalVars.handlers.actionMenuItemPress=function(n){m&&m(n)||(y.ensureInitialized(),y.sendMessageRequestToParent("handleActionMenuItemPress",[n]))},C.GlobalVars.handlers.setModuleView=function(n){_&&_(n)||(y.ensureInitialized(),y.sendMessageRequestToParent("viewConfigItemPress",[n]))},n.setUpViews=function(n,s){y.ensureInitialized(),_=s,y.sendMessageRequestToParent("setUpViews",[n])},n.setNavBarMenu=function(n,m){y.ensureInitialized(),s=m,y.sendMessageRequestToParent("setNavBarMenu",[n])},n.showActionMenu=function(n,s){y.ensureInitialized(),m=s,y.sendMessageRequestToParent("showActionMenu",[n])}}(s.menus||(s.menus={}))},function(n,s,m){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var y=m(1),C=m(0),_=m(2),E=m(3)
;s.getUserJoinedTeams=function(n,s){y.ensureInitialized();var m=y.sendMessageRequestToParent("getUserJoinedTeams",[s]);C.GlobalVars.callbacks[m]=n},s.enterFullscreen=function(){y.ensureInitialized(_.frameContexts.content),y.sendMessageRequestToParent("enterFullscreen",[])},s.exitFullscreen=function(){y.ensureInitialized(_.frameContexts.content),y.sendMessageRequestToParent("exitFullscreen",[])},s.openFilePreview=function(n){y.ensureInitialized(_.frameContexts.content);var s=[n.entityId,n.title,n.description,n.type,n.objectUrl,n.downloadUrl,n.webPreviewUrl,n.webEditUrl,n.baseUrl,n.editFile,n.subEntityId];y.sendMessageRequestToParent("openFilePreview",s)},s.showNotification=function(n){y.ensureInitialized(_.frameContexts.content);var s=[n.message,n.notificationType];y.sendMessageRequestToParent("showNotification",s)},s.uploadCustomApp=function(n,s){y.ensureInitialized();var m=y.sendMessageRequestToParent("uploadCustomApp",[n]);C.GlobalVars.callbacks[m]=s||E.getGenericOnCompleteHandler()
},s.sendCustomMessage=function(n,s,m){y.ensureInitialized();var _=y.sendMessageRequestToParent(n,s);return"function"==typeof m&&(C.GlobalVars.callbacks[_]=function(){for(var n=[],s=0;s<arguments.length;s++)n[s]=arguments[s];m.apply(null,n)}),_},s.sendCustomEvent=function(n,s){if(y.ensureInitialized(),!C.GlobalVars.childWindow)throw new Error("The child window has not yet been initialized or is not present");y.sendMessageEventToChild(n,s)},s.registerCustomHandler=function(n,s){var m=this;y.ensureInitialized(),C.GlobalVars.handlers[n]=function(){for(var n=[],y=0;y<arguments.length;y++)n[y]=arguments[y];return s.apply(m,n)}},s.getChatMembers=function(n){y.ensureInitialized();var s=y.sendMessageRequestToParent("getChatMembers");C.GlobalVars.callbacks[s]=n},s.getConfigSetting=function(n,s){y.ensureInitialized();var m=y.sendMessageRequestToParent("getConfigSetting",[s]);C.GlobalVars.callbacks[m]=n}},function(n,s,m){"use strict";Object.defineProperty(s,"__esModule",{value:!0})
;var y=m(1),C=m(0),_=m(2);!function(n){n.openConversation=function(n){y.ensureInitialized(_.frameContexts.content);var s=y.sendMessageRequestToParent("conversations.openConversation",[{title:n.title,subEntityId:n.subEntityId,conversationId:n.conversationId,channelId:n.channelId,entityId:n.entityId}]);C.GlobalVars.onCloseConversationHandler=n.onCloseConversation,C.GlobalVars.onStartConversationHandler=n.onStartConversation,C.GlobalVars.callbacks[s]=function(n,s){if(!n)throw new Error(s)}},n.closeConversation=function(){y.ensureInitialized(_.frameContexts.content),y.sendMessageRequestToParent("conversations.closeConversation"),C.GlobalVars.onCloseConversationHandler=null,C.GlobalVars.onStartConversationHandler=null}}(s.conversations||(s.conversations={}))},function(n,s,m){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var y=m(15);s.appInitialization=y.appInitialization;var C=m(16);s.authentication=C.authentication;var _=m(4);s.enablePrintCapability=_.enablePrintCapability,
s.executeDeepLink=_.executeDeepLink,s.getContext=_.getContext,s.getMruTabInstances=_.getMruTabInstances,s.getTabInstances=_.getTabInstances,s.initialize=_.initialize,s.initializeWithFrameContext=_.initializeWithFrameContext,s.navigateBack=_.navigateBack,s.navigateCrossDomain=_.navigateCrossDomain,s.navigateToTab=_.navigateToTab,s.print=_.print,s.registerBackButtonHandler=_.registerBackButtonHandler,s.registerBeforeUnloadHandler=_.registerBeforeUnloadHandler,s.registerChangeSettingsHandler=_.registerChangeSettingsHandler,s.registerFullScreenHandler=_.registerFullScreenHandler,s.registerOnLoadHandler=_.registerOnLoadHandler,s.registerOnThemeChangeHandler=_.registerOnThemeChangeHandler,s.setFrameContext=_.setFrameContext,s.shareDeepLink=_.shareDeepLink;var E=m(5);s.settings=E.settings;var w=m(17);s.tasks=w.tasks;var S=m(7);s.ChildAppWindow=S.ChildAppWindow,s.ParentAppWindow=S.ParentAppWindow},function(n,s,m){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var y=m(1),C=m(2)
;!function(n){n.notifyAppLoaded=function(){y.ensureInitialized(),y.sendMessageRequestToParent("appInitialization.appLoaded",[C.version])},n.notifySuccess=function(){y.ensureInitialized(),y.sendMessageRequestToParent("appInitialization.success",[C.version])},n.notifyFailure=function(n){y.ensureInitialized(),y.sendMessageRequestToParent("appInitialization.failure",[n.reason,n.message])}}(s.appInitialization||(s.appInitialization={}))},function(n,s,m){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var y=m(1),C=m(0),_=m(2);!function(n){var s,m;function i(){l();try{C.GlobalVars.childWindow&&C.GlobalVars.childWindow.close()}finally{C.GlobalVars.childWindow=null,C.GlobalVars.childOrigin=null}}function o(n){s=n,i();var m=s.width||600,y=s.height||400;m=Math.min(m,C.GlobalVars.currentWindow.outerWidth-400),y=Math.min(y,C.GlobalVars.currentWindow.outerHeight-200);var _=document.createElement("a");_.href=s.url
;var E=void 0!==C.GlobalVars.currentWindow.screenLeft?C.GlobalVars.currentWindow.screenLeft:C.GlobalVars.currentWindow.screenX,w=void 0!==C.GlobalVars.currentWindow.screenTop?C.GlobalVars.currentWindow.screenTop:C.GlobalVars.currentWindow.screenY;E+=C.GlobalVars.currentWindow.outerWidth/2-m/2,w+=C.GlobalVars.currentWindow.outerHeight/2-y/2,C.GlobalVars.childWindow=C.GlobalVars.currentWindow.open(_.href,"_blank","toolbar=no, location=yes, status=no, menubar=no, scrollbars=yes, top="+w+", left="+E+", width="+m+", height="+y),C.GlobalVars.childWindow?u():c("FailedToOpenWindow")}function l(){m&&(clearInterval(m),m=0),delete C.GlobalVars.handlers.initialize,delete C.GlobalVars.handlers.navigateCrossDomain}function u(){l(),m=C.GlobalVars.currentWindow.setInterval((function(){if(!C.GlobalVars.childWindow||C.GlobalVars.childWindow.closed)c("CancelledByUser");else{var n=C.GlobalVars.childOrigin;try{C.GlobalVars.childOrigin="*",y.sendMessageEventToChild("ping")}finally{C.GlobalVars.childOrigin=n
}}}),100),C.GlobalVars.handlers.initialize=function(){return[_.frameContexts.authentication,C.GlobalVars.hostClientType]},C.GlobalVars.handlers.navigateCrossDomain=function(){return!1}}function c(n){try{s&&s.failureCallback&&s.failureCallback(n)}finally{s=null,i()}}function d(n,s,m){if(n){var y=document.createElement("a");y.href=decodeURIComponent(n),y.host&&y.host!==window.location.host&&"outlook.office.com"===y.host&&y.search.indexOf("client_type=Win32_Outlook")>-1&&(s&&"result"===s&&(m&&(y.href=f(y.href,"result",m)),C.GlobalVars.currentWindow.location.assign(f(y.href,"authSuccess",""))),s&&"reason"===s&&(m&&(y.href=f(y.href,"reason",m)),C.GlobalVars.currentWindow.location.assign(f(y.href,"authFailure",""))))}}function f(n,s,m){var y=n.indexOf("#"),C=-1===y?"#":n.substr(y);return C=C+"&"+s+(""!==m?"="+m:""),(n=-1===y?n:n.substr(0,y))+C}C.GlobalVars.handlers["authentication.authenticate.success"]=function(n){try{s&&s.successCallback&&s.successCallback(n)}finally{s=null,i()}},
C.GlobalVars.handlers["authentication.authenticate.failure"]=c,n.registerAuthenticationHandlers=function(n){s=n},n.authenticate=function(n){var m=void 0!==n?n:s;if(y.ensureInitialized(_.frameContexts.content,_.frameContexts.settings,_.frameContexts.remove,_.frameContexts.task),"desktop"===C.GlobalVars.hostClientType||"android"===C.GlobalVars.hostClientType||"ios"===C.GlobalVars.hostClientType||"rigel"===C.GlobalVars.hostClientType){var E=document.createElement("a");E.href=m.url;var w=y.sendMessageRequestToParent("authentication.authenticate",[E.href,m.width,m.height]);C.GlobalVars.callbacks[w]=function(n,s){n?m.successCallback(s):m.failureCallback(s)}}else o(m)},n.getAuthToken=function(n){y.ensureInitialized();var s=y.sendMessageRequestToParent("authentication.getAuthToken",[n.resources]);C.GlobalVars.callbacks[s]=function(s,m){s?n.successCallback(m):n.failureCallback(m)}},n.getUser=function(n){y.ensureInitialized();var s=y.sendMessageRequestToParent("authentication.getUser")
;C.GlobalVars.callbacks[s]=function(s,m){s?n.successCallback(m):n.failureCallback(m)}},n.notifySuccess=function(n,s){d(s,"result",n),y.ensureInitialized(_.frameContexts.authentication),y.sendMessageRequestToParent("authentication.authenticate.success",[n]),y.waitForMessageQueue(C.GlobalVars.parentWindow,(function(){return setTimeout((function(){return C.GlobalVars.currentWindow.close()}),200)}))},n.notifyFailure=function(n,s){d(s,"reason",n),y.ensureInitialized(_.frameContexts.authentication),y.sendMessageRequestToParent("authentication.authenticate.failure",[n]),y.waitForMessageQueue(C.GlobalVars.parentWindow,(function(){return setTimeout((function(){return C.GlobalVars.currentWindow.close()}),200)}))}}(s.authentication||(s.authentication={}))},function(n,s,m){"use strict";var y=this&&this.__rest||function(n,s){var m={};for(var y in n)Object.prototype.hasOwnProperty.call(n,y)&&s.indexOf(y)<0&&(m[y]=n[y]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var C=0
;for(y=Object.getOwnPropertySymbols(n);C<y.length;C++)s.indexOf(y[C])<0&&(m[y[C]]=n[y[C]])}return m};Object.defineProperty(s,"__esModule",{value:!0});var C=m(1),_=m(0),E=m(2),w=m(7);!function(n){n.startTask=function(n,s){C.ensureInitialized(E.frameContexts.content);var m=C.sendMessageRequestToParent("tasks.startTask",[n]);return _.GlobalVars.callbacks[m]=s,new w.ChildAppWindow},n.updateTask=function(n){C.ensureInitialized(E.frameContexts.content,E.frameContexts.task),n.width,n.height;var s=y(n,["width","height"]);if(Object.keys(s).length)throw new Error("updateTask requires a taskInfo argument containing only width and height");C.sendMessageRequestToParent("tasks.updateTask",[n])},n.submitTask=function(n,s){C.ensureInitialized(E.frameContexts.content,E.frameContexts.task),C.sendMessageRequestToParent("tasks.completeTask",[n,Array.isArray(s)?s:[s]])}}(s.tasks||(s.tasks={}))}])},99:function(n,s){var m;m=function(){return this}();try{m=m||new Function("return this")()}catch(n){
"object"==typeof window&&(m=window)}n.exports=m}})}));