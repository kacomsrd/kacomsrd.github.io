/*! For license information please see authEnd.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.FindMsg=t():e.FindMsg=t()}(self,(function(){return(()=>{var e={80869:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AccountEntity:()=>V.r,ApiId:()=>f,AuthError:()=>k.l,AuthErrorMessage:()=>k.Y,AuthenticationHeaderParser:()=>Ye.d,AuthenticationScheme:()=>v.hO,BrowserAuthError:()=>N,BrowserAuthErrorMessage:()=>O,BrowserCacheLocation:()=>l,BrowserConfigurationAuthError:()=>oe,BrowserConfigurationAuthErrorMessage:()=>re,BrowserUtils:()=>ge,ClientAuthError:()=>ae.e,ClientAuthErrorMessage:()=>ae.A,ClientConfigurationError:()=>be.r,ClientConfigurationErrorMessage:()=>be.L,EventMessageUtils:()=>Ke,EventType:()=>w,InteractionRequiredAuthError:()=>z.Yo,InteractionRequiredAuthErrorMessage:()=>z.Zy,InteractionStatus:()=>m,InteractionType:()=>g,LogLevel:()=>B.i,Logger:()=>B.Y,NavigationClient:()=>me,ProtocolMode:()=>le.A,PublicClientApplication:()=>ze,ServerError:()=>j.n,SignedHttpRequest:()=>Je,StringUtils:()=>P.x,UrlString:()=>se.G,WrapperSKU:()=>C,stubbedPublicClientApplication:()=>Ve,version:()=>ye});var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)};function o(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=function(){return i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)};function a(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))}function s(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function c(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function u(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(c(arguments[t]));return e}var l,d,p,h,f,g,m,v=n(77891),y="msal.js.browser";!function(e){e.LocalStorage="localStorage",e.SessionStorage="sessionStorage",e.MemoryStorage="memoryStorage"}(l||(l={})),function(e){e.GET="GET",e.POST="POST"}(d||(d={})),function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",e.SESSION_STATE="session.state",e.REQUEST_STATE="request.state",e.NONCE_IDTOKEN="nonce.id_token",e.ORIGIN_URI="request.origin",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.REQUEST_PARAMS="request.params",e.SCOPES="scopes",e.INTERACTION_STATUS_KEY="interaction.status",e.CCS_CREDENTIAL="ccs.credential",e.CORRELATION_ID="request.correlationId"}(p||(p={})),function(e){e.WRAPPER_SKU="wrapper.sku",e.WRAPPER_VER="wrapper.version"}(h||(h={})),function(e){e[e.acquireTokenRedirect=861]="acquireTokenRedirect",e[e.acquireTokenPopup=862]="acquireTokenPopup",e[e.ssoSilent=863]="ssoSilent",e[e.acquireTokenSilent_authCode=864]="acquireTokenSilent_authCode",e[e.handleRedirectPromise=865]="handleRedirectPromise",e[e.acquireTokenByCode=866]="acquireTokenByCode",e[e.acquireTokenSilent_silentFlow=61]="acquireTokenSilent_silentFlow",e[e.logout=961]="logout",e[e.logoutPopup=962]="logoutPopup"}(f||(f={})),function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent"}(g||(g={})),function(e){e.Startup="startup",e.Login="login",e.Logout="logout",e.AcquireToken="acquireToken",e.SsoSilent="ssoSilent",e.HandleRedirect="handleRedirect",e.None="none"}(m||(m={}));var C,E={scopes:v.f_},T="jwk";!function(e){e.React="@azure/msal-react",e.Angular="@azure/msal-angular"}(C||(C={}));var w,b="msal.db",S=function(){function e(){}return e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e}(),I=function(){function e(e){this.cryptoObj=e}return e.prototype.generateGuid=function(){try{var e=new Uint8Array(16);return this.cryptoObj.getRandomValues(e),e[6]|=64,e[6]&=79,e[8]|=128,e[8]&=191,S.decimalToHex(e[0])+S.decimalToHex(e[1])+S.decimalToHex(e[2])+S.decimalToHex(e[3])+"-"+S.decimalToHex(e[4])+S.decimalToHex(e[5])+"-"+S.decimalToHex(e[6])+S.decimalToHex(e[7])+"-"+S.decimalToHex(e[8])+S.decimalToHex(e[9])+"-"+S.decimalToHex(e[10])+S.decimalToHex(e[11])+S.decimalToHex(e[12])+S.decimalToHex(e[13])+S.decimalToHex(e[14])+S.decimalToHex(e[15])}catch(e){for(var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",n="0123456789abcdef",r=0,o="",i=0;i<36;i++)"-"!==t[i]&&"4"!==t[i]&&(r=16*Math.random()|0),"x"===t[i]?o+=n[r]:"y"===t[i]?(r&=3,o+=n[r|=8]):o+=t[i];return o}},e.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e}(),A=function(){function e(){}return e.stringToUtf8Arr=function(e){for(var t,n=0,r=e.length,o=0;o<r;o++)n+=(t=e.charCodeAt(o))<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6;for(var i=new Uint8Array(n),a=0,s=0;a<n;s++)(t=e.charCodeAt(s))<128?i[a++]=t:t<2048?(i[a++]=192+(t>>>6),i[a++]=128+(63&t)):t<65536?(i[a++]=224+(t>>>12),i[a++]=128+(t>>>6&63),i[a++]=128+(63&t)):t<2097152?(i[a++]=240+(t>>>18),i[a++]=128+(t>>>12&63),i[a++]=128+(t>>>6&63),i[a++]=128+(63&t)):t<67108864?(i[a++]=248+(t>>>24),i[a++]=128+(t>>>18&63),i[a++]=128+(t>>>12&63),i[a++]=128+(t>>>6&63),i[a++]=128+(63&t)):(i[a++]=252+(t>>>30),i[a++]=128+(t>>>24&63),i[a++]=128+(t>>>18&63),i[a++]=128+(t>>>12&63),i[a++]=128+(t>>>6&63),i[a++]=128+(63&t));return i},e.stringToArrayBuffer=function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return t},e.utf8ArrToString=function(e){for(var t="",n=void 0,r=e.length,o=0;o<r;o++)n=e[o],t+=String.fromCharCode(n>251&&n<254&&o+5<r?1073741824*(n-252)+(e[++o]-128<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:n>247&&n<252&&o+4<r?(n-248<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:n>239&&n<248&&o+3<r?(n-240<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:n>223&&n<240&&o+2<r?(n-224<<12)+(e[++o]-128<<6)+e[++o]-128:n>191&&n<224&&o+1<r?(n-192<<6)+e[++o]-128:n);return t},e}(),_=function(){function e(){}return e.prototype.urlEncode=function(e){return encodeURIComponent(this.encode(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))},e.prototype.urlEncodeArr=function(e){return this.base64EncArr(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},e.prototype.encode=function(e){var t=A.stringToUtf8Arr(e);return this.base64EncArr(t)},e.prototype.base64EncArr=function(e){for(var t=(3-e.length%3)%3,n="",r=void 0,o=e.length,i=0,a=0;a<o;a++)r=a%3,i|=e[a]<<(16>>>r&24),2!==r&&e.length-a!=1||(n+=String.fromCharCode(this.uint6ToB64(i>>>18&63),this.uint6ToB64(i>>>12&63),this.uint6ToB64(i>>>6&63),this.uint6ToB64(63&i)),i=0);return 0===t?n:n.substring(0,n.length-t)+(1===t?"=":"==")},e.prototype.uint6ToB64=function(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65},e}(),R=function(){function e(){}return e.prototype.decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}var n=this.base64DecToArr(t);return A.utf8ArrToString(n)},e.prototype.base64DecToArr=function(e,t){for(var n=e.replace(/[^A-Za-z0-9\+\/]/g,""),r=n.length,o=t?Math.ceil((3*r+1>>>2)/t)*t:3*r+1>>>2,i=new Uint8Array(o),a=void 0,s=void 0,c=0,u=0,l=0;l<r;l++)if(s=3&l,c|=this.b64ToUint6(n.charCodeAt(l))<<18-6*s,3===s||r-l==1){for(a=0;a<3&&u<o;a++,u++)i[u]=c>>>(16>>>a&24)&255;c=0}return i},e.prototype.b64ToUint6=function(e){return e>64&&e<91?e-65:e>96&&e<123?e-71:e>47&&e<58?e+4:43===e?62:47===e?63:0},e}(),P=n(61653),k=n(87342),O={pkceNotGenerated:{code:"pkce_not_created",desc:"The PKCE code challenge and verifier could not be generated."},cryptoDoesNotExist:{code:"crypto_nonexistent",desc:"The crypto object or function is not available."},httpMethodNotImplementedError:{code:"http_method_not_implemented",desc:"The HTTP method given has not been implemented in this library."},emptyNavigateUriError:{code:"empty_navigate_uri",desc:"Navigation URI is empty. Please check stack trace for more info."},hashEmptyError:{code:"hash_empty_error",desc:"Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash."},hashDoesNotContainStateError:{code:"no_state_in_hash",desc:"Hash does not contain state. Please verify that the request originated from msal."},hashDoesNotContainKnownPropertiesError:{code:"hash_does_not_contain_known_properties",desc:"Hash does not contain known properites. Please verify that your redirectUri is not changing the hash."},unableToParseStateError:{code:"unable_to_parse_state",desc:"Unable to parse state. Please verify that the request originated from msal."},stateInteractionTypeMismatchError:{code:"state_interaction_type_mismatch",desc:"Hash contains state but the interaction type does not match the caller."},interactionInProgress:{code:"interaction_in_progress",desc:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.  For more visit: aka.ms/msaljs/browser-errors."},popupWindowError:{code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},emptyWindowError:{code:"empty_window_error",desc:"window.open returned null or undefined window object."},userCancelledError:{code:"user_cancelled",desc:"User cancelled the flow."},monitorPopupTimeoutError:{code:"monitor_window_timeout",desc:"Token acquisition in popup failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},monitorIframeTimeoutError:{code:"monitor_window_timeout",desc:"Token acquisition in iframe failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},redirectInIframeError:{code:"redirect_in_iframe",desc:"Code flow is not supported inside an iframe. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs."},blockTokenRequestsInHiddenIframeError:{code:"block_iframe_reload",desc:"Request was blocked inside an iframe because MSAL detected an authentication response. For more visit: aka.ms/msaljs/browser-errors"},blockAcquireTokenInPopupsError:{code:"block_nested_popups",desc:"Request was blocked inside a popup because MSAL detected it was running in a popup."},iframeClosedPrematurelyError:{code:"iframe_closed_prematurely",desc:"The iframe being monitored was closed prematurely."},silentLogoutUnsupportedError:{code:"silent_logout_unsupported",desc:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead."},noAccountError:{code:"no_account_error",desc:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request."},silentPromptValueError:{code:"silent_prompt_value_error",desc:"The value given for the prompt value is not valid for silent requests - must be set to 'none'."},noTokenRequestCacheError:{code:"no_token_request_cache_error",desc:"No token request found in cache."},unableToParseTokenRequestCacheError:{code:"unable_to_parse_token_request_cache_error",desc:"The cached token request could not be parsed."},noCachedAuthorityError:{code:"no_cached_authority_error",desc:"No cached authority found."},authRequestNotSet:{code:"auth_request_not_set_error",desc:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler"},invalidCacheType:{code:"invalid_cache_type",desc:"Invalid cache type"},notInBrowserEnvironment:{code:"non_browser_environment",desc:"Login and token requests are not supported in non-browser environments."},databaseNotOpen:{code:"database_not_open",desc:"Database is not open!"},noNetworkConnectivity:{code:"no_network_connectivity",desc:"No network connectivity. Check your internet connection."},postRequestFailed:{code:"post_request_failed",desc:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'"},getRequestFailed:{code:"get_request_failed",desc:"Network request failed. Please check the network trace to determine root cause."},failedToParseNetworkResponse:{code:"failed_to_parse_response",desc:"Failed to parse network response. Check network trace."},unableToLoadTokenError:{code:"unable_to_load_token",desc:"Error loading token to cache."},signingKeyNotFoundInStorage:{code:"crypto_key_not_found",desc:"Cryptographic Key or Keypair not found in browser storage."},authCodeRequired:{code:"auth_code_required",desc:"An authorization code must be provided (as the `code` property on the request) to this flow."},databaseUnavailable:{code:"database_unavailable",desc:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts."}},N=function(e){function t(n,r){var o=e.call(this,n,r)||this;return Object.setPrototypeOf(o,t.prototype),o.name="BrowserAuthError",o}return o(t,e),t.createPkceNotGeneratedError=function(e){return new t(O.pkceNotGenerated.code,O.pkceNotGenerated.desc+" Detail:"+e)},t.createCryptoNotAvailableError=function(e){return new t(O.cryptoDoesNotExist.code,O.cryptoDoesNotExist.desc+" Detail:"+e)},t.createHttpMethodNotImplementedError=function(e){return new t(O.httpMethodNotImplementedError.code,O.httpMethodNotImplementedError.desc+" Given Method: "+e)},t.createEmptyNavigationUriError=function(){return new t(O.emptyNavigateUriError.code,O.emptyNavigateUriError.desc)},t.createEmptyHashError=function(e){return new t(O.hashEmptyError.code,O.hashEmptyError.desc+" Given Url: "+e)},t.createHashDoesNotContainStateError=function(){return new t(O.hashDoesNotContainStateError.code,O.hashDoesNotContainStateError.desc)},t.createHashDoesNotContainKnownPropertiesError=function(){return new t(O.hashDoesNotContainKnownPropertiesError.code,O.hashDoesNotContainKnownPropertiesError.desc)},t.createUnableToParseStateError=function(){return new t(O.unableToParseStateError.code,O.unableToParseStateError.desc)},t.createStateInteractionTypeMismatchError=function(){return new t(O.stateInteractionTypeMismatchError.code,O.stateInteractionTypeMismatchError.desc)},t.createInteractionInProgressError=function(){return new t(O.interactionInProgress.code,O.interactionInProgress.desc)},t.createPopupWindowError=function(e){var n=O.popupWindowError.desc;return n=P.x.isEmpty(e)?n:n+" Details: "+e,new t(O.popupWindowError.code,n)},t.createEmptyWindowCreatedError=function(){return new t(O.emptyWindowError.code,O.emptyWindowError.desc)},t.createUserCancelledError=function(){return new t(O.userCancelledError.code,O.userCancelledError.desc)},t.createMonitorPopupTimeoutError=function(){return new t(O.monitorPopupTimeoutError.code,O.monitorPopupTimeoutError.desc)},t.createMonitorIframeTimeoutError=function(){return new t(O.monitorIframeTimeoutError.code,O.monitorIframeTimeoutError.desc)},t.createRedirectInIframeError=function(e){return new t(O.redirectInIframeError.code,O.redirectInIframeError.desc+" (window.parent !== window) => "+e)},t.createBlockReloadInHiddenIframeError=function(){return new t(O.blockTokenRequestsInHiddenIframeError.code,O.blockTokenRequestsInHiddenIframeError.desc)},t.createBlockAcquireTokenInPopupsError=function(){return new t(O.blockAcquireTokenInPopupsError.code,O.blockAcquireTokenInPopupsError.desc)},t.createIframeClosedPrematurelyError=function(){return new t(O.iframeClosedPrematurelyError.code,O.iframeClosedPrematurelyError.desc)},t.createSilentLogoutUnsupportedError=function(){return new t(O.silentLogoutUnsupportedError.code,O.silentLogoutUnsupportedError.desc)},t.createNoAccountError=function(){return new t(O.noAccountError.code,O.noAccountError.desc)},t.createSilentPromptValueError=function(e){return new t(O.silentPromptValueError.code,O.silentPromptValueError.desc+" Given value: "+e)},t.createUnableToParseTokenRequestCacheError=function(){return new t(O.unableToParseTokenRequestCacheError.code,O.unableToParseTokenRequestCacheError.desc)},t.createNoTokenRequestCacheError=function(){return new t(O.noTokenRequestCacheError.code,O.noTokenRequestCacheError.desc)},t.createAuthRequestNotSetError=function(){return new t(O.authRequestNotSet.code,O.authRequestNotSet.desc)},t.createNoCachedAuthorityError=function(){return new t(O.noCachedAuthorityError.code,O.noCachedAuthorityError.desc)},t.createInvalidCacheTypeError=function(){return new t(O.invalidCacheType.code,""+O.invalidCacheType.desc)},t.createNonBrowserEnvironmentError=function(){return new t(O.notInBrowserEnvironment.code,O.notInBrowserEnvironment.desc)},t.createDatabaseNotOpenError=function(){return new t(O.databaseNotOpen.code,O.databaseNotOpen.desc)},t.createNoNetworkConnectivityError=function(){return new t(O.noNetworkConnectivity.code,O.noNetworkConnectivity.desc)},t.createPostRequestFailedError=function(e,n){return new t(O.postRequestFailed.code,O.postRequestFailed.desc+" | Network client threw: "+e+" | Attempted to reach: "+n.split("?")[0])},t.createGetRequestFailedError=function(e,n){return new t(O.getRequestFailed.code,O.getRequestFailed.desc+" | Network client threw: "+e+" | Attempted to reach: "+n.split("?")[0])},t.createFailedToParseNetworkResponseError=function(e){return new t(O.failedToParseNetworkResponse.code,O.failedToParseNetworkResponse.desc+" | Attempted to reach: "+e.split("?")[0])},t.createUnableToLoadTokenError=function(e){return new t(O.unableToLoadTokenError.code,O.unableToLoadTokenError.desc+" | "+e)},t.createSigningKeyNotFoundInStorageError=function(e){return new t(O.signingKeyNotFoundInStorage.code,O.signingKeyNotFoundInStorage.desc+" | No match found for KeyId: "+e)},t.createAuthCodeRequiredError=function(){return new t(O.authCodeRequired.code,O.authCodeRequired.desc)},t.createDatabaseUnavailableError=function(){return new t(O.databaseUnavailable.code,O.databaseUnavailable.desc)},t}(k.l),M=function(){function e(e){this.base64Encode=new _,this.cryptoObj=e}return e.prototype.generateCodes=function(){return a(this,void 0,void 0,(function(){var e,t;return s(this,(function(n){switch(n.label){case 0:return e=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(e)];case 1:return t=n.sent(),[2,{verifier:e,challenge:t}]}}))}))},e.prototype.generateCodeVerifier=function(){try{var e=new Uint8Array(32);return this.cryptoObj.getRandomValues(e),this.base64Encode.urlEncodeArr(e)}catch(e){throw N.createPkceNotGeneratedError(e)}},e.prototype.generateCodeChallengeFromVerifier=function(e){return a(this,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(e)];case 1:return t=r.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(t))];case 2:throw n=r.sent(),N.createPkceNotGeneratedError(n);case 3:return[2]}}))}))},e}(),x="SHA-256",F=new Uint8Array([1,0,1]),L=function(){function e(e){if(this.logger=e,!this.hasCryptoAPI())throw N.createCryptoNotAvailableError("Browser crypto or msCrypto object not available.");this._keygenAlgorithmOptions={name:"RSASSA-PKCS1-v1_5",hash:x,modulusLength:2048,publicExponent:F}}return e.prototype.sha256Digest=function(e){return a(this,void 0,void 0,(function(){var t;return s(this,(function(n){return t=A.stringToUtf8Arr(e),[2,this.hasIECrypto()?this.getMSCryptoDigest(x,t):this.getSubtleCryptoDigest(x,t)]}))}))},e.prototype.getRandomValues=function(e){var t=window.msCrypto||window.crypto;if(!t.getRandomValues)throw N.createCryptoNotAvailableError("getRandomValues does not exist.");t.getRandomValues(e)},e.prototype.generateKeyPair=function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(n){return[2,this.hasIECrypto()?this.msCryptoGenerateKey(e,t):window.crypto.subtle.generateKey(this._keygenAlgorithmOptions,e,t)]}))}))},e.prototype.exportJwk=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){return[2,this.hasIECrypto()?this.msCryptoExportJwk(e):window.crypto.subtle.exportKey(T,e)]}))}))},e.prototype.importJwk=function(t,n,r){return a(this,void 0,void 0,(function(){var o,i;return s(this,(function(a){return o=e.getJwkString(t),i=A.stringToArrayBuffer(o),[2,this.hasIECrypto()?this.msCryptoImportKey(i,n,r):window.crypto.subtle.importKey(T,t,this._keygenAlgorithmOptions,n,r)]}))}))},e.prototype.sign=function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(n){return[2,this.hasIECrypto()?this.msCryptoSign(e,t):window.crypto.subtle.sign(this._keygenAlgorithmOptions,e,t)]}))}))},e.prototype.hasCryptoAPI=function(){return this.hasIECrypto()||this.hasBrowserCrypto()},e.prototype.hasIECrypto=function(){return"msCrypto"in window},e.prototype.hasBrowserCrypto=function(){return"crypto"in window},e.prototype.getSubtleCryptoDigest=function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(n){return[2,window.crypto.subtle.digest(e,t)]}))}))},e.prototype.getMSCryptoDigest=function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(n){return[2,new Promise((function(n,r){var o=window.msCrypto.subtle.digest(e,t.buffer);o.addEventListener("complete",(function(e){n(e.target.result)})),o.addEventListener("error",(function(e){r(e)}))}))]}))}))},e.prototype.msCryptoGenerateKey=function(e,t){return a(this,void 0,void 0,(function(){var n=this;return s(this,(function(r){return[2,new Promise((function(r,o){var i=window.msCrypto.subtle.generateKey(n._keygenAlgorithmOptions,e,t);i.addEventListener("complete",(function(e){r(e.target.result)})),i.addEventListener("error",(function(e){o(e)}))}))]}))}))},e.prototype.msCryptoExportJwk=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){return[2,new Promise((function(t,n){var r=window.msCrypto.subtle.exportKey(T,e);r.addEventListener("complete",(function(e){var r=e.target.result,o=A.utf8ArrToString(new Uint8Array(r)).replace(/\r/g,"").replace(/\n/g,"").replace(/\t/g,"").split(" ").join("").replace("\0","");try{t(JSON.parse(o))}catch(e){n(e)}})),r.addEventListener("error",(function(e){n(e)}))}))]}))}))},e.prototype.msCryptoImportKey=function(e,t,n){return a(this,void 0,void 0,(function(){var r=this;return s(this,(function(o){return[2,new Promise((function(o,i){var a=window.msCrypto.subtle.importKey(T,e,r._keygenAlgorithmOptions,t,n);a.addEventListener("complete",(function(e){o(e.target.result)})),a.addEventListener("error",(function(e){i(e)}))}))]}))}))},e.prototype.msCryptoSign=function(e,t){return a(this,void 0,void 0,(function(){var n=this;return s(this,(function(r){return[2,new Promise((function(r,o){var i=window.msCrypto.subtle.sign(n._keygenAlgorithmOptions,e,t);i.addEventListener("complete",(function(e){r(e.target.result)})),i.addEventListener("error",(function(e){o(e)}))}))]}))}))},e.getJwkString=function(e){return JSON.stringify(e,Object.keys(e).sort())},e}(),U=function(){function e(){this.dbName=b,this.version=1,this.tableName="msal.db.keys",this.dbOpen=!1}return e.prototype.open=function(){return a(this,void 0,void 0,(function(){var e=this;return s(this,(function(t){return[2,new Promise((function(t,n){var r=window.indexedDB.open(e.dbName,e.version);r.addEventListener("upgradeneeded",(function(t){t.target.result.createObjectStore(e.tableName)})),r.addEventListener("success",(function(n){var r=n;e.db=r.target.result,e.dbOpen=!0,t()})),r.addEventListener("error",(function(){return n(N.createDatabaseUnavailableError())}))}))]}))}))},e.prototype.validateDbIsOpen=function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:return[2,e.sent()];case 2:return[2]}}))}))},e.prototype.getItem=function(e){return a(this,void 0,void 0,(function(){var t=this;return s(this,(function(n){switch(n.label){case 0:return[4,this.validateDbIsOpen()];case 1:return n.sent(),[2,new Promise((function(n,r){if(!t.db)return r(N.createDatabaseNotOpenError());var o=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).get(e);o.addEventListener("success",(function(e){n(e.target.result)})),o.addEventListener("error",(function(e){return r(e)}))}))]}}))}))},e.prototype.setItem=function(e,t){return a(this,void 0,void 0,(function(){var n=this;return s(this,(function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise((function(r,o){if(!n.db)return o(N.createDatabaseNotOpenError());var i=n.db.transaction([n.tableName],"readwrite").objectStore(n.tableName).put(t,e);i.addEventListener("success",(function(){return r()})),i.addEventListener("error",(function(e){return o(e)}))}))]}}))}))},e.prototype.removeItem=function(e){return a(this,void 0,void 0,(function(){var t=this;return s(this,(function(n){switch(n.label){case 0:return[4,this.validateDbIsOpen()];case 1:return n.sent(),[2,new Promise((function(n,r){if(!t.db)return r(N.createDatabaseNotOpenError());var o=t.db.transaction([t.tableName],"readwrite").objectStore(t.tableName).delete(e);o.addEventListener("success",(function(){return n()})),o.addEventListener("error",(function(e){return r(e)}))}))]}}))}))},e.prototype.getKeys=function(){return a(this,void 0,void 0,(function(){var e=this;return s(this,(function(t){switch(t.label){case 0:return[4,this.validateDbIsOpen()];case 1:return t.sent(),[2,new Promise((function(t,n){if(!e.db)return n(N.createDatabaseNotOpenError());var r=e.db.transaction([e.tableName],"readonly").objectStore(e.tableName).getAllKeys();r.addEventListener("success",(function(e){t(e.target.result)})),r.addEventListener("error",(function(e){return n(e)}))}))]}}))}))},e.prototype.containsKey=function(e){return a(this,void 0,void 0,(function(){var t=this;return s(this,(function(n){switch(n.label){case 0:return[4,this.validateDbIsOpen()];case 1:return n.sent(),[2,new Promise((function(n,r){if(!t.db)return r(N.createDatabaseNotOpenError());var o=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).count(e);o.addEventListener("success",(function(e){n(1===e.target.result)})),o.addEventListener("error",(function(e){return r(e)}))}))]}}))}))},e.prototype.deleteDatabase=function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){return[2,new Promise((function(e,t){var n=window.indexedDB.deleteDatabase(b);n.addEventListener("success",(function(){return e(!0)})),n.addEventListener("error",(function(){return t(!1)}))}))]}))}))},e}(),D=function(){function e(){this.cache=new Map}return e.prototype.getItem=function(e){return this.cache.get(e)||null},e.prototype.setItem=function(e,t){this.cache.set(e,t)},e.prototype.removeItem=function(e){this.cache.delete(e)},e.prototype.getKeys=function(){var e=[];return this.cache.forEach((function(t,n){e.push(n)})),e},e.prototype.containsKey=function(e){return this.cache.has(e)},e.prototype.clear=function(){this.cache.clear()},e}(),H=function(){function e(e){this.inMemoryCache=new D,this.indexedDBCache=new U,this.logger=e}return e.prototype.handleDatabaseAccessError=function(e){e instanceof N&&e.errorCode===O.databaseUnavailable.code&&this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")},e.prototype.getItem=function(e){return a(this,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:if(t=this.inMemoryCache.getItem(e))return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.getItem(e)];case 2:return[2,r.sent()];case 3:return n=r.sent(),this.handleDatabaseAccessError(n),[3,4];case 4:return[2,t]}}))}))},e.prototype.setItem=function(e,t){return a(this,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:this.inMemoryCache.setItem(e,t),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.indexedDBCache.setItem(e,t)];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),this.handleDatabaseAccessError(n),[3,4];case 4:return[2]}}))}))},e.prototype.removeItem=function(e){return a(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:this.inMemoryCache.removeItem(e),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.indexedDBCache.removeItem(e)];case 2:return n.sent(),[3,4];case 3:return t=n.sent(),this.handleDatabaseAccessError(t),[3,4];case 4:return[2]}}))}))},e.prototype.getKeys=function(){return a(this,void 0,void 0,(function(){var e,t;return s(this,(function(n){switch(n.label){case 0:if(0!==(e=this.inMemoryCache.getKeys()).length)return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),this.logger.verbose("In-memory cache is empty, now querying persistent storage."),[4,this.indexedDBCache.getKeys()];case 2:return[2,n.sent()];case 3:return t=n.sent(),this.handleDatabaseAccessError(t),[3,4];case 4:return[2,e]}}))}))},e.prototype.containsKey=function(e){return a(this,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:if(t=this.inMemoryCache.containsKey(e))return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.containsKey(e)];case 2:return[2,r.sent()];case 3:return n=r.sent(),this.handleDatabaseAccessError(n),[3,4];case 4:return[2,t]}}))}))},e.prototype.clear=function(){return a(this,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:this.inMemoryCache.clear(),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.indexedDBCache.deleteDatabase()];case 2:return t.sent(),[3,4];case 3:return e=t.sent(),this.handleDatabaseAccessError(e),[3,4];case 4:return[2]}}))}))},e}(),q=function(){function e(e){this.logger=e,this.browserCrypto=new L(this.logger),this.b64Encode=new _,this.b64Decode=new R,this.guidGenerator=new I(this.browserCrypto),this.pkceGenerator=new M(this.browserCrypto),this.cache={asymmetricKeys:new H(this.logger),symmetricKeys:new H(this.logger)}}return e.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},e.prototype.base64Encode=function(e){return this.b64Encode.encode(e)},e.prototype.base64Decode=function(e){return this.b64Decode.decode(e)},e.prototype.generatePkceCodes=function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){return[2,this.pkceGenerator.generateCodes()]}))}))},e.prototype.getPublicKeyThumbprint=function(t){return a(this,void 0,void 0,(function(){var n,r,o,i,a,c,u;return s(this,(function(s){switch(s.label){case 0:return[4,this.browserCrypto.generateKeyPair(e.EXTRACTABLE,e.POP_KEY_USAGES)];case 1:return n=s.sent(),[4,this.browserCrypto.exportJwk(n.publicKey)];case 2:return r=s.sent(),o={e:r.e,kty:r.kty,n:r.n},i=L.getJwkString(o),[4,this.hashString(i)];case 3:return a=s.sent(),[4,this.browserCrypto.exportJwk(n.privateKey)];case 4:return c=s.sent(),[4,this.browserCrypto.importJwk(c,!1,["sign"])];case 5:return u=s.sent(),[4,this.cache.asymmetricKeys.setItem(a,{privateKey:u,publicKey:n.publicKey,requestMethod:t.resourceRequestMethod,requestUri:t.resourceRequestUri})];case 6:return s.sent(),[2,a]}}))}))},e.prototype.removeTokenBindingKey=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.cache.asymmetricKeys.removeItem(e)];case 1:return t.sent(),[4,this.cache.asymmetricKeys.containsKey(e)];case 2:return[2,!t.sent()]}}))}))},e.prototype.clearKeystore=function(){return a(this,void 0,void 0,(function(){var e,t,n;return s(this,(function(r){switch(r.label){case 0:return e=Object.keys(this.cache),(t=this.cache[e[0]])?[4,t.deleteDatabase()]:[3,2];case 1:return n=r.sent(),[3,3];case 2:n=!1,r.label=3;case 3:return[2,n]}}))}))},e.prototype.signJwt=function(e,t){return a(this,void 0,void 0,(function(){var n,r,o,i,a,c,u,l,d,p;return s(this,(function(s){switch(s.label){case 0:return[4,this.cache.asymmetricKeys.getItem(t)];case 1:if(!(n=s.sent()))throw N.createSigningKeyNotFoundInStorageError(t);return[4,this.browserCrypto.exportJwk(n.publicKey)];case 2:return r=s.sent(),o=L.getJwkString(r),i={alg:r.alg,type:T},a=this.b64Encode.urlEncode(JSON.stringify(i)),e.cnf={jwk:JSON.parse(o)},c=this.b64Encode.urlEncode(JSON.stringify(e)),u=a+"."+c,l=A.stringToArrayBuffer(u),[4,this.browserCrypto.sign(n.privateKey,l)];case 3:return d=s.sent(),p=this.b64Encode.urlEncodeArr(new Uint8Array(d)),[2,u+"."+p]}}))}))},e.prototype.hashString=function(e){return a(this,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:return[4,this.browserCrypto.sha256Digest(e)];case 1:return t=r.sent(),n=new Uint8Array(t),[2,this.b64Encode.urlEncodeArr(n)]}}))}))},e.POP_KEY_USAGES=["sign","verify"],e.EXTRACTABLE=!0,e}(),B=n(21362),G=n(66561),j=n(91359),z=n(83927),V=n(43640),K=n(67656),W=n(70979),J=n(85907),Y=n(11429),Q=n(59993),X=n(44612),Z=n(1713),$=n(4184),ee=n(3516),te=n(34726),ne=n(70591),re={redirectUriNotSet:{code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},postLogoutUriNotSet:{code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},storageNotSupportedError:{code:"storage_not_supported",desc:"Given storage configuration option was not supported."},noRedirectCallbacksSet:{code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},invalidCallbackObject:{code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},stubPcaInstanceCalled:{code:"stubbed_public_client_application_called",desc:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors"},inMemRedirectUnavailable:{code:"in_mem_redirect_unavailable",desc:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."}},oe=function(e){function t(n,r){var o=e.call(this,n,r)||this;return o.name="BrowserConfigurationAuthError",Object.setPrototypeOf(o,t.prototype),o}return o(t,e),t.createRedirectUriEmptyError=function(){return new t(re.redirectUriNotSet.code,re.redirectUriNotSet.desc)},t.createPostLogoutRedirectUriEmptyError=function(){return new t(re.postLogoutUriNotSet.code,re.postLogoutUriNotSet.desc)},t.createStorageNotSupportedError=function(e){return new t(re.storageNotSupportedError.code,re.storageNotSupportedError.desc+" Given Location: "+e)},t.createRedirectCallbacksNotSetError=function(){return new t(re.noRedirectCallbacksSet.code,re.noRedirectCallbacksSet.desc)},t.createStubPcaInstanceCalledError=function(){return new t(re.stubPcaInstanceCalled.code,re.stubPcaInstanceCalled.desc)},t.createInMemoryRedirectUnavailableError=function(){return new t(re.inMemRedirectUnavailable.code,re.inMemRedirectUnavailable.desc)},t}(k.l),ie=function(){function e(e){this.validateWindowStorage(e),this.windowStorage=window[e]}return e.prototype.validateWindowStorage=function(e){if(e!==l.LocalStorage&&e!==l.SessionStorage)throw oe.createStorageNotSupportedError(e);if(!window[e])throw oe.createStorageNotSupportedError(e)},e.prototype.getItem=function(e){return this.windowStorage.getItem(e)},e.prototype.setItem=function(e,t){this.windowStorage.setItem(e,t)},e.prototype.removeItem=function(e){this.windowStorage.removeItem(e)},e.prototype.getKeys=function(){return Object.keys(this.windowStorage)},e.prototype.containsKey=function(e){return this.windowStorage.hasOwnProperty(e)},e}(),ae=n(60742),se=n(99860),ce=function(){function e(){}return e.extractBrowserRequestState=function(e,t){if(P.x.isEmpty(t))return null;try{return ee.C.parseRequestState(e,t).libraryState.meta}catch(e){throw ae.e.createInvalidStateError(t,e)}},e.parseServerResponseFromHash=function(e){if(!e)return{};var t=new se.G(e);return se.G.getDeserializedHash(t.getHash())},e}(),ue=function(e){function t(t,n,r,o){var i=e.call(this,t,r)||this;return i.COOKIE_LIFE_MULTIPLIER=864e5,i.cacheConfig=n,i.logger=o,i.internalStorage=new D,i.browserStorage=i.setupBrowserStorage(i.cacheConfig.cacheLocation),i.temporaryCacheStorage=i.setupTemporaryCacheStorage(i.cacheConfig.cacheLocation),i.migrateCacheEntries(),i}return o(t,e),t.prototype.setupBrowserStorage=function(e){switch(e){case l.LocalStorage:case l.SessionStorage:try{return new ie(e)}catch(e){this.logger.verbose(e);break}}return this.cacheConfig.cacheLocation=l.MemoryStorage,new D},t.prototype.setupTemporaryCacheStorage=function(e){switch(e){case l.LocalStorage:case l.SessionStorage:try{return new ie(l.SessionStorage)}catch(e){return this.logger.verbose(e),this.internalStorage}case l.MemoryStorage:default:return this.internalStorage}},t.prototype.migrateCacheEntries=function(){var e=this,t=v.gT.CACHE_PREFIX+"."+v.Vi.ID_TOKEN,n=v.gT.CACHE_PREFIX+"."+v.Vi.CLIENT_INFO,r=v.gT.CACHE_PREFIX+"."+v.Vi.ERROR,o=v.gT.CACHE_PREFIX+"."+v.Vi.ERROR_DESC,i=[this.browserStorage.getItem(t),this.browserStorage.getItem(n),this.browserStorage.getItem(r),this.browserStorage.getItem(o)];[v.Vi.ID_TOKEN,v.Vi.CLIENT_INFO,v.Vi.ERROR,v.Vi.ERROR_DESC].forEach((function(t,n){return e.migrateCacheEntry(t,i[n])}))},t.prototype.migrateCacheEntry=function(e,t){t&&this.setTemporaryCache(e,t,!0)},t.prototype.validateAndParseJson=function(e){try{var t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(e){return null}},t.prototype.getItem=function(e){return this.browserStorage.getItem(e)},t.prototype.setItem=function(e,t){this.browserStorage.setItem(e,t)},t.prototype.getAccount=function(e){var t=this.getItem(e);if(!t)return null;var n=this.validateAndParseJson(t);return n&&V.r.isAccountEntity(n)?K.L.toObject(new V.r,n):null},t.prototype.setAccount=function(e){this.logger.trace("BrowserCacheManager.setAccount called");var t=e.generateAccountKey();this.setItem(t,JSON.stringify(e))},t.prototype.getIdTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null;var n=this.validateAndParseJson(t);return n&&W.w.isIdTokenEntity(n)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),K.L.toObject(new W.w,n)):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null)},t.prototype.setIdTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},t.prototype.getAccessTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null;var n=this.validateAndParseJson(t);return n&&J._.isAccessTokenEntity(n)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),K.L.toObject(new J._,n)):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null)},t.prototype.setAccessTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},t.prototype.getRefreshTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null;var n=this.validateAndParseJson(t);return n&&Y.e.isRefreshTokenEntity(n)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),K.L.toObject(new Y.e,n)):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null)},t.prototype.setRefreshTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},t.prototype.getAppMetadata=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;var n=this.validateAndParseJson(t);return n&&Q.T.isAppMetadataEntity(e,n)?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),K.L.toObject(new Q.T,n)):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null)},t.prototype.setAppMetadata=function(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");var t=e.generateAppMetadataKey();this.setItem(t,JSON.stringify(e))},t.prototype.getServerTelemetry=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;var n=this.validateAndParseJson(t);return n&&X.d.isServerTelemetryEntity(e,n)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),K.L.toObject(new X.d,n)):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)},t.prototype.setServerTelemetry=function(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t))},t.prototype.getAuthorityMetadata=function(e){var t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;var n=this.validateAndParseJson(t);return n&&Z.l.isAuthorityMetadataEntity(e,n)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),K.L.toObject(new Z.l,n)):null},t.prototype.getAuthorityMetadataKeys=function(){var e=this;return this.internalStorage.getKeys().filter((function(t){return e.isAuthorityMetadata(t)}))},t.prototype.setWrapperMetadata=function(e,t){this.internalStorage.setItem(h.WRAPPER_SKU,e),this.internalStorage.setItem(h.WRAPPER_VER,t)},t.prototype.getWrapperMetadata=function(){return[this.internalStorage.getItem(h.WRAPPER_SKU)||"",this.internalStorage.getItem(h.WRAPPER_VER)||""]},t.prototype.setAuthorityMetadata=function(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))},t.prototype.getActiveAccount=function(){var e=this.generateCacheKey(v.Vi.ACTIVE_ACCOUNT),t=this.browserStorage.getItem(e);return t&&this.getAccountInfoByFilter({localAccountId:t})[0]||null},t.prototype.setActiveAccount=function(e){var t=this.generateCacheKey(v.Vi.ACTIVE_ACCOUNT);e?(this.logger.verbose("setActiveAccount: Active account set"),this.browserStorage.setItem(t,e.localAccountId)):(this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(t))},t.prototype.getAccountInfoByFilter=function(e){return this.getAllAccounts().filter((function(t){return!(e.username&&e.username.toLowerCase()!==t.username.toLowerCase()||e.homeAccountId&&e.homeAccountId!==t.homeAccountId||e.localAccountId&&e.localAccountId!==t.localAccountId||e.tenantId&&e.tenantId!==t.tenantId||e.environment&&e.environment!==t.environment)}))},t.prototype.getThrottlingCache=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;var n=this.validateAndParseJson(t);return n&&$.A.isThrottlingEntity(e,n)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),K.L.toObject(new $.A,n)):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)},t.prototype.setThrottlingCache=function(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t))},t.prototype.getTemporaryCache=function(e,t){var n=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){var r=this.getItemCookie(n);if(r)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),r}var o=this.temporaryCacheStorage.getItem(n);if(!o){if(this.cacheConfig.cacheLocation===l.LocalStorage){var i=this.browserStorage.getItem(n);if(i)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),i}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),o},t.prototype.setTemporaryCache=function(e,t,n){var r=n?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(r,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(r,t))},t.prototype.removeItem=function(e){return this.browserStorage.removeItem(e),this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(e)),!0},t.prototype.containsKey=function(e){return this.browserStorage.containsKey(e)||this.temporaryCacheStorage.containsKey(e)},t.prototype.getKeys=function(){return u(this.browserStorage.getKeys(),this.temporaryCacheStorage.getKeys())},t.prototype.clear=function(){return a(this,void 0,void 0,(function(){var e=this;return s(this,(function(t){switch(t.label){case 0:return[4,this.removeAllAccounts()];case 1:return t.sent(),this.removeAppMetadata(),this.getKeys().forEach((function(t){!e.browserStorage.containsKey(t)&&!e.temporaryCacheStorage.containsKey(t)||-1===t.indexOf(v.gT.CACHE_PREFIX)&&-1===t.indexOf(e.clientId)||e.removeItem(t)})),this.internalStorage.clear(),[2]}}))}))},t.prototype.setItemCookie=function(e,t,n){var r=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/;";n&&(r+="expires="+this.getCookieExpirationTime(n)+";"),this.cacheConfig.secureCookies&&(r+="Secure;"),document.cookie=r},t.prototype.getItemCookie=function(e){for(var t=encodeURIComponent(e)+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var o=n[r];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return decodeURIComponent(o.substring(t.length,o.length))}return""},t.prototype.clearMsalCookies=function(){var e=this,t=v.gT.CACHE_PREFIX+"."+this.clientId;document.cookie.split(";").forEach((function(n){for(;" "===n.charAt(0);)n=n.substring(1);if(0===n.indexOf(t)){var r=n.split("=")[0];e.clearItemCookie(r)}}))},t.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)},t.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+e*this.COOKIE_LIFE_MULTIPLIER).toUTCString()},t.prototype.getCache=function(){return this.browserStorage},t.prototype.setCache=function(){},t.prototype.generateCacheKey=function(e){return this.validateAndParseJson(e)?JSON.stringify(e):P.x.startsWith(e,v.gT.CACHE_PREFIX)||P.x.startsWith(e,v.Vi.ADAL_ID_TOKEN)?e:v.gT.CACHE_PREFIX+"."+this.clientId+"."+e},t.prototype.generateAuthorityKey=function(e){var t=ee.C.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(p.AUTHORITY+"."+t)},t.prototype.generateNonceKey=function(e){var t=ee.C.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(p.NONCE_IDTOKEN+"."+t)},t.prototype.generateStateKey=function(e){var t=ee.C.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(p.REQUEST_STATE+"."+t)},t.prototype.getCachedAuthority=function(e){var t=this.generateStateKey(e),n=this.getTemporaryCache(t);if(!n)return null;var r=this.generateAuthorityKey(n);return this.getTemporaryCache(r)},t.prototype.updateCacheEntries=function(e,t,n,r,o){this.logger.trace("BrowserCacheManager.updateCacheEntries called");var i=this.generateStateKey(e);this.setTemporaryCache(i,e,!1);var a=this.generateNonceKey(e);this.setTemporaryCache(a,t,!1);var s=this.generateAuthorityKey(e);if(this.setTemporaryCache(s,n,!1),o){var c={credential:o.homeAccountId,type:te.G.HOME_ACCOUNT_ID};this.setTemporaryCache(p.CCS_CREDENTIAL,JSON.stringify(c),!0)}else P.x.isEmpty(r)||(c={credential:r,type:te.G.UPN},this.setTemporaryCache(p.CCS_CREDENTIAL,JSON.stringify(c),!0))},t.prototype.resetRequestCache=function(e){var t=this;this.logger.trace("BrowserCacheManager.resetRequestCache called"),P.x.isEmpty(e)||this.getKeys().forEach((function(n){-1!==n.indexOf(e)&&t.removeItem(n)})),e&&(this.removeItem(this.generateStateKey(e)),this.removeItem(this.generateNonceKey(e)),this.removeItem(this.generateAuthorityKey(e))),this.removeItem(this.generateCacheKey(p.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(p.ORIGIN_URI)),this.removeItem(this.generateCacheKey(p.URL_HASH)),this.removeItem(this.generateCacheKey(p.CORRELATION_ID)),this.removeItem(this.generateCacheKey(p.CCS_CREDENTIAL)),this.setInteractionInProgress(!1)},t.prototype.cleanRequestByState=function(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){var t=this.generateStateKey(e),n=this.temporaryCacheStorage.getItem(t);this.logger.infoPii("BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: "+n),this.resetRequestCache(n||"")}this.clearMsalCookies()},t.prototype.cleanRequestByInteractionType=function(e){var t=this;this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.getKeys().forEach((function(n){if(-1!==n.indexOf(p.REQUEST_STATE)){var r=t.temporaryCacheStorage.getItem(n);if(r){var o=ce.extractBrowserRequestState(t.cryptoImpl,r);o&&o.interactionType===e&&(t.logger.infoPii("BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: "+r),t.resetRequestCache(r))}}})),this.clearMsalCookies(),this.setInteractionInProgress(!1)},t.prototype.cacheCodeRequest=function(e,t){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");var n=t.base64Encode(JSON.stringify(e));this.setTemporaryCache(p.REQUEST_PARAMS,n,!0)},t.prototype.getCachedRequest=function(e,t){this.logger.trace("BrowserCacheManager.getCachedRequest called");var n=this.getTemporaryCache(p.REQUEST_PARAMS,!0);if(!n)throw N.createNoTokenRequestCacheError();var r=this.validateAndParseJson(t.base64Decode(n));if(!r)throw N.createUnableToParseTokenRequestCacheError();if(this.removeItem(this.generateCacheKey(p.REQUEST_PARAMS)),P.x.isEmpty(r.authority)){var o=this.generateAuthorityKey(e),i=this.getTemporaryCache(o);if(!i)throw N.createNoCachedAuthorityError();r.authority=i}return r},t.prototype.isInteractionInProgress=function(e){var t=this.getInteractionInProgress();return e?t===this.clientId:!!t},t.prototype.getInteractionInProgress=function(){var e=v.gT.CACHE_PREFIX+"."+p.INTERACTION_STATUS_KEY;return this.getTemporaryCache(e,!1)},t.prototype.setInteractionInProgress=function(e){var t=this.getInteractionInProgress(),n=v.gT.CACHE_PREFIX+"."+p.INTERACTION_STATUS_KEY;e&&!t?this.setTemporaryCache(n,this.clientId,!1):e||t!==this.clientId||this.removeItem(n)},t.prototype.getLegacyLoginHint=function(){var e=this.getTemporaryCache(v.Vi.ADAL_ID_TOKEN);e&&(this.browserStorage.removeItem(v.Vi.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));var t=this.getTemporaryCache(v.Vi.ID_TOKEN,!0);t&&(this.removeItem(this.generateCacheKey(v.Vi.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));var n=t||e;if(n){var r=new ne.H(n,this.cryptoImpl);if(r.claims&&r.claims.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),r.claims.preferred_username;if(r.claims&&r.claims.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),r.claims.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null},t.prototype.updateCredentialCacheKey=function(e,t){var n=t.generateCredentialKey();if(e!==n){var r=this.getItem(e);if(r)return this.removeItem(e),this.setItem(n,r),this.logger.verbose("Updated an outdated "+t.credentialType+" cache key"),n;this.logger.error("Attempted to update an outdated "+t.credentialType+" cache key but no item matching the outdated key was found in storage")}return e},t}(K.L),le=n(82617),de=n(14854),pe=n(30658),he=function(){function e(){}return e.prototype.sendGetRequestAsync=function(e,t){return a(this,void 0,void 0,(function(){var n,r,o;return s(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,fetch(e,{method:d.GET,headers:this.getFetchHeaders(t)})];case 1:return n=i.sent(),[3,3];case 2:throw r=i.sent(),window.navigator.onLine?N.createGetRequestFailedError(r,e):N.createNoNetworkConnectivityError();case 3:return i.trys.push([3,5,,6]),o={headers:this.getHeaderDict(n.headers)},[4,n.json()];case 4:return[2,(o.body=i.sent(),o.status=n.status,o)];case 5:throw i.sent(),N.createFailedToParseNetworkResponseError(e);case 6:return[2]}}))}))},e.prototype.sendPostRequestAsync=function(e,t){return a(this,void 0,void 0,(function(){var n,r,o,i;return s(this,(function(a){switch(a.label){case 0:n=t&&t.body||"",a.label=1;case 1:return a.trys.push([1,3,,4]),[4,fetch(e,{method:d.POST,headers:this.getFetchHeaders(t),body:n})];case 2:return r=a.sent(),[3,4];case 3:throw o=a.sent(),window.navigator.onLine?N.createPostRequestFailedError(o,e):N.createNoNetworkConnectivityError();case 4:return a.trys.push([4,6,,7]),i={headers:this.getHeaderDict(r.headers)},[4,r.json()];case 5:return[2,(i.body=a.sent(),i.status=r.status,i)];case 6:throw a.sent(),N.createFailedToParseNetworkResponseError(e);case 7:return[2]}}))}))},e.prototype.getFetchHeaders=function(e){var t=new Headers;if(!e||!e.headers)return t;var n=e.headers;return Object.keys(n).forEach((function(e){t.append(e,n[e])})),t},e.prototype.getHeaderDict=function(e){var t={};return e.forEach((function(e,n){t[n]=e})),t},e}(),fe=function(){function e(){}return e.prototype.sendGetRequestAsync=function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(n){return[2,this.sendRequestAsync(e,d.GET,t)]}))}))},e.prototype.sendPostRequestAsync=function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(n){return[2,this.sendRequestAsync(e,d.POST,t)]}))}))},e.prototype.sendRequestAsync=function(e,t,n){var r=this;return new Promise((function(o,i){var a=new XMLHttpRequest;if(a.open(t,e,!0),r.setXhrHeaders(a,n),a.onload=function(){(a.status<200||a.status>=300)&&(t===d.POST?i(N.createPostRequestFailedError("Failed with status "+a.status,e)):i(N.createGetRequestFailedError("Failed with status "+a.status,e)));try{var n=JSON.parse(a.responseText),s={headers:r.getHeaderDict(a),body:n,status:a.status};o(s)}catch(t){i(N.createFailedToParseNetworkResponseError(e))}},a.onerror=function(){window.navigator.onLine?t===d.POST?i(N.createPostRequestFailedError("Failed with status "+a.status,e)):i(N.createGetRequestFailedError("Failed with status "+a.status,e)):i(N.createNoNetworkConnectivityError())},t===d.POST&&n&&n.body)a.send(n.body);else{if(t!==d.GET)throw N.createHttpMethodNotImplementedError(t);a.send()}}))},e.prototype.setXhrHeaders=function(e,t){if(t&&t.headers){var n=t.headers;Object.keys(n).forEach((function(t){e.setRequestHeader(t,n[t])}))}},e.prototype.getHeaderDict=function(e){var t=e.getAllResponseHeaders().trim().split(/[\r\n]+/),n={};return t.forEach((function(e){var t=e.split(": "),r=t.shift(),o=t.join(": ");r&&o&&(n[r]=o)})),n},e}(),ge=function(){function e(){}return e.clearHash=function(e){e.location.hash=v.gT.EMPTY_STRING,"function"==typeof e.history.replaceState&&e.history.replaceState(null,v.gT.EMPTY_STRING,""+e.location.origin+e.location.pathname+e.location.search)},e.replaceHash=function(e){var t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):""},e.isInIframe=function(){return window.parent!==window},e.isInPopup=function(){return"undefined"!=typeof window&&!!window.opener&&window.opener!==window&&"string"==typeof window.name&&0===window.name.indexOf("msal.")},e.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},e.getHomepage=function(){var e=new se.G(window.location.href).getUrlComponents();return e.Protocol+"//"+e.HostNameAndPort+"/"},e.getBrowserNetworkClient=function(){return window.fetch&&window.Headers?new he:new fe},e.blockReloadInHiddenIframes=function(){if(se.G.hashContainsKnownProperties(window.location.hash)&&e.isInIframe())throw N.createBlockReloadInHiddenIframeError()},e.blockRedirectInIframe=function(t,n){var r=e.isInIframe();if(t===g.Redirect&&r&&!n)throw N.createRedirectInIframeError(r)},e.blockAcquireTokenInPopups=function(){if(e.isInPopup())throw N.createBlockAcquireTokenInPopupsError()},e.blockNonBrowserEnvironment=function(e){if(!e)throw N.createNonBrowserEnvironmentError()},e.detectIEOrEdge=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),n=e.indexOf("Trident/"),r=e.indexOf("Edge/");return t>0||n>0||r>0},e}(),me=function(){function e(){}return e.prototype.navigateInternal=function(t,n){return e.defaultNavigateWindow(t,n)},e.prototype.navigateExternal=function(t,n){return e.defaultNavigateWindow(t,n)},e.defaultNavigateWindow=function(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise((function(e){setTimeout((function(){e(!0)}),t.timeout)}))},e}(),ve="@azure/msal-browser",ye="2.21.0";!function(e){e.ACCOUNT_ADDED="msal:accountAdded",e.ACCOUNT_REMOVED="msal:accountRemoved",e.LOGIN_START="msal:loginStart",e.LOGIN_SUCCESS="msal:loginSuccess",e.LOGIN_FAILURE="msal:loginFailure",e.ACQUIRE_TOKEN_START="msal:acquireTokenStart",e.ACQUIRE_TOKEN_SUCCESS="msal:acquireTokenSuccess",e.ACQUIRE_TOKEN_FAILURE="msal:acquireTokenFailure",e.ACQUIRE_TOKEN_NETWORK_START="msal:acquireTokenFromNetworkStart",e.SSO_SILENT_START="msal:ssoSilentStart",e.SSO_SILENT_SUCCESS="msal:ssoSilentSuccess",e.SSO_SILENT_FAILURE="msal:ssoSilentFailure",e.ACQUIRE_TOKEN_BY_CODE_START="msal:acquireTokenByCodeStart",e.ACQUIRE_TOKEN_BY_CODE_SUCCESS="msal:acquireTokenByCodeSuccess",e.ACQUIRE_TOKEN_BY_CODE_FAILURE="msal:acquireTokenByCodeFailure",e.HANDLE_REDIRECT_START="msal:handleRedirectStart",e.HANDLE_REDIRECT_END="msal:handleRedirectEnd",e.POPUP_OPENED="msal:popupOpened",e.LOGOUT_START="msal:logoutStart",e.LOGOUT_SUCCESS="msal:logoutSuccess",e.LOGOUT_FAILURE="msal:logoutFailure",e.LOGOUT_END="msal:logoutEnd"}(w||(w={}));var Ce=function(){function e(e,t){this.eventCallbacks=new Map,this.logger=e,this.browserCrypto=t,this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}return e.prototype.addEventCallback=function(e){if("undefined"!=typeof window){var t=this.browserCrypto.createNewGuid();return this.eventCallbacks.set(t,e),this.logger.verbose("Event callback registered with id: "+t),t}return null},e.prototype.removeEventCallback=function(e){this.eventCallbacks.delete(e),this.logger.verbose("Event callback "+e+" removed.")},e.prototype.enableAccountStorageEvents=function(){"undefined"!=typeof window&&(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))},e.prototype.disableAccountStorageEvents=function(){"undefined"!=typeof window&&(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))},e.prototype.emitEvent=function(e,t,n,r){var o=this;if("undefined"!=typeof window){var i={eventType:e,interactionType:t||null,payload:n||null,error:r||null,timestamp:Date.now()};this.logger.info("Emitting event: "+e),this.eventCallbacks.forEach((function(t,n){o.logger.verbose("Emitting event to callback "+n+": "+e),t.apply(null,[i])}))}},e.prototype.handleAccountCacheChange=function(e){try{var t=e.newValue||e.oldValue;if(!t)return;var n=JSON.parse(t);if("object"!=typeof n||!V.r.isAccountEntity(n))return;var r=K.L.toObject(new V.r,n).getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.emitEvent(w.ACCOUNT_ADDED,void 0,r)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.emitEvent(w.ACCOUNT_REMOVED,void 0,r))}catch(e){return}},e}(),Ee=n(47282),Te=n(29046),we=n(65676),be=n(47181),Se=n(31093),Ie=function(e){function t(t,n,r,o,i,a,s){var c=e.call(this,t,n,r,o,i,s)||this;return c.navigationClient=a,c}return o(t,e),t.prototype.initializeAuthorizationCodeRequest=function(e){return a(this,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:return this.logger.verbose("initializeAuthorizationRequest called",e.correlationId),[4,this.browserCrypto.generatePkceCodes()];case 1:return t=r.sent(),n=i(i({},e),{redirectUri:e.redirectUri,code:"",codeVerifier:t.verifier}),e.codeChallenge=t.challenge,e.codeChallengeMethod=v.gT.S256_CODE_CHALLENGE_METHOD,[2,n]}}))}))},t.prototype.initializeLogoutRequest=function(e){if(this.logger.verbose("initializeLogoutRequest called",null==e?void 0:e.correlationId),this.browserStorage.isInteractionInProgress())throw N.createInteractionInProgressError();var t=i({correlationId:this.browserCrypto.createNewGuid()},e);return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=se.G.getAbsoluteUrl(e.postLogoutRedirectUri,ge.getCurrentUri())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=se.G.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,ge.getCurrentUri())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=se.G.getAbsoluteUrl(ge.getCurrentUri(),ge.getCurrentUri())),t},t.prototype.createAuthCodeClient=function(e,t){return a(this,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:return[4,this.getClientConfiguration(e,t)];case 1:return n=r.sent(),[2,new Te.U(n)]}}))}))},t.prototype.getClientConfiguration=function(e,t){return a(this,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:return this.logger.verbose("getClientConfiguration called"),[4,this.getDiscoveredAuthority(t)];case 1:return n=r.sent(),[2,{authOptions:{clientId:this.config.auth.clientId,authority:n,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:this.config.system.loggerOptions.loggerCallback,piiLoggingEnabled:this.config.system.loggerOptions.piiLoggingEnabled,logLevel:this.config.system.loggerOptions.logLevel,correlationId:this.correlationId},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:e,libraryInfo:{sku:y,version:ye,cpu:"",os:""}}]}}))}))},t.prototype.validateAndExtractStateFromHash=function(e,t,n){this.logger.verbose("validateAndExtractStateFromHash called",n);var r=se.G.getDeserializedHash(e);if(!r.state)throw N.createHashDoesNotContainStateError();var o=ce.extractBrowserRequestState(this.browserCrypto,r.state);if(!o)throw N.createUnableToParseStateError();if(o.interactionType!==t)throw N.createStateInteractionTypeMismatchError();return this.logger.verbose("Returning state from hash",n),r.state},t.prototype.getDiscoveredAuthority=function(e){return a(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return this.logger.verbose("getDiscoveredAuthority called"),t={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},e?(this.logger.verbose("Creating discovered authority with request authority"),[4,we.A.createDiscoveredInstance(e,this.config.system.networkClient,this.browserStorage,t)]):[3,2];case 1:case 3:return[2,n.sent()];case 2:return this.logger.verbose("Creating discovered authority with configured authority"),[4,we.A.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient,this.browserStorage,t)]}}))}))},t.prototype.preflightInteractiveRequest=function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:if(this.logger.verbose("preflightInteractiveRequest called, validating app environment",null==e?void 0:e.correlationId),ge.blockReloadInHiddenIframes(),this.browserStorage.isInteractionInProgress(!1))throw N.createInteractionInProgressError();return[4,this.initializeAuthorizationRequest(e,t)];case 1:return[2,n.sent()]}}))}))},t.prototype.initializeAuthorizationRequest=function(e,t){return a(this,void 0,void 0,(function(){var n,r,o,a,c,u,l;return s(this,(function(s){switch(s.label){case 0:return this.logger.verbose("initializeAuthorizationRequest called"),n=this.getRedirectUri(e.redirectUri),r={interactionType:t},o=ee.C.setRequestState(this.browserCrypto,e&&e.state||"",r),c=[{}],[4,this.initializeBaseRequest(e)];case 1:return a=i.apply(void 0,[i.apply(void 0,c.concat([s.sent()])),{redirectUri:n,state:o,nonce:e.nonce||this.browserCrypto.createNewGuid(),responseMode:v.vw.FRAGMENT}]),(u=e.account||this.browserStorage.getActiveAccount())&&(this.logger.verbose("Setting validated request account"),this.logger.verbosePii("Setting validated request account: "+u),a.account=u),P.x.isEmpty(a.loginHint)&&!u&&(l=this.browserStorage.getLegacyLoginHint())&&(a.loginHint=l),this.browserStorage.updateCacheEntries(a.state,a.nonce,a.authority,a.loginHint||"",a.account||null),[2,a]}}))}))},t}(function(){function e(e,t,n,r,o,i){this.config=e,this.browserStorage=t,this.browserCrypto=n,this.networkClient=this.config.system.networkClient,this.eventHandler=o,this.correlationId=i||this.browserCrypto.createNewGuid(),this.logger=r.clone(y,ye,this.correlationId)}return e.prototype.clearCacheOnLogout=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:if(!e)return[3,5];V.r.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null)),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.browserStorage.removeAccount(V.r.generateAccountCacheKey(e))];case 2:return t.sent(),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request."),[3,4];case 3:return t.sent(),this.logger.error("Account provided in logout request was not found. Local cache unchanged."),[3,4];case 4:return[3,9];case 5:return t.trys.push([5,8,,9]),[4,this.browserStorage.clear()];case 6:return t.sent(),[4,this.browserCrypto.clearKeystore()];case 7:return t.sent(),this.logger.verbose("No account provided in logout request, clearing all cache items."),[3,9];case 8:return t.sent(),this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged."),[3,9];case 9:return[2]}}))}))},e.prototype.initializeBaseRequest=function(e){return a(this,void 0,void 0,(function(){var t,n,r;return s(this,(function(o){switch(o.label){case 0:if(this.logger.verbose("Initializing BaseAuthRequest"),t=e.authority||this.config.auth.authority,n=u(e&&e.scopes||[]),e.authenticationScheme){if(e.authenticationScheme===v.hO.SSH){if(!e.sshJwk)throw be.r.createMissingSshJwkError();if(!e.sshKid)throw be.r.createMissingSshKidError()}this.logger.verbose('Authentication Scheme set to "'+e.authenticationScheme+'" as configured in Auth request')}else e.authenticationScheme=v.hO.BEARER,this.logger.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return!e.claims||P.x.isEmpty(e.claims)?[3,2]:(r=e,[4,this.browserCrypto.hashString(e.claims)]);case 1:r.requestedClaimsHash=o.sent(),o.label=2;case 2:return[2,i(i({},e),{correlationId:this.correlationId,authority:t,scopes:n})]}}))}))},e.prototype.getRedirectUri=function(e){this.logger.verbose("getRedirectUri called");var t=e||this.config.auth.redirectUri||ge.getCurrentUri();return se.G.getAbsoluteUrl(t,ge.getCurrentUri())},e.prototype.initializeServerTelemetryManager=function(e,t){this.logger.verbose("initializeServerTelemetryManager called");var n={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new Se.d(n,this.browserStorage)},e}()),Ae=function(){function e(e,t){this.browserStorage=e,this.logger=t,this.unloadWindow=this.unloadWindow.bind(this)}return e.prototype.openPopup=function(t,n){try{var r=void 0;if(n.popup?(r=n.popup,this.logger.verbosePii("Navigating popup window to: "+t),r.location.assign(t)):void 0===n.popup&&(this.logger.verbosePii("Opening popup window to: "+t),r=e.openSizedPopup(t,n.popupName,n.popupWindowAttributes,this.logger)),!r)throw N.createEmptyWindowCreatedError();return r.focus&&r.focus(),this.currentWindow=r,window.addEventListener("beforeunload",this.unloadWindow),r}catch(e){throw this.logger.error("error opening popup "+e.message),this.browserStorage.setInteractionInProgress(!1),N.createPopupWindowError(e.toString())}},e.openSizedPopup=function(e,t,n,r){var o,i,a,s,c=window.screenLeft?window.screenLeft:window.screenX,u=window.screenTop?window.screenTop:window.screenY,l=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,d=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,p=null===(o=n.popupSize)||void 0===o?void 0:o.width,h=null===(i=n.popupSize)||void 0===i?void 0:i.height,f=null===(a=n.popupPosition)||void 0===a?void 0:a.top,g=null===(s=n.popupPosition)||void 0===s?void 0:s.left;return(!p||p<0||p>l)&&(r.verbose("Default popup window width used. Window width not configured or invalid."),p=483),(!h||h<0||h>d)&&(r.verbose("Default popup window height used. Window height not configured or invalid."),h=600),(!f||f<0||f>d)&&(r.verbose("Default popup window top position used. Window top not configured or invalid."),f=Math.max(0,d/2-300+u)),(!g||g<0||g>l)&&(r.verbose("Default popup window left position used. Window left not configured or invalid."),g=Math.max(0,l/2-241.5+c)),window.open(e,t,"width="+p+", height="+h+", top="+f+", left="+g+", scrollbars=yes")},e.prototype.unloadWindow=function(e){this.browserStorage.cleanRequestByInteractionType(g.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()},e.prototype.cleanPopup=function(e){e&&e.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)},e.prototype.monitorPopupForSameOrigin=function(e){var t=this;return new Promise((function(n,r){var o=setInterval((function(){if(e.closed)return t.cleanPopup(),clearInterval(o),void r(N.createUserCancelledError());var i=v.gT.EMPTY_STRING;try{i=e.location.href}catch(e){}P.x.isEmpty(i)||"about:blank"===i||(clearInterval(o),n())}),50)}))},e.generatePopupName=function(e,t){return"msal."+e+"."+t.scopes.join("-")+"."+t.authority+"."+t.correlationId},e.generateLogoutPopupName=function(e,t){return"msal."+e+"."+(t.account&&t.account.homeAccountId)+"."+t.correlationId},e}(),_e=function(){function e(e,t,n,r){this.authModule=e,this.browserStorage=t,this.authCodeRequest=n,this.browserRequestLogger=r}return e.prototype.handleCodeResponseFromHash=function(e,t,n,r){return a(this,void 0,void 0,(function(){var o,i,a;return s(this,(function(s){if(this.browserRequestLogger.verbose("InteractionHandler.handleCodeResponse called"),P.x.isEmpty(e))throw N.createEmptyHashError(e);if(o=this.browserStorage.generateStateKey(t),!(i=this.browserStorage.getTemporaryCache(o)))throw ae.e.createStateNotFoundError("Cached State");return a=this.authModule.handleFragmentResponse(e,i),[2,this.handleCodeResponseFromServer(a,t,n,r)]}))}))},e.prototype.handleCodeResponseFromServer=function(e,t,n,r,o){return void 0===o&&(o=!0),a(this,void 0,void 0,(function(){var i,a,c,u,l,d;return s(this,(function(s){switch(s.label){case 0:if(this.browserRequestLogger.trace("InteractionHandler.handleCodeResponseFromServer called"),i=this.browserStorage.generateStateKey(t),!(a=this.browserStorage.getTemporaryCache(i)))throw ae.e.createStateNotFoundError("Cached State");return c=this.browserStorage.generateNonceKey(a),u=this.browserStorage.getTemporaryCache(c),this.authCodeRequest.code=e.code,e.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(e.cloud_instance_host_name,n,r)]:[3,2];case 1:s.sent(),s.label=2;case 2:return o&&(e.nonce=u||void 0),e.state=a,e.client_info?this.authCodeRequest.clientInfo=e.client_info:(l=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=l),[4,this.authModule.acquireToken(this.authCodeRequest,e)];case 3:return d=s.sent(),this.browserStorage.cleanRequestByState(t),[2,d]}}))}))},e.prototype.updateTokenEndpointAuthority=function(e,t,n){return a(this,void 0,void 0,(function(){var r,o;return s(this,(function(i){switch(i.label){case 0:return r="https://"+e+"/"+t.tenant+"/",[4,we.A.createDiscoveredInstance(r,n,this.browserStorage,t.options)];case 1:return o=i.sent(),this.authModule.updateAuthority(o),[2]}}))}))},e.prototype.checkCcsCredentials=function(){var e=this.browserStorage.getTemporaryCache(p.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch(t){this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii("Cache credential could not be parsed: "+e)}return null},e}(),Re=function(e){function t(t,n,r,o){var i=e.call(this,t,n,r,o)||this;return i.popupUtils=new Ae(n,o),i}return o(t,e),t.prototype.initiateAuthRequest=function(e,t){if(P.x.isEmpty(e))throw this.browserRequestLogger.error("Navigate url is empty"),N.createEmptyNavigationUriError();return this.browserStorage.setInteractionInProgress(!0),this.browserRequestLogger.infoPii("Navigate to: "+e),this.popupUtils.openPopup(e,t)},t.prototype.monitorPopupForHash=function(e){var t=this;return this.popupUtils.monitorPopupForSameOrigin(e).then((function(){var n=e.location.hash;if(ge.clearHash(e),t.popupUtils.cleanPopup(e),!n)throw N.createEmptyHashError(e.location.href);if(se.G.hashContainsKnownProperties(n))return n;throw N.createHashDoesNotContainKnownPropertiesError()}))},t}(_e),Pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.acquireToken=function(e){return a(this,void 0,void 0,(function(){var t,n,r,o,i;return s(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,this.preflightInteractiveRequest(e,g.Popup)];case 1:return t=a.sent(),n=Ae.generatePopupName(this.config.auth.clientId,t),r=e.popupWindowAttributes||{},this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true, acquiring token"),[2,this.acquireTokenPopupAsync(t,n,r)]):(this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),o=Ae.openSizedPopup("about:blank",n,r,this.logger),[2,this.acquireTokenPopupAsync(t,n,r,o)]);case 2:return i=a.sent(),[2,Promise.reject(i)];case 3:return[2]}}))}))},t.prototype.logout=function(e){try{this.logger.verbose("logoutPopup called");var t=this.initializeLogoutRequest(e),n=Ae.generateLogoutPopupName(this.config.auth.clientId,t),r=e&&e.authority,o=e&&e.mainWindowRedirectUri,i=(null==e?void 0:e.popupWindowAttributes)||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,n,i,r,void 0,o);this.logger.verbose("asyncPopup set to false, opening popup");var a=Ae.openSizedPopup("about:blank",n,i,this.logger);return this.logoutPopupAsync(t,n,i,r,a,o)}catch(e){return Promise.reject(e)}},t.prototype.acquireTokenPopupAsync=function(e,t,n,r){return a(this,void 0,void 0,(function(){var o,i,a,c,u,l,d,p,h,m;return s(this,(function(s){switch(s.label){case 0:this.logger.verbose("acquireTokenPopupAsync called"),o=this.initializeServerTelemetryManager(f.acquireTokenPopup),s.label=1;case 1:return s.trys.push([1,7,,8]),[4,this.initializeAuthorizationCodeRequest(e)];case 2:return i=s.sent(),[4,this.createAuthCodeClient(o,e.authority)];case 3:return a=s.sent(),this.logger.verbose("Auth code client created"),[4,a.getAuthCodeUrl(e)];case 4:return c=s.sent(),u=new Re(a,this.browserStorage,i,this.logger),l={popup:r,popupName:t,popupWindowAttributes:n},d=u.initiateAuthRequest(c,l),this.eventHandler.emitEvent(w.POPUP_OPENED,g.Popup,{popupWindow:d},null),[4,u.monitorPopupForHash(d)];case 5:return p=s.sent(),h=this.validateAndExtractStateFromHash(p,g.Popup,e.correlationId),Ee.v.removeThrottle(this.browserStorage,this.config.auth.clientId,i),[4,u.handleCodeResponseFromHash(p,h,a.authority,this.networkClient)];case 6:return[2,s.sent()];case 7:throw m=s.sent(),r&&r.close(),m instanceof k.l&&m.setCorrelationId(this.correlationId),o.cacheFailedRequest(m),this.browserStorage.cleanRequestByState(e.state),m;case 8:return[2]}}))}))},t.prototype.logoutPopupAsync=function(e,t,n,r,o,i){return a(this,void 0,void 0,(function(){var a,c,u,l,d,p,h,m,v;return s(this,(function(s){switch(s.label){case 0:this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(w.LOGOUT_START,g.Popup,e),a=this.initializeServerTelemetryManager(f.logoutPopup),s.label=1;case 1:return s.trys.push([1,8,,9]),[4,this.clearCacheOnLogout(e.account)];case 2:return s.sent(),this.browserStorage.setInteractionInProgress(!0),[4,this.createAuthCodeClient(a,r)];case 3:c=s.sent(),this.logger.verbose("Auth code client created"),u=c.getLogoutUri(e),this.eventHandler.emitEvent(w.LOGOUT_SUCCESS,g.Popup,e),l=new Ae(this.browserStorage,this.logger),d=l.openPopup(u,{popupName:t,popupWindowAttributes:n,popup:o}),this.eventHandler.emitEvent(w.POPUP_OPENED,g.Popup,{popupWindow:d},null),s.label=4;case 4:return s.trys.push([4,6,,7]),[4,l.monitorPopupForSameOrigin(d)];case 5:return s.sent(),this.logger.verbose("Popup successfully redirected to postLogoutRedirectUri"),[3,7];case 6:return p=s.sent(),this.logger.verbose("Error occurred while monitoring popup for same origin. Session on server may remain active. Error: "+p),[3,7];case 7:return l.cleanPopup(d),i?(h={apiId:f.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},m=se.G.getAbsoluteUrl(i,ge.getCurrentUri()),this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii("Redirecing main window to: "+m),this.navigationClient.navigateInternal(m,h)):this.logger.verbose("No main window navigation requested"),[3,9];case 8:throw v=s.sent(),o&&o.close(),v instanceof k.l&&v.setCorrelationId(this.correlationId),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(w.LOGOUT_FAILURE,g.Popup,null,v),this.eventHandler.emitEvent(w.LOGOUT_END,g.Popup),a.cacheFailedRequest(v),v;case 9:return this.eventHandler.emitEvent(w.LOGOUT_END,g.Popup),[2]}}))}))},t}(Ie),ke=function(e){function t(t,n,r,o,i){var a=e.call(this,t,n,r,o)||this;return a.browserCrypto=i,a}return o(t,e),t.prototype.initiateAuthRequest=function(e,t){return a(this,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:return this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest called"),P.x.isEmpty(e)?[3,7]:(t.redirectStartPage&&(this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(p.ORIGIN_URI,t.redirectStartPage,!0)),this.browserStorage.setInteractionInProgress(!0),this.browserStorage.setTemporaryCache(p.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest,this.browserCrypto),this.browserRequestLogger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to: "+e),n={apiId:f.acquireTokenRedirect,timeout:t.redirectTimeout,noHistory:!1},"function"!=typeof t.onRedirectNavigate?[3,4]:(this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1===t.onRedirectNavigate(e)?[3,2]:(this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),[4,t.navigationClient.navigateExternal(e,n)])));case 1:case 5:return r.sent(),[2];case 2:return this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation"),[2];case 3:return[3,6];case 4:return this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),[4,t.navigationClient.navigateExternal(e,n)];case 6:return[3,8];case 7:throw this.browserRequestLogger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),N.createEmptyNavigationUriError();case 8:return[2]}}))}))},t.prototype.handleCodeResponseFromHash=function(e,t,n,r,o){return a(this,void 0,void 0,(function(){var i,a,c,u,l,d,p;return s(this,(function(s){switch(s.label){case 0:if(this.browserRequestLogger.verbose("RedirectHandler.handleCodeResponse called"),P.x.isEmpty(e))throw N.createEmptyHashError(e);if(this.browserStorage.setInteractionInProgress(!1),i=this.browserStorage.generateStateKey(t),!(a=this.browserStorage.getTemporaryCache(i)))throw ae.e.createStateNotFoundError("Cached State");return c=this.authModule.handleFragmentResponse(e,a),u=this.browserStorage.generateNonceKey(a),l=this.browserStorage.getTemporaryCache(u),this.authCodeRequest.code=c.code,c.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(c.cloud_instance_host_name,n,r)]:[3,2];case 1:s.sent(),s.label=2;case 2:return c.nonce=l||void 0,c.state=a,c.client_info?this.authCodeRequest.clientInfo=c.client_info:(d=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=d),o&&Ee.v.removeThrottle(this.browserStorage,o,this.authCodeRequest),[4,this.authModule.acquireToken(this.authCodeRequest,c)];case 3:return p=s.sent(),this.browserStorage.cleanRequestByState(t),[2,p]}}))}))},t}(_e),Oe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.acquireToken=function(e){return a(this,void 0,void 0,(function(){var t,n,r,o,i,a,c,u;return s(this,(function(s){switch(s.label){case 0:return[4,this.preflightInteractiveRequest(e,g.Redirect)];case 1:t=s.sent(),n=this.initializeServerTelemetryManager(f.acquireTokenRedirect),s.label=2;case 2:return s.trys.push([2,7,,8]),[4,this.initializeAuthorizationCodeRequest(t)];case 3:return r=s.sent(),[4,this.createAuthCodeClient(n,t.authority)];case 4:return o=s.sent(),this.logger.verbose("Auth code client created"),i=new ke(o,this.browserStorage,r,this.logger,this.browserCrypto),[4,o.getAuthCodeUrl(t)];case 5:return a=s.sent(),c=this.getRedirectStartPage(e.redirectStartPage),this.logger.verbosePii("Redirect start page: "+c),[4,i.initiateAuthRequest(a,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:c,onRedirectNavigate:e.onRedirectNavigate})];case 6:return[2,s.sent()];case 7:throw(u=s.sent())instanceof k.l&&u.setCorrelationId(this.correlationId),n.cacheFailedRequest(u),this.browserStorage.cleanRequestByState(t.state),u;case 8:return[2]}}))}))},t.prototype.handleRedirectPromise=function(e){return a(this,void 0,void 0,(function(){var t,n,r,o,i,a,c,u,l,d,h;return s(this,(function(s){switch(s.label){case 0:t=this.initializeServerTelemetryManager(f.handleRedirectPromise),s.label=1;case 1:if(s.trys.push([1,10,,11]),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(n=this.getRedirectResponseHash(e||window.location.hash)))return this.logger.info("handleRedirectPromise did not detect a response hash as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(g.Redirect),[2,null];r=void 0;try{r=this.validateAndExtractStateFromHash(n,g.Redirect),ge.clearHash(window),this.logger.verbose("State extracted from hash")}catch(e){return this.logger.info("handleRedirectPromise was unable to extract state due to: "+e),this.browserStorage.cleanRequestByInteractionType(g.Redirect),[2,null]}return o=this.browserStorage.getTemporaryCache(p.ORIGIN_URI,!0)||"",i=se.G.removeHashFromUrl(o),a=se.G.removeHashFromUrl(window.location.href),i===a&&this.config.auth.navigateToLoginRequestUrl?(this.logger.verbose("Current page is loginRequestUrl, handling hash"),[4,this.handleHash(n,r,t)]):[3,3];case 2:return c=s.sent(),o.indexOf("#")>-1&&ge.replaceHash(o),[2,c];case 3:return this.config.auth.navigateToLoginRequestUrl?[3,4]:(this.logger.verbose("NavigateToLoginRequestUrl set to false, handling hash"),[2,this.handleHash(n,r,t)]);case 4:return ge.isInIframe()&&!this.config.system.allowRedirectInIframe?[3,9]:(this.browserStorage.setTemporaryCache(p.URL_HASH,n,!0),u={apiId:f.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0},l=!0,o&&"null"!==o?[3,6]:(d=ge.getHomepage(),this.browserStorage.setTemporaryCache(p.ORIGIN_URI,d,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),[4,this.navigationClient.navigateInternal(d,u)]));case 5:return l=s.sent(),[3,8];case 6:return this.logger.verbose("Navigating to loginRequestUrl: "+o),[4,this.navigationClient.navigateInternal(o,u)];case 7:l=s.sent(),s.label=8;case 8:if(!l)return[2,this.handleHash(n,r,t)];s.label=9;case 9:return[2,null];case 10:throw(h=s.sent())instanceof k.l&&h.setCorrelationId(this.correlationId),t.cacheFailedRequest(h),this.browserStorage.cleanRequestByInteractionType(g.Redirect),h;case 11:return[2]}}))}))},t.prototype.getRedirectResponseHash=function(e){this.logger.verbose("getRedirectResponseHash called");var t=se.G.hashContainsKnownProperties(e),n=this.browserStorage.getTemporaryCache(p.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(p.URL_HASH)),t?(this.logger.verbose("Hash contains known properties, returning response hash"),e):(this.logger.verbose("Hash does not contain known properties, returning cached hash"),n)},t.prototype.handleHash=function(e,t,n){return a(this,void 0,void 0,(function(){var r,o,i;return s(this,(function(a){switch(a.label){case 0:if(r=this.browserStorage.getCachedRequest(t,this.browserCrypto),this.logger.verbose("handleHash called, retrieved cached request"),!(o=this.browserStorage.getCachedAuthority(t)))throw N.createNoCachedAuthorityError();return[4,this.createAuthCodeClient(n,o)];case 1:return i=a.sent(),this.logger.verbose("Auth code client created"),[4,new ke(i,this.browserStorage,r,this.logger,this.browserCrypto).handleCodeResponseFromHash(e,t,i.authority,this.networkClient,this.config.auth.clientId)];case 2:return[2,a.sent()]}}))}))},t.prototype.logout=function(e){return a(this,void 0,void 0,(function(){var t,n,r,o,i,a;return s(this,(function(s){switch(s.label){case 0:this.logger.verbose("logoutRedirect called"),t=this.initializeLogoutRequest(e),n=this.initializeServerTelemetryManager(f.logout),s.label=1;case 1:return s.trys.push([1,10,,11]),this.eventHandler.emitEvent(w.LOGOUT_START,g.Redirect,e),[4,this.clearCacheOnLogout(t.account)];case 2:return s.sent(),r={apiId:f.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},[4,this.createAuthCodeClient(n,e&&e.authority)];case 3:return o=s.sent(),this.logger.verbose("Auth code client created"),i=o.getLogoutUri(t),this.eventHandler.emitEvent(w.LOGOUT_SUCCESS,g.Redirect,t),e&&"function"==typeof e.onRedirectNavigate?!1===e.onRedirectNavigate(i)?[3,5]:(this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),[4,this.navigationClient.navigateExternal(i,r)]):[3,7];case 4:return s.sent(),[2];case 5:this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation"),s.label=6;case 6:return[3,9];case 7:return[4,this.navigationClient.navigateExternal(i,r)];case 8:return s.sent(),[2];case 9:return[3,11];case 10:throw(a=s.sent())instanceof k.l&&a.setCorrelationId(this.correlationId),n.cacheFailedRequest(a),this.eventHandler.emitEvent(w.LOGOUT_FAILURE,g.Redirect,null,a),this.eventHandler.emitEvent(w.LOGOUT_END,g.Redirect),a;case 11:return this.eventHandler.emitEvent(w.LOGOUT_END,g.Redirect),[2]}}))}))},t.prototype.getRedirectStartPage=function(e){var t=e||window.location.href;return se.G.getAbsoluteUrl(t,ge.getCurrentUri())},t}(Ie),Ne=function(e){function t(t,n,r,o,i){var a=e.call(this,t,n,r,o)||this;return a.navigateFrameWait=i,a}return o(t,e),t.prototype.initiateAuthRequest=function(e){return a(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:if(P.x.isEmpty(e))throw this.browserRequestLogger.info("Navigate url is empty"),N.createEmptyNavigationUriError();return this.navigateFrameWait?[4,this.loadFrame(e)]:[3,2];case 1:return t=n.sent(),[3,3];case 2:t=this.loadFrameSync(e),n.label=3;case 3:return[2,t]}}))}))},t.prototype.monitorIframeForHash=function(e,t){var n=this;return new Promise((function(r,o){t<6e3&&n.browserRequestLogger.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower ("+t+"ms) than the default (6000ms). This may result in timeouts.");var i=window.performance.now()+t,a=setInterval((function(){if(window.performance.now()>i)return n.removeHiddenIframe(e),clearInterval(a),void o(N.createMonitorIframeTimeoutError());var t=v.gT.EMPTY_STRING,s=e.contentWindow;try{t=s?s.location.href:v.gT.EMPTY_STRING}catch(e){}if(!P.x.isEmpty(t)){var c=s?s.location.hash:v.gT.EMPTY_STRING;return se.G.hashContainsKnownProperties(c)?(n.removeHiddenIframe(e),clearInterval(a),void r(c)):void 0}}),50)}))},t.prototype.loadFrame=function(e){var t=this;return new Promise((function(n,r){var o=t.createHiddenIframe();setTimeout((function(){o?(o.src=e,n(o)):r("Unable to load iframe")}),t.navigateFrameWait)}))},t.prototype.loadFrameSync=function(e){var t=this.createHiddenIframe();return t.src=e,t},t.prototype.createHiddenIframe=function(){var e=document.createElement("iframe");return e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(e),e},t.prototype.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},t}(_e),Me=function(e){function t(t,n,r,o,i,a,s,c){var u=e.call(this,t,n,r,o,i,a,c)||this;return u.apiId=s,u}return o(t,e),t.prototype.acquireToken=function(e){return a(this,void 0,void 0,(function(){var t,n,r,o,a,c;return s(this,(function(s){switch(s.label){case 0:if(this.logger.verbose("acquireTokenByIframe called"),P.x.isEmpty(e.loginHint)&&P.x.isEmpty(e.sid)&&(!e.account||P.x.isEmpty(e.account.username))&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request."),e.prompt&&e.prompt!==v.NJ.NONE)throw N.createSilentPromptValueError(e.prompt);return[4,this.initializeAuthorizationRequest(i(i({},e),{prompt:v.NJ.NONE}),g.Silent)];case 1:t=s.sent(),n=this.initializeServerTelemetryManager(this.apiId),s.label=2;case 2:return s.trys.push([2,7,,8]),[4,this.initializeAuthorizationCodeRequest(t)];case 3:return r=s.sent(),[4,this.createAuthCodeClient(n,t.authority)];case 4:return o=s.sent(),this.logger.verbose("Auth code client created"),[4,o.getAuthCodeUrl(t)];case 5:return a=s.sent(),[4,this.silentTokenHelper(a,r,o,this.logger)];case 6:return[2,s.sent()];case 7:throw(c=s.sent())instanceof k.l&&c.setCorrelationId(this.correlationId),n.cacheFailedRequest(c),this.browserStorage.cleanRequestByState(t.state),c;case 8:return[2]}}))}))},t.prototype.logout=function(){return Promise.reject(N.createSilentLogoutUnsupportedError())},t.prototype.silentTokenHelper=function(e,t,n,r){return a(this,void 0,void 0,(function(){var o,i,a,c;return s(this,(function(s){switch(s.label){case 0:return[4,(o=new Ne(n,this.browserStorage,t,r,this.config.system.navigateFrameWait)).initiateAuthRequest(e)];case 1:return i=s.sent(),[4,o.monitorIframeForHash(i,this.config.system.iframeHashTimeout)];case 2:return a=s.sent(),c=this.validateAndExtractStateFromHash(a,g.Silent,t.correlationId),[2,o.handleCodeResponseFromHash(a,c,n.authority,this.networkClient)]}}))}))},t}(Ie),xe=n(28508),Fe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.acquireToken=function(e){return a(this,void 0,void 0,(function(){var t,n,r,o,a=this;return s(this,(function(s){switch(s.label){case 0:return n=[i({},e)],[4,this.initializeBaseRequest(e)];case 1:return t=i.apply(void 0,n.concat([s.sent()])),r=this.initializeServerTelemetryManager(f.acquireTokenSilent_silentFlow),[4,this.createRefreshTokenClient(r,t.authority)];case 2:return o=s.sent(),this.logger.verbose("Refresh token client created"),[2,o.acquireTokenByRefreshToken(t).catch((function(e){throw e instanceof k.l&&e.setCorrelationId(a.correlationId),r.cacheFailedRequest(e),e}))]}}))}))},t.prototype.logout=function(){return Promise.reject(N.createSilentLogoutUnsupportedError())},t.prototype.createRefreshTokenClient=function(e,t){return a(this,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:return[4,this.getClientConfiguration(e,t)];case 1:return n=r.sent(),[2,new xe.Y(n)]}}))}))},t}(Ie),Le=n(95622),Ue=n(92613),De=function(){function e(e,t,n,r){this.isBrowserEnvironment="undefined"!=typeof window,this.config=e,this.storage=t,this.logger=n,this.cryptoObj=r}return e.prototype.loadExternalTokens=function(e,t,n){if(this.logger.info("TokenCache - loadExternalTokens called"),!t.id_token)throw N.createUnableToLoadTokenError("Please ensure server response includes id token.");if(e.account)this.loadIdToken(t.id_token,e.account.homeAccountId,e.account.environment,e.account.tenantId,n),this.loadAccessToken(e,t,e.account.homeAccountId,e.account.environment,e.account.tenantId,n);else{if(!e.authority)throw N.createUnableToLoadTokenError("Please provide a request with an account or a request with authority.");var r={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},o=new Le.W(e.authority,this.config.system.networkClient,this.storage,r);if(n.clientInfo)this.logger.trace("TokenCache - homeAccountId from options"),this.loadIdToken(t.id_token,n.clientInfo,o.hostnameAndPort,o.tenant,n),this.loadAccessToken(e,t,n.clientInfo,o.hostnameAndPort,o.tenant,n);else{if(!t.client_info)throw N.createUnableToLoadTokenError("Please provide clientInfo in the response or options.");this.logger.trace("TokenCache - homeAccountId from response"),this.loadIdToken(t.id_token,t.client_info,o.hostnameAndPort,o.tenant,n),this.loadAccessToken(e,t,t.client_info,o.hostnameAndPort,o.tenant,n)}}},e.prototype.loadIdToken=function(e,t,n,r,o){var i=W.w.createIdTokenEntity(t,n,e,this.config.auth.clientId,r),a=new ne.H(e,this.cryptoObj),s=o.clientInfo?V.r.createAccount(o.clientInfo,t,a,void 0,void 0,void 0,void 0,n):V.r.createGenericAccount(t,a,void 0,void 0,void 0,void 0,n);if(!this.isBrowserEnvironment)throw N.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.");this.logger.verbose("TokenCache - loading id token"),this.storage.setAccount(s),this.storage.setIdTokenCredential(i)},e.prototype.loadAccessToken=function(e,t,n,r,o,i){if(t.access_token){if(!t.expires_in)throw N.createUnableToLoadTokenError("Please ensure server response includes expires_in value.");if(!i.extendedExpiresOn)throw N.createUnableToLoadTokenError("Please provide an extendedExpiresOn value in the options.");var a=new Ue.i(e.scopes).printScopes(),s=t.expires_in,c=i.extendedExpiresOn,u=J._.createAccessTokenEntity(n,r,t.access_token,this.config.auth.clientId,o,a,s,c,this.cryptoObj);if(!this.isBrowserEnvironment)throw N.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.");this.logger.verbose("TokenCache - loading access token"),this.storage.setAccessTokenCredential(u)}else this.logger.verbose("TokenCache - No access token provided for caching")},e}(),He=function(e){function t(t){var n=e.call(this,t)||this;return n.includeRedirectUri=!1,n}return o(t,e),t}(Te.U),qe=function(e){function t(t,n,r,o,i,a,s,c){var u=e.call(this,t,n,r,o,i,a,c)||this;return u.apiId=s,u}return o(t,e),t.prototype.acquireToken=function(e){return a(this,void 0,void 0,(function(){var t,n,r,o,a,c;return s(this,(function(s){switch(s.label){case 0:if(this.logger.trace("SilentAuthCodeClient.acquireToken called"),!e.code)throw N.createAuthCodeRequiredError();return[4,this.initializeAuthorizationRequest(e,g.Silent)];case 1:t=s.sent(),n=this.initializeServerTelemetryManager(this.apiId),s.label=2;case 2:return s.trys.push([2,4,,5]),r=i(i({},t),{code:e.code}),[4,this.getClientConfiguration(n,t.authority)];case 3:return o=s.sent(),a=new He(o),this.logger.verbose("Auth code client created"),[2,new Ne(a,this.browserStorage,r,this.logger,this.config.system.navigateFrameWait).handleCodeResponseFromServer({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t.state,a.authority,this.networkClient,!1)];case 4:throw(c=s.sent())instanceof k.l&&c.setCorrelationId(this.correlationId),n.cacheFailedRequest(c),this.browserStorage.cleanRequestByState(t.state),c;case 5:return[2]}}))}))},t.prototype.logout=function(){return Promise.reject(N.createSilentLogoutUnsupportedError())},t}(Ie),Be=function(){function e(e){var t,n,r,o,a,s,c,u,d,p,h,f;this.isBrowserEnvironment="undefined"!=typeof window,this.config=(t=e,n=this.isBrowserEnvironment,r=t.auth,o=t.cache,a=t.system,s={clientId:"",authority:""+v.gT.DEFAULT_AUTHORITY,knownAuthorities:[],cloudDiscoveryMetadata:"",authorityMetadata:"",redirectUri:"",postLogoutRedirectUri:"",navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:le.A.AAD},c={cacheLocation:l.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1},u={loggerCallback:function(){},logLevel:B.i.Info,piiLoggingEnabled:!1},d=i(i({},de.z),{loggerOptions:u,networkClient:n?ge.getBrowserNetworkClient():pe.y,navigationClient:new me,loadFrameTimeout:0,windowHashTimeout:a&&a.loadFrameTimeout||6e4,iframeHashTimeout:a&&a.loadFrameTimeout||6e3,navigateFrameWait:n&&ge.detectIEOrEdge()?500:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1}),{auth:i(i({},s),r),cache:i(i({},c),o),system:i(i({},d),a)}),this.logger=new B.Y(this.config.system.loggerOptions,ve,ye),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.browserCrypto=this.isBrowserEnvironment?new q(this.logger):G.d,this.eventHandler=new Ce(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new ue(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger):(p=this.config.auth.clientId,h=this.logger,f={cacheLocation:l.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1},new ue(p,f,G.d,h)),this.tokenCache=new De(this.config,this.browserStorage,this.logger,this.browserCrypto)}return e.prototype.handleRedirectPromise=function(e){return a(this,void 0,void 0,(function(){var t,n,r,o,i,a=this;return s(this,(function(s){return this.logger.verbose("handleRedirectPromise called"),t=this.getAllAccounts(),this.isBrowserEnvironment?(n=e||v.gT.EMPTY_STRING,void 0===(r=this.redirectResponse.get(n))?(this.eventHandler.emitEvent(w.HANDLE_REDIRECT_START,g.Redirect),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise"),o=this.browserStorage.getTemporaryCache(p.CORRELATION_ID,!0)||"",i=new Oe(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,o),r=i.handleRedirectPromise(e).then((function(e){return e&&(t.length<a.getAllAccounts().length?(a.eventHandler.emitEvent(w.LOGIN_SUCCESS,g.Redirect,e),a.logger.verbose("handleRedirectResponse returned result, login success")):(a.eventHandler.emitEvent(w.ACQUIRE_TOKEN_SUCCESS,g.Redirect,e),a.logger.verbose("handleRedirectResponse returned result, acquire token success"))),a.eventHandler.emitEvent(w.HANDLE_REDIRECT_END,g.Redirect),e})).catch((function(e){throw t.length>0?a.eventHandler.emitEvent(w.ACQUIRE_TOKEN_FAILURE,g.Redirect,null,e):a.eventHandler.emitEvent(w.LOGIN_FAILURE,g.Redirect,null,e),a.eventHandler.emitEvent(w.HANDLE_REDIRECT_END,g.Redirect),e})),this.redirectResponse.set(n,r)):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),[2,r]):(this.logger.verbose("handleRedirectPromise returns null, not browser environment"),[2,null])}))}))},e.prototype.acquireTokenRedirect=function(e){return a(this,void 0,void 0,(function(){var t,n=this;return s(this,(function(r){return this.preflightBrowserEnvironmentCheck(g.Redirect),this.logger.verbose("acquireTokenRedirect called"),(t=this.getAllAccounts().length>0)?this.eventHandler.emitEvent(w.ACQUIRE_TOKEN_START,g.Redirect,e):this.eventHandler.emitEvent(w.LOGIN_START,g.Redirect,e),[2,new Oe(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,e.correlationId).acquireToken(e).catch((function(e){throw t?n.eventHandler.emitEvent(w.ACQUIRE_TOKEN_FAILURE,g.Redirect,null,e):n.eventHandler.emitEvent(w.LOGIN_FAILURE,g.Redirect,null,e),e}))]}))}))},e.prototype.acquireTokenPopup=function(e){var t=this;try{this.preflightBrowserEnvironmentCheck(g.Popup),this.logger.verbose("acquireTokenPopup called",e.correlationId)}catch(e){return Promise.reject(e)}var n=this.getAllAccounts();return n.length>0?this.eventHandler.emitEvent(w.ACQUIRE_TOKEN_START,g.Popup,e):this.eventHandler.emitEvent(w.LOGIN_START,g.Popup,e),new Pe(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,e.correlationId).acquireToken(e).then((function(e){return n.length<t.getAllAccounts().length?t.eventHandler.emitEvent(w.LOGIN_SUCCESS,g.Popup,e):t.eventHandler.emitEvent(w.ACQUIRE_TOKEN_SUCCESS,g.Popup,e),e})).catch((function(e){return n.length>0?t.eventHandler.emitEvent(w.ACQUIRE_TOKEN_FAILURE,g.Popup,null,e):t.eventHandler.emitEvent(w.LOGIN_FAILURE,g.Popup,null,e),Promise.reject(e)}))},e.prototype.ssoSilent=function(e){return a(this,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:this.preflightBrowserEnvironmentCheck(g.Silent),this.logger.verbose("ssoSilent called",e.correlationId),this.eventHandler.emitEvent(w.SSO_SILENT_START,g.Silent,e),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,new Me(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,f.ssoSilent,e.correlationId).acquireToken(e)];case 2:return t=r.sent(),this.eventHandler.emitEvent(w.SSO_SILENT_SUCCESS,g.Silent,t),[2,t];case 3:throw n=r.sent(),this.eventHandler.emitEvent(w.SSO_SILENT_FAILURE,g.Silent,null,n),n;case 4:return[2]}}))}))},e.prototype.acquireTokenByCode=function(e){return a(this,void 0,void 0,(function(){var t,n=this;return s(this,(function(r){this.preflightBrowserEnvironmentCheck(g.Silent),this.logger.trace("acquireTokenByCode called",e.correlationId),this.eventHandler.emitEvent(w.ACQUIRE_TOKEN_BY_CODE_START,g.Silent,e);try{if(!e.code)throw N.createAuthCodeRequiredError();return(t=this.hybridAuthCodeResponses.get(e.code))?this.logger.verbose("Existing acquireTokenByCode request found",e.correlationId):(this.logger.verbose("Initiating new acquireTokenByCode request",e.correlationId),t=this.acquireTokenByCodeAsync(e).then((function(t){return n.eventHandler.emitEvent(w.ACQUIRE_TOKEN_BY_CODE_SUCCESS,g.Silent,t),n.hybridAuthCodeResponses.delete(e.code),t})).catch((function(t){throw n.hybridAuthCodeResponses.delete(e.code),t})),this.hybridAuthCodeResponses.set(e.code,t)),[2,t]}catch(e){throw this.eventHandler.emitEvent(w.ACQUIRE_TOKEN_BY_CODE_FAILURE,g.Silent,null,e),e}return[2]}))}))},e.prototype.acquireTokenByCodeAsync=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),[4,new qe(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,f.acquireTokenByCode,e.correlationId).acquireToken(e)];case 1:return[2,t.sent()]}}))}))},e.prototype.acquireTokenByRefreshToken=function(e){return a(this,void 0,void 0,(function(){var t=this;return s(this,(function(n){return this.eventHandler.emitEvent(w.ACQUIRE_TOKEN_NETWORK_START,g.Silent,e),ge.blockReloadInHiddenIframes(),[2,new Fe(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,e.correlationId).acquireToken(e).catch((function(n){var r=n instanceof j.n,o=n instanceof z.Yo,i="invalid_grant"===n.errorCode;if(r&&i&&!o)return t.logger.verbose("Refresh token expired or invalid, attempting acquire token by iframe",e.correlationId),new Me(t.config,t.browserStorage,t.browserCrypto,t.logger,t.eventHandler,t.navigationClient,f.acquireTokenSilent_authCode,e.correlationId).acquireToken(e);throw n}))]}))}))},e.prototype.logout=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead."),[2,this.logoutRedirect(e)]}))}))},e.prototype.logoutRedirect=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){return this.preflightBrowserEnvironmentCheck(g.Redirect),[2,new Oe(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,null==e?void 0:e.correlationId).logout(e)]}))}))},e.prototype.logoutPopup=function(e){try{return this.preflightBrowserEnvironmentCheck(g.Popup),new Pe(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,null==e?void 0:e.correlationId).logout(e)}catch(e){return Promise.reject(e)}},e.prototype.getAllAccounts=function(){return this.logger.verbose("getAllAccounts called"),this.isBrowserEnvironment?this.browserStorage.getAllAccounts():[]},e.prototype.getAccountByUsername=function(e){var t=this.getAllAccounts();return!P.x.isEmpty(e)&&t&&t.length?(this.logger.verbose("Account matching username found, returning"),this.logger.verbosePii("Returning signed-in accounts matching username: "+e),t.filter((function(t){return t.username.toLowerCase()===e.toLowerCase()}))[0]||null):(this.logger.verbose("getAccountByUsername: No matching account found, returning null"),null)},e.prototype.getAccountByHomeId=function(e){var t=this.getAllAccounts();return!P.x.isEmpty(e)&&t&&t.length?(this.logger.verbose("Account matching homeAccountId found, returning"),this.logger.verbosePii("Returning signed-in accounts matching homeAccountId: "+e),t.filter((function(t){return t.homeAccountId===e}))[0]||null):(this.logger.verbose("getAccountByHomeId: No matching account found, returning null"),null)},e.prototype.getAccountByLocalId=function(e){var t=this.getAllAccounts();return!P.x.isEmpty(e)&&t&&t.length?(this.logger.verbose("Account matching localAccountId found, returning"),this.logger.verbosePii("Returning signed-in accounts matching localAccountId: "+e),t.filter((function(t){return t.localAccountId===e}))[0]||null):(this.logger.verbose("getAccountByLocalId: No matching account found, returning null"),null)},e.prototype.setActiveAccount=function(e){this.browserStorage.setActiveAccount(e)},e.prototype.getActiveAccount=function(){return this.browserStorage.getActiveAccount()},e.prototype.preflightBrowserEnvironmentCheck=function(e){if(this.logger.verbose("preflightBrowserEnvironmentCheck started"),ge.blockNonBrowserEnvironment(this.isBrowserEnvironment),ge.blockRedirectInIframe(e,this.config.system.allowRedirectInIframe),ge.blockReloadInHiddenIframes(),ge.blockAcquireTokenInPopups(),e===g.Redirect&&this.config.cache.cacheLocation===l.MemoryStorage&&!this.config.cache.storeAuthStateInCookie)throw oe.createInMemoryRedirectUnavailableError()},e.prototype.addEventCallback=function(e){return this.eventHandler.addEventCallback(e)},e.prototype.removeEventCallback=function(e){this.eventHandler.removeEventCallback(e)},e.prototype.enableAccountStorageEvents=function(){this.eventHandler.enableAccountStorageEvents()},e.prototype.disableAccountStorageEvents=function(){this.eventHandler.disableAccountStorageEvents()},e.prototype.getTokenCache=function(){return this.tokenCache},e.prototype.getLogger=function(){return this.logger},e.prototype.setLogger=function(e){this.logger=e},e.prototype.initializeWrapperLibrary=function(e,t){this.browserStorage.setWrapperMetadata(e,t)},e.prototype.setNavigationClient=function(e){this.navigationClient=e},e.prototype.getConfiguration=function(){return this.config},e}(),Ge=n(43387),je=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.acquireToken=function(e){return a(this,void 0,void 0,(function(){var t,n,r,o;return s(this,(function(i){switch(i.label){case 0:return t=this.initializeServerTelemetryManager(f.acquireTokenSilent_silentFlow),[4,this.createSilentFlowClient(t,e.authority)];case 1:n=i.sent(),this.logger.verbose("Silent auth client created"),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,n.acquireCachedToken(e)];case 3:return r=i.sent(),this.eventHandler.emitEvent(w.ACQUIRE_TOKEN_SUCCESS,g.Silent,r),[2,r];case 4:throw(o=i.sent())instanceof N&&o.errorCode===O.signingKeyNotFoundInStorage.code&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),o;case 5:return[2]}}))}))},t.prototype.logout=function(){return Promise.reject(N.createSilentLogoutUnsupportedError())},t.prototype.createSilentFlowClient=function(e,t){return a(this,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:return[4,this.getClientConfiguration(e,t)];case 1:return n=r.sent(),[2,new Ge.g(n)]}}))}))},t.prototype.initializeSilentRequest=function(e,t){return a(this,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:return n=[i({},e)],[4,this.initializeBaseRequest(e)];case 1:return[2,i.apply(void 0,[i.apply(void 0,n.concat([r.sent()])),{account:t,forceRefresh:e.forceRefresh||!1}])]}}))}))},t}(Ie),ze=function(e){function t(t){var n=e.call(this,t)||this;return n.activeSilentTokenRequests=new Map,n}return o(t,e),t.prototype.loginRedirect=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){return this.logger.verbose("loginRedirect called"),[2,this.acquireTokenRedirect(e||E)]}))}))},t.prototype.loginPopup=function(e){return this.logger.verbose("loginPopup called"),this.acquireTokenPopup(e||E)},t.prototype.acquireTokenSilent=function(e){return a(this,void 0,void 0,(function(){var t,n,r,o,i,a=this;return s(this,(function(s){if(this.preflightBrowserEnvironmentCheck(g.Silent),this.logger.verbose("acquireTokenSilent called",e.correlationId),!(t=e.account||this.getActiveAccount()))throw N.createNoAccountError();return n={clientId:this.config.auth.clientId,authority:e.authority||"",scopes:e.scopes,homeAccountIdentifier:t.homeAccountId,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid},r=JSON.stringify(n),void 0===(o=this.activeSilentTokenRequests.get(r))?(this.logger.verbose("acquireTokenSilent called for the first time, storing active request",e.correlationId),i=this.acquireTokenSilentAsync(e,t).then((function(e){return a.activeSilentTokenRequests.delete(r),e})).catch((function(e){throw a.activeSilentTokenRequests.delete(r),e})),this.activeSilentTokenRequests.set(r,i),[2,i]):(this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",e.correlationId),[2,o])}))}))},t.prototype.acquireTokenSilentAsync=function(e,t){return a(this,void 0,void 0,(function(){var n,r,o=this;return s(this,(function(i){switch(i.label){case 0:return[4,(n=new je(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,e.correlationId)).initializeSilentRequest(e,t)];case 1:return r=i.sent(),this.eventHandler.emitEvent(w.ACQUIRE_TOKEN_START,g.Silent,e),[2,n.acquireToken(r).catch((function(){return a(o,void 0,void 0,(function(){var e,t;return s(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.acquireTokenByRefreshToken(r)];case 1:return e=n.sent(),this.eventHandler.emitEvent(w.ACQUIRE_TOKEN_SUCCESS,g.Silent,e),[2,e];case 2:throw t=n.sent(),this.eventHandler.emitEvent(w.ACQUIRE_TOKEN_FAILURE,g.Silent,null,t),t;case 3:return[2]}}))}))}))]}}))}))},t}(Be),Ve={acquireTokenPopup:function(){return Promise.reject(oe.createStubPcaInstanceCalledError())},acquireTokenRedirect:function(){return Promise.reject(oe.createStubPcaInstanceCalledError())},acquireTokenSilent:function(){return Promise.reject(oe.createStubPcaInstanceCalledError())},acquireTokenByCode:function(){return Promise.reject(oe.createStubPcaInstanceCalledError())},getAllAccounts:function(){return[]},getAccountByHomeId:function(){return null},getAccountByUsername:function(){return null},getAccountByLocalId:function(){return null},handleRedirectPromise:function(){return Promise.reject(oe.createStubPcaInstanceCalledError())},loginPopup:function(){return Promise.reject(oe.createStubPcaInstanceCalledError())},loginRedirect:function(){return Promise.reject(oe.createStubPcaInstanceCalledError())},logout:function(){return Promise.reject(oe.createStubPcaInstanceCalledError())},logoutRedirect:function(){return Promise.reject(oe.createStubPcaInstanceCalledError())},logoutPopup:function(){return Promise.reject(oe.createStubPcaInstanceCalledError())},ssoSilent:function(){return Promise.reject(oe.createStubPcaInstanceCalledError())},addEventCallback:function(){return null},removeEventCallback:function(){},enableAccountStorageEvents:function(){},disableAccountStorageEvents:function(){},getTokenCache:function(){throw oe.createStubPcaInstanceCalledError()},getLogger:function(){throw oe.createStubPcaInstanceCalledError()},setLogger:function(){},setActiveAccount:function(){},getActiveAccount:function(){return null},initializeWrapperLibrary:function(){},setNavigationClient:function(){},getConfiguration:function(){throw oe.createStubPcaInstanceCalledError()}},Ke=function(){function e(){}return e.getInteractionStatusFromEvent=function(e,t){switch(e.eventType){case w.LOGIN_START:return m.Login;case w.SSO_SILENT_START:return m.SsoSilent;case w.ACQUIRE_TOKEN_START:if(e.interactionType===g.Redirect||e.interactionType===g.Popup)return m.AcquireToken;break;case w.HANDLE_REDIRECT_START:return m.HandleRedirect;case w.LOGOUT_START:return m.Logout;case w.SSO_SILENT_SUCCESS:case w.SSO_SILENT_FAILURE:if(t&&t!==m.SsoSilent)break;return m.None;case w.LOGOUT_END:if(t&&t!==m.Logout)break;return m.None;case w.HANDLE_REDIRECT_END:if(t&&t!==m.HandleRedirect)break;return m.None;case w.LOGIN_SUCCESS:case w.LOGIN_FAILURE:case w.ACQUIRE_TOKEN_SUCCESS:case w.ACQUIRE_TOKEN_FAILURE:if(e.interactionType===g.Redirect||e.interactionType===g.Popup){if(t&&t!==m.Login&&t!==m.AcquireToken)break;return m.None}}return null},e}(),We=n(17650),Je=function(){function e(e,t){var n=t&&t.loggerOptions||{};this.logger=new B.Y(n,ve,ye),this.cryptoOps=new q(this.logger),this.popTokenGenerator=new We.$(this.cryptoOps),this.shrParameters=e}return e.prototype.generatePublicKeyThumbprint=function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this.popTokenGenerator.generateKid(this.shrParameters)];case 1:return[2,e.sent().kid]}}))}))},e.prototype.signRequest=function(e,t,n){return a(this,void 0,void 0,(function(){return s(this,(function(r){return[2,this.popTokenGenerator.signPayload(e,t,this.shrParameters,n)]}))}))},e.prototype.removeKeys=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.cryptoOps.removeTokenBindingKey(e)];case 1:return[2,t.sent()]}}))}))},e}(),Ye=n(32030)},5096:(e,t,n)=>{"use strict";n.d(t,{pi:()=>i,mG:()=>a,ZT:()=>o,Jh:()=>s,pr:()=>c});var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)};function o(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=function(){return i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)};function a(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))}function s(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function c(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}},70591:(e,t,n)=>{"use strict";n.d(t,{H:()=>i});var r=n(60742),o=n(61653),i=function(){function e(t,n){if(o.x.isEmpty(t))throw r.e.createTokenNullOrEmptyError(t);this.rawToken=t,this.claims=e.extractTokenClaims(t,n)}return e.extractTokenClaims=function(e,t){var n=o.x.decodeAuthToken(e);try{var i=n.JWSPayload,a=t.base64Decode(i);return JSON.parse(a)}catch(e){throw r.e.createTokenParsingError(e)}},e}()},34726:(e,t,n)=>{"use strict";var r;n.d(t,{G:()=>r}),function(e){e.HOME_ACCOUNT_ID="home_account_id",e.UPN="UPN"}(r||(r={}))},11520:(e,t,n)=>{"use strict";n.d(t,{B:()=>a,j:()=>s});var r=n(60742),o=n(61653),i=n(77891);function a(e,t){if(o.x.isEmpty(e))throw r.e.createClientInfoEmptyError();try{var n=t.base64Decode(e);return JSON.parse(n)}catch(e){throw r.e.createClientInfoDecodingError(e)}}function s(e){if(o.x.isEmpty(e))throw r.e.createClientInfoDecodingError("Home account ID was empty.");var t=e.split(i.Bv.CLIENT_INFO_SEPARATOR,2);return{uid:t[0],utid:t.length<2?i.gT.EMPTY_STRING:t[1]}}},95622:(e,t,n)=>{"use strict";n.d(t,{W:()=>h});var r=n(5096),o=n(52944);function i(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")}var a=n(99860),s=n(60742),c=n(77891),u=n(47181),l=n(82617),d=n(1713),p=function(){function e(e){this.networkInterface=e}return e.prototype.detectRegion=function(e,t){return(0,r.mG)(this,void 0,void 0,(function(){var n,o,i,a;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:if(n=e)return[3,8];r.label=1;case 1:return r.trys.push([1,6,,7]),[4,this.getRegionFromIMDS(c.gT.IMDS_VERSION)];case 2:return(o=r.sent()).status===c.YY.httpSuccess&&(n=o.body,t.region_source=c.W.IMDS),o.status!==c.YY.httpBadRequest?[3,5]:[4,this.getCurrentVersion()];case 3:return(i=r.sent())?[4,this.getRegionFromIMDS(i)]:(t.region_source=c.W.FAILED_AUTO_DETECTION,[2,null]);case 4:(a=r.sent()).status===c.YY.httpSuccess&&(n=a.body,t.region_source=c.W.IMDS),r.label=5;case 5:return[3,7];case 6:return r.sent(),t.region_source=c.W.FAILED_AUTO_DETECTION,[2,null];case 7:return[3,9];case 8:t.region_source=c.W.ENVIRONMENT_VARIABLE,r.label=9;case 9:return n||(t.region_source=c.W.FAILED_AUTO_DETECTION),[2,n||null]}}))}))},e.prototype.getRegionFromIMDS=function(t){return(0,r.mG)(this,void 0,void 0,(function(){return(0,r.Jh)(this,(function(n){return[2,this.networkInterface.sendGetRequestAsync(c.gT.IMDS_ENDPOINT+"?api-version="+t+"&format=text",e.IMDS_OPTIONS,c.gT.IMDS_TIMEOUT)]}))}))},e.prototype.getCurrentVersion=function(){return(0,r.mG)(this,void 0,void 0,(function(){var t;return(0,r.Jh)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.networkInterface.sendGetRequestAsync(c.gT.IMDS_ENDPOINT+"?format=json",e.IMDS_OPTIONS)];case 1:return(t=n.sent()).status===c.YY.httpBadRequest&&t.body&&t.body["newest-versions"]&&t.body["newest-versions"].length>0?[2,t.body["newest-versions"][0]]:[2,null];case 2:return n.sent(),[2,null];case 3:return[2]}}))}))},e.IMDS_OPTIONS={headers:{Metadata:"true"}},e}(),h=function(){function e(e,t,n,r){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=n,this.authorityOptions=r,this.regionDiscovery=new p(t),this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0}}return Object.defineProperty(e.prototype,"authorityType",{get:function(){var e=this.canonicalAuthorityUrlComponents.PathSegments;return e.length&&e[0].toLowerCase()===c.gT.ADFS?o.a.Adfs:o.a.Default},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"protocolMode",{get:function(){return this.authorityOptions.protocolMode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.authorityOptions},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(e){this._canonicalAuthority=new a.G(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hostnameAndPort",{get:function(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.authorization_endpoint);return this.replaceTenant(e)}throw s.e.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint);return this.replaceTenant(e)}throw s.e.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));return this.replaceTenant(e)}throw s.e.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw s.e.createLogoutNotSupportedError();var e=this.replacePath(this.metadata.end_session_endpoint);return this.replaceTenant(e)}throw s.e.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.issuer);return this.replaceTenant(e)}throw s.e.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),e.prototype.replaceTenant=function(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)},e.prototype.replacePath=function(e){var t=e,n=new a.G(this.metadata.canonical_authority).getUrlComponents().PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((function(e,r){var o=n[r];e!==o&&(t=t.replace("/"+o+"/","/"+e+"/"))})),t},Object.defineProperty(e.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.authorityType===o.a.Adfs||this.protocolMode===l.A.OIDC?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!1,configurable:!0}),e.prototype.discoveryComplete=function(){return!!this.metadata},e.prototype.resolveEndpointsAsync=function(){return(0,r.mG)(this,void 0,void 0,(function(){var e,t,n,o;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:return(e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort))||(e=new d.l).updateCanonicalAuthority(this.canonicalAuthority),[4,this.updateCloudDiscoveryMetadata(e)];case 1:return t=r.sent(),this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network),[4,this.updateEndpointMetadata(e)];case 2:return n=r.sent(),t!==c.pQ.CACHE&&n!==c.pQ.CACHE&&(e.resetExpiresAt(),e.updateCanonicalAuthority(this.canonicalAuthority)),o=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache),this.cacheManager.setAuthorityMetadata(o,e),this.metadata=e,[2]}}))}))},e.prototype.updateEndpointMetadata=function(t){var n;return(0,r.mG)(this,void 0,void 0,(function(){var o,i,a;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:return(o=this.getEndpointMetadataFromConfig())?(t.updateEndpointMetadata(o,!1),[2,c.pQ.CONFIG]):this.isAuthoritySameType(t)&&t.endpointsFromNetwork&&!t.isExpired()?[2,c.pQ.CACHE]:[4,this.getEndpointMetadataFromNetwork()];case 1:return(o=r.sent())?(null===(n=this.authorityOptions.azureRegionConfiguration)||void 0===n?void 0:n.azureRegion)?[4,this.regionDiscovery.detectRegion(this.authorityOptions.azureRegionConfiguration.environmentRegion,this.regionDiscoveryMetadata)]:[3,3]:[3,4];case 2:i=r.sent(),a=this.authorityOptions.azureRegionConfiguration.azureRegion===c.gT.AZURE_REGION_AUTO_DISCOVER_FLAG?i:this.authorityOptions.azureRegionConfiguration.azureRegion,this.authorityOptions.azureRegionConfiguration.azureRegion===c.gT.AZURE_REGION_AUTO_DISCOVER_FLAG?this.regionDiscoveryMetadata.region_outcome=i?c.ki.AUTO_DETECTION_REQUESTED_SUCCESSFUL:c.ki.AUTO_DETECTION_REQUESTED_FAILED:this.regionDiscoveryMetadata.region_outcome=i?this.authorityOptions.azureRegionConfiguration.azureRegion===i?c.ki.CONFIGURED_MATCHES_DETECTED:c.ki.CONFIGURED_NOT_DETECTED:c.ki.CONFIGURED_NO_AUTO_DETECTION,a&&(this.regionDiscoveryMetadata.region_used=a,o=e.replaceWithRegionalInformation(o,a)),r.label=3;case 3:return t.updateEndpointMetadata(o,!0),[2,c.pQ.NETWORK];case 4:throw s.e.createUnableToGetOpenidConfigError(this.defaultOpenIdConfigurationEndpoint)}}))}))},e.prototype.isAuthoritySameType=function(e){return new a.G(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length},e.prototype.getEndpointMetadataFromConfig=function(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw u.r.createInvalidAuthorityMetadataError()}return null},e.prototype.getEndpointMetadataFromNetwork=function(){return(0,r.mG)(this,void 0,void 0,(function(){var e;return(0,r.Jh)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.networkInterface.sendGetRequestAsync(this.defaultOpenIdConfigurationEndpoint)];case 1:return[2,i((e=t.sent()).body)?e.body:null];case 2:return t.sent(),[2,null];case 3:return[2]}}))}))},e.prototype.updateCloudDiscoveryMetadata=function(e){return(0,r.mG)(this,void 0,void 0,(function(){var t;return(0,r.Jh)(this,(function(n){switch(n.label){case 0:return(t=this.getCloudDiscoveryMetadataFromConfig())?(e.updateCloudDiscoveryMetadata(t,!1),[2,c.pQ.CONFIG]):this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!e.isExpired()?[2,c.pQ.CACHE]:[4,this.getCloudDiscoveryMetadataFromNetwork()];case 1:if(t=n.sent())return e.updateCloudDiscoveryMetadata(t,!0),[2,c.pQ.NETWORK];throw u.r.createUntrustedAuthorityError()}}))}))},e.prototype.getCloudDiscoveryMetadataFromConfig=function(){if(this.authorityOptions.cloudDiscoveryMetadata)try{var t=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),n=e.getCloudDiscoveryMetadataFromNetworkResponse(t.metadata,this.hostnameAndPort);if(n)return n}catch(e){throw u.r.createInvalidCloudDiscoveryMetadataError()}return this.isInKnownAuthorities()?e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort):null},e.prototype.getCloudDiscoveryMetadataFromNetwork=function(){return(0,r.mG)(this,void 0,void 0,(function(){var t,n,o,i;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:t=""+c.gT.AAD_INSTANCE_DISCOVERY_ENDPT+this.canonicalAuthority+"oauth2/v2.0/authorize",n=null,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(t)];case 2:return o=r.sent(),i=function(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}(o.body)?o.body.metadata:[],0===i.length?[2,null]:(n=e.getCloudDiscoveryMetadataFromNetworkResponse(i,this.hostnameAndPort),[3,4]);case 3:return r.sent(),[2,null];case 4:return n||(n=e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),[2,n]}}))}))},e.prototype.isInKnownAuthorities=function(){var e=this;return this.authorityOptions.knownAuthorities.filter((function(t){return a.G.getDomainFromUrl(t).toLowerCase()===e.hostnameAndPort})).length>0},e.createCloudDiscoveryMetadataFromHost=function(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}},e.getCloudDiscoveryMetadataFromNetworkResponse=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.aliases.indexOf(t)>-1)return r}return null},e.prototype.getPreferredCache=function(){if(this.discoveryComplete())return this.metadata.preferred_cache;throw s.e.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},e.prototype.isAlias=function(e){return this.metadata.aliases.indexOf(e)>-1},e.isPublicCloudAuthority=function(e){return c.gT.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0},e.buildRegionalAuthorityString=function(e,t,n){var o=new a.G(e);o.validateAsUri();var i=o.getUrlComponents(),s=t+"."+i.HostNameAndPort;this.isPublicCloudAuthority(i.HostNameAndPort)&&(s=t+"."+c.gT.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX);var u=a.G.constructAuthorityUriFromObject((0,r.pi)((0,r.pi)({},o.getUrlComponents()),{HostNameAndPort:s})).urlString;return n?u+"?"+n:u},e.replaceWithRegionalInformation=function(t,n){return t.authorization_endpoint=e.buildRegionalAuthorityString(t.authorization_endpoint,n),t.token_endpoint=e.buildRegionalAuthorityString(t.token_endpoint,n,"allowestsrnonmsi=true"),t.end_session_endpoint&&(t.end_session_endpoint=e.buildRegionalAuthorityString(t.end_session_endpoint,n)),t},e}()},65676:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var r=n(5096),o=n(95622),i=n(47181),a=n(61653),s=n(60742),c=function(){function e(){}return e.createDiscoveredInstance=function(t,n,o,i){return(0,r.mG)(this,void 0,void 0,(function(){var a,c;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:a=e.createInstance(t,n,o,i),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,a.resolveEndpointsAsync()];case 2:return r.sent(),[2,a];case 3:throw c=r.sent(),s.e.createEndpointDiscoveryIncompleteError(c);case 4:return[2]}}))}))},e.createInstance=function(e,t,n,r){if(a.x.isEmpty(e))throw i.r.createUrlEmptyError();return new o.W(e,t,n,r)},e}()},52944:(e,t,n)=>{"use strict";var r;n.d(t,{a:()=>r}),function(e){e[e.Default=0]="Default",e[e.Adfs=1]="Adfs"}(r||(r={}))},82617:(e,t,n)=>{"use strict";var r;n.d(t,{A:()=>r}),function(e){e.AAD="AAD",e.OIDC="OIDC"}(r||(r={}))},67656:(e,t,n)=>{"use strict";n.d(t,{L:()=>d,w:()=>p});var r=n(5096),o=n(77891),i=n(10521),a=n(92613),s=n(43640),c=n(87342),u=n(60742),l=n(70591),d=function(){function e(e,t){this.clientId=e,this.cryptoImpl=t}return e.prototype.getAllAccounts=function(){var t=this,n=this.getAccountsFilteredBy(),r=Object.keys(n).map((function(e){return n[e]}));return r.length<1?[]:r.map((function(n){var r=e.toObject(new s.r,n).getAccountInfo(),o=t.readIdTokenFromCache(t.clientId,r);return o&&!r.idTokenClaims&&(r.idTokenClaims=new l.H(o.secret,t.cryptoImpl).claims),r}))},e.prototype.saveCacheRecord=function(e){return(0,r.mG)(this,void 0,void 0,(function(){return(0,r.Jh)(this,(function(t){switch(t.label){case 0:if(!e)throw u.e.createNullOrUndefinedCacheRecord();return e.account&&this.setAccount(e.account),e.idToken&&this.setIdTokenCredential(e.idToken),e.accessToken?[4,this.saveAccessToken(e.accessToken)]:[3,2];case 1:t.sent(),t.label=2;case 2:return e.refreshToken&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata),[2]}}))}))},e.prototype.saveAccessToken=function(e){return(0,r.mG)(this,void 0,void 0,(function(){var t,n,o,i,s=this;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:return t=this.getCredentialsFilteredBy({clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash}),n=a.i.fromString(e.target),(o=Object.keys(t.accessTokens).map((function(e){return t.accessTokens[e]})))?(i=[],o.forEach((function(e){a.i.fromString(e.target).intersectingScopeSets(n)&&i.push(s.removeCredential(e))})),[4,Promise.all(i)]):[3,2];case 1:r.sent(),r.label=2;case 2:return this.setAccessTokenCredential(e),[2]}}))}))},e.prototype.getAccountsFilteredBy=function(e){return this.getAccountsFilteredByInternal(e?e.homeAccountId:"",e?e.environment:"",e?e.realm:"")},e.prototype.getAccountsFilteredByInternal=function(e,t,n){var r=this,o=this.getKeys(),i={};return o.forEach((function(o){var a=r.getAccount(o);a&&(e&&!r.matchHomeAccountId(a,e)||t&&!r.matchEnvironment(a,t)||n&&!r.matchRealm(a,n)||(i[o]=a))})),i},e.prototype.getCredentialsFilteredBy=function(e){return this.getCredentialsFilteredByInternal(e.homeAccountId,e.environment,e.credentialType,e.clientId,e.familyId,e.realm,e.target,e.oboAssertion,e.tokenType,e.keyId,e.requestedClaimsHash)},e.prototype.getCredentialsFilteredByInternal=function(e,t,n,r,a,s,c,u,l,d,p){var h=this,f=this.getKeys(),g={idTokens:{},accessTokens:{},refreshTokens:{}};return f.forEach((function(f){var m=i.m.getCredentialType(f);if(m!==o.gT.NOT_DEFINED){var v=h.getSpecificCredential(f,m);if(v&&(!u||h.matchOboAssertion(v,u))&&(!e||h.matchHomeAccountId(v,e))&&(!t||h.matchEnvironment(v,t))&&(!s||h.matchRealm(v,s))&&(!n||h.matchCredentialType(v,n))&&(!r||h.matchClientId(v,r))&&(!a||h.matchFamilyId(v,a))&&(!c||h.matchTarget(v,c))&&(!p&&!v.requestedClaimsHash||v.requestedClaimsHash===p)){if(n===o.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(l&&!h.matchTokenType(v,l))return;if(l===o.hO.SSH&&d&&!h.matchKeyId(v,d))return}var y=h.updateCredentialCacheKey(f,v);switch(m){case o.d3.ID_TOKEN:g.idTokens[y]=v;break;case o.d3.ACCESS_TOKEN:case o.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME:g.accessTokens[y]=v;break;case o.d3.REFRESH_TOKEN:g.refreshTokens[y]=v}}}})),g},e.prototype.getAppMetadataFilteredBy=function(e){return this.getAppMetadataFilteredByInternal(e.environment,e.clientId)},e.prototype.getAppMetadataFilteredByInternal=function(e,t){var n=this,r=this.getKeys(),o={};return r.forEach((function(r){if(n.isAppMetadata(r)){var i=n.getAppMetadata(r);i&&(e&&!n.matchEnvironment(i,e)||t&&!n.matchClientId(i,t)||(o[r]=i))}})),o},e.prototype.getAuthorityMetadataByAlias=function(e){var t=this,n=this.getAuthorityMetadataKeys(),r=null;return n.forEach((function(n){if(t.isAuthorityMetadata(n)&&-1!==n.indexOf(t.clientId)){var o=t.getAuthorityMetadata(n);o&&-1!==o.aliases.indexOf(e)&&(r=o)}})),r},e.prototype.removeAllAccounts=function(){return(0,r.mG)(this,void 0,void 0,(function(){var e,t,n=this;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:return e=this.getKeys(),t=[],e.forEach((function(e){n.getAccount(e)&&t.push(n.removeAccount(e))})),[4,Promise.all(t)];case 1:return r.sent(),[2,!0]}}))}))},e.prototype.removeAccount=function(e){return(0,r.mG)(this,void 0,void 0,(function(){var t;return(0,r.Jh)(this,(function(n){switch(n.label){case 0:if(!(t=this.getAccount(e)))throw u.e.createNoAccountFoundError();return[4,this.removeAccountContext(t)];case 1:return[2,n.sent()&&this.removeItem(e,o.Xj.ACCOUNT)]}}))}))},e.prototype.removeAccountContext=function(e){return(0,r.mG)(this,void 0,void 0,(function(){var t,n,a,s=this;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:return t=this.getKeys(),n=e.generateAccountId(),a=[],t.forEach((function(e){var t=i.m.getCredentialType(e);if(t!==o.gT.NOT_DEFINED){var r=s.getSpecificCredential(e,t);r&&n===r.generateAccountId()&&a.push(s.removeCredential(r))}})),[4,Promise.all(a)];case 1:return r.sent(),[2,!0]}}))}))},e.prototype.removeCredential=function(e){return(0,r.mG)(this,void 0,void 0,(function(){var t,n;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:if(t=e.generateCredentialKey(),e.credentialType.toLowerCase()!==o.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())return[3,4];if(e.tokenType!==o.hO.POP)return[3,4];if(!(n=e.keyId))return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.cryptoImpl.removeTokenBindingKey(n)];case 2:return r.sent(),[3,4];case 3:throw r.sent(),u.e.createBindingKeyNotRemovedError();case 4:return[2,this.removeItem(t,o.Xj.CREDENTIAL)]}}))}))},e.prototype.removeAppMetadata=function(){var e=this;return this.getKeys().forEach((function(t){e.isAppMetadata(t)&&e.removeItem(t,o.Xj.APP_METADATA)})),!0},e.prototype.readCacheRecord=function(e,t,n,r){var o=this.readAccountFromCache(e),i=this.readIdTokenFromCache(t,e),a=this.readAccessTokenFromCache(t,e,n),s=this.readRefreshTokenFromCache(t,e,!1),c=this.readAppMetadataFromCache(r,t);return o&&i&&(o.idTokenClaims=new l.H(i.secret,this.cryptoImpl).claims),{account:o,idToken:i,accessToken:a,refreshToken:s,appMetadata:c}},e.prototype.readAccountFromCache=function(e){var t=s.r.generateAccountCacheKey(e);return this.getAccount(t)},e.prototype.readIdTokenFromCache=function(e,t){var n={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:o.d3.ID_TOKEN,clientId:e,realm:t.tenantId},r=this.getCredentialsFilteredBy(n),i=Object.keys(r.idTokens).map((function(e){return r.idTokens[e]})),a=i.length;if(a<1)return null;if(a>1)throw u.e.createMultipleMatchingTokensInCacheError();return i[0]},e.prototype.readAccessTokenFromCache=function(e,t,n){var r=new a.i(n.scopes||[]),i=n.authenticationScheme||o.hO.BEARER,s=i&&i.toLowerCase()!==o.hO.BEARER.toLowerCase()?o.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME:o.d3.ACCESS_TOKEN,c={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:s,clientId:e,realm:t.tenantId,target:r.printScopesLowerCase(),tokenType:i,keyId:n.sshKid,requestedClaimsHash:n.requestedClaimsHash},l=this.getCredentialsFilteredBy(c),d=Object.keys(l.accessTokens).map((function(e){return l.accessTokens[e]})),p=d.length;if(p<1)return null;if(p>1)throw u.e.createMultipleMatchingTokensInCacheError();return d[0]},e.prototype.readRefreshTokenFromCache=function(e,t,n){var r=n?o.ch:void 0,i={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:o.d3.REFRESH_TOKEN,clientId:e,familyId:r},a=this.getCredentialsFilteredBy(i),s=Object.keys(a.refreshTokens).map((function(e){return a.refreshTokens[e]}));return s.length<1?null:s[0]},e.prototype.readAppMetadataFromCache=function(e,t){var n={environment:e,clientId:t},r=this.getAppMetadataFilteredBy(n),o=Object.keys(r).map((function(e){return r[e]})),i=o.length;if(i<1)return null;if(i>1)throw u.e.createMultipleMatchingAppMetadataInCacheError();return o[0]},e.prototype.isAppMetadataFOCI=function(e,t){var n=this.readAppMetadataFromCache(e,t);return!(!n||n.familyId!==o.ch)},e.prototype.matchHomeAccountId=function(e,t){return!(!e.homeAccountId||t!==e.homeAccountId)},e.prototype.matchOboAssertion=function(e,t){return!(!e.oboAssertion||t!==e.oboAssertion)},e.prototype.matchEnvironment=function(e,t){var n=this.getAuthorityMetadataByAlias(t);return!!(n&&n.aliases.indexOf(e.environment)>-1)},e.prototype.matchCredentialType=function(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()},e.prototype.matchClientId=function(e,t){return!(!e.clientId||t!==e.clientId)},e.prototype.matchFamilyId=function(e,t){return!(!e.familyId||t!==e.familyId)},e.prototype.matchRealm=function(e,t){return!(!e.realm||t!==e.realm)},e.prototype.matchTarget=function(e,t){if(e.credentialType!==o.d3.ACCESS_TOKEN&&e.credentialType!==o.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)return!1;var n=a.i.fromString(e.target),r=a.i.fromString(t);return r.containsOnlyOIDCScopes()?r.removeScope(o.gT.OFFLINE_ACCESS_SCOPE):r.removeOIDCScopes(),n.containsScopeSet(r)},e.prototype.matchTokenType=function(e,t){return!(!e.tokenType||e.tokenType!==t)},e.prototype.matchKeyId=function(e,t){return!(!e.keyId||e.keyId!==t)},e.prototype.isAppMetadata=function(e){return-1!==e.indexOf(o.dg)},e.prototype.isAuthorityMetadata=function(e){return-1!==e.indexOf(o.QU.CACHE_KEY)},e.prototype.generateAuthorityMetadataCacheKey=function(e){return o.QU.CACHE_KEY+"-"+this.clientId+"-"+e},e.prototype.getSpecificCredential=function(e,t){switch(t){case o.d3.ID_TOKEN:return this.getIdTokenCredential(e);case o.d3.ACCESS_TOKEN:case o.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME:return this.getAccessTokenCredential(e);case o.d3.REFRESH_TOKEN:return this.getRefreshTokenCredential(e);default:return null}},e.toObject=function(e,t){for(var n in t)e[n]=t[n];return e},e}(),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.ZT)(t,e),t.prototype.setAccount=function(){throw c.l.createUnexpectedError("Storage interface - setAccount() has not been implemented for the cacheStorage interface.")},t.prototype.getAccount=function(){throw c.l.createUnexpectedError("Storage interface - getAccount() has not been implemented for the cacheStorage interface.")},t.prototype.setIdTokenCredential=function(){throw c.l.createUnexpectedError("Storage interface - setIdTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getIdTokenCredential=function(){throw c.l.createUnexpectedError("Storage interface - getIdTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setAccessTokenCredential=function(){throw c.l.createUnexpectedError("Storage interface - setAccessTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getAccessTokenCredential=function(){throw c.l.createUnexpectedError("Storage interface - getAccessTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setRefreshTokenCredential=function(){throw c.l.createUnexpectedError("Storage interface - setRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getRefreshTokenCredential=function(){throw c.l.createUnexpectedError("Storage interface - getRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setAppMetadata=function(){throw c.l.createUnexpectedError("Storage interface - setAppMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAppMetadata=function(){throw c.l.createUnexpectedError("Storage interface - getAppMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.setServerTelemetry=function(){throw c.l.createUnexpectedError("Storage interface - setServerTelemetry() has not been implemented for the cacheStorage interface.")},t.prototype.getServerTelemetry=function(){throw c.l.createUnexpectedError("Storage interface - getServerTelemetry() has not been implemented for the cacheStorage interface.")},t.prototype.setAuthorityMetadata=function(){throw c.l.createUnexpectedError("Storage interface - setAuthorityMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAuthorityMetadata=function(){throw c.l.createUnexpectedError("Storage interface - getAuthorityMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAuthorityMetadataKeys=function(){throw c.l.createUnexpectedError("Storage interface - getAuthorityMetadataKeys() has not been implemented for the cacheStorage interface.")},t.prototype.setThrottlingCache=function(){throw c.l.createUnexpectedError("Storage interface - setThrottlingCache() has not been implemented for the cacheStorage interface.")},t.prototype.getThrottlingCache=function(){throw c.l.createUnexpectedError("Storage interface - getThrottlingCache() has not been implemented for the cacheStorage interface.")},t.prototype.removeItem=function(){throw c.l.createUnexpectedError("Storage interface - removeItem() has not been implemented for the cacheStorage interface.")},t.prototype.containsKey=function(){throw c.l.createUnexpectedError("Storage interface - containsKey() has not been implemented for the cacheStorage interface.")},t.prototype.getKeys=function(){throw c.l.createUnexpectedError("Storage interface - getKeys() has not been implemented for the cacheStorage interface.")},t.prototype.clear=function(){return(0,r.mG)(this,void 0,void 0,(function(){return(0,r.Jh)(this,(function(e){throw c.l.createUnexpectedError("Storage interface - clear() has not been implemented for the cacheStorage interface.")}))}))},t.prototype.updateCredentialCacheKey=function(){throw c.l.createUnexpectedError("Storage interface - updateCredentialCacheKey() has not been implemented for the cacheStorage interface.")},t}(d)},85907:(e,t,n)=>{"use strict";n.d(t,{_:()=>l});var r=n(5096),o=n(10521),i=n(77891),a=n(33848),s=n(61653),c=n(70591),u=n(60742),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.ZT)(t,e),t.createAccessTokenEntity=function(e,n,r,o,l,d,p,h,f,g,m,v,y,C,E){var T,w,b=new t;b.homeAccountId=e,b.credentialType=i.d3.ACCESS_TOKEN,b.secret=r;var S=a.I.nowSeconds();if(b.cachedAt=S.toString(),b.expiresOn=p.toString(),b.extendedExpiresOn=h.toString(),g&&(b.refreshOn=g.toString()),b.environment=n,b.clientId=o,b.realm=l,b.target=d,b.oboAssertion=v,b.tokenType=s.x.isEmpty(m)?i.hO.BEARER:m,C&&(b.requestedClaims=C,b.requestedClaimsHash=E),(null===(T=b.tokenType)||void 0===T?void 0:T.toLowerCase())!==i.hO.BEARER.toLowerCase())switch(b.credentialType=i.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME,b.tokenType){case i.hO.POP:var I=c.H.extractTokenClaims(r,f);if(!(null===(w=null==I?void 0:I.cnf)||void 0===w?void 0:w.kid))throw u.e.createTokenClaimsRequiredError();b.keyId=I.cnf.kid;break;case i.hO.SSH:b.keyId=y}return b},t.isAccessTokenEntity=function(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.hasOwnProperty("target")&&(e.credentialType===i.d3.ACCESS_TOKEN||e.credentialType===i.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME)},t}(o.m)},43640:(e,t,n)=>{"use strict";n.d(t,{r:()=>c});var r=n(77891),o=n(11520),i=n(61653),a=n(60742),s=n(52944),c=function(){function e(){}return e.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(r.Bv.CACHE_KEY_SEPARATOR).toLowerCase()},e.prototype.generateAccountKey=function(){return e.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},e.prototype.generateType=function(){switch(this.authorityType){case r.iR.ADFS_ACCOUNT_TYPE:return r.LL.ADFS;case r.iR.MSAV1_ACCOUNT_TYPE:return r.LL.MSA;case r.iR.MSSTS_ACCOUNT_TYPE:return r.LL.MSSTS;case r.iR.GENERIC_ACCOUNT_TYPE:return r.LL.GENERIC;default:throw a.e.createUnexpectedAccountTypeError()}},e.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims}},e.generateAccountCacheKey=function(e){return[e.homeAccountId,e.environment||"",e.tenantId||""].join(r.Bv.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAccount=function(t,n,o,i,s,c,u,l){var d,p,h,f,g,m,v=new e;v.authorityType=r.iR.MSSTS_ACCOUNT_TYPE,v.clientInfo=t,v.homeAccountId=n;var y=l||i&&i.getPreferredCache();if(!y)throw a.e.createInvalidCacheEnvironmentError();return v.environment=y,v.realm=(null===(d=null==o?void 0:o.claims)||void 0===d?void 0:d.tid)||"",v.oboAssertion=s,o&&(v.idTokenClaims=o.claims,v.localAccountId=(null===(p=null==o?void 0:o.claims)||void 0===p?void 0:p.oid)||(null===(h=null==o?void 0:o.claims)||void 0===h?void 0:h.sub)||"",v.username=(null===(f=null==o?void 0:o.claims)||void 0===f?void 0:f.preferred_username)||((null===(g=null==o?void 0:o.claims)||void 0===g?void 0:g.emails)?o.claims.emails[0]:""),v.name=null===(m=null==o?void 0:o.claims)||void 0===m?void 0:m.name),v.cloudGraphHostName=c,v.msGraphHost=u,v},e.createGenericAccount=function(t,n,o,i,c,u,l){var d,p,h,f,g=new e;g.authorityType=o&&o.authorityType===s.a.Adfs?r.iR.ADFS_ACCOUNT_TYPE:r.iR.GENERIC_ACCOUNT_TYPE,g.homeAccountId=t,g.realm="",g.oboAssertion=i;var m=l||o&&o.getPreferredCache();if(!m)throw a.e.createInvalidCacheEnvironmentError();return n&&(g.localAccountId=(null===(d=null==n?void 0:n.claims)||void 0===d?void 0:d.oid)||(null===(p=null==n?void 0:n.claims)||void 0===p?void 0:p.sub)||"",g.username=(null===(h=null==n?void 0:n.claims)||void 0===h?void 0:h.upn)||"",g.name=(null===(f=null==n?void 0:n.claims)||void 0===f?void 0:f.name)||"",g.idTokenClaims=null==n?void 0:n.claims),g.environment=m,g.cloudGraphHostName=c,g.msGraphHost=u,g},e.generateHomeAccountId=function(e,t,n,a,c){var u,l=(null===(u=null==c?void 0:c.claims)||void 0===u?void 0:u.sub)?c.claims.sub:r.gT.EMPTY_STRING;if(t===s.a.Adfs)return l;if(e)try{var d=(0,o.B)(e,a);if(!i.x.isEmpty(d.uid)&&!i.x.isEmpty(d.utid))return""+d.uid+r.Bv.CLIENT_INFO_SEPARATOR+d.utid}catch(e){}return n.verbose("No client info in response"),l},e.isAccountEntity=function(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType")},e.accountInfoIsEqual=function(e,t,n){if(!e||!t)return!1;var r=!0;if(n){var o=e.idTokenClaims||{},i=t.idTokenClaims||{};r=o.iat===i.iat&&o.nonce===i.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&r},e}()},59993:(e,t,n)=>{"use strict";n.d(t,{T:()=>o});var r=n(77891),o=function(){function e(){}return e.prototype.generateAppMetadataKey=function(){return e.generateAppMetadataCacheKey(this.environment,this.clientId)},e.generateAppMetadataCacheKey=function(e,t){return[r.dg,e,t].join(r.Bv.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAppMetadataEntity=function(t,n,r){var o=new e;return o.clientId=t,o.environment=n,r&&(o.familyId=r),o},e.isAppMetadataEntity=function(e,t){return!!t&&0===e.indexOf(r.dg)&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("environment")},e}()},1713:(e,t,n)=>{"use strict";n.d(t,{l:()=>i});var r=n(77891),o=n(33848),i=function(){function e(){this.expiresAt=o.I.nowSeconds()+r.QU.REFRESH_TIME_SECONDS}return e.prototype.updateCloudDiscoveryMetadata=function(e,t){this.aliases=e.aliases,this.preferred_cache=e.preferred_cache,this.preferred_network=e.preferred_network,this.aliasesFromNetwork=t},e.prototype.updateEndpointMetadata=function(e,t){this.authorization_endpoint=e.authorization_endpoint,this.token_endpoint=e.token_endpoint,this.end_session_endpoint=e.end_session_endpoint,this.issuer=e.issuer,this.endpointsFromNetwork=t},e.prototype.updateCanonicalAuthority=function(e){this.canonical_authority=e},e.prototype.resetExpiresAt=function(){this.expiresAt=o.I.nowSeconds()+r.QU.REFRESH_TIME_SECONDS},e.prototype.isExpired=function(){return this.expiresAt<=o.I.nowSeconds()},e.isAuthorityMetadataEntity=function(e,t){return!!t&&0===e.indexOf(r.QU.CACHE_KEY)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")},e}()},10521:(e,t,n)=>{"use strict";n.d(t,{m:()=>i});var r=n(77891),o=n(60742),i=function(){function e(){}return e.prototype.generateAccountId=function(){return e.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},e.prototype.generateCredentialId=function(){return e.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},e.prototype.generateTarget=function(){return e.generateTargetForCacheKey(this.target)},e.prototype.generateCredentialKey=function(){return e.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId,this.tokenType,this.requestedClaimsHash)},e.prototype.generateType=function(){switch(this.credentialType){case r.d3.ID_TOKEN:return r.LL.ID_TOKEN;case r.d3.ACCESS_TOKEN:case r.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME:return r.LL.ACCESS_TOKEN;case r.d3.REFRESH_TOKEN:return r.LL.REFRESH_TOKEN;default:throw o.e.createUnexpectedCredentialTypeError()}},e.getCredentialType=function(e){return-1!==e.indexOf(r.d3.ACCESS_TOKEN.toLowerCase())?-1!==e.indexOf(r.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())?r.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME:r.d3.ACCESS_TOKEN:-1!==e.indexOf(r.d3.ID_TOKEN.toLowerCase())?r.d3.ID_TOKEN:-1!==e.indexOf(r.d3.REFRESH_TOKEN.toLowerCase())?r.d3.REFRESH_TOKEN:r.gT.NOT_DEFINED},e.generateCredentialCacheKey=function(e,t,n,o,i,a,s,c,u){return[this.generateAccountIdForCacheKey(e,t),this.generateCredentialIdForCacheKey(n,o,i,s),this.generateTargetForCacheKey(a),this.generateClaimsHashForCacheKey(u),this.generateSchemeForCacheKey(c)].join(r.Bv.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateAccountIdForCacheKey=function(e,t){return[e,t].join(r.Bv.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateCredentialIdForCacheKey=function(e,t,n,o){return[e,e===r.d3.REFRESH_TOKEN&&o||t,n||""].join(r.Bv.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateTargetForCacheKey=function(e){return(e||"").toLowerCase()},e.generateClaimsHashForCacheKey=function(e){return(e||"").toLowerCase()},e.generateSchemeForCacheKey=function(e){return e&&e.toLowerCase()!==r.hO.BEARER.toLowerCase()?e.toLowerCase():""},e}()},70979:(e,t,n)=>{"use strict";n.d(t,{w:()=>a});var r=n(5096),o=n(10521),i=n(77891),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.ZT)(t,e),t.createIdTokenEntity=function(e,n,r,o,a,s){var c=new t;return c.credentialType=i.d3.ID_TOKEN,c.homeAccountId=e,c.environment=n,c.clientId=o,c.secret=r,c.realm=a,c.oboAssertion=s,c},t.isIdTokenEntity=function(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===i.d3.ID_TOKEN},t}(o.m)},11429:(e,t,n)=>{"use strict";n.d(t,{e:()=>a});var r=n(5096),o=n(10521),i=n(77891),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.ZT)(t,e),t.createRefreshTokenEntity=function(e,n,r,o,a,s){var c=new t;return c.clientId=o,c.credentialType=i.d3.REFRESH_TOKEN,c.environment=n,c.homeAccountId=e,c.secret=r,c.oboAssertion=s,a&&(c.familyId=a),c},t.isRefreshTokenEntity=function(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===i.d3.REFRESH_TOKEN},t}(o.m)},44612:(e,t,n)=>{"use strict";n.d(t,{d:()=>o});var r=n(77891),o=function(){function e(){this.failedRequests=[],this.errors=[],this.cacheHits=0}return e.isServerTelemetryEntity=function(e,t){var n=0===e.indexOf(r.HN.CACHE_KEY),o=!0;return t&&(o=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),n&&o},e}()},4184:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(77891),o=function(){function e(){}return e.isThrottlingEntity=function(e,t){var n=!1;e&&(n=0===e.indexOf(r.bb.THROTTLING_PREFIX));var o=!0;return t&&(o=t.hasOwnProperty("throttleTime")),n&&o},e}()},59665:(e,t,n)=>{"use strict";n.d(t,{C:()=>r});var r=function(){function e(e,t){this.cache=e,this.hasChanged=t}return Object.defineProperty(e.prototype,"cacheHasChanged",{get:function(){return this.hasChanged},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tokenCache",{get:function(){return this.cache},enumerable:!1,configurable:!0}),e}()},29046:(e,t,n)=>{"use strict";n.d(t,{U:()=>v});var r=n(5096),o=n(13761),i=n(87479),a=n(77891),s=n(32105),c=n(61653),u=n(60742),l=n(99860),d=n(17650),p=n(33848),h=n(11520),f=n(34726),g=n(47181),m=n(5035),v=function(e){function t(t){var n=e.call(this,t)||this;return n.includeRedirectUri=!0,n}return(0,r.ZT)(t,e),t.prototype.getAuthCodeUrl=function(e){return(0,r.mG)(this,void 0,void 0,(function(){var t;return(0,r.Jh)(this,(function(n){return t=this.createAuthCodeUrlQueryString(e),[2,l.G.appendQueryString(this.authority.authorizationEndpoint,t)]}))}))},t.prototype.acquireToken=function(e,t){return(0,r.mG)(this,void 0,void 0,(function(){var n,o,i;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:if(this.logger.info("in acquireToken call"),!e||c.x.isEmpty(e.code))throw u.e.createTokenRequestCannotBeMadeError();return n=p.I.nowSeconds(),[4,this.executeTokenRequest(this.authority,e)];case 1:return o=r.sent(),(i=new s.s(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(o.body),[4,i.handleServerTokenResponse(o.body,this.authority,n,e,t)];case 2:return[2,r.sent()]}}))}))},t.prototype.handleFragmentResponse=function(e,t){var n=new s.s(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null),o=new l.G(e),i=l.G.getDeserializedHash(o.getHash());if(n.validateServerAuthorizationCodeResponse(i,t,this.cryptoUtils),!i.code)throw u.e.createNoAuthCodeInServerResponseError();return(0,r.pi)((0,r.pi)({},i),{code:i.code})},t.prototype.getLogoutUri=function(e){if(!e)throw g.r.createEmptyLogoutRequestError();var t=this.createLogoutUrlQueryString(e);return l.G.appendQueryString(this.authority.endSessionEndpoint,t)},t.prototype.executeTokenRequest=function(e,t){return(0,r.mG)(this,void 0,void 0,(function(){var n,o,i,s,u,l,d;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:return n={clientId:this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},[4,this.createTokenRequestBody(t)];case 1:if(o=r.sent(),i=this.createTokenQueryParameters(t),s=void 0,t.clientInfo)try{u=(0,h.B)(t.clientInfo,this.cryptoUtils),s={credential:""+u.uid+a.Bv.CLIENT_INFO_SEPARATOR+u.utid,type:f.G.HOME_ACCOUNT_ID}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}return l=this.createTokenRequestHeaders(s||t.ccsCredential),d=c.x.isEmpty(i)?e.tokenEndpoint:e.tokenEndpoint+"?"+i,[2,this.executePostToTokenEndpoint(d,o,l,n)]}}))}))},t.prototype.createTokenQueryParameters=function(e){var t=new i.H;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()},t.prototype.createTokenRequestBody=function(e){return(0,r.mG)(this,void 0,void 0,(function(){var t,n,o,s,u,l,p;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:return(t=new i.H).addClientId(this.config.authOptions.clientId),this.includeRedirectUri?t.addRedirectUri(e.redirectUri):m.D.validateRedirectUri(e.redirectUri),t.addScopes(e.scopes),t.addAuthorizationCode(e.code),t.addLibraryInfo(this.config.libraryInfo),t.addThrottling(),this.serverTelemetryManager&&t.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&t.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(n=this.config.clientCredentials.clientAssertion,t.addClientAssertion(n.assertion),t.addClientAssertionType(n.assertionType)),t.addGrantType(a.qJ.AUTHORIZATION_CODE_GRANT),t.addClientInfo(),e.authenticationScheme!==a.hO.POP?[3,2]:[4,new d.$(this.cryptoUtils).generateCnf(e)];case 1:return o=r.sent(),t.addPopToken(o),[3,3];case 2:if(e.authenticationScheme===a.hO.SSH){if(!e.sshJwk)throw g.r.createMissingSshJwkError();t.addSshJwk(e.sshJwk)}r.label=3;case 3:if(s=e.correlationId||this.config.cryptoInterface.createNewGuid(),t.addCorrelationId(s),(!c.x.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),u=void 0,e.clientInfo)try{l=(0,h.B)(e.clientInfo,this.cryptoUtils),u={credential:""+l.uid+a.Bv.CLIENT_INFO_SEPARATOR+l.utid,type:f.G.HOME_ACCOUNT_ID}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}else u=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&u)switch(u.type){case f.G.HOME_ACCOUNT_ID:try{l=(0,h.j)(u.credential),t.addCcsOid(l)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case f.G.UPN:t.addCcsUpn(u.credential)}return e.tokenBodyParameters&&t.addExtraQueryParameters(e.tokenBodyParameters),!e.enableSpaAuthorizationCode||e.tokenBodyParameters&&e.tokenBodyParameters[a.Fo.RETURN_SPA_CODE]||t.addExtraQueryParameters(((p={})[a.Fo.RETURN_SPA_CODE]="1",p)),[2,t.createQueryString()]}}))}))},t.prototype.createAuthCodeUrlQueryString=function(e){var t=new i.H;t.addClientId(this.config.authOptions.clientId);var n=(0,r.pr)(e.scopes||[],e.extraScopesToConsent||[]);t.addScopes(n),t.addRedirectUri(e.redirectUri);var o=e.correlationId||this.config.cryptoInterface.createNewGuid();if(t.addCorrelationId(o),t.addResponseMode(e.responseMode),t.addResponseTypeCode(),t.addLibraryInfo(this.config.libraryInfo),t.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&t.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&t.addPrompt(e.prompt),e.domainHint&&t.addDomainHint(e.domainHint),e.prompt!==a.NJ.SELECT_ACCOUNT)if(e.sid&&e.prompt===a.NJ.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),t.addSid(e.sid);else if(e.account){var s=this.extractAccountSid(e.account);if(s&&e.prompt===a.NJ.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),t.addSid(s);try{var u=(0,h.j)(e.account.homeAccountId);t.addCcsOid(u)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),t.addLoginHint(e.loginHint),t.addCcsUpn(e.loginHint);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),t.addLoginHint(e.account.username);try{u=(0,h.j)(e.account.homeAccountId),t.addCcsOid(u)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),t.addLoginHint(e.loginHint),t.addCcsUpn(e.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return e.nonce&&t.addNonce(e.nonce),e.state&&t.addState(e.state),(!c.x.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),t.createQueryString()},t.prototype.createLogoutUrlQueryString=function(e){var t=new i.H;return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),e.state&&t.addState(e.state),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),t.createQueryString()},t.prototype.extractAccountSid=function(e){return e.idTokenClaims&&e.idTokenClaims.sid||null},t}(o.W)},13761:(e,t,n)=>{"use strict";n.d(t,{W:()=>p});var r=n(5096),o=n(14854),i=n(97482),a=n(21362),s=n(77891),c=n(26246),u=n(60742),l=n(34726),d=n(11520),p=function(){function e(e){this.config=(0,o.j)(e),this.logger=new a.Y(this.config.loggerOptions,c.u,c.i),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new i.r(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority}return e.prototype.createTokenRequestHeaders=function(e){var t={};if(t[s.SZ.CONTENT_TYPE]=s.gT.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case l.G.HOME_ACCOUNT_ID:try{var n=(0,d.j)(e.credential);t[s.SZ.CCS_HEADER]="Oid:"+n.uid+"@"+n.utid}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case l.G.UPN:t[s.SZ.CCS_HEADER]="UPN: "+e.credential}return t},e.prototype.executePostToTokenEndpoint=function(e,t,n,o){return(0,r.mG)(this,void 0,void 0,(function(){var i;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:return[4,this.networkManager.sendPostRequest(o,e,{body:t,headers:n})];case 1:return i=r.sent(),this.config.serverTelemetryManager&&i.status<500&&429!==i.status&&this.config.serverTelemetryManager.clearTelemetryCache(),[2,i]}}))}))},e.prototype.updateAuthority=function(e){if(!e.discoveryComplete())throw u.e.createEndpointDiscoveryIncompleteError("Updated authority has not completed endpoint discovery.");this.authority=e},e}()},28508:(e,t,n)=>{"use strict";n.d(t,{Y:()=>y});var r=n(5096),o=n(13761),i=n(87479),a=n(77891),s=n(32105),c=n(17650),u=n(61653),l=n(47181),d=n(60742),p=n(91359),h=n(33848),f=n(99860),g=n(34726),m=n(11520),v=n(83927),y=function(e){function t(t){return e.call(this,t)||this}return(0,r.ZT)(t,e),t.prototype.acquireToken=function(e){return(0,r.mG)(this,void 0,void 0,(function(){var t,n,o;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:return t=h.I.nowSeconds(),[4,this.executeTokenRequest(e,this.authority)];case 1:return n=r.sent(),(o=new s.s(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(n.body),[2,o.handleServerTokenResponse(n.body,this.authority,t,e,void 0,void 0,!0)]}}))}))},t.prototype.acquireTokenByRefreshToken=function(e){return(0,r.mG)(this,void 0,void 0,(function(){var t,n;return(0,r.Jh)(this,(function(r){if(!e)throw l.r.createEmptyTokenRequestError();if(!e.account)throw d.e.createNoAccountInSilentRequestError();if(this.cacheManager.isAppMetadataFOCI(e.account.environment,this.config.authOptions.clientId))try{return[2,this.acquireTokenWithCachedRefreshToken(e,!0)]}catch(r){if(t=r instanceof v.Yo&&r.errorCode===v.Zy.noTokensFoundError.code,n=r instanceof p.n&&r.errorCode===a.D1.INVALID_GRANT_ERROR&&r.subError===a.D1.CLIENT_MISMATCH_ERROR,t||n)return[2,this.acquireTokenWithCachedRefreshToken(e,!1)];throw r}return[2,this.acquireTokenWithCachedRefreshToken(e,!1)]}))}))},t.prototype.acquireTokenWithCachedRefreshToken=function(e,t){return(0,r.mG)(this,void 0,void 0,(function(){var n,o;return(0,r.Jh)(this,(function(i){if(!(n=this.cacheManager.readRefreshTokenFromCache(this.config.authOptions.clientId,e.account,t)))throw v.Yo.createNoTokensFoundError();return o=(0,r.pi)((0,r.pi)({},e),{refreshToken:n.secret,authenticationScheme:e.authenticationScheme||a.hO.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:g.G.HOME_ACCOUNT_ID}}),[2,this.acquireToken(o)]}))}))},t.prototype.executeTokenRequest=function(e,t){return(0,r.mG)(this,void 0,void 0,(function(){var n,o,i,a,s;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:return[4,this.createTokenRequestBody(e)];case 1:return n=r.sent(),o=this.createTokenQueryParameters(e),i=this.createTokenRequestHeaders(e.ccsCredential),a={clientId:this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid},s=f.G.appendQueryString(t.tokenEndpoint,o),[2,this.executePostToTokenEndpoint(s,n,i,a)]}}))}))},t.prototype.createTokenQueryParameters=function(e){var t=new i.H;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()},t.prototype.createTokenRequestBody=function(e){return(0,r.mG)(this,void 0,void 0,(function(){var t,n,o,s,d;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:return(t=new i.H).addClientId(this.config.authOptions.clientId),t.addScopes(e.scopes),t.addGrantType(a.qJ.REFRESH_TOKEN_GRANT),t.addClientInfo(),t.addLibraryInfo(this.config.libraryInfo),t.addThrottling(),this.serverTelemetryManager&&t.addServerTelemetry(this.serverTelemetryManager),n=e.correlationId||this.config.cryptoInterface.createNewGuid(),t.addCorrelationId(n),t.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(o=this.config.clientCredentials.clientAssertion,t.addClientAssertion(o.assertion),t.addClientAssertionType(o.assertionType)),e.authenticationScheme!==a.hO.POP?[3,2]:[4,new c.$(this.cryptoUtils).generateCnf(e)];case 1:return s=r.sent(),t.addPopToken(s),[3,3];case 2:if(e.authenticationScheme===a.hO.SSH){if(!e.sshJwk)throw l.r.createMissingSshJwkError();t.addSshJwk(e.sshJwk)}r.label=3;case 3:if((!u.x.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case g.G.HOME_ACCOUNT_ID:try{d=(0,m.j)(e.ccsCredential.credential),t.addCcsOid(d)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case g.G.UPN:t.addCcsUpn(e.ccsCredential.credential)}return[2,t.createQueryString()]}}))}))},t}(o.W)},43387:(e,t,n)=>{"use strict";n.d(t,{g:()=>p});var r=n(5096),o=n(13761),i=n(70591),a=n(33848),s=n(28508),c=n(60742),u=n(47181),l=n(32105),d=n(77891),p=function(e){function t(t){return e.call(this,t)||this}return(0,r.ZT)(t,e),t.prototype.acquireToken=function(e){return(0,r.mG)(this,void 0,void 0,(function(){var t;return(0,r.Jh)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.acquireCachedToken(e)];case 1:return[2,n.sent()];case 2:if((t=n.sent())instanceof c.e&&t.errorCode===c.A.tokenRefreshRequired.code)return[2,new s.Y(this.config).acquireTokenByRefreshToken(e)];throw t;case 3:return[2]}}))}))},t.prototype.acquireCachedToken=function(e){var t,n,o,i;return(0,r.mG)(this,void 0,void 0,(function(){var s,l;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:if(!e)throw u.r.createEmptyTokenRequestError();if(e.forceRefresh)throw null===(t=this.serverTelemetryManager)||void 0===t||t.setCacheOutcome(d.To.FORCE_REFRESH),this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because forceRefresh is true."),c.e.createRefreshRequiredError();if(!e.account)throw c.e.createNoAccountInSilentRequestError();if(s=e.authority||this.authority.getPreferredCache(),!(l=this.cacheManager.readCacheRecord(e.account,this.config.authOptions.clientId,e,s)).accessToken)throw null===(n=this.serverTelemetryManager)||void 0===n||n.setCacheOutcome(d.To.NO_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),c.e.createRefreshRequiredError();if(a.I.wasClockTurnedBack(l.accessToken.cachedAt)||a.I.isTokenExpired(l.accessToken.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw null===(o=this.serverTelemetryManager)||void 0===o||o.setCacheOutcome(d.To.CACHED_ACCESS_TOKEN_EXPIRED),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token is expired or will expire within "+this.config.systemOptions.tokenRenewalOffsetSeconds+" seconds."),c.e.createRefreshRequiredError();if(l.accessToken.refreshOn&&a.I.isTokenExpired(l.accessToken.refreshOn,0))throw null===(i=this.serverTelemetryManager)||void 0===i||i.setCacheOutcome(d.To.REFRESH_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'."),c.e.createRefreshRequiredError();return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[4,this.generateResultFromCacheRecord(l,e)];case 1:return[2,r.sent()]}}))}))},t.prototype.generateResultFromCacheRecord=function(e,t){return(0,r.mG)(this,void 0,void 0,(function(){var n;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:return e.idToken&&(n=new i.H(e.idToken.secret,this.config.cryptoInterface)),[4,l.s.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,n)];case 1:return[2,r.sent()]}}))}))},t}(o.W)},14854:(e,t,n)=>{"use strict";n.d(t,{z:()=>l,j:()=>g});var r=n(5096),o=n(66561),i=n(87342),a=n(21362),s=n(77891),c=n(26246),u=n(67656),l={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},d={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:a.i.Info,correlationId:""},p={sendGetRequestAsync:function(){return(0,r.mG)(this,void 0,void 0,(function(){return(0,r.Jh)(this,(function(e){throw i.l.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented")}))}))},sendPostRequestAsync:function(){return(0,r.mG)(this,void 0,void 0,(function(){return(0,r.Jh)(this,(function(e){throw i.l.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented")}))}))}},h={sku:s.gT.SKU,version:c.i,cpu:"",os:""},f={clientSecret:"",clientAssertion:void 0};function g(e){var t,n=e.authOptions,i=e.systemOptions,a=e.loggerOptions,s=e.storageInterface,c=e.networkInterface,g=e.cryptoInterface,m=e.clientCredentials,v=e.libraryInfo,y=e.serverTelemetryManager,C=e.persistencePlugin,E=e.serializableCache,T=(0,r.pi)((0,r.pi)({},d),a);return{authOptions:(t=n,(0,r.pi)({clientCapabilities:[]},t)),systemOptions:(0,r.pi)((0,r.pi)({},l),i),loggerOptions:T,storageInterface:s||new u.w(n.clientId,o.d),networkInterface:c||p,cryptoInterface:g||o.d,clientCredentials:m||f,libraryInfo:(0,r.pi)((0,r.pi)({},h),v),serverTelemetryManager:y||null,persistencePlugin:C||null,serializableCache:E||null}}},66561:(e,t,n)=>{"use strict";n.d(t,{d:()=>i});var r=n(5096),o=n(87342),i={createNewGuid:function(){throw o.l.createUnexpectedError("Crypto interface - createNewGuid() has not been implemented")},base64Decode:function(){throw o.l.createUnexpectedError("Crypto interface - base64Decode() has not been implemented")},base64Encode:function(){throw o.l.createUnexpectedError("Crypto interface - base64Encode() has not been implemented")},generatePkceCodes:function(){return(0,r.mG)(this,void 0,void 0,(function(){return(0,r.Jh)(this,(function(e){throw o.l.createUnexpectedError("Crypto interface - generatePkceCodes() has not been implemented")}))}))},getPublicKeyThumbprint:function(){return(0,r.mG)(this,void 0,void 0,(function(){return(0,r.Jh)(this,(function(e){throw o.l.createUnexpectedError("Crypto interface - getPublicKeyThumbprint() has not been implemented")}))}))},removeTokenBindingKey:function(){return(0,r.mG)(this,void 0,void 0,(function(){return(0,r.Jh)(this,(function(e){throw o.l.createUnexpectedError("Crypto interface - removeTokenBindingKey() has not been implemented")}))}))},clearKeystore:function(){return(0,r.mG)(this,void 0,void 0,(function(){return(0,r.Jh)(this,(function(e){throw o.l.createUnexpectedError("Crypto interface - clearKeystore() has not been implemented")}))}))},signJwt:function(){return(0,r.mG)(this,void 0,void 0,(function(){return(0,r.Jh)(this,(function(e){throw o.l.createUnexpectedError("Crypto interface - signJwt() has not been implemented")}))}))},hashString:function(){return(0,r.mG)(this,void 0,void 0,(function(){return(0,r.Jh)(this,(function(e){throw o.l.createUnexpectedError("Crypto interface - hashString() has not been implemented")}))}))}}},17650:(e,t,n)=>{"use strict";n.d(t,{$:()=>u});var r,o=n(5096),i=n(70591),a=n(33848),s=n(99860),c=n(60742);!function(e){e.SW="sw",e.UHW="uhw"}(r||(r={}));var u=function(){function e(e){this.cryptoUtils=e}return e.prototype.generateCnf=function(e){return(0,o.mG)(this,void 0,void 0,(function(){var t;return(0,o.Jh)(this,(function(n){switch(n.label){case 0:return[4,this.generateKid(e)];case 1:return t=n.sent(),[2,this.cryptoUtils.base64Encode(JSON.stringify(t))]}}))}))},e.prototype.generateKid=function(e){return(0,o.mG)(this,void 0,void 0,(function(){return(0,o.Jh)(this,(function(t){switch(t.label){case 0:return[4,this.cryptoUtils.getPublicKeyThumbprint(e)];case 1:return[2,{kid:t.sent(),xms_ksl:r.SW}]}}))}))},e.prototype.signPopToken=function(e,t){var n;return(0,o.mG)(this,void 0,void 0,(function(){var r;return(0,o.Jh)(this,(function(o){if(r=i.H.extractTokenClaims(e,this.cryptoUtils),!(null===(n=null==r?void 0:r.cnf)||void 0===n?void 0:n.kid))throw c.e.createTokenClaimsRequiredError();return[2,this.signPayload(e,r.cnf.kid,t)]}))}))},e.prototype.signPayload=function(e,t,n,r){return(0,o.mG)(this,void 0,void 0,(function(){var i,c,u,l,d,p;return(0,o.Jh)(this,(function(h){switch(h.label){case 0:return i=n.resourceRequestMethod,c=n.resourceRequestUri,u=n.shrClaims,l=n.shrNonce,d=c?new s.G(c):void 0,p=null==d?void 0:d.getUrlComponents(),[4,this.cryptoUtils.signJwt((0,o.pi)({at:e,ts:a.I.nowSeconds(),m:null==i?void 0:i.toUpperCase(),u:null==p?void 0:p.HostNameAndPort,nonce:l||this.cryptoUtils.createNewGuid(),p:null==p?void 0:p.AbsolutePath,q:(null==p?void 0:p.QueryString)?[[],p.QueryString]:void 0,client_claims:u||void 0},r),t)];case 1:return[2,h.sent()]}}))}))},e}()},87342:(e,t,n)=>{"use strict";n.d(t,{l:()=>a,Y:()=>i});var r=n(5096),o=n(77891),i={unexpectedError:{code:"unexpected_error",desc:"Unexpected error in authentication."}},a=function(e){function t(n,r,i){var a=this,s=r?n+": "+r:n;return a=e.call(this,s)||this,Object.setPrototypeOf(a,t.prototype),a.errorCode=n||o.gT.EMPTY_STRING,a.errorMessage=r||"",a.subError=i||"",a.name="AuthError",a}return(0,r.ZT)(t,e),t.prototype.setCorrelationId=function(e){this.correlationId=e},t.createUnexpectedError=function(e){return new t(i.unexpectedError.code,i.unexpectedError.desc+": "+e)},t}(Error)},60742:(e,t,n)=>{"use strict";n.d(t,{e:()=>a,A:()=>i});var r=n(5096),o=n(87342),i={clientInfoDecodingError:{code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},clientInfoEmptyError:{code:"client_info_empty_error",desc:"The client info was empty. Please review the trace to determine the root cause."},tokenParsingError:{code:"token_parsing_error",desc:"Token cannot be parsed. Please review stack trace to determine root cause."},nullOrEmptyToken:{code:"null_or_empty_token",desc:"The token is null or empty. Please review the trace to determine the root cause."},endpointResolutionError:{code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},networkError:{code:"network_error",desc:"Network request failed. Please check network trace to determine root cause."},unableToGetOpenidConfigError:{code:"openid_config_error",desc:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints."},hashNotDeserialized:{code:"hash_not_deserialized",desc:"The hash parameters could not be deserialized. Please review the trace to determine the root cause."},blankGuidGenerated:{code:"blank_guid_generated",desc:"The guid generated was blank. Please review the trace to determine the root cause."},invalidStateError:{code:"invalid_state",desc:"State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState()."},stateMismatchError:{code:"state_mismatch",desc:"State mismatch error. Please check your network. Continued requests may cause cache overflow."},stateNotFoundError:{code:"state_not_found",desc:"State not found"},nonceMismatchError:{code:"nonce_mismatch",desc:"Nonce mismatch error. This may be caused by a race condition in concurrent requests."},nonceNotFoundError:{code:"nonce_not_found",desc:"nonce not found"},noTokensFoundError:{code:"no_tokens_found",desc:"No tokens were found for the given scopes, and no authorization code was passed to acquireToken. You must retrieve an authorization code before making a call to acquireToken()."},multipleMatchingTokens:{code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account."},multipleMatchingAccounts:{code:"multiple_matching_accounts",desc:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account"},multipleMatchingAppMetadata:{code:"multiple_matching_appMetadata",desc:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata"},tokenRequestCannotBeMade:{code:"request_cannot_be_made",desc:"Token request cannot be made without authorization code or refresh token."},appendEmptyScopeError:{code:"cannot_append_empty_scope",desc:"Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info."},removeEmptyScopeError:{code:"cannot_remove_empty_scope",desc:"Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info."},appendScopeSetError:{code:"cannot_append_scopeset",desc:"Cannot append ScopeSet due to error."},emptyInputScopeSetError:{code:"empty_input_scopeset",desc:"Empty input ScopeSet cannot be processed."},DeviceCodePollingCancelled:{code:"device_code_polling_cancelled",desc:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true."},DeviceCodeExpired:{code:"device_code_expired",desc:"Device code is expired."},DeviceCodeUnknownError:{code:"device_code_unknown_error",desc:"Device code stopped polling for unknown reasons."},NoAccountInSilentRequest:{code:"no_account_in_silent_request",desc:"Please pass an account object, silent flow is not supported without account information"},invalidCacheRecord:{code:"invalid_cache_record",desc:"Cache record object was null or undefined."},invalidCacheEnvironment:{code:"invalid_cache_environment",desc:"Invalid environment when attempting to create cache entry"},noAccountFound:{code:"no_account_found",desc:"No account found in cache for given key."},CachePluginError:{code:"no cache plugin set on CacheManager",desc:"ICachePlugin needs to be set before using readFromStorage or writeFromStorage"},noCryptoObj:{code:"no_crypto_object",desc:"No crypto object detected. This is required for the following operation: "},invalidCacheType:{code:"invalid_cache_type",desc:"Invalid cache type"},unexpectedAccountType:{code:"unexpected_account_type",desc:"Unexpected account type."},unexpectedCredentialType:{code:"unexpected_credential_type",desc:"Unexpected credential type."},invalidAssertion:{code:"invalid_assertion",desc:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515"},invalidClientCredential:{code:"invalid_client_credential",desc:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential"},tokenRefreshRequired:{code:"token_refresh_required",desc:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired."},userTimeoutReached:{code:"user_timeout_reached",desc:"User defined timeout for device code polling reached"},tokenClaimsRequired:{code:"token_claims_cnf_required_for_signedjwt",desc:"Cannot generate a POP jwt if the token_claims are not populated"},noAuthorizationCodeFromServer:{code:"authorization_code_missing_from_server_response",desc:"Server response does not contain an authorization code to proceed"},noAzureRegionDetected:{code:"no_azure_region_detected",desc:"No azure region was detected and no fallback was made available"},accessTokenEntityNullError:{code:"access_token_entity_null",desc:"Access token entity is null, please check logs and cache to ensure a valid access token is present."},bindingKeyNotRemovedError:{code:"binding_key_not_removed",desc:"Could not remove the credential's binding key from storage."},logoutNotSupported:{code:"end_session_endpoint_not_supported",desc:"Provided authority does not support logout."}},a=function(e){function t(n,r){var o=e.call(this,n,r)||this;return o.name="ClientAuthError",Object.setPrototypeOf(o,t.prototype),o}return(0,r.ZT)(t,e),t.createClientInfoDecodingError=function(e){return new t(i.clientInfoDecodingError.code,i.clientInfoDecodingError.desc+" Failed with error: "+e)},t.createClientInfoEmptyError=function(){return new t(i.clientInfoEmptyError.code,""+i.clientInfoEmptyError.desc)},t.createTokenParsingError=function(e){return new t(i.tokenParsingError.code,i.tokenParsingError.desc+" Failed with error: "+e)},t.createTokenNullOrEmptyError=function(e){return new t(i.nullOrEmptyToken.code,i.nullOrEmptyToken.desc+" Raw Token Value: "+e)},t.createEndpointDiscoveryIncompleteError=function(e){return new t(i.endpointResolutionError.code,i.endpointResolutionError.desc+" Detail: "+e)},t.createNetworkError=function(e,n){return new t(i.networkError.code,i.networkError.desc+" | Fetch client threw: "+n+" | Attempted to reach: "+e.split("?")[0])},t.createUnableToGetOpenidConfigError=function(e){return new t(i.unableToGetOpenidConfigError.code,i.unableToGetOpenidConfigError.desc+" Attempted to retrieve endpoints from: "+e)},t.createHashNotDeserializedError=function(e){return new t(i.hashNotDeserialized.code,i.hashNotDeserialized.desc+" Given Object: "+e)},t.createInvalidStateError=function(e,n){return new t(i.invalidStateError.code,i.invalidStateError.desc+" Invalid State: "+e+", Root Err: "+n)},t.createStateMismatchError=function(){return new t(i.stateMismatchError.code,i.stateMismatchError.desc)},t.createStateNotFoundError=function(e){return new t(i.stateNotFoundError.code,i.stateNotFoundError.desc+":  "+e)},t.createNonceMismatchError=function(){return new t(i.nonceMismatchError.code,i.nonceMismatchError.desc)},t.createNonceNotFoundError=function(e){return new t(i.nonceNotFoundError.code,i.nonceNotFoundError.desc+":  "+e)},t.createMultipleMatchingTokensInCacheError=function(){return new t(i.multipleMatchingTokens.code,i.multipleMatchingTokens.desc+".")},t.createMultipleMatchingAccountsInCacheError=function(){return new t(i.multipleMatchingAccounts.code,i.multipleMatchingAccounts.desc)},t.createMultipleMatchingAppMetadataInCacheError=function(){return new t(i.multipleMatchingAppMetadata.code,i.multipleMatchingAppMetadata.desc)},t.createTokenRequestCannotBeMadeError=function(){return new t(i.tokenRequestCannotBeMade.code,i.tokenRequestCannotBeMade.desc)},t.createAppendEmptyScopeToSetError=function(e){return new t(i.appendEmptyScopeError.code,i.appendEmptyScopeError.desc+" Given Scope: "+e)},t.createRemoveEmptyScopeFromSetError=function(e){return new t(i.removeEmptyScopeError.code,i.removeEmptyScopeError.desc+" Given Scope: "+e)},t.createAppendScopeSetError=function(e){return new t(i.appendScopeSetError.code,i.appendScopeSetError.desc+" Detail Error: "+e)},t.createEmptyInputScopeSetError=function(){return new t(i.emptyInputScopeSetError.code,""+i.emptyInputScopeSetError.desc)},t.createDeviceCodeCancelledError=function(){return new t(i.DeviceCodePollingCancelled.code,""+i.DeviceCodePollingCancelled.desc)},t.createDeviceCodeExpiredError=function(){return new t(i.DeviceCodeExpired.code,""+i.DeviceCodeExpired.desc)},t.createDeviceCodeUnknownError=function(){return new t(i.DeviceCodeUnknownError.code,""+i.DeviceCodeUnknownError.desc)},t.createNoAccountInSilentRequestError=function(){return new t(i.NoAccountInSilentRequest.code,""+i.NoAccountInSilentRequest.desc)},t.createNullOrUndefinedCacheRecord=function(){return new t(i.invalidCacheRecord.code,i.invalidCacheRecord.desc)},t.createInvalidCacheEnvironmentError=function(){return new t(i.invalidCacheEnvironment.code,i.invalidCacheEnvironment.desc)},t.createNoAccountFoundError=function(){return new t(i.noAccountFound.code,i.noAccountFound.desc)},t.createCachePluginError=function(){return new t(i.CachePluginError.code,""+i.CachePluginError.desc)},t.createNoCryptoObjectError=function(e){return new t(i.noCryptoObj.code,""+i.noCryptoObj.desc+e)},t.createInvalidCacheTypeError=function(){return new t(i.invalidCacheType.code,""+i.invalidCacheType.desc)},t.createUnexpectedAccountTypeError=function(){return new t(i.unexpectedAccountType.code,""+i.unexpectedAccountType.desc)},t.createUnexpectedCredentialTypeError=function(){return new t(i.unexpectedCredentialType.code,""+i.unexpectedCredentialType.desc)},t.createInvalidAssertionError=function(){return new t(i.invalidAssertion.code,""+i.invalidAssertion.desc)},t.createInvalidCredentialError=function(){return new t(i.invalidClientCredential.code,""+i.invalidClientCredential.desc)},t.createRefreshRequiredError=function(){return new t(i.tokenRefreshRequired.code,i.tokenRefreshRequired.desc)},t.createUserTimeoutReachedError=function(){return new t(i.userTimeoutReached.code,i.userTimeoutReached.desc)},t.createTokenClaimsRequiredError=function(){return new t(i.tokenClaimsRequired.code,i.tokenClaimsRequired.desc)},t.createNoAuthCodeInServerResponseError=function(){return new t(i.noAuthorizationCodeFromServer.code,i.noAuthorizationCodeFromServer.desc)},t.createBindingKeyNotRemovedError=function(){return new t(i.bindingKeyNotRemovedError.code,i.bindingKeyNotRemovedError.desc)},t.createLogoutNotSupportedError=function(){return new t(i.logoutNotSupported.code,i.logoutNotSupported.desc)},t}(o.l)},47181:(e,t,n)=>{"use strict";n.d(t,{r:()=>a,L:()=>i});var r=n(5096),o=n(60742),i={redirectUriNotSet:{code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},postLogoutUriNotSet:{code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},claimsRequestParsingError:{code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},authorityUriInsecure:{code:"authority_uri_insecure",desc:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},urlParseError:{code:"url_parse_error",desc:"URL could not be parsed into appropriate segments."},urlEmptyError:{code:"empty_url_error",desc:"URL was empty or null."},emptyScopesError:{code:"empty_input_scopes_error",desc:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token."},nonArrayScopesError:{code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},clientIdSingleScopeError:{code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},invalidPrompt:{code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent', 'create' and 'none'.  Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest"},invalidClaimsRequest:{code:"invalid_claims",desc:"Given claims parameter must be a stringified JSON object."},tokenRequestEmptyError:{code:"token_request_empty",desc:"Token request was empty and not found in cache."},logoutRequestEmptyError:{code:"logout_request_empty",desc:"The logout request was null or undefined."},invalidCodeChallengeMethod:{code:"invalid_code_challenge_method",desc:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".'},invalidCodeChallengeParams:{code:"pkce_params_missing",desc:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request"},invalidCloudDiscoveryMetadata:{code:"invalid_cloud_discovery_metadata",desc:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields"},invalidAuthorityMetadata:{code:"invalid_authority_metadata",desc:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields."},untrustedAuthority:{code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter."},missingSshJwk:{code:"missing_ssh_jwk",desc:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme."},missingSshKid:{code:"missing_ssh_kid",desc:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme."},missingNonceAuthenticationHeader:{code:"missing_nonce_authentication_header",desc:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce."},invalidAuthenticationHeader:{code:"invalid_authentication_header",desc:"Invalid authentication header provided"}},a=function(e){function t(n,r){var o=e.call(this,n,r)||this;return o.name="ClientConfigurationError",Object.setPrototypeOf(o,t.prototype),o}return(0,r.ZT)(t,e),t.createRedirectUriEmptyError=function(){return new t(i.redirectUriNotSet.code,i.redirectUriNotSet.desc)},t.createPostLogoutRedirectUriEmptyError=function(){return new t(i.postLogoutUriNotSet.code,i.postLogoutUriNotSet.desc)},t.createClaimsRequestParsingError=function(e){return new t(i.claimsRequestParsingError.code,i.claimsRequestParsingError.desc+" Given value: "+e)},t.createInsecureAuthorityUriError=function(e){return new t(i.authorityUriInsecure.code,i.authorityUriInsecure.desc+" Given URI: "+e)},t.createUrlParseError=function(e){return new t(i.urlParseError.code,i.urlParseError.desc+" Given Error: "+e)},t.createUrlEmptyError=function(){return new t(i.urlEmptyError.code,i.urlEmptyError.desc)},t.createEmptyScopesArrayError=function(){return new t(i.emptyScopesError.code,""+i.emptyScopesError.desc)},t.createClientIdSingleScopeError=function(e){return new t(i.clientIdSingleScopeError.code,i.clientIdSingleScopeError.desc+" Given Scopes: "+e)},t.createInvalidPromptError=function(e){return new t(i.invalidPrompt.code,i.invalidPrompt.desc+" Given value: "+e)},t.createInvalidClaimsRequestError=function(){return new t(i.invalidClaimsRequest.code,i.invalidClaimsRequest.desc)},t.createEmptyLogoutRequestError=function(){return new t(i.logoutRequestEmptyError.code,i.logoutRequestEmptyError.desc)},t.createEmptyTokenRequestError=function(){return new t(i.tokenRequestEmptyError.code,i.tokenRequestEmptyError.desc)},t.createInvalidCodeChallengeMethodError=function(){return new t(i.invalidCodeChallengeMethod.code,i.invalidCodeChallengeMethod.desc)},t.createInvalidCodeChallengeParamsError=function(){return new t(i.invalidCodeChallengeParams.code,i.invalidCodeChallengeParams.desc)},t.createInvalidCloudDiscoveryMetadataError=function(){return new t(i.invalidCloudDiscoveryMetadata.code,i.invalidCloudDiscoveryMetadata.desc)},t.createInvalidAuthorityMetadataError=function(){return new t(i.invalidAuthorityMetadata.code,i.invalidAuthorityMetadata.desc)},t.createUntrustedAuthorityError=function(){return new t(i.untrustedAuthority.code,i.untrustedAuthority.desc)},t.createMissingSshJwkError=function(){return new t(i.missingSshJwk.code,i.missingSshJwk.desc)},t.createMissingSshKidError=function(){return new t(i.missingSshKid.code,i.missingSshKid.desc)},t.createMissingNonceAuthenticationHeadersError=function(){return new t(i.missingNonceAuthenticationHeader.code,i.missingNonceAuthenticationHeader.desc)},t.createInvalidAuthenticationHeaderError=function(e,n){return new t(i.invalidAuthenticationHeader.code,i.invalidAuthenticationHeader.desc+". Invalid header: "+e+". Details: "+n)},t}(o.e)},83927:(e,t,n)=>{"use strict";n.d(t,{Yo:()=>c,Zy:()=>s});var r=n(5096),o=n(87342),i=["interaction_required","consent_required","login_required"],a=["message_only","additional_action","basic_action","user_password_expired","consent_required"],s={noTokensFoundError:{code:"no_tokens_found",desc:"No refresh token found in the cache. Please sign-in."}},c=function(e){function t(n,r,o){var i=e.call(this,n,r,o)||this;return i.name="InteractionRequiredAuthError",Object.setPrototypeOf(i,t.prototype),i}return(0,r.ZT)(t,e),t.isInteractionRequiredError=function(e,t,n){var r=!!e&&i.indexOf(e)>-1,o=!!n&&a.indexOf(n)>-1,s=!!t&&i.some((function(e){return t.indexOf(e)>-1}));return r||s||o},t.createNoTokensFoundError=function(){return new t(s.noTokensFoundError.code,s.noTokensFoundError.desc)},t}(o.l)},91359:(e,t,n)=>{"use strict";n.d(t,{n:()=>o});var r=n(5096),o=function(e){function t(n,r,o){var i=e.call(this,n,r,o)||this;return i.name="ServerError",Object.setPrototypeOf(i,t.prototype),i}return(0,r.ZT)(t,e),t}(n(87342).l)},21362:(e,t,n)=>{"use strict";n.d(t,{i:()=>r,Y:()=>a});var r,o=n(61653),i=n(77891);!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"}(r||(r={}));var a=function(){function e(e,t,n){this.level=r.Info,this.localCallback=e.loggerCallback||function(){},this.piiLoggingEnabled=e.piiLoggingEnabled||!1,this.level="number"==typeof e.logLevel?e.logLevel:r.Info,this.correlationId=e.correlationId||"",this.packageName=t||i.gT.EMPTY_STRING,this.packageVersion=n||i.gT.EMPTY_STRING}return e.prototype.clone=function(t,n,r){return new e({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:r||this.correlationId},t,n)},e.prototype.logMessage=function(e,t){if(!(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)){var n=(new Date).toUTCString(),i=(o.x.isEmpty(t.correlationId)?o.x.isEmpty(this.correlationId)?"["+n+"]":"["+n+"] : ["+this.correlationId+"]":"["+n+"] : ["+t.correlationId+"]")+" : "+this.packageName+"@"+this.packageVersion+" : "+r[t.logLevel]+" - "+e;this.executeCallback(t.logLevel,i,t.containsPii||!1)}},e.prototype.executeCallback=function(e,t,n){this.localCallback&&this.localCallback(e,t,n)},e.prototype.error=function(e,t){this.logMessage(e,{logLevel:r.Error,containsPii:!1,correlationId:t||""})},e.prototype.errorPii=function(e,t){this.logMessage(e,{logLevel:r.Error,containsPii:!0,correlationId:t||""})},e.prototype.warning=function(e,t){this.logMessage(e,{logLevel:r.Warning,containsPii:!1,correlationId:t||""})},e.prototype.warningPii=function(e,t){this.logMessage(e,{logLevel:r.Warning,containsPii:!0,correlationId:t||""})},e.prototype.info=function(e,t){this.logMessage(e,{logLevel:r.Info,containsPii:!1,correlationId:t||""})},e.prototype.infoPii=function(e,t){this.logMessage(e,{logLevel:r.Info,containsPii:!0,correlationId:t||""})},e.prototype.verbose=function(e,t){this.logMessage(e,{logLevel:r.Verbose,containsPii:!1,correlationId:t||""})},e.prototype.verbosePii=function(e,t){this.logMessage(e,{logLevel:r.Verbose,containsPii:!0,correlationId:t||""})},e.prototype.trace=function(e,t){this.logMessage(e,{logLevel:r.Trace,containsPii:!1,correlationId:t||""})},e.prototype.tracePii=function(e,t){this.logMessage(e,{logLevel:r.Trace,containsPii:!0,correlationId:t||""})},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},e}()},30658:(e,t,n)=>{"use strict";n.d(t,{y:()=>o});var r=n(87342),o={sendGetRequestAsync:function(){return Promise.reject(r.l.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented for the Network interface."))},sendPostRequestAsync:function(){return Promise.reject(r.l.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented for the Network interface."))}}},97482:(e,t,n)=>{"use strict";n.d(t,{r:()=>s});var r=n(5096),o=n(47282),i=n(60742),a=n(87342),s=function(){function e(e,t){this.networkClient=e,this.cacheManager=t}return e.prototype.sendPostRequest=function(e,t,n){return(0,r.mG)(this,void 0,void 0,(function(){var s,c;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:o.v.preProcess(this.cacheManager,e),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.networkClient.sendPostRequestAsync(t,n)];case 2:return s=r.sent(),[3,4];case 3:throw(c=r.sent())instanceof a.l?c:i.e.createNetworkError(t,c);case 4:return o.v.postProcess(this.cacheManager,e,s),[2,s]}}))}))},e}()},47282:(e,t,n)=>{"use strict";n.d(t,{v:()=>i});var r=n(77891),o=n(91359),i=function(){function e(){}return e.generateThrottlingStorageKey=function(e){return r.bb.THROTTLING_PREFIX+"."+JSON.stringify(e)},e.preProcess=function(t,n){var i,a=e.generateThrottlingStorageKey(n),s=t.getThrottlingCache(a);if(s){if(s.throttleTime<Date.now())return void t.removeItem(a,r.Xj.THROTTLING);throw new o.n((null===(i=s.errorCodes)||void 0===i?void 0:i.join(" "))||r.gT.EMPTY_STRING,s.errorMessage,s.subError)}},e.postProcess=function(t,n,o){if(e.checkResponseStatus(o)||e.checkResponseForRetryAfter(o)){var i={throttleTime:e.calculateThrottleTime(parseInt(o.headers[r.SZ.RETRY_AFTER])),error:o.body.error,errorCodes:o.body.error_codes,errorMessage:o.body.error_description,subError:o.body.suberror};t.setThrottlingCache(e.generateThrottlingStorageKey(n),i)}},e.checkResponseStatus=function(e){return 429===e.status||e.status>=500&&e.status<600},e.checkResponseForRetryAfter=function(e){return!!e.headers&&e.headers.hasOwnProperty(r.SZ.RETRY_AFTER)&&(e.status<200||e.status>=300)},e.calculateThrottleTime=function(e){var t=e<=0?0:e,n=Date.now()/1e3;return Math.floor(1e3*Math.min(n+(t||r.bb.DEFAULT_THROTTLE_TIME_SECONDS),n+r.bb.DEFAULT_MAX_THROTTLE_TIME_SECONDS))},e.removeThrottle=function(e,t,n,o){var i={clientId:t,authority:n.authority,scopes:n.scopes,homeAccountIdentifier:o,claims:n.claims,authenticationScheme:n.authenticationScheme,resourceRequestMethod:n.resourceRequestMethod,resourceRequestUri:n.resourceRequestUri,shrClaims:n.shrClaims,sshKid:n.sshKid},a=this.generateThrottlingStorageKey(i);return e.removeItem(a,r.Xj.THROTTLING)},e}()},26246:(e,t,n)=>{"use strict";n.d(t,{u:()=>r,i:()=>o});var r="@azure/msal-common",o="6.0.0"},32030:(e,t,n)=>{"use strict";n.d(t,{d:()=>i});var r=n(47181),o=n(77891),i=function(){function e(e){this.headers=e}return e.prototype.getShrNonce=function(){var e=this.headers[o.SZ.AuthenticationInfo];if(e){var t=this.parseChallenges(e);if(t.nextnonce)return t.nextnonce;throw r.r.createInvalidAuthenticationHeaderError(o.SZ.AuthenticationInfo,"nextnonce challenge is missing.")}var n=this.headers[o.SZ.WWWAuthenticate];if(n){var i=this.parseChallenges(n);if(i.nonce)return i.nonce;throw r.r.createInvalidAuthenticationHeaderError(o.SZ.WWWAuthenticate,"nonce challenge is missing.")}throw r.r.createMissingNonceAuthenticationHeadersError()},e.prototype.parseChallenges=function(e){var t=e.indexOf(" "),n=e.substr(t+1).split(","),r={};return n.forEach((function(e){var t=e.split("="),n=t[0],o=t[1];r[n]=unescape(o.replace(/['"]+/g,""))})),r},e}()},87479:(e,t,n)=>{"use strict";n.d(t,{H:()=>u});var r=n(5096),o=n(77891),i=n(92613),a=n(47181),s=n(5035),c=n(61653),u=function(){function e(){this.parameters=new Map}return e.prototype.addResponseTypeCode=function(){this.parameters.set(o.Fo.RESPONSE_TYPE,encodeURIComponent(o.gT.CODE_RESPONSE_TYPE))},e.prototype.addResponseMode=function(e){this.parameters.set(o.Fo.RESPONSE_MODE,encodeURIComponent(e||o.vw.QUERY))},e.prototype.addScopes=function(e,t){void 0===t&&(t=!0);var n=t?(0,r.pr)(e||[],o.f_):e||[],a=new i.i(n);this.parameters.set(o.Fo.SCOPE,encodeURIComponent(a.printScopes()))},e.prototype.addClientId=function(e){this.parameters.set(o.Fo.CLIENT_ID,encodeURIComponent(e))},e.prototype.addRedirectUri=function(e){s.D.validateRedirectUri(e),this.parameters.set(o.Fo.REDIRECT_URI,encodeURIComponent(e))},e.prototype.addPostLogoutRedirectUri=function(e){s.D.validateRedirectUri(e),this.parameters.set(o.Fo.POST_LOGOUT_URI,encodeURIComponent(e))},e.prototype.addIdTokenHint=function(e){this.parameters.set(o.Fo.ID_TOKEN_HINT,encodeURIComponent(e))},e.prototype.addDomainHint=function(e){this.parameters.set(o.VO.DOMAIN_HINT,encodeURIComponent(e))},e.prototype.addLoginHint=function(e){this.parameters.set(o.VO.LOGIN_HINT,encodeURIComponent(e))},e.prototype.addCcsUpn=function(e){this.parameters.set(o.SZ.CCS_HEADER,encodeURIComponent("UPN:"+e))},e.prototype.addCcsOid=function(e){this.parameters.set(o.SZ.CCS_HEADER,encodeURIComponent("Oid:"+e.uid+"@"+e.utid))},e.prototype.addSid=function(e){this.parameters.set(o.VO.SID,encodeURIComponent(e))},e.prototype.addClaims=function(e,t){var n=this.addClientCapabilitiesToClaims(e,t);s.D.validateClaims(n),this.parameters.set(o.Fo.CLAIMS,encodeURIComponent(n))},e.prototype.addCorrelationId=function(e){this.parameters.set(o.Fo.CLIENT_REQUEST_ID,encodeURIComponent(e))},e.prototype.addLibraryInfo=function(e){this.parameters.set(o.Fo.X_CLIENT_SKU,e.sku),this.parameters.set(o.Fo.X_CLIENT_VER,e.version),this.parameters.set(o.Fo.X_CLIENT_OS,e.os),this.parameters.set(o.Fo.X_CLIENT_CPU,e.cpu)},e.prototype.addPrompt=function(e){s.D.validatePrompt(e),this.parameters.set(""+o.Fo.PROMPT,encodeURIComponent(e))},e.prototype.addState=function(e){c.x.isEmpty(e)||this.parameters.set(o.Fo.STATE,encodeURIComponent(e))},e.prototype.addNonce=function(e){this.parameters.set(o.Fo.NONCE,encodeURIComponent(e))},e.prototype.addCodeChallengeParams=function(e,t){if(s.D.validateCodeChallengeParams(e,t),!e||!t)throw a.r.createInvalidCodeChallengeParamsError();this.parameters.set(o.Fo.CODE_CHALLENGE,encodeURIComponent(e)),this.parameters.set(o.Fo.CODE_CHALLENGE_METHOD,encodeURIComponent(t))},e.prototype.addAuthorizationCode=function(e){this.parameters.set(o.Fo.CODE,encodeURIComponent(e))},e.prototype.addDeviceCode=function(e){this.parameters.set(o.Fo.DEVICE_CODE,encodeURIComponent(e))},e.prototype.addRefreshToken=function(e){this.parameters.set(o.Fo.REFRESH_TOKEN,encodeURIComponent(e))},e.prototype.addCodeVerifier=function(e){this.parameters.set(o.Fo.CODE_VERIFIER,encodeURIComponent(e))},e.prototype.addClientSecret=function(e){this.parameters.set(o.Fo.CLIENT_SECRET,encodeURIComponent(e))},e.prototype.addClientAssertion=function(e){this.parameters.set(o.Fo.CLIENT_ASSERTION,encodeURIComponent(e))},e.prototype.addClientAssertionType=function(e){this.parameters.set(o.Fo.CLIENT_ASSERTION_TYPE,encodeURIComponent(e))},e.prototype.addOboAssertion=function(e){this.parameters.set(o.Fo.OBO_ASSERTION,encodeURIComponent(e))},e.prototype.addRequestTokenUse=function(e){this.parameters.set(o.Fo.REQUESTED_TOKEN_USE,encodeURIComponent(e))},e.prototype.addGrantType=function(e){this.parameters.set(o.Fo.GRANT_TYPE,encodeURIComponent(e))},e.prototype.addClientInfo=function(){this.parameters.set(o.sR,"1")},e.prototype.addExtraQueryParameters=function(e){var t=this;s.D.sanitizeEQParams(e,this.parameters),Object.keys(e).forEach((function(n){t.parameters.set(n,e[n])}))},e.prototype.addClientCapabilitiesToClaims=function(e,t){var n;if(e)try{n=JSON.parse(e)}catch(e){throw a.r.createInvalidClaimsRequestError()}else n={};return t&&t.length>0&&(n.hasOwnProperty(o.As.ACCESS_TOKEN)||(n[o.As.ACCESS_TOKEN]={}),n[o.As.ACCESS_TOKEN][o.As.XMS_CC]={values:t}),JSON.stringify(n)},e.prototype.addUsername=function(e){this.parameters.set(o.Ge.username,e)},e.prototype.addPassword=function(e){this.parameters.set(o.Ge.password,e)},e.prototype.addPopToken=function(e){c.x.isEmpty(e)||(this.parameters.set(o.Fo.TOKEN_TYPE,o.hO.POP),this.parameters.set(o.Fo.REQ_CNF,encodeURIComponent(e)))},e.prototype.addSshJwk=function(e){c.x.isEmpty(e)||(this.parameters.set(o.Fo.TOKEN_TYPE,o.hO.SSH),this.parameters.set(o.Fo.REQ_CNF,encodeURIComponent(e)))},e.prototype.addServerTelemetry=function(e){this.parameters.set(o.Fo.X_CLIENT_CURR_TELEM,e.generateCurrentRequestHeaderValue()),this.parameters.set(o.Fo.X_CLIENT_LAST_TELEM,e.generateLastRequestHeaderValue())},e.prototype.addThrottling=function(){this.parameters.set(o.Fo.X_MS_LIB_CAPABILITY,o.bb.X_MS_LIB_CAPABILITY_VALUE)},e.prototype.createQueryString=function(){var e=new Array;return this.parameters.forEach((function(t,n){e.push(n+"="+t)})),e.join("&")},e}()},5035:(e,t,n)=>{"use strict";n.d(t,{D:()=>a});var r=n(61653),o=n(47181),i=n(77891),a=function(){function e(){}return e.validateRedirectUri=function(e){if(r.x.isEmpty(e))throw o.r.createRedirectUriEmptyError()},e.validatePrompt=function(e){var t=[];for(var n in i.NJ)t.push(i.NJ[n]);if(t.indexOf(e)<0)throw o.r.createInvalidPromptError(e)},e.validateClaims=function(e){try{JSON.parse(e)}catch(e){throw o.r.createInvalidClaimsRequestError()}},e.validateCodeChallengeParams=function(e,t){if(r.x.isEmpty(e)||r.x.isEmpty(t))throw o.r.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(t)},e.validateCodeChallengeMethod=function(e){if([i.VX.PLAIN,i.VX.S256].indexOf(e)<0)throw o.r.createInvalidCodeChallengeMethodError()},e.sanitizeEQParams=function(e,t){return e?(t.forEach((function(t,n){e[n]&&delete e[n]})),e):{}},e}()},92613:(e,t,n)=>{"use strict";n.d(t,{i:()=>c});var r=n(5096),o=n(47181),i=n(61653),a=n(60742),s=n(77891),c=function(){function e(e){var t=this,n=e?i.x.trimArrayEntries((0,r.pr)(e)):[],o=n?i.x.removeEmptyStringsFromArray(n):[];this.validateInputScopes(o),this.scopes=new Set,o.forEach((function(e){return t.scopes.add(e)}))}return e.fromString=function(t){return new e((t||"").split(" "))},e.prototype.validateInputScopes=function(e){if(!e||e.length<1)throw o.r.createEmptyScopesArrayError()},e.prototype.containsScope=function(t){var n=new e(this.printScopesLowerCase().split(" "));return!i.x.isEmpty(t)&&n.scopes.has(t.toLowerCase())},e.prototype.containsScopeSet=function(e){var t=this;return!(!e||e.scopes.size<=0)&&this.scopes.size>=e.scopes.size&&e.asArray().every((function(e){return t.containsScope(e)}))},e.prototype.containsOnlyOIDCScopes=function(){var e=this,t=0;return s.$f.forEach((function(n){e.containsScope(n)&&(t+=1)})),this.scopes.size===t},e.prototype.appendScope=function(e){i.x.isEmpty(e)||this.scopes.add(e.trim())},e.prototype.appendScopes=function(e){var t=this;try{e.forEach((function(e){return t.appendScope(e)}))}catch(e){throw a.e.createAppendScopeSetError(e)}},e.prototype.removeScope=function(e){if(i.x.isEmpty(e))throw a.e.createRemoveEmptyScopeFromSetError(e);this.scopes.delete(e.trim())},e.prototype.removeOIDCScopes=function(){var e=this;s.$f.forEach((function(t){e.scopes.delete(t)}))},e.prototype.unionScopeSets=function(e){if(!e)throw a.e.createEmptyInputScopeSetError();var t=new Set;return e.scopes.forEach((function(e){return t.add(e.toLowerCase())})),this.scopes.forEach((function(e){return t.add(e.toLowerCase())})),t},e.prototype.intersectingScopeSets=function(e){if(!e)throw a.e.createEmptyInputScopeSetError();e.containsOnlyOIDCScopes()||e.removeOIDCScopes();var t=this.unionScopeSets(e),n=e.getScopeCount(),r=this.getScopeCount();return t.size<r+n},e.prototype.getScopeCount=function(){return this.scopes.size},e.prototype.asArray=function(){var e=[];return this.scopes.forEach((function(t){return e.push(t)})),e},e.prototype.printScopes=function(){return this.scopes?this.asArray().join(" "):""},e.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()},e}()},32105:(e,t,n)=>{"use strict";n.d(t,{s:()=>w});var r=n(5096),o=n(11520),i=n(60742),a=n(61653),s=n(91359),c=n(70591),u=n(92613),l=n(43640),d=n(52944),p=n(70979),h=n(85907),f=n(11429),g=n(83927),m=function(e,t,n,r,o){this.account=e||null,this.idToken=t||null,this.accessToken=n||null,this.refreshToken=r||null,this.appMetadata=o||null},v=n(3516),y=n(77891),C=n(17650),E=n(59993),T=n(59665),w=function(){function e(e,t,n,r,o,i){this.clientId=e,this.cacheStorage=t,this.cryptoObj=n,this.logger=r,this.serializableCache=o,this.persistencePlugin=i}return e.prototype.validateServerAuthorizationCodeResponse=function(e,t,n){if(!e.state||!t)throw e.state?i.e.createStateNotFoundError("Cached State"):i.e.createStateNotFoundError("Server State");if(decodeURIComponent(e.state)!==decodeURIComponent(t))throw i.e.createStateMismatchError();if(e.error||e.error_description||e.suberror){if(g.Yo.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new g.Yo(e.error||y.gT.EMPTY_STRING,e.error_description,e.suberror);throw new s.n(e.error||y.gT.EMPTY_STRING,e.error_description,e.suberror)}e.client_info&&(0,o.B)(e.client_info,n)},e.prototype.validateTokenResponse=function(e){if(e.error||e.error_description||e.suberror){if(g.Yo.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new g.Yo(e.error,e.error_description,e.suberror);var t=e.error_codes+" - ["+e.timestamp+"]: "+e.error_description+" - Correlation ID: "+e.correlation_id+" - Trace ID: "+e.trace_id;throw new s.n(e.error,t,e.suberror)}},e.prototype.handleServerTokenResponse=function(t,n,o,s,u,d,p){return(0,r.mG)(this,void 0,void 0,(function(){var h,f,g,m,C;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:if(t.id_token&&(h=new c.H(t.id_token||y.gT.EMPTY_STRING,this.cryptoObj),u&&!a.x.isEmpty(u.nonce)&&h.claims.nonce!==u.nonce))throw i.e.createNonceMismatchError();this.homeAccountIdentifier=l.r.generateHomeAccountId(t.client_info||y.gT.EMPTY_STRING,n.authorityType,this.logger,this.cryptoObj,h),u&&u.state&&(f=v.C.parseRequestState(this.cryptoObj,u.state)),t.key_id=t.key_id||s.sshKid||void 0,g=this.generateCacheRecord(t,n,o,s,h,d,u),r.label=1;case 1:return r.trys.push([1,,5,8]),this.persistencePlugin&&this.serializableCache?(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),m=new T.C(this.serializableCache,!0),[4,this.persistencePlugin.beforeCacheAccess(m)]):[3,3];case 2:r.sent(),r.label=3;case 3:return p&&g.account&&(C=g.account.generateAccountKey(),!this.cacheStorage.getAccount(C))?(this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),[2,e.generateAuthenticationResult(this.cryptoObj,n,g,!1,s,h,f)]):[4,this.cacheStorage.saveCacheRecord(g)];case 4:return r.sent(),[3,8];case 5:return this.persistencePlugin&&this.serializableCache&&m?(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),[4,this.persistencePlugin.afterCacheAccess(m)]):[3,7];case 6:r.sent(),r.label=7;case 7:return[7];case 8:return[2,e.generateAuthenticationResult(this.cryptoObj,n,g,!1,s,h,f,t.spa_code)]}}))}))},e.prototype.generateCacheRecord=function(e,t,n,r,o,s,c){var l,d,g=t.getPreferredCache();if(a.x.isEmpty(g))throw i.e.createInvalidCacheEnvironmentError();!a.x.isEmpty(e.id_token)&&o&&(l=p.w.createIdTokenEntity(this.homeAccountIdentifier,g,e.id_token||y.gT.EMPTY_STRING,this.clientId,o.claims.tid||y.gT.EMPTY_STRING,s),d=this.generateAccountEntity(e,o,t,s,c));var v=null;if(!a.x.isEmpty(e.access_token)){var C=e.scope?u.i.fromString(e.scope):new u.i(r.scopes||[]),T=("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,w=("string"==typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,b=("string"==typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,S=n+T,I=S+w,A=b&&b>0?n+b:void 0;v=h._.createAccessTokenEntity(this.homeAccountIdentifier,g,e.access_token||y.gT.EMPTY_STRING,this.clientId,o?o.claims.tid||y.gT.EMPTY_STRING:t.tenant,C.printScopes(),S,I,this.cryptoObj,A,e.token_type,s,e.key_id,r.claims,r.requestedClaimsHash)}var _=null;a.x.isEmpty(e.refresh_token)||(_=f.e.createRefreshTokenEntity(this.homeAccountIdentifier,g,e.refresh_token||y.gT.EMPTY_STRING,this.clientId,e.foci,s));var R=null;return a.x.isEmpty(e.foci)||(R=E.T.createAppMetadataEntity(this.clientId,g,e.foci)),new m(d,l,v,_,R)},e.prototype.generateAccountEntity=function(e,t,n,r,o){var s=n.authorityType,c=o?o.cloud_graph_host_name:"",u=o?o.msgraph_host:"";if(s===d.a.Adfs)return this.logger.verbose("Authority type is ADFS, creating ADFS account"),l.r.createGenericAccount(this.homeAccountIdentifier,t,n,r,c,u);if(a.x.isEmpty(e.client_info)&&"AAD"===n.protocolMode)throw i.e.createClientInfoEmptyError();return e.client_info?l.r.createAccount(e.client_info,this.homeAccountIdentifier,t,n,r,c,u):l.r.createGenericAccount(this.homeAccountIdentifier,t,n,r,c,u)},e.generateAuthenticationResult=function(e,t,n,o,i,a,s,c){var l,d,p;return(0,r.mG)(this,void 0,void 0,(function(){var h,f,g,m,v,E,T;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:return h="",f=[],g=null,v=y.gT.EMPTY_STRING,n.accessToken?n.accessToken.tokenType!==y.hO.POP?[3,2]:[4,new C.$(e).signPopToken(n.accessToken.secret,i)]:[3,4];case 1:return h=r.sent(),[3,3];case 2:h=n.accessToken.secret,r.label=3;case 3:f=u.i.fromString(n.accessToken.target).asArray(),g=new Date(1e3*Number(n.accessToken.expiresOn)),m=new Date(1e3*Number(n.accessToken.extendedExpiresOn)),r.label=4;case 4:return n.appMetadata&&(v=n.appMetadata.familyId===y.ch?y.ch:y.gT.EMPTY_STRING),E=(null==a?void 0:a.claims.oid)||(null==a?void 0:a.claims.sub)||y.gT.EMPTY_STRING,T=(null==a?void 0:a.claims.tid)||y.gT.EMPTY_STRING,[2,{authority:t.canonicalAuthority,uniqueId:E,tenantId:T,scopes:f,account:n.account?n.account.getAccountInfo():null,idToken:a?a.rawToken:y.gT.EMPTY_STRING,idTokenClaims:a?a.claims:{},accessToken:h,fromCache:o,expiresOn:g,correlationId:i.correlationId,extExpiresOn:m,familyId:v,tokenType:(null===(l=n.accessToken)||void 0===l?void 0:l.tokenType)||y.gT.EMPTY_STRING,state:s?s.userRequestState:y.gT.EMPTY_STRING,cloudGraphHostName:(null===(d=n.account)||void 0===d?void 0:d.cloudGraphHostName)||y.gT.EMPTY_STRING,msGraphHost:(null===(p=n.account)||void 0===p?void 0:p.msGraphHost)||y.gT.EMPTY_STRING,code:c}]}}))}))},e}()},31093:(e,t,n)=>{"use strict";n.d(t,{d:()=>a});var r=n(77891),o=n(44612),i=n(61653),a=function(){function e(e,t){this.cacheOutcome=r.To.NO_CACHE_HIT,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||r.gT.EMPTY_STRING,this.wrapperVer=e.wrapperVer||r.gT.EMPTY_STRING,this.telemetryCacheKey=r.HN.CACHE_KEY+r.Bv.CACHE_KEY_SEPARATOR+e.clientId}return e.prototype.generateCurrentRequestHeaderValue=function(){var e=""+this.apiId+r.HN.VALUE_SEPARATOR+this.cacheOutcome,t=[this.wrapperSKU,this.wrapperVer].join(r.HN.VALUE_SEPARATOR),n=[e,this.getRegionDiscoveryFields()].join(r.HN.VALUE_SEPARATOR);return[r.HN.SCHEMA_VERSION,n,t].join(r.HN.CATEGORY_SEPARATOR)},e.prototype.generateLastRequestHeaderValue=function(){var t=this.getLastRequests(),n=e.maxErrorsToSend(t),o=t.failedRequests.slice(0,2*n).join(r.HN.VALUE_SEPARATOR),i=t.errors.slice(0,n).join(r.HN.VALUE_SEPARATOR),a=t.errors.length,s=[a,n<a?r.HN.OVERFLOW_TRUE:r.HN.OVERFLOW_FALSE].join(r.HN.VALUE_SEPARATOR);return[r.HN.SCHEMA_VERSION,t.cacheHits,o,i,s].join(r.HN.CATEGORY_SEPARATOR)},e.prototype.cacheFailedRequest=function(e){var t=this.getLastRequests();t.errors.length>=r.HN.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),i.x.isEmpty(e.subError)?i.x.isEmpty(e.errorCode)?e&&e.toString()?t.errors.push(e.toString()):t.errors.push(r.HN.UNKNOWN_ERROR):t.errors.push(e.errorCode):t.errors.push(e.subError),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)},e.prototype.incrementCacheHits=function(){var e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits},e.prototype.getLastRequests=function(){var e=new o.d;return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e},e.prototype.clearTelemetryCache=function(){var t=this.getLastRequests(),n=e.maxErrorsToSend(t);if(n===t.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{var r=new o.d;r.failedRequests=t.failedRequests.slice(2*n),r.errors=t.errors.slice(n),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,r)}},e.maxErrorsToSend=function(e){var t,n=0,o=0,i=e.errors.length;for(t=0;t<i;t++){var a=e.failedRequests[2*t]||r.gT.EMPTY_STRING,s=e.failedRequests[2*t+1]||r.gT.EMPTY_STRING,c=e.errors[t]||r.gT.EMPTY_STRING;if(!((o+=a.toString().length+s.toString().length+c.length+3)<r.HN.MAX_LAST_HEADER_BYTES))break;n+=1}return n},e.prototype.getRegionDiscoveryFields=function(){var e=[];return e.push(this.regionUsed||""),e.push(this.regionSource||""),e.push(this.regionOutcome||""),e.join(",")},e.prototype.updateRegionDiscoveryMetadata=function(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome},e.prototype.setCacheOutcome=function(e){this.cacheOutcome=e},e}()},99860:(e,t,n)=>{"use strict";n.d(t,{G:()=>s});var r=n(47181),o=n(60742),i=n(61653),a=n(77891),s=function(){function e(t){if(this._urlString=t,i.x.isEmpty(this._urlString))throw r.r.createUrlEmptyError();i.x.isEmpty(this.getHash())&&(this._urlString=e.canonicalizeUri(t))}return Object.defineProperty(e.prototype,"urlString",{get:function(){return this._urlString},enumerable:!1,configurable:!0}),e.canonicalizeUri=function(e){if(e){var t=e.toLowerCase();return i.x.endsWith(t,"?")?t=t.slice(0,-1):i.x.endsWith(t,"?/")&&(t=t.slice(0,-2)),i.x.endsWith(t,"/")||(t+="/"),t}return e},e.prototype.validateAsUri=function(){var e;try{e=this.getUrlComponents()}catch(e){throw r.r.createUrlParseError(e)}if(!e.HostNameAndPort||!e.PathSegments)throw r.r.createUrlParseError("Given url string: "+this.urlString);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw r.r.createInsecureAuthorityUriError(this.urlString)},e.appendQueryString=function(e,t){return i.x.isEmpty(t)?e:e.indexOf("?")<0?e+"?"+t:e+"&"+t},e.removeHashFromUrl=function(t){return e.canonicalizeUri(t.split("#")[0])},e.prototype.replaceTenantPath=function(t){var n=this.getUrlComponents(),r=n.PathSegments;return!t||0===r.length||r[0]!==a.Nb.COMMON&&r[0]!==a.Nb.ORGANIZATIONS||(r[0]=t),e.constructAuthorityUriFromObject(n)},e.prototype.getHash=function(){return e.parseHash(this.urlString)},e.prototype.getUrlComponents=function(){var e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw r.r.createUrlParseError("Given url string: "+this.urlString);var n={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},o=n.AbsolutePath.split("/");return o=o.filter((function(e){return e&&e.length>0})),n.PathSegments=o,!i.x.isEmpty(n.QueryString)&&n.QueryString.endsWith("/")&&(n.QueryString=n.QueryString.substring(0,n.QueryString.length-1)),n},e.getDomainFromUrl=function(e){var t=RegExp("^([^:/?#]+://)?([^/?#]*)"),n=e.match(t);if(!n)throw r.r.createUrlParseError("Given url string: "+e);return n[2]},e.getAbsoluteUrl=function(t,n){if(t[0]===a.gT.FORWARD_SLASH){var r=new e(n).getUrlComponents();return r.Protocol+"//"+r.HostNameAndPort+t}return t},e.parseHash=function(e){var t=e.indexOf("#"),n=e.indexOf("#/");return n>-1?e.substring(n+2):t>-1?e.substring(t+1):""},e.constructAuthorityUriFromObject=function(t){return new e(t.Protocol+"//"+t.HostNameAndPort+"/"+t.PathSegments.join("/"))},e.getDeserializedHash=function(t){if(i.x.isEmpty(t))return{};var n=e.parseHash(t),r=i.x.queryStringToObject(i.x.isEmpty(n)?t:n);if(!r)throw o.e.createHashNotDeserializedError(JSON.stringify(r));return r},e.hashContainsKnownProperties=function(t){if(i.x.isEmpty(t)||t.indexOf("=")<0)return!1;var n=e.getDeserializedHash(t);return!!(n.code||n.error_description||n.error||n.state)},e}()},77891:(e,t,n)=>{"use strict";n.d(t,{Nb:()=>i,Fo:()=>a,dg:()=>b,QU:()=>A,hO:()=>_,pQ:()=>w,sR:()=>S,iR:()=>m,To:()=>M,Xj:()=>C,LL:()=>E,As:()=>s,VX:()=>T,gT:()=>u,d3:()=>y,D1:()=>F,qJ:()=>g,SZ:()=>r,f_:()=>l,$f:()=>d,Ge:()=>P,Vi:()=>o,NJ:()=>h,ki:()=>N,W:()=>O,YY:()=>k,vw:()=>f,HN:()=>R,VO:()=>p,Bv:()=>v,ch:()=>I,bb:()=>x});var r,o,i,a,s,c=n(5096),u={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",ADFS:"adfs",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},l=[u.OPENID_SCOPE,u.PROFILE_SCOPE,u.OFFLINE_ACCESS_SCOPE],d=(0,c.pr)(l,[u.EMAIL_SCOPE]);!function(e){e.CONTENT_TYPE="Content-Type",e.RETRY_AFTER="Retry-After",e.CCS_HEADER="X-AnchorMailbox",e.WWWAuthenticate="WWW-Authenticate",e.AuthenticationInfo="Authentication-Info"}(r||(r={})),function(e){e.ID_TOKEN="idtoken",e.CLIENT_INFO="client.info",e.ADAL_ID_TOKEN="adal.idtoken",e.ERROR="error",e.ERROR_DESC="error.description",e.ACTIVE_ACCOUNT="active-account"}(o||(o={})),function(e){e.COMMON="common",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers"}(i||(i={})),function(e){e.CLIENT_ID="client_id",e.REDIRECT_URI="redirect_uri",e.RESPONSE_TYPE="response_type",e.RESPONSE_MODE="response_mode",e.GRANT_TYPE="grant_type",e.CLAIMS="claims",e.SCOPE="scope",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.REFRESH_TOKEN="refresh_token",e.EXPIRES_IN="expires_in",e.STATE="state",e.NONCE="nonce",e.PROMPT="prompt",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info",e.CODE="code",e.CODE_CHALLENGE="code_challenge",e.CODE_CHALLENGE_METHOD="code_challenge_method",e.CODE_VERIFIER="code_verifier",e.CLIENT_REQUEST_ID="client-request-id",e.X_CLIENT_SKU="x-client-SKU",e.X_CLIENT_VER="x-client-VER",e.X_CLIENT_OS="x-client-OS",e.X_CLIENT_CPU="x-client-CPU",e.X_CLIENT_CURR_TELEM="x-client-current-telemetry",e.X_CLIENT_LAST_TELEM="x-client-last-telemetry",e.X_MS_LIB_CAPABILITY="x-ms-lib-capability",e.POST_LOGOUT_URI="post_logout_redirect_uri",e.ID_TOKEN_HINT="id_token_hint",e.DEVICE_CODE="device_code",e.CLIENT_SECRET="client_secret",e.CLIENT_ASSERTION="client_assertion",e.CLIENT_ASSERTION_TYPE="client_assertion_type",e.TOKEN_TYPE="token_type",e.REQ_CNF="req_cnf",e.OBO_ASSERTION="assertion",e.REQUESTED_TOKEN_USE="requested_token_use",e.ON_BEHALF_OF="on_behalf_of",e.FOCI="foci",e.CCS_HEADER="X-AnchorMailbox",e.RETURN_SPA_CODE="return_spa_code"}(a||(a={})),function(e){e.ACCESS_TOKEN="access_token",e.XMS_CC="xms_cc"}(s||(s={}));var p,h={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create"};!function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ID_TOKEN="id_token",e.DOMAIN_HINT="domain_hint",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"}(p||(p={}));var f,g,m,v,y,C,E,T={PLAIN:"plain",S256:"S256"};!function(e){e.QUERY="query",e.FRAGMENT="fragment",e.FORM_POST="form_post"}(f||(f={})),function(e){e.IMPLICIT_GRANT="implicit",e.AUTHORIZATION_CODE_GRANT="authorization_code",e.CLIENT_CREDENTIALS_GRANT="client_credentials",e.RESOURCE_OWNER_PASSWORD_GRANT="password",e.REFRESH_TOKEN_GRANT="refresh_token",e.DEVICE_CODE_GRANT="device_code",e.JWT_BEARER="urn:ietf:params:oauth:grant-type:jwt-bearer"}(g||(g={})),function(e){e.MSSTS_ACCOUNT_TYPE="MSSTS",e.ADFS_ACCOUNT_TYPE="ADFS",e.MSAV1_ACCOUNT_TYPE="MSA",e.GENERIC_ACCOUNT_TYPE="Generic"}(m||(m={})),function(e){e.CACHE_KEY_SEPARATOR="-",e.CLIENT_INFO_SEPARATOR="."}(v||(v={})),function(e){e.ID_TOKEN="IdToken",e.ACCESS_TOKEN="AccessToken",e.ACCESS_TOKEN_WITH_AUTH_SCHEME="AccessToken_With_AuthScheme",e.REFRESH_TOKEN="RefreshToken"}(y||(y={})),function(e){e.ACCOUNT="Account",e.CREDENTIAL="Credential",e.ID_TOKEN="IdToken",e.ACCESS_TOKEN="AccessToken",e.REFRESH_TOKEN="RefreshToken",e.APP_METADATA="AppMetadata",e.TEMPORARY="TempCache",e.TELEMETRY="Telemetry",e.UNDEFINED="Undefined",e.THROTTLING="Throttling"}(C||(C={})),function(e){e[e.ADFS=1001]="ADFS",e[e.MSA=1002]="MSA",e[e.MSSTS=1003]="MSSTS",e[e.GENERIC=1004]="GENERIC",e[e.ACCESS_TOKEN=2001]="ACCESS_TOKEN",e[e.REFRESH_TOKEN=2002]="REFRESH_TOKEN",e[e.ID_TOKEN=2003]="ID_TOKEN",e[e.APP_METADATA=3001]="APP_METADATA",e[e.UNDEFINED=9999]="UNDEFINED"}(E||(E={}));var w,b="appmetadata",S="client_info",I="1",A={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:86400};!function(e){e.CONFIG="config",e.CACHE="cache",e.NETWORK="network"}(w||(w={}));var _,R={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"};!function(e){e.BEARER="Bearer",e.POP="pop",e.SSH="ssh-cert"}(_||(_={}));var P,k,O,N,M,x={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},F={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"};!function(e){e.username="username",e.password="password"}(P||(P={})),function(e){e[e.httpSuccess=200]="httpSuccess",e[e.httpBadRequest=400]="httpBadRequest"}(k||(k={})),function(e){e.FAILED_AUTO_DETECTION="1",e.INTERNAL_CACHE="2",e.ENVIRONMENT_VARIABLE="3",e.IMDS="4"}(O||(O={})),function(e){e.CONFIGURED_MATCHES_DETECTED="1",e.CONFIGURED_NO_AUTO_DETECTION="2",e.CONFIGURED_NOT_DETECTED="3",e.AUTO_DETECTION_REQUESTED_SUCCESSFUL="4",e.AUTO_DETECTION_REQUESTED_FAILED="5"}(N||(N={})),function(e){e.NO_CACHE_HIT="0",e.FORCE_REFRESH="1",e.NO_CACHED_ACCESS_TOKEN="2",e.CACHED_ACCESS_TOKEN_EXPIRED="3",e.REFRESH_CACHED_ACCESS_TOKEN="4"}(M||(M={}))},3516:(e,t,n)=>{"use strict";n.d(t,{C:()=>a});var r=n(61653),o=n(77891),i=n(60742),a=function(){function e(){}return e.setRequestState=function(t,n,i){var a=e.generateLibraryState(t,i);return r.x.isEmpty(n)?a:""+a+o.gT.RESOURCE_DELIM+n},e.generateLibraryState=function(e,t){if(!e)throw i.e.createNoCryptoObjectError("generateLibraryState");var n={id:e.createNewGuid()};t&&(n.meta=t);var r=JSON.stringify(n);return e.base64Encode(r)},e.parseRequestState=function(e,t){if(!e)throw i.e.createNoCryptoObjectError("parseRequestState");if(r.x.isEmpty(t))throw i.e.createInvalidStateError(t,"Null, undefined or empty state");try{var n=t.split(o.gT.RESOURCE_DELIM),a=n[0],s=n.length>1?n.slice(1).join(o.gT.RESOURCE_DELIM):"",c=e.base64Decode(a),u=JSON.parse(c);return{userRequestState:r.x.isEmpty(s)?"":s,libraryState:u}}catch(e){throw i.e.createInvalidStateError(t,e)}},e}()},61653:(e,t,n)=>{"use strict";n.d(t,{x:()=>o});var r=n(60742),o=function(){function e(){}return e.decodeAuthToken=function(t){if(e.isEmpty(t))throw r.e.createTokenNullOrEmptyError(t);var n=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);if(!n||n.length<4)throw r.e.createTokenParsingError("Given token is malformed: "+JSON.stringify(t));return{header:n[1],JWSPayload:n[2],JWSSig:n[3]}},e.isEmpty=function(e){return void 0===e||!e||0===e.length},e.isEmptyObj=function(t){if(t&&!e.isEmpty(t))try{var n=JSON.parse(t);return 0===Object.keys(n).length}catch(e){}return!0},e.startsWith=function(e,t){return 0===e.indexOf(t)},e.endsWith=function(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length},e.queryStringToObject=function(e){var t={},n=e.split("&"),r=function(e){return decodeURIComponent(e.replace(/\+/g," "))};return n.forEach((function(e){if(e.trim()){var n=e.split(/=(.+)/g,2),o=n[0],i=n[1];o&&i&&(t[r(o)]=r(i))}})),t},e.trimArrayEntries=function(e){return e.map((function(e){return e.trim()}))},e.removeEmptyStringsFromArray=function(t){return t.filter((function(t){return!e.isEmpty(t)}))},e.jsonParseHelper=function(e){try{return JSON.parse(e)}catch(e){return null}},e.matchPattern=function(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)},e}()},33848:(e,t,n)=>{"use strict";n.d(t,{I:()=>r});var r=function(){function e(){}return e.nowSeconds=function(){return Math.round((new Date).getTime()/1e3)},e.isTokenExpired=function(t,n){var r=Number(t)||0;return e.nowSeconds()+n>r},e.wasClockTurnedBack=function(t){return Number(t)>e.nowSeconds()},e.delay=function(e,t){return new Promise((function(n){return setTimeout((function(){return n(t)}),e)}))},e}()},96674:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AppInsightsCore:()=>Bt,ApplicationAnalytics:()=>jr,ApplicationInsights:()=>vi,ApplicationInsightsContainer:()=>Ei,BaseCore:()=>Ht,BaseTelemetryPlugin:()=>ft,CoreUtils:()=>un,DependenciesPlugin:()=>li,DistributedTracingModes:()=>tr,Event:()=>Fn,Exception:()=>nr,LoggingSeverity:()=>H,Metric:()=>Dn,NotificationManager:()=>qt,PageView:()=>zn,PageViewPerformance:()=>Vn,PerfEvent:()=>at,PerfManager:()=>st,PropertiesPlugin:()=>jo,RemoteDependencyData:()=>Ur,Sender:()=>Po,SeverityLevel:()=>$n,Telemetry:()=>mi,Trace:()=>Ln,Util:()=>Or,_InternalMessageId:()=>q,doPerf:()=>ut});var r="function",o="object",i="undefined",a=Object,s=a.prototype,c=a.assign,u=a.create,l=a.defineProperty,d=s.hasOwnProperty;function p(){return typeof globalThis!==i&&globalThis?globalThis:typeof self!==i&&self?self:typeof window!==i&&window?window:typeof n.g!==i&&n.g?n.g:null}function h(e){throw new TypeError(e)}function f(e){if(u)return u(e);if(null==e)return{};var t=typeof e;function n(){}return t!==o&&t!==r&&h("Object prototype may only be an Object:"+e),n.prototype=e,new n}(p()||{}).Symbol,(p()||{}).Reflect;var g=c||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])s.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},m=function(e,t){return m=a.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},m(e,t)};function v(e,t){function n(){this.constructor=e}typeof t!==r&&null!==t&&h("Class extends value "+String(t)+" is not a constructor or null"),m(e,t),e.prototype=null===t?f(t):(n.prototype=t.prototype,new n)}function y(e,t){for(var n=0,r=t.length,o=e.length;n<r;n++,o++)e[o]=t[n];return e}var C="prototype",E="function",T="_dynClass",w="_unknown_",b=Object,S=b.getPrototypeOf,I=0;function A(e,t){return e&&b.prototype.hasOwnProperty.call(e,t)}function _(e){return e&&(e===b.prototype||e===Array.prototype)}function R(e){return _(e)||e===Function.prototype}function P(e){if(e){if(S)return S(e);var t=e.__proto__||e.prototype||(e.constructor?e.constructor.prototype:null);if(t)return t}return null}function k(e,t){var n=[],r=b.getOwnPropertyNames;if(r)n=r(e);else for(var o in e)"string"==typeof o&&A(e,o)&&n.push(o);if(n&&n.length>0)for(var i=0;i<n.length;i++)t(n[i])}function O(e,t,n){return"constructor"!==t&&typeof e[t]===E&&(n||A(e,t))}function N(e){throw new TypeError("DynamicProto: "+e)}function M(e,t){for(var n=e.length-1;n>=0;n--)if(e[n]===t)return!0;return!1}function x(e,t,n,r){var o=null;if(e&&A(n,T)){var i=e._dynInstFuncs||{};if((o=(i[n._dynClass]||{})[t])||N("Missing ["+t+"] "+E),!o._dynInstChk&&!1!==i._dynInstChk){for(var a=!A(e,t),s=P(e),c=[];a&&s&&!R(s)&&!M(c,s);){var u=s[t];if(u){a=u===r;break}c.push(s),s=P(s)}try{a&&(e[t]=o),o._dynInstChk=1}catch(e){i._dynInstChk=!1}}}return o}function F(e,t,n){var r=t[e];return r===n&&(r=P(t)[e]),typeof r!==E&&N("["+e+"] is not a "+E),r}function L(e,t){return A(e,C)?e.name||t||w:((e||{}).constructor||{}).name||t||w}function U(e,t,n,r){A(e,C)||N("theClass is an invalid class definition.");var o=e.prototype;(function(e,t){if(S)for(var n=[],r=P(t);r&&!R(r)&&!M(n,r);){if(r===e)return!0;n.push(r),r=P(r)}return!1})(o,t)||N("["+L(e)+"] is not in class hierarchy of ["+L(t)+"]");var i=null;A(o,T)?i=o._dynClass:(i="_dynCls$"+L(e,"_")+"$"+I,I++,o._dynClass=i);var a=U._dfOpts,s=!!a.useBaseInst;s&&r&&void 0!==r.useBaseInst&&(s=!!r.useBaseInst);var c=function(e){var t={};return k(e,(function(n){!t[n]&&O(e,n,!1)&&(t[n]=e[n])})),t}(t),u=function(e,t,n,r){function o(e,t,n){var o=t[n];if(o._isDynProxy&&r){var i=e._dynInstFuncs||{};!1!==i._dynInstChk&&(o=(i[t._dynClass]||{})[n]||o)}return function(){return o.apply(e,arguments)}}var i={};k(n,(function(e){i[e]=o(t,n,e)}));for(var a=P(e),s=[];a&&!R(a)&&!M(s,a);)k(a,(function(e){!i[e]&&O(a,e,!S)&&(i[e]=o(t,a,e))})),s.push(a),a=P(a);return i}(o,t,c,s);n(t,u);var l=!!S&&!!a.setInstFuncs;l&&r&&(l=!!r.setInstFuncs),function(e,t,n,r,o){if(!_(e)){var i=n._dynInstFuncs=n._dynInstFuncs||{},a=i[t]=i[t]||{};!1!==i._dynInstChk&&(i._dynInstChk=!!o),k(n,(function(t){O(n,t,!1)&&n[t]!==r[t]&&(a[t]=n[t],delete n[t],(!A(e,t)||e[t]&&!e[t]._isDynProxy)&&(e[t]=function(e,t){var n=function(){return(x(this,t,e,n)||F(t,e,n)).apply(this,arguments)};return n._isDynProxy=1,n}(e,t)))}))}}(o,i,t,c,!1!==l)}U._dfOpts={setInstFuncs:!0,useBaseInst:!0};const D=U;var H;!function(e){e[e.CRITICAL=1]="CRITICAL",e[e.WARNING=2]="WARNING"}(H||(H={}));var q={BrowserDoesNotSupportLocalStorage:0,BrowserCannotReadLocalStorage:1,BrowserCannotReadSessionStorage:2,BrowserCannotWriteLocalStorage:3,BrowserCannotWriteSessionStorage:4,BrowserFailedRemovalFromLocalStorage:5,BrowserFailedRemovalFromSessionStorage:6,CannotSendEmptyTelemetry:7,ClientPerformanceMathError:8,ErrorParsingAISessionCookie:9,ErrorPVCalc:10,ExceptionWhileLoggingError:11,FailedAddingTelemetryToBuffer:12,FailedMonitorAjaxAbort:13,FailedMonitorAjaxDur:14,FailedMonitorAjaxOpen:15,FailedMonitorAjaxRSC:16,FailedMonitorAjaxSend:17,FailedMonitorAjaxGetCorrelationHeader:18,FailedToAddHandlerForOnBeforeUnload:19,FailedToSendQueuedTelemetry:20,FailedToReportDataLoss:21,FlushFailed:22,MessageLimitPerPVExceeded:23,MissingRequiredFieldSpecification:24,NavigationTimingNotSupported:25,OnError:26,SessionRenewalDateIsZero:27,SenderNotInitialized:28,StartTrackEventFailed:29,StopTrackEventFailed:30,StartTrackFailed:31,StopTrackFailed:32,TelemetrySampledAndNotSent:33,TrackEventFailed:34,TrackExceptionFailed:35,TrackMetricFailed:36,TrackPVFailed:37,TrackPVFailedCalc:38,TrackTraceFailed:39,TransmissionFailed:40,FailedToSetStorageBuffer:41,FailedToRestoreStorageBuffer:42,InvalidBackendResponse:43,FailedToFixDepricatedValues:44,InvalidDurationValue:45,TelemetryEnvelopeInvalid:46,CreateEnvelopeError:47,CannotSerializeObject:48,CannotSerializeObjectNonSerializable:49,CircularReferenceDetected:50,ClearAuthContextFailed:51,ExceptionTruncated:52,IllegalCharsInName:53,ItemNotInArray:54,MaxAjaxPerPVExceeded:55,MessageTruncated:56,NameTooLong:57,SampleRateOutOfRange:58,SetAuthContextFailed:59,SetAuthContextFailedAccountName:60,StringValueTooLong:61,StartCalledMoreThanOnce:62,StopCalledWithoutStart:63,TelemetryInitializerFailed:64,TrackArgumentsNotSpecified:65,UrlTooLong:66,SessionStorageBufferFull:67,CannotAccessCookie:68,IdTooLong:69,InvalidEvent:70,FailedMonitorAjaxSetRequestHeader:71,SendBrowserInfoOnUserInit:72,PluginException:73,NotificationException:74,SnippetScriptLoadFailure:99,InvalidInstrumentationKey:100,CannotParseAiBlobValue:101,InvalidContentBlob:102,TrackPageActionEventFailed:103,FailedAddingCustomDefinedRequestContext:104,InMemoryStorageBufferFull:105},B=l;function G(e){return s.toString.call(e)}function j(e){return void 0===e||typeof e===i}function z(e){return null===e||j(e)}function V(e){return!z(e)}function K(e,t){return e&&d.call(e,t)}function W(e){return typeof e===o}function J(e){return typeof e===r}function Y(e,t,n,r){void 0===r&&(r=!1);var o=!1;if(!z(e))try{z(e.addEventListener)?z(e.attachEvent)||(e.attachEvent("on"+t,n),o=!0):(e.addEventListener(t,n,r),o=!0)}catch(e){}return o}function Q(e,t){if(e)for(var n in e)d.call(e,n)&&t.call(e,n,e[n])}function X(e,t){return!(!e||!t)&&-1!==e.indexOf(t)}function Z(e){return"[object Date]"===G(e)}function $(e){return"[object Array]"===G(e)}function ee(e){return"[object Error]"===G(e)}function te(e){return"string"==typeof e}function ne(e){return"number"==typeof e}function re(e){return"boolean"==typeof e}function oe(e){if(Z(e)){var t=function(e){var t=String(e);return 1===t.length&&(t="0"+t),t};return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}function ie(e,t,n){var r=e.length;try{for(var o=0;o<r&&(!(o in e)||-1!==t.call(n||e,e[o],o,e));o++);}catch(e){}}function ae(e,t,n){var r=e.length,o=n||0;try{for(var i=Math.max(o>=0?o:r-Math.abs(o),0);i<r;i++)if(i in e&&e[i]===t)return i}catch(e){}return-1}function se(e,t,n){var r=e.length,o=n||e,i=new Array(r);try{for(var a=0;a<r;a++)a in e&&(i[a]=t.call(o,e[a],e))}catch(e){}return i}function ce(e,t,n){var r,o=e.length,i=0;if(arguments.length>=3)r=arguments[2];else{for(;i<o&&!(i in e);)i++;r=e[i++]}for(;i<o;)i in e&&(r=t(r,e[i],i,e)),i++;return r}function ue(e){return"string"!=typeof e?e:e.replace(/^\s+|\s+$/g,"")}a.freeze,a.seal;var le=!{toString:null}.propertyIsEnumerable("toString"),de=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];function pe(e){var t=typeof e;t===r||t===o&&null!==e||h("objKeys called on non-object");var n=[];for(var i in e)e&&d.call(e,i)&&n.push(i);if(le)for(var a=de.length,s=0;s<a;s++)e&&d.call(e,de[s])&&n.push(de[s]);return n}function he(e,t,n,r){if(B)try{var o={enumerable:!0,configurable:!0};return n&&(o.get=n),r&&(o.set=r),B(e,t,o),!0}catch(e){}return!1}function fe(){var e=Date;return e.now?e.now():(new e).getTime()}function ge(e){return ee(e)?e.name:""}function me(e,t,n,r,o){var i=n;return e&&((i=e[t])===n||o&&!o(i)||r&&!r(n)||(i=n,e[t]=i)),i}function ve(e,t,n){var r;return e?!(r=e[t])&&z(r)&&(r=j(n)?{}:n,e[t]=r):r=j(n)?{}:n,r}function ye(e){return!e}function Ce(e){return!!e}function Ee(e){throw new Error(e)}function Te(e,t,n){if(e&&t&&e!==t&&W(e)&&W(t)){var r=function(r){if(te(r)){var o=t[r];J(o)?n&&!n(r,!0,t,e)||(e[r]=(i=r,function(){var e=arguments;return t[i].apply(t,e)})):n&&!n(r,!1,t,e)||(K(e,r)&&delete e[r],he(e,r,(function(){return t[r]}),(function(e){t[r]=e}))||(e[r]=o))}var i};for(var o in t)r(o)}return e}function we(e){return e&&(e=a(c?c({},e):e)),e}var be="window",Se="JSON",Ie="msie",Ae="trident/",_e=null,Re=null,Pe=null,ke=null;function Oe(e,t){var n=!1;if(e){try{if(!(n=t in e)){var r=e.prototype;r&&(n=t in r)}}catch(e){}if(!n)try{n=!j((new e)[t])}catch(e){}}return n}function Ne(e){var t=p();return t&&t[e]?t[e]:e===be&&Me()?window:null}function Me(){return Boolean(typeof window===o&&window)}function xe(){return Me()?window:Ne(be)}function Fe(){return Boolean(typeof document===o&&document)}function Le(){return Fe()?document:Ne("document")}function Ue(){return Boolean(typeof navigator===o&&navigator)}function De(){return Ue()?navigator:Ne("navigator")}function He(e){return typeof location===o&&location?location:Ne("location")}function qe(){return Ne("performance")}function Be(){return Boolean(typeof JSON===o&&JSON||null!==Ne(Se))}function Ge(){return Be()?JSON||Ne(Se):null}function je(){var e=De();if(e&&(e.userAgent!==Re||null===_e)){var t=((Re=e.userAgent)||"").toLowerCase();_e=X(t,Ie)||X(t,Ae)}return _e}function ze(e){if(void 0===e&&(e=null),!e){var t=De()||{};e=t?(t.userAgent||"").toLowerCase():""}var n=(e||"").toLowerCase();if(X(n,Ie))return parseInt(n.split(Ie)[1]);if(X(n,Ae)){var r=parseInt(n.split(Ae)[1]);if(r)return r+4}return null}function Ve(e){var t=Object.prototype.toString.call(e),n="";return"[object Error]"===t?n="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e.name+"'":Be()&&(n=Ge().stringify(e)),t+n}function Ke(){return null===ke&&(ke=Ue()&&Boolean(De().sendBeacon)),ke}function We(e){var t=!1;try{t=!!Ne("fetch");var n=Ne("Request");t&&e&&n&&(t=Oe(n,"keepalive"))}catch(e){}return t}function Je(){return null===Pe&&(Pe=void 0!==typeof XDomainRequest)&&Ye()&&(Pe=Pe&&!Oe(Ne("XMLHttpRequest"),"withCredentials")),Pe}function Ye(){var e=!1;try{e=!!Ne("XMLHttpRequest")}catch(e){}return e}var Qe,Xe=["eventsSent","eventsDiscarded","eventsSendRequest","perfEvent"],Ze=null;function $e(e,t){return function(){var n=arguments,r=et(t);if(r){var o=r.listener;o&&o[e]&&o[e].apply(o,n)}}}function et(e){var t,n=Ze;return n||!0===e.disableDbgExt||(n=Ze||((t=Ne("Microsoft"))&&(Ze=t.ApplicationInsights),Ze)),n?n.ChromeDbgExt:null}function tt(e){return e?'"'+e.replace(/\"/g,"")+'"':""}function nt(e,t){var n=typeof console!==i?console:Ne("console");if(n){var r="log";n[e]&&(r=e),J(n[r])&&n[r](t)}}var rt=function(){function e(e,t,n,r){void 0===n&&(n=!1);var o=this;o.messageId=e,o.message=(n?"AI: ":"AI (Internal): ")+e;var i="";Be()&&(i=Ge().stringify(r));var a=(t?" message:"+tt(t):"")+(r?" props:"+tt(i):"");o.message+=a}return e.dataType="MessageData",e}();function ot(e,t){return(e||{}).logger||new it(t)}var it=function e(t){this.identifier="DiagnosticLogger",this.queue=[];var n=0,r={};D(e,this,(function(e){function o(e,n){var r=t[e];return z(r)?n:r}function i(e,n){var r=et(t);r&&r.diagLog&&r.diagLog(e,n)}z(t)&&(t={}),e.consoleLoggingLevel=function(){return o("loggingLevelConsole",0)},e.telemetryLoggingLevel=function(){return o("loggingLevelTelemetry",1)},e.maxInternalMessageLimit=function(){return o("maxMessageLimit",25)},e.enableDebugExceptions=function(){return o("enableDebugExceptions",!1)},e.throwInternal=function(t,n,o,a,s){void 0===s&&(s=!1);var c=new rt(n,o,s,a);if(e.enableDebugExceptions())throw c;var u=t===H.CRITICAL?"errorToConsole":"warnToConsole";if(j(c.message))i("throw"+(t===H.CRITICAL?"Critical":"Warning"),c);else{var l=e.consoleLoggingLevel();if(s){var d=+c.messageId;!r[d]&&l>=t&&(e[u](c.message),r[d]=!0)}else l>=t&&e[u](c.message);e.logInternalMessage(t,c)}},e.warnToConsole=function(e){nt("warn",e),i("warning",e)},e.errorToConsole=function(e){nt("error",e),i("error",e)},e.resetInternalMessageCount=function(){n=0,r={}},e.logInternalMessage=function(t,o){if(!(n>=e.maxInternalMessageLimit())){var a=!0,s="AITR_"+o.messageId;if(r[s]?a=!1:r[s]=!0,a&&(t<=e.telemetryLoggingLevel()&&(e.queue.push(o),n++,i(t===H.CRITICAL?"error":"warn",o)),n===e.maxInternalMessageLimit())){var c="Internal events throttle limit per PageView reached for this app.",u=new rt(q.MessageLimitPerPVExceeded,c,!1);e.queue.push(u),t===H.CRITICAL?e.errorToConsole(c):e.warnToConsole(c)}}}}))},at=function(){function e(t,n,r){var o,i=this,a=!1;i.start=fe(),i.name=t,i.isAsync=r,i.isChildEvt=function(){return!1},J(n)&&(a=he(i,"payload",(function(){return!o&&J(n)&&(o=n(),n=null),o}))),i.getCtx=function(t){return t?t===e.ParentContextKey||t===e.ChildrenContextKey?i[t]:(i.ctx||{})[t]:null},i.setCtx=function(t,n){t&&(t===e.ParentContextKey?(i[t]||(i.isChildEvt=function(){return!0}),i[t]=n):t===e.ChildrenContextKey?i[t]=n:(i.ctx=i.ctx||{})[t]=n)},i.complete=function(){var t=0,r=i.getCtx(e.ChildrenContextKey);if($(r))for(var o=0;o<r.length;o++){var s=r[o];s&&(t+=s.time)}i.time=fe()-i.start,i.exTime=i.time-t,i.complete=function(){},!a&&J(n)&&(i.payload=n())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),st=function e(t){this.ctx={},D(e,this,(function(e){e.create=function(e,t,n){return new at(e,t,n)},e.fire=function(e){e&&(e.complete(),t&&J(t.perfEvent)&&t.perfEvent(e))},e.setCtx=function(t,n){t&&((e.ctx=e.ctx||{})[t]=n)},e.getCtx=function(t){return(e.ctx||{})[t]}}))},ct="CoreUtils.doPerf";function ut(e,t,n,r,o){if(e){var i=e;if(J(i.getPerfMgr)&&(i=i.getPerfMgr()),i){var a=void 0,s=i.getCtx(ct);try{if(a=i.create(t(),r,o)){if(s&&a.setCtx&&(a.setCtx(at.ParentContextKey,s),s.getCtx&&s.setCtx)){var c=s.getCtx(at.ChildrenContextKey);c||(c=[],s.setCtx(at.ChildrenContextKey,c)),c.push(a)}return i.setCtx(ct,a),n(a)}}catch(e){a&&a.setCtx&&a.setCtx("exception",e)}finally{a&&i.fire(a),i.setCtx(ct,s)}}}return n()}var lt=function(e,t){var n=this,r=null,o=J(e.processTelemetry),i=J(e.setNextPlugin);n._hasRun=!1,n.getPlugin=function(){return e},n.getNext=function(){return r},n.setNext=function(e){r=e},n.processTelemetry=function(a,s){s||(s=t);var c=e?e.identifier:"TelemetryPluginChain";ut(s?s.core():null,(function(){return c+":processTelemetry"}),(function(){if(e&&o){n._hasRun=!0;try{s.setNext(r),i&&e.setNextPlugin(r),r&&(r._hasRun=!1),e.processTelemetry(a,s)}catch(n){var t=r&&r._hasRun;r&&t||s.diagLog().throwInternal(H.CRITICAL,q.PluginException,"Plugin ["+e.identifier+"] failed during processTelemetry - "+Ve(n)),r&&!t&&r.processTelemetry(a,s)}}else r&&(n._hasRun=!0,r.processTelemetry(a,s))}),(function(){return{item:a}}),!a.sync)}};function dt(e,t){var n=[];if(e&&e.length>0)for(var r=null,o=0;o<e.length;o++){var i=e[o];if(i&&J(i.processTelemetry)){var a=new lt(i,t);n.push(a),r&&r.setNext(a),r=a}}return n.length>0?n[0]:null}var pt=function e(t,n,r,o){var i=this,a=null;null!==o&&(t&&J(t.getPlugin)?a=function(e,t,n){var r=[],o=!n;if(e)for(;e;){var i=e.getPlugin();(o||i===n)&&(o=!0,r.push(i)),e=e.getNext()}return o||r.push(n),dt(r,t)}(t,i,o||t.getPlugin()):o?a=function(e,t,n){var r=e,o=!1;return n&&e&&(r=[],ie(e,(function(e){(o||e===n)&&(o=!0,r.push(e))}))),n&&!o&&(r||(r=[]),r.push(n)),dt(r,t)}(t,i,o):j(o)&&(a=dt(t,i))),i.core=function(){return r},i.diagLog=function(){return ot(r,n)},i.getCfg=function(){return n},i.getExtCfg=function(e,t){var r;if(void 0===t&&(t={}),n){var o=n.extensionConfig;o&&e&&(r=o[e])}return r||t},i.getConfig=function(e,t,r){var o;void 0===r&&(r=!1);var a=i.getExtCfg(e,null);return a&&!z(a[t])?o=a[t]:n&&!z(n[t])&&(o=n[t]),z(o)?r:o},i.hasNext=function(){return null!=a},i.getNext=function(){return a},i.setNext=function(e){a=e},i.processNext=function(e){var t=a;t&&(a=t.getNext(),t.processTelemetry(e,i))},i.createNew=function(t,o){return void 0===t&&(t=null),new e(t||a,n,r,o)}},ht="extensionConfig",ft=function(){function e(){var e=this,t=!1,n=null,r=null;e.core=null,e.diagLog=function(t){return e._getTelCtx(t).diagLog()},e.isInitialized=function(){return t},e.setInitialized=function(e){t=e},e.setNextPlugin=function(e){r=e},e.processNext=function(e,t){t?t.processNext(e):r&&J(r.processTelemetry)&&r.processTelemetry(e,null)},e._getTelCtx=function(t){void 0===t&&(t=null);var o=t;if(!o){var i=n||new pt(null,{},e.core);o=r&&r.getPlugin?i.createNew(null,r.getPlugin):i.createNew(null,r)}return o},e._baseTelInit=function(o,i,a,s){o&&me(o,ht,[],null,z),!s&&i&&(s=i.getProcessTelContext().getNext());var c=r;r&&r.getPlugin&&(c=r.getPlugin()),e.core=i,n=new pt(s,o,i,c),t=!0}}return e.prototype.initialize=function(e,t,n,r){this._baseTelInit(e,t,n,r)},e}();function gt(e,t){for(var n=[],r=null,o=e.getNext();o;){var i=o.getPlugin();i&&(r&&J(r.setNextPlugin)&&J(i.processTelemetry)&&r.setNextPlugin(i),J(i.isInitialized)&&i.isInitialized()||n.push(i),r=i,o=o.getNext())}ie(n,(function(n){n.initialize(e.getCfg(),e.core(),t,e.getNext())}))}function mt(e){return e.sort((function(e,t){var n=0,r=J(t.processTelemetry);return J(e.processTelemetry)?n=r?e.priority-t.priority:1:r&&(n=-1),n}))}var vt=function(e){function t(){var n,r=e.call(this)||this;function o(e){e&&e.length>0&&(function(e){ie(e,(function(e){e.priority<500&&Ee("Channel has invalid priority"+e.identifier)}))}(e=e.sort((function(e,t){return e.priority-t.priority}))),n.push(e))}return r.identifier="ChannelControllerPlugin",r.priority=500,D(t,r,(function(e,t){e.setNextPlugin=function(e){},e.processTelemetry=function(e,t){n&&ie(n,(function(n){n.length>0&&r._getTelCtx(t).createNew(n).processNext(e)}))},e.getChannelControls=function(){return n},e.initialize=function(r,i,a){e.isInitialized()||(t.initialize(r,i,a),function(e,t){if(n=[],e&&ie(e,(function(e){return o(e)})),t){var r=[];ie(t,(function(e){e.priority>500&&r.push(e)})),o(r)}}((r||{}).channels,a),ie(n,(function(e){return gt(new pt(e,r,i),a)})))}})),r}var n;return v(t,e),t._staticInit=(he(n=t.prototype,"ChannelControls",n.getChannelControls),void he(n,"channelQueue",n.getChannelControls)),t}(ft),yt="toGMTString",Ct="toUTCString",Et="",Tt=null,wt=null,bt=null,St=Le(),It={},At={};function _t(e,t){var n=kt._ckMgr||At._ckMgr;return n||(n=kt._ckMgr=kt(e,t),At._ckMgr=n),n}function Rt(e){return!e||e.isEnabled()}function Pt(e,t){var n;if(e)n=e.getCookieMgr();else if(t){var r=t.cookieCfg;n=r._ckMgr?r._ckMgr:kt(t)}return n||(n=_t(t,(e||{}).logger)),n}function kt(e,t){var n=function(e){var t=e.cookieCfg=e.cookieCfg||{};if(me(t,"domain",e.cookieDomain,V,z),me(t,"path",e.cookiePath||"/",null,z),z(t.enabled)){var n=void 0;j(e.isCookieUseDisabled)||(n=!e.isCookieUseDisabled),j(e.disableCookiesUsage)||(n=!e.disableCookiesUsage),t.enabled=n}return t}(e||At),r=n.path||"/",o=n.domain,i=!1!==n.enabled,a={isEnabled:function(){var e=i&&Ot(t),n=At._ckMgr;return e&&n&&a!==n&&(e=Rt(n)),e},setEnabled:function(e){i=!1!==e},set:function(e,t,i,s,c){var u=!1;if(Rt(a)){var l={},d=ue(t||Et),p=d.indexOf(";");if(-1!==p&&(d=ue(t.substring(0,p)),l=Nt(t.substring(p+1))),me(l,"domain",s||o,Ce,j),!z(i)){var h=je();if(j(l.expires)){var f=fe()+1e3*i;if(f>0){var g=new Date;g.setTime(f),me(l,"expires",Mt(g,h?yt:Ct)||Mt(g,h?yt:Ct)||Et,Ce)}}h||me(l,"max-age",Et+i,null,j)}var m=He();m&&"https:"===m.protocol&&(me(l,"secure",null,null,j),null===wt&&(wt=!Ut((De()||{}).userAgent)),wt&&me(l,"SameSite","None",null,j)),me(l,"path",c||r,null,j),(n.setCookie||Lt)(e,xt(d,l)),u=!0}return u},get:function(e){var t=Et;return Rt(a)&&(t=(n.getCookie||Ft)(e)),t},del:function(e,t){var n=!1;return Rt(a)&&(n=a.purge(e,t)),n},purge:function(e,r){var o,i=!1;if(Ot(t)){var a=((o={}).path=r||"/",o.expires="Thu, 01 Jan 1970 00:00:01 GMT",o);je()||(a["max-age"]="0"),(n.delCookie||Lt)(e,xt(Et,a)),i=!0}return i}};return a._ckMgr=a,a}function Ot(e){if(null===Tt){Tt=!1;try{Tt=void 0!==(St||{}).cookie}catch(t){e&&e.throwInternal(H.WARNING,q.CannotAccessCookie,"Cannot access document.cookie - "+ge(t),{exception:Ve(t)})}}return Tt}function Nt(e){var t={};return e&&e.length&&ie(ue(e).split(";"),(function(e){if(e=ue(e||Et)){var n=e.indexOf("=");-1===n?t[e]=null:t[ue(e.substring(0,n))]=ue(e.substring(n+1))}})),t}function Mt(e,t){return J(e[t])?e[t]():null}function xt(e,t){var n=e||Et;return Q(t,(function(e,t){n+="; "+e+(z(t)?Et:"="+t)})),n}function Ft(e){var t=Et;if(St){var n=St.cookie||Et;bt!==n&&(It=Nt(n),bt=n),t=ue(It[e]||Et)}return t}function Lt(e,t){St&&(St.cookie=e+"="+t)}function Ut(e){return!(!te(e)||!X(e,"CPU iPhone OS 12")&&!X(e,"iPad; CPU OS 12")&&!(X(e,"Macintosh; Intel Mac OS X 10_14")&&X(e,"Version/")&&X(e,"Safari"))&&(!X(e,"Macintosh; Intel Mac OS X 10_14")||!function(e,t){if(e){var n=t.length,r=e.length;if(e===t)return!0;if(r>=n){for(var o=r-1,i=n-1;i>=0;i--){if(e[o]!=t[i])return!1;o--}return!0}}return!1}(e,"AppleWebKit/605.1.15 (KHTML, like Gecko)"))&&!X(e,"Chrome/5")&&!X(e,"Chrome/6")&&(!X(e,"UnrealEngine")||X(e,"Chrome"))&&!X(e,"UCBrowser/12")&&!X(e,"UCBrowser/11"))}function Dt(e,t){return new st(t)}var Ht=function e(){var t,n,r,o,i,a=!1;D(e,this,(function(e){e._extensions=new Array,n=new vt,e.logger=new it({loggingLevelConsole:H.CRITICAL}),t=[],e.isInitialized=function(){return a},e.initialize=function(t,o,i,s){e.isInitialized()&&Ee("Core should not be initialized more than once"),t&&!z(t.instrumentationKey)||Ee("Please provide instrumentation key"),r=s,e._notificationManager=s,e.config=t||{},s&&!0!==e.config.disableDbgExt&&s.addNotificationListener(function(e){if(!Qe){Qe={};for(var t=0;t<Xe.length;t++)Qe[Xe[t]]=$e(Xe[t],e)}return Qe}(t)),e.config.enablePerfMgr&&me(e.config,"createPerfMgr",Dt),t.extensions=z(t.extensions)?[]:t.extensions,ve(t,ht).NotificationManager=s,i&&(e.logger=i);var c=[];c.push.apply(c,y(y([],o),t.extensions)),c=mt(c);var u=[],l=[],d={};ie(c,(function(e){(z(e)||z(e.initialize))&&Ee("Extensions must provide callback to initialize");var t=e.priority,r=e.identifier;e&&t&&(z(d[t])?d[t]=r:i.warnToConsole("Two extensions have same priority #"+t+" - "+d[t]+", "+r)),!t||t<n.priority?u.push(e):l.push(e)})),c.push(n),u.push(n),c=mt(c),e._extensions=c,gt(new pt([n],t,e),c),gt(new pt(u,t,e),c),e._extensions=u,0===e.getTransmissionControls().length&&Ee("No channels available"),a=!0,e.releaseQueue()},e.getTransmissionControls=function(){return n.getChannelControls()},e.track=function(n){me(n,"iKey",e.config.instrumentationKey,null,ye),me(n,"time",oe(new Date),null,ye),me(n,"ver","4.0",null,z),e.isInitialized()?e.getProcessTelContext().processNext(n):t.push(n)},e.getProcessTelContext=function(){var t=e._extensions,r=t;return t&&0!==t.length||(r=[n]),new pt(r,e.config,e)},e.getNotifyMgr=function(){return r||(r=f({addNotificationListener:function(e){},removeNotificationListener:function(e){},eventsSent:function(e){},eventsDiscarded:function(e,t){},eventsSendRequest:function(e,t){}}),e._notificationManager=r),r},e.getCookieMgr=function(){return i||(i=kt(e.config,e.logger)),i},e.setCookieMgr=function(e){i=e},e.getPerfMgr=function(){return o||e.config&&e.config.enablePerfMgr&&J(e.config.createPerfMgr)&&(o=e.config.createPerfMgr(e,e.getNotifyMgr())),o||null},e.setPerfMgr=function(e){o=e},e.eventCnt=function(){return t.length},e.releaseQueue=function(){t.length>0&&(ie(t,(function(t){e.getProcessTelContext().processNext(t)})),t=[])}}))},qt=function e(t){this.listeners=[];var n=!!(t||{}).perfEvtsSendAll;D(e,this,(function(e){e.addNotificationListener=function(t){e.listeners.push(t)},e.removeNotificationListener=function(t){for(var n=ae(e.listeners,t);n>-1;)e.listeners.splice(n,1),n=ae(e.listeners,t)},e.eventsSent=function(t){ie(e.listeners,(function(e){e&&e.eventsSent&&setTimeout((function(){return e.eventsSent(t)}),0)}))},e.eventsDiscarded=function(t,n){ie(e.listeners,(function(e){e&&e.eventsDiscarded&&setTimeout((function(){return e.eventsDiscarded(t,n)}),0)}))},e.eventsSendRequest=function(t,n){ie(e.listeners,(function(e){if(e&&e.eventsSendRequest)if(n)setTimeout((function(){return e.eventsSendRequest(t,n)}),0);else try{e.eventsSendRequest(t,n)}catch(e){}}))},e.perfEvent=function(t){t&&(!n&&t.isChildEvt()||ie(e.listeners,(function(e){if(e&&e.perfEvent)if(t.isAsync)setTimeout((function(){return e.perfEvent(t)}),0);else try{e.perfEvent(t)}catch(e){}})))}}))},Bt=function(e){function t(){var n=e.call(this)||this,r=0;return D(t,n,(function(e,t){function n(t){var n=e.getNotifyMgr();n&&n.eventsDiscarded([t],2)}e.initialize=function(e,n,r,o){t.initialize(e,n,r||new it(e),o||new qt(e))},e.track=function(r){ut(e.getPerfMgr(),(function(){return"AppInsightsCore:track"}),(function(){null===r&&(n(r),Ee("Invalid telemetry item")),function(e){if(z(e.name))throw n(e),Error("telemetry name required")}(r),t.track(r)}),(function(){return{item:r}}),!r.sync)},e.addNotificationListener=function(t){var n=e.getNotifyMgr();n&&n.addNotificationListener(t)},e.removeNotificationListener=function(t){var n=e.getNotifyMgr();n&&n.removeNotificationListener(t)},e.pollInternalLogs=function(t){var n=e.config.diagnosticLogInterval;return n&&n>0||(n=1e4),r&&e.stopPollingInternalLogs(),r=setInterval((function(){var n=e.logger?e.logger.queue:[];ie(n,(function(n){var r={name:t||"InternalMessageId: "+n.messageId,iKey:e.config.instrumentationKey,time:oe(new Date),baseType:rt.dataType,baseData:{message:n.message}};e.track(r)})),n.length=0}),n)},e.stopPollingInternalLogs=function(){r&&(clearInterval(r),r=0)}})),n}return v(t,e),t}(Ht),Gt=4294967296,jt=4294967295,zt=!1,Vt=123456789,Kt=987654321;function Wt(e){e<0&&(e>>>=0),Vt=123456789+e&jt,Kt=987654321-e&jt,zt=!0}function Jt(){try{var e=2147483647&fe();Wt((Math.random()*Gt^e)+e)}catch(e){}}function Yt(e){return e>0?Math.floor(Qt()/jt*(e+1))>>>0:0}function Qt(e){var t,n=Ne("crypto")||Ne("msCrypto");return n&&n.getRandomValues?t=n.getRandomValues(new Uint32Array(1))[0]&jt:je()?(zt||Jt(),t=Xt()&jt):t=Math.floor(Gt*Math.random()|0),e||(t>>>=0),t}function Xt(e){var t=((Kt=36969*(65535&Kt)+(Kt>>16)&jt)<<16)+(65535&(Vt=18e3*(65535&Vt)+(Vt>>16)&jt))>>>0&jt|0;return e||(t>>>=0),t}var Zt,$t="visibilitychange",en="pagehide",tn=null;function nn(e,t){var n=!1,r=xe();r&&(n=Y(r,e,t),n=Y(r.body,e,t)||n);var o=Le();return o&&(n=Y(o,e,t)||n),n}function rn(e,t,n){var r=!1;if(t&&e&&$(e)){var o=[];ie(e,(function(e){te(e)&&(n&&-1!==ae(n,e)?o.push(e):r=nn(e,t)||r)})),!r&&o.length>0&&(r=rn(o,t))}return r}function on(e,t){return rn(["beforeunload","unload","pagehide"],e,t)}function an(e,t){var n=!1;return t&&-1!==ae(t,en)||(n=nn(en,e)),t&&-1!==ae(t,$t)||(n=nn($t,(function(t){var n=Le();e&&n&&"hidden"===n.visibilityState&&e(t)}))||n),!n&&t&&(n=an(e)),n}function sn(e){void 0===e&&(e=22);for(var t=Qt()>>>0,n=0,r="";r.length<e;)n++,r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&t),t>>>=6,5===n&&(t=(Qt()<<2&4294967295|3&t)>>>0,n=0);return r}function cn(){for(var e,t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n="",r=0;r<4;r++)n+=t[15&(e=Qt())]+t[e>>4&15]+t[e>>8&15]+t[e>>12&15]+t[e>>16&15]+t[e>>20&15]+t[e>>24&15]+t[e>>28&15];var o=t[8+(3&Qt())|0];return n.substr(0,8)+n.substr(9,4)+"4"+n.substr(13,3)+o+n.substr(16,3)+n.substr(19,12)}var un={_canUseCookies:void 0,isTypeof:function(e,t){return typeof e===t},isUndefined:j,isNullOrUndefined:z,hasOwnProperty:K,isFunction:J,isObject:W,isDate:Z,isArray:$,isError:ee,isString:te,isNumber:ne,isBoolean:re,toISOString:oe,arrForEach:ie,arrIndexOf:ae,arrMap:se,arrReduce:ce,strTrim:ue,objCreate:f,objKeys:pe,objDefineAccessors:he,addEventHandler:nn,dateNow:fe,isIE:je,disableCookies:pn,newGuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(ln,(function(e){var t=0|Yt(15);return("x"===e?t:3&t|8).toString(16)}))},perfNow:function(){var e=qe();return e&&e.now?e.now():fe()},newId:sn,randomValue:Yt,random32:Qt,mwcRandomSeed:function(e){e?Wt(e):Jt()},mwcRandom32:Xt,generateW3CId:cn},ln=/[xy]/g;function dn(e,t){var n=_t(e,t),r=un._canUseCookies;return null===tn&&(tn=[],Zt=r,he(un,"_canUseCookies",(function(){return Zt}),(function(e){Zt=e,ie(tn,(function(t){t.setEnabled(e)}))}))),-1===ae(tn,n)&&tn.push(n),re(r)&&n.setEnabled(r),re(Zt)&&n.setEnabled(Zt),n}function pn(){dn().setEnabled(!1)}var hn="AppInsightsPropertiesPlugin",fn="AppInsightsChannelPlugin",gn="ApplicationInsightsAnalytics";function mn(e,t,n){var r=t.length,o=vn(e,t);if(o.length!==r){for(var i=0,a=o;void 0!==n[a];)i++,a=o.substring(0,147)+An(i);o=a}return o}function vn(e,t){var n;return t&&(t=ue(t.toString())).length>150&&(n=t.substring(0,150),e&&e.throwInternal(H.WARNING,q.NameTooLong,"name is too long.  It has been truncated to 150 characters.",{name:t},!0)),n||t}function yn(e,t,n){var r;return void 0===n&&(n=1024),t&&(n=n||1024,(t=ue(t)).toString().length>n&&(r=t.toString().substring(0,n),e&&e.throwInternal(H.WARNING,q.StringValueTooLong,"string value is too long. It has been truncated to "+n+" characters.",{value:t},!0))),r||t}function Cn(e,t){return In(e,t,2048,q.UrlTooLong)}function En(e,t){var n;return t&&t.length>32768&&(n=t.substring(0,32768),e&&e.throwInternal(H.WARNING,q.MessageTruncated,"message is too long, it has been truncated to 32768 characters.",{message:t},!0)),n||t}function Tn(e,t){var n;if(t){var r=""+t;r.length>32768&&(n=r.substring(0,32768),e&&e.throwInternal(H.WARNING,q.ExceptionTruncated,"exception is too long, it has been truncated to 32768 characters.",{exception:t},!0))}return n||t}function wn(e,t){if(t){var n={};Q(t,(function(t,r){if(W(r)&&Be())try{r=Ge().stringify(r)}catch(t){e&&e.throwInternal(H.WARNING,q.CannotSerializeObjectNonSerializable,"custom property is not valid",{exception:t},!0)}r=yn(e,r,8192),t=mn(e,t,n),n[t]=r})),t=n}return t}function bn(e,t){if(t){var n={};Q(t,(function(t,r){t=mn(e,t,n),n[t]=r})),t=n}return t}function Sn(e,t){return t?In(e,t,128,q.IdTooLong).toString():t}function In(e,t,n,r){var o;return t&&(t=ue(t)).length>n&&(o=t.substring(0,n),e&&e.throwInternal(H.WARNING,r,"input is too long, it has been truncated to "+n+" characters.",{data:t},!0)),o||t}function An(e){var t="00"+e;return t.substr(t.length-3)}var _n,Rn={MAX_NAME_LENGTH:150,MAX_ID_LENGTH:128,MAX_PROPERTY_LENGTH:8192,MAX_STRING_LENGTH:1024,MAX_URL_LENGTH:2048,MAX_MESSAGE_LENGTH:32768,MAX_EXCEPTION_LENGTH:32768,sanitizeKeyAndAddUniqueness:mn,sanitizeKey:vn,sanitizeString:yn,sanitizeUrl:Cn,sanitizeMessage:En,sanitizeException:Tn,sanitizeProperties:wn,sanitizeMeasurements:bn,sanitizeId:Sn,sanitizeInput:In,padNumber:An,trim:ue},Pn="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",kn="http.method",On="https://dc.services.visualstudio.com",Nn="not_specified",Mn=function(){function e(){}return e.create=function(e,t,n,r,o,i){if(n=yn(r,n)||Nn,z(e)||z(t)||z(n))throw Error("Input doesn't contain all required fields");var a="";e.iKey&&(a=e.iKey,delete e.iKey);var s={name:n,time:oe(new Date),iKey:a,ext:i||{},tags:[],data:{},baseType:t,baseData:e};return z(o)||Q(o,(function(e,t){s.data[e]=t})),s},e}(),xn=function(){this.ver=2,this.properties={},this.measurements={}},Fn=function(e){function t(t,n,r,o){var i=e.call(this)||this;return i.aiDataContract={ver:1,name:1,properties:0,measurements:0},i.name=yn(t,n)||Nn,i.properties=wn(t,r),i.measurements=bn(t,o),i}return v(t,e),t.envelopeType="Microsoft.ApplicationInsights.{0}.Event",t.dataType="EventData",t}(xn),Ln=function(e){function t(t,n,r,o,i){var a=e.call(this)||this;return a.aiDataContract={ver:1,message:1,severityLevel:0,properties:0},n=n||Nn,a.message=En(t,n),a.properties=wn(t,o),a.measurements=bn(t,i),r&&(a.severityLevel=r),a}return v(t,e),t.envelopeType="Microsoft.ApplicationInsights.{0}.Message",t.dataType="MessageData",t}((function(){this.ver=2,this.properties={},this.measurements={}}));!function(e){e[e.Measurement=0]="Measurement",e[e.Aggregation=1]="Aggregation"}(_n||(_n={}));var Un=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.aiDataContract={name:1,kind:0,value:1,count:0,min:0,max:0,stdDev:0},t}return v(t,e),t}((function(){this.kind=_n.Measurement})),Dn=function(e){function t(t,n,r,o,i,a,s,c,u){var l=e.call(this)||this;l.aiDataContract={ver:1,metrics:1,properties:0};var d=new Un;return d.count=o>0?o:void 0,d.max=isNaN(a)||null===a?void 0:a,d.min=isNaN(i)||null===i?void 0:i,d.name=yn(t,n)||Nn,d.value=r,d.stdDev=isNaN(s)||null===s?void 0:s,l.metrics=[d],l.properties=wn(t,c),l.measurements=bn(t,u),l}return v(t,e),t.envelopeType="Microsoft.ApplicationInsights.{0}.Metric",t.dataType="MetricData",t}((function(){this.ver=2,this.metrics=[],this.properties={},this.measurements={}})),Hn=function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}return v(t,e),t}(xn);function qn(e,t){return void 0===t&&(t=!1),null==e?t:"true"===e.toString().toLowerCase()}function Bn(e){(isNaN(e)||e<0)&&(e=0);var t=""+(e=Math.round(e))%1e3,n=""+Math.floor(e/1e3)%60,r=""+Math.floor(e/6e4)%60,o=""+Math.floor(e/36e5)%24,i=Math.floor(e/864e5);return t=1===t.length?"00"+t:2===t.length?"0"+t:t,n=n.length<2?"0"+n:n,r=r.length<2?"0"+r:r,(i>0?i+".":"")+(o=o.length<2?"0"+o:o)+":"+r+":"+n+"."+t}function Gn(e,t){var n=null;return ie(e,(function(e){if(e.identifier===t)return n=e,-1})),n}function jn(e,t,n,r,o){return!o&&te(e)&&("Script error."===e||"Script error"===e)}var zn=function(e){function t(t,n,r,o,i,a,s){var c=e.call(this)||this;return c.aiDataContract={ver:1,name:0,url:0,duration:0,properties:0,measurements:0,id:0},c.id=Sn(t,s),c.url=Cn(t,r),c.name=yn(t,n)||Nn,isNaN(o)||(c.duration=Bn(o)),c.properties=wn(t,i),c.measurements=bn(t,a),c}return v(t,e),t.envelopeType="Microsoft.ApplicationInsights.{0}.Pageview",t.dataType="PageviewData",t}(Hn),Vn=function(e){function t(t,n,r,o,i,a,s){var c=e.call(this)||this;return c.aiDataContract={ver:1,name:0,url:0,duration:0,perfTotal:0,networkConnect:0,sentRequest:0,receivedResponse:0,domProcessing:0,properties:0,measurements:0},c.url=Cn(t,r),c.name=yn(t,n)||Nn,c.properties=wn(t,i),c.measurements=bn(t,a),s&&(c.domProcessing=s.domProcessing,c.duration=s.duration,c.networkConnect=s.networkConnect,c.perfTotal=s.perfTotal,c.receivedResponse=s.receivedResponse,c.sentRequest=s.sentRequest),c}return v(t,e),t.envelopeType="Microsoft.ApplicationInsights.{0}.PageviewPerformance",t.dataType="PageviewPerformanceData",t}(function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}return v(t,e),t}(Hn));function Kn(e,t){var n=e;return n&&!te(n)&&(JSON&&JSON.stringify?(n=JSON.stringify(e),!t||n&&"{}"!==n||(n=J(e.toString)?e.toString():""+e)):n=e+" - (Missing JSON.stringify)"),n||""}function Wn(e,t){var n=e;return e&&(n&&!te(n)&&(n=e.message||e.description||n),n&&!te(n)&&(n=Kn(n,!0)),e.filename&&(n=n+" @"+(e.filename||"")+":"+(e.lineno||"?")+":"+(e.colno||"?"))),t&&"String"!==t&&"Object"!==t&&"Error"!==t&&-1===(n||"").indexOf(t)&&(n=t+": "+n),n||""}function Jn(e){return e&&e.src&&te(e.src)&&e.obj&&$(e.obj)}function Yn(e){var t=e||"";te(t)||(t=te(t.stack)?t.stack:""+t);var n=t.split("\n");return{src:t,obj:n}}function Qn(e){var t=null;if(e)try{if(e.stack)t=Yn(e.stack);else if(e.error&&e.error.stack)t=Yn(e.error.stack);else if(e.exception&&e.exception.stack)t=Yn(e.exception.stack);else if(Jn(e))t=e;else if(Jn(e.stackDetails))t=e.stackDetails;else if(window&&window.opera&&e.message)t=function(e){for(var t=[],n=e.split("\n"),r=0;r<n.length;r++){var o=n[r];n[r+1]&&(o+="@"+n[r+1],r++),t.push(o)}return{src:e,obj:t}}(e.message);else if(te(e))t=Yn(e);else{var n=e.message||e.description||"";te(e.errorSrc)&&(n&&(n+="\n"),n+=" from "+e.errorSrc),n&&(t=Yn(n))}}catch(e){t=Yn(e)}return t||{src:"",obj:null}}function Xn(e){var t="";if(e&&!(t=e.typeName||e.name||""))try{var n=/function (.{1,200})\(/.exec(e.constructor.toString());t=n&&n.length>1?n[1]:""}catch(e){}return t}function Zn(e){if(e)try{if(!te(e)){var t=Xn(e),n=Kn(e,!1);return n&&"{}"!==n||(e.error&&(t=Xn(e=e.error)),n=Kn(e,!0)),0!==n.indexOf(t)&&"String"!==t?t+":"+n:n}}catch(e){}return""+(e||"")}var $n,er,tr,nr=function(e){function t(t,n,r,o,i,a){var s=e.call(this)||this;return s.aiDataContract={ver:1,exceptions:1,severityLevel:0,properties:0,measurements:0},function(e){try{if(W(e))return"ver"in e&&"exceptions"in e&&"properties"in e}catch(e){}return!1}(n)?(s.exceptions=n.exceptions,s.properties=n.properties,s.measurements=n.measurements,n.severityLevel&&(s.severityLevel=n.severityLevel),n.id&&(s.id=n.id),n.problemGroup&&(s.problemGroup=n.problemGroup),s.ver=2,z(n.isManual)||(s.isManual=n.isManual)):(r||(r={}),s.exceptions=[new rr(t,n,r)],s.properties=wn(t,r),s.measurements=bn(t,o),i&&(s.severityLevel=i),a&&(s.id=a)),s}return v(t,e),t.CreateAutoException=function(e,t,n,r,o,i,a,s){var c=Xn(o||i||e);return{message:Wn(e,c),url:t,lineNumber:n,columnNumber:r,error:Zn(o||i||e),evt:Zn(i||e),typeName:c,stackDetails:Qn(a||o||i),errorSrc:s}},t.CreateFromInterface=function(e,n,r,o){var i=n.exceptions&&se(n.exceptions,(function(t){return rr.CreateFromInterface(e,t)}));return new t(e,g(g({},n),{exceptions:i}),r,o)},t.prototype.toInterface=function(){var e=this,t=e.exceptions,n=e.properties,r=e.measurements,o=e.severityLevel,i=(e.ver,e.problemGroup),a=e.id,s=e.isManual;return{ver:"4.0",exceptions:t instanceof Array&&se(t,(function(e){return e.toInterface()}))||void 0,severityLevel:o,properties:n,measurements:r,problemGroup:i,id:a,isManual:s}},t.CreateSimpleException=function(e,t,n,r,o,i){return{exceptions:[{hasFullStack:!0,message:e,stack:o,typeName:t}]}},t.envelopeType="Microsoft.ApplicationInsights.{0}.Exception",t.dataType="ExceptionData",t.formatError=Zn,t}((function(){this.ver=2,this.exceptions=[],this.properties={},this.measurements={}})),rr=function(e){function t(t,n,r){var o=e.call(this)||this;if(o.aiDataContract={id:0,outerId:0,typeName:1,message:1,hasFullStack:0,stack:0,parsedStack:2},function(e){try{if(W(e))return"hasFullStack"in e&&"typeName"in e}catch(e){}return!1}(n))o.typeName=n.typeName,o.message=n.message,o.stack=n.stack,o.parsedStack=n.parsedStack,o.hasFullStack=n.hasFullStack;else{var i=n,a=i&&i.evt;ee(i)||(i=i.error||a||i),o.typeName=yn(t,Xn(i))||Nn,o.message=En(t,Wn(n||i,o.typeName))||Nn;var s=n.stackDetails||Qn(n);o.parsedStack=function(e){var t,n=e.obj;if(n&&n.length>0){t=[];var r=0,o=0;if(ie(n,(function(e){var n=e.toString();if(or.regex.test(n)){var i=new or(n,r++);o+=i.sizeInBytes,t.push(i)}})),o>32768)for(var i=0,a=t.length-1,s=0,c=i,u=a;i<a;){if((s+=t[i].sizeInBytes+t[a].sizeInBytes)>32768){var l=u-c+1;t.splice(c,l);break}c=i,u=a,i++,a--}}return t}(s),o.stack=Tn(t,function(e){var t="";return e&&(e.obj?ie(e.obj,(function(e){t+=e+"\n"})):t=e.src||""),t}(s)),o.hasFullStack=$(o.parsedStack)&&o.parsedStack.length>0,r&&(r.typeName=r.typeName||o.typeName)}return o}return v(t,e),t.prototype.toInterface=function(){var e=this.parsedStack instanceof Array&&se(this.parsedStack,(function(e){return e.toInterface()}));return{id:this.id,outerId:this.outerId,typeName:this.typeName,message:this.message,hasFullStack:this.hasFullStack,stack:this.stack,parsedStack:e||void 0}},t.CreateFromInterface=function(e,n){var r=n.parsedStack instanceof Array&&se(n.parsedStack,(function(e){return or.CreateFromInterface(e)}))||n.parsedStack;return new t(e,g(g({},n),{parsedStack:r}))},t}((function(){this.hasFullStack=!0,this.parsedStack=[]})),or=function(e){function t(n,r){var o=e.call(this)||this;if(o.sizeInBytes=0,o.aiDataContract={level:1,method:1,assembly:0,fileName:0,line:0},"string"==typeof n){var i=n;o.level=r,o.method="<no_method>",o.assembly=ue(i),o.fileName="",o.line=0;var a=i.match(t.regex);a&&a.length>=5&&(o.method=ue(a[2])||o.method,o.fileName=ue(a[4]),o.line=parseInt(a[5])||0)}else o.level=n.level,o.method=n.method,o.assembly=n.assembly,o.fileName=n.fileName,o.line=n.line,o.sizeInBytes=0;return o.sizeInBytes+=o.method.length,o.sizeInBytes+=o.fileName.length,o.sizeInBytes+=o.assembly.length,o.sizeInBytes+=t.baseSize,o.sizeInBytes+=o.level.toString().length,o.sizeInBytes+=o.line.toString().length,o}return v(t,e),t.CreateFromInterface=function(e){return new t(e,null)},t.prototype.toInterface=function(){return{level:this.level,method:this.method,assembly:this.assembly,fileName:this.fileName,line:this.line}},t.regex=/^([\s]+at)?[\s]{0,50}([^\@\()]+?)[\s]{0,50}(\@|\()([^\(\n]+):([0-9]+):([0-9]+)(\)?)$/,t.baseSize=58,t}((function(){}));!function(e){e[e.Verbose=0]="Verbose",e[e.Information=1]="Information",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.Critical=4]="Critical"}($n||($n={})),function(e){e[e.LocalStorage=0]="LocalStorage",e[e.SessionStorage=1]="SessionStorage"}(er||(er={})),function(e){e[e.AI=0]="AI",e[e.AI_AND_W3C=1]="AI_AND_W3C",e[e.W3C=2]="W3C"}(tr||(tr={}));var ir=void 0,ar=void 0;function sr(){return dr()?cr(er.LocalStorage):null}function cr(e){try{if(z(p()))return null;var t=new Date,n=Ne(e===er.LocalStorage?"localStorage":"sessionStorage");n.setItem(t.toString(),t.toString());var r=n.getItem(t.toString())!==t.toString();if(n.removeItem(t.toString()),!r)return n}catch(e){}return null}function ur(){return gr()?cr(er.SessionStorage):null}function lr(){ir=!1,ar=!1}function dr(){return void 0===ir&&(ir=!!cr(er.LocalStorage)),ir}function pr(e,t){var n=sr();if(null!==n)try{return n.getItem(t)}catch(t){ir=!1,e.throwInternal(H.WARNING,q.BrowserCannotReadLocalStorage,"Browser failed read of local storage. "+ge(t),{exception:Ve(t)})}return null}function hr(e,t,n){var r=sr();if(null!==r)try{return r.setItem(t,n),!0}catch(t){ir=!1,e.throwInternal(H.WARNING,q.BrowserCannotWriteLocalStorage,"Browser failed write to local storage. "+ge(t),{exception:Ve(t)})}return!1}function fr(e,t){var n=sr();if(null!==n)try{return n.removeItem(t),!0}catch(t){ir=!1,e.throwInternal(H.WARNING,q.BrowserFailedRemovalFromLocalStorage,"Browser failed removal of local storage item. "+ge(t),{exception:Ve(t)})}return!1}function gr(){return void 0===ar&&(ar=!!cr(er.SessionStorage)),ar}function mr(e,t){var n=ur();if(null!==n)try{return n.getItem(t)}catch(t){ar=!1,e.throwInternal(H.WARNING,q.BrowserCannotReadSessionStorage,"Browser failed read of session storage. "+ge(t),{exception:Ve(t)})}return null}function vr(e,t,n){var r=ur();if(null!==r)try{return r.setItem(t,n),!0}catch(t){ar=!1,e.throwInternal(H.WARNING,q.BrowserCannotWriteSessionStorage,"Browser failed write to session storage. "+ge(t),{exception:Ve(t)})}return!1}function yr(e,t){var n=ur();if(null!==n)try{return n.removeItem(t),!0}catch(t){ar=!1,e.throwInternal(H.WARNING,q.BrowserFailedRemovalFromSessionStorage,"Browser failed removal of session storage item. "+ge(t),{exception:Ve(t)})}return!1}function Cr(e){var t=null;if(J(Event))t=new Event(e);else{var n=Le();n&&n.createEvent&&(t=n.createEvent("Event")).initEvent(e,!0,!0)}return t}var Er={requestContextHeader:"Request-Context",requestContextTargetKey:"appId",requestContextAppIdFormat:"appId=cid-v1:",requestIdHeader:"Request-Id",traceParentHeader:"traceparent",traceStateHeader:"tracestate",sdkContextHeader:"Sdk-Context",sdkContextHeaderAppIdRequest:"appId",requestContextHeaderLowerCase:"request-context"},Tr=Le()||{},wr=0,br=[null,null,null,null,null];function Sr(e){var t=wr,n=br,r=n[t];return Tr.createElement?n[t]||(r=n[t]=Tr.createElement("a")):r={host:_r(e,!0)},r.href=e,++t>=n.length&&(t=0),wr=t,r}function Ir(e){var t,n=Sr(e);return n&&(t=n.href),t}function Ar(e,t){return e?e.toUpperCase()+" "+t:t}function _r(e,t){var n=Rr(e,t)||"";if(n){var r=n.match(/(www[0-9]?\.)?(.[^/:]+)(\:[\d]+)?/i);if(null!=r&&r.length>3&&te(r[2])&&r[2].length>0)return r[2]+(r[3]||"")}return n}function Rr(e,t){var n=null;if(e){var r=e.match(/(\w*):\/\/(.[^/:]+)(\:[\d]+)?/i);if(null!=r&&r.length>2&&te(r[2])&&r[2].length>0&&(n=r[2]||"",t&&r.length>2)){var o=(r[1]||"").toLowerCase(),i=r[3]||"";("http"===o&&":80"===i||"https"===o&&":443"===i)&&(i=""),n+=i}}return n}var Pr=["https://dc.services.visualstudio.com/v2/track","https://breeze.aimon.applicationinsights.io/v2/track","https://dc-int.services.visualstudio.com/v2/track"];function kr(e){return-1!==Pr.indexOf(e.toLowerCase())}var Or={NotSpecified:Nn,createDomEvent:Cr,disableStorage:lr,isInternalApplicationInsightsEndpoint:kr,canUseLocalStorage:dr,getStorage:pr,setStorage:hr,removeStorage:fr,canUseSessionStorage:gr,getSessionStorageKeys:function(){var e=[];return gr()&&Q(Ne("sessionStorage"),(function(t){e.push(t)})),e},getSessionStorage:mr,setSessionStorage:vr,removeSessionStorage:yr,disableCookies:pn,canUseCookies:function(e){return dn(null,e).isEnabled()},disallowsSameSiteNone:Ut,setCookie:function(e,t,n,r){dn(null,e).set(t,n,null,r)},stringToBoolOrDefault:qn,getCookie:function(e,t){return dn(null,e).get(t)},deleteCookie:function(e,t){return dn(null,e).del(t)},trim:ue,newId:sn,random32:function(){return Qt(!0)},generateW3CId:cn,isArray:$,isError:ee,isDate:Z,toISOStringForIE8:oe,getIEVersion:ze,msToTimeSpan:Bn,isCrossOriginError:jn,dump:Ve,getExceptionName:ge,addEventHandler:Y,IsBeaconApiSupported:Ke,getExtension:Gn},Nr={parseUrl:Sr,getAbsoluteUrl:Ir,getPathName:function(e){var t,n=Sr(e);return n&&(t=n.pathname),t},getCompleteUrl:Ar,parseHost:_r,parseFullHost:Rr},Mr={correlationIdPrefix:"cid-v1:",canIncludeCorrelationHeader:function(e,t,n){if(!t||e&&e.disableCorrelationHeaders)return!1;if(e&&e.correlationHeaderExcludePatterns)for(var r=0;r<e.correlationHeaderExcludePatterns.length;r++)if(e.correlationHeaderExcludePatterns[r].test(t))return!1;var o=Sr(t).host.toLowerCase();if(!o||-1===o.indexOf(":443")&&-1===o.indexOf(":80")||(o=(Rr(t,!0)||"").toLowerCase()),(!e||!e.enableCorsCorrelation)&&o&&o!==n)return!1;var i,a=e&&e.correlationHeaderDomains;if(a&&(ie(a,(function(e){var t=new RegExp(e.toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*"));i=i||t.test(o)})),!i))return!1;var s=e&&e.correlationHeaderExcludedDomains;if(!s||0===s.length)return!0;for(r=0;r<s.length;r++)if(new RegExp(s[r].toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*")).test(o))return!1;return o&&o.length>0},getCorrelationContext:function(e){if(e){var t=Mr.getCorrelationContextValue(e,Er.requestContextTargetKey);if(t&&t!==Mr.correlationIdPrefix)return t}},getCorrelationContextValue:function(e,t){if(e)for(var n=e.split(","),r=0;r<n.length;++r){var o=n[r].split("=");if(2===o.length&&o[0]===t)return o[1]}}};function xr(){var e=qe();if(e&&e.now&&e.timing){var t=e.now()+e.timing.navigationStart;if(t>0)return t}return fe()}function Fr(e,t){var n=null;return 0===e||0===t||z(e)||z(t)||(n=t-e),n}var Lr={Now:xr,GetDuration:Fr},Ur=function(e){function t(t,n,r,o,i,a,s,c,u,l,d,p){void 0===u&&(u="Ajax");var h=e.call(this)||this;h.aiDataContract={id:1,ver:1,name:0,resultCode:0,duration:0,success:0,data:0,target:0,type:0,properties:0,measurements:0,kind:0,value:0,count:0,min:0,max:0,stdDev:0,dependencyKind:0,dependencySource:0,commandName:0,dependencyTypeName:0},h.id=n,h.duration=Bn(i),h.success=a,h.resultCode=s+"",h.type=yn(t,u);var f=function(e,t,n,r){var o,i=r,a=r;if(t&&t.length>0){var s=Sr(t);if(o=s.host,!i)if(null!=s.pathname){var c=0===s.pathname.length?"/":s.pathname;"/"!==c.charAt(0)&&(c="/"+c),a=s.pathname,i=yn(e,n?n+" "+c:c)}else i=yn(e,t)}else o=r,i=r;return{target:o,name:i,data:a}}(t,r,c,o);return h.data=Cn(t,o)||f.data,h.target=yn(t,f.target),l&&(h.target="".concat(h.target," | ").concat(l)),h.name=yn(t,f.name),h.properties=wn(t,d),h.measurements=bn(t,p),h}return v(t,e),t.envelopeType="Microsoft.ApplicationInsights.{0}.RemoteDependency",t.dataType="RemoteDependencyData",t}((function(){this.ver=2,this.success=!0,this.properties={},this.measurements={}})),Dr=function e(t,n,r,o){D(e,this,(function(e){var i,a=null,s=[],c=!1;function u(){r&&ie(r.getTransmissionControls(),(function(e){ie(e,(function(e){return e.flush(!0)}))}))}r&&(i=r.logger),e.trackPageView=function(e,r){var l=e.name;if(z(l)||"string"!=typeof l){var d=Le();l=e.name=d&&d.title||""}var p=e.uri;if(z(p)||"string"!=typeof p){var h=He();p=e.uri=h&&h.href||""}if(!o.isPerformanceTimingSupported())return t.sendPageViewInternal(e,r),u(),void i.throwInternal(H.WARNING,q.NavigationTimingNotSupported,"trackPageView: navigation timing API used for calculation of page duration is not supported in this browser. This page view will be collected without duration and timing info.");var f,g,m,v=!1,y=o.getPerformanceTiming().navigationStart;y>0&&(f=Fr(y,+new Date),o.shouldCollectDuration(f)||(f=void 0)),z(r)||z(r.duration)||(g=r.duration),!n&&isNaN(g)||(isNaN(g)&&(r||(r={}),r.duration=f),t.sendPageViewInternal(e,r),u(),v=!0),r||(r={}),m=function(){var n=!1;try{if(o.isPerformanceTimingDataReady()){n=!0;var a={name:l,uri:p};o.populatePageViewPerformanceEvent(a),a.isValid||v?(v||(r.duration=a.durationMs,t.sendPageViewInternal(e,r)),c||(t.sendPageViewPerformanceInternal(a,r),c=!0)):(r.duration=f,t.sendPageViewInternal(e,r))}else y>0&&Fr(y,+new Date)>6e4&&(n=!0,v||(r.duration=6e4,t.sendPageViewInternal(e,r)))}catch(e){i.throwInternal(H.CRITICAL,q.TrackPVFailedCalc,"trackPageView failed on page load calculation: "+ge(e),{exception:Ve(e)})}return n},s.push(m),a||(a=setInterval((function(){var e=s.slice(0),t=!1;s=[],ie(e,(function(e){e()?t=!0:s.push(e)})),0===s.length&&(clearInterval(a),a=null),t&&u()}),100))}}))},Hr=function(){function e(e,t){this.prevPageVisitDataKeyName="prevPageVisitData",this.pageVisitTimeTrackingHandler=t,this._logger=e}return e.prototype.trackPreviousPageVisit=function(e,t){try{var n=this.restartPageVisitTimer(e,t);n&&this.pageVisitTimeTrackingHandler(n.pageName,n.pageUrl,n.pageVisitTime)}catch(e){this._logger.warnToConsole("Auto track page visit time failed, metric will not be collected: "+Ve(e))}},e.prototype.restartPageVisitTimer=function(e,t){try{var n=this.stopPageVisitTimer();return this.startPageVisitTimer(e,t),n}catch(e){return this._logger.warnToConsole("Call to restart failed: "+Ve(e)),null}},e.prototype.startPageVisitTimer=function(e,t){try{if(gr()){null!=mr(this._logger,this.prevPageVisitDataKeyName)&&Ee("Cannot call startPageVisit consecutively without first calling stopPageVisit");var n=new qr(e,t),r=Ge().stringify(n);vr(this._logger,this.prevPageVisitDataKeyName,r)}}catch(e){this._logger.warnToConsole("Call to start failed: "+Ve(e))}},e.prototype.stopPageVisitTimer=function(){try{if(gr()){var e=fe(),t=mr(this._logger,this.prevPageVisitDataKeyName);if(t&&Be()){var n=Ge().parse(t);return n.pageVisitTime=e-n.pageVisitStartTime,yr(this._logger,this.prevPageVisitDataKeyName),n}return null}return null}catch(e){return this._logger.warnToConsole("Stop page visit timer failed: "+Ve(e)),null}},e}(),qr=function(e,t){this.pageVisitStartTime=fe(),this.pageName=e,this.pageUrl=t},Br=function(){function e(e){this.MAX_DURATION_ALLOWED=36e5,e&&(this._logger=e.logger)}return e.prototype.populatePageViewPerformanceEvent=function(e){e.isValid=!1;var t=this.getPerformanceNavigationTiming(),n=this.getPerformanceTiming(),r=0,o=0,i=0,a=0,s=0;(t||n)&&(t?(r=t.duration,o=0===t.startTime?t.connectEnd:Fr(t.startTime,t.connectEnd),i=Fr(t.requestStart,t.responseStart),a=Fr(t.responseStart,t.responseEnd),s=Fr(t.responseEnd,t.loadEventEnd)):(r=Fr(n.navigationStart,n.loadEventEnd),o=Fr(n.navigationStart,n.connectEnd),i=Fr(n.requestStart,n.responseStart),a=Fr(n.responseStart,n.responseEnd),s=Fr(n.responseEnd,n.loadEventEnd)),0===r?this._logger.throwInternal(H.WARNING,q.ErrorPVCalc,"error calculating page view performance.",{total:r,network:o,request:i,response:a,dom:s}):this.shouldCollectDuration(r,o,i,a,s)?r<Math.floor(o)+Math.floor(i)+Math.floor(a)+Math.floor(s)?this._logger.throwInternal(H.WARNING,q.ClientPerformanceMathError,"client performance math error.",{total:r,network:o,request:i,response:a,dom:s}):(e.durationMs=r,e.perfTotal=e.duration=Bn(r),e.networkConnect=Bn(o),e.sentRequest=Bn(i),e.receivedResponse=Bn(a),e.domProcessing=Bn(s),e.isValid=!0):this._logger.throwInternal(H.WARNING,q.InvalidDurationValue,"Invalid page load duration value. Browser perf data won't be sent.",{total:r,network:o,request:i,response:a,dom:s}))},e.prototype.getPerformanceTiming=function(){return this.isPerformanceTimingSupported()?qe().timing:null},e.prototype.getPerformanceNavigationTiming=function(){return this.isPerformanceNavigationTimingSupported()?qe().getEntriesByType("navigation")[0]:null},e.prototype.isPerformanceNavigationTimingSupported=function(){var e=qe();return e&&e.getEntriesByType&&e.getEntriesByType("navigation").length>0},e.prototype.isPerformanceTimingSupported=function(){var e=qe();return e&&e.timing},e.prototype.isPerformanceTimingDataReady=function(){var e=qe(),t=e?e.timing:0;return t&&t.domainLookupStart>0&&t.navigationStart>0&&t.responseStart>0&&t.requestStart>0&&t.loadEventEnd>0&&t.responseEnd>0&&t.connectEnd>0&&t.domLoading>0},e.prototype.shouldCollectDuration=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=De()||{},r=["googlebot","adsbot-google","apis-google","mediapartners-google"],o=n.userAgent,i=!1;if(o)for(var a=0;a<r.length;a++)i=i||-1!==o.toLowerCase().indexOf(r[a]);if(i)return!1;for(a=0;a<e.length;a++)if(e[a]<0||e[a]>=this.MAX_DURATION_ALLOWED)return!1;return!0},e}();function Gr(e,t){e&&e.dispatchEvent&&t&&e.dispatchEvent(t)}var jr=function(e){function t(){var n,r,i,a,s,c=e.call(this)||this;return c.identifier=gn,c.priority=180,c.autoRoutePVDelay=500,D(t,c,(function(e,u){var l=He();a=l&&l.href||"",e.getCookieMgr=function(){return Pt(e.core)},e.processTelemetry=function(t,n){ut(e.core,(function(){return e.identifier+":processTelemetry"}),(function(){var r=!1,o=e._telemetryInitializers.length;n=e._getTelCtx(n);for(var i=0;i<o;++i){var a=e._telemetryInitializers[i];if(a)try{if(!1===a.apply(null,[t])){r=!0;break}}catch(e){n.diagLog().throwInternal(H.CRITICAL,q.TelemetryInitializerFailed,"One of telemetry initializers failed, telemetry item will not be sent: "+ge(e),{exception:Ve(e)},!0)}}r||e.processNext(t,n)}),(function(){return{item:t}}),!t.sync)},e.trackEvent=function(t,n){try{var r=Mn.create(t,Fn.dataType,Fn.envelopeType,e.diagLog(),n);e.core.track(r)}catch(t){e.diagLog().throwInternal(H.WARNING,q.TrackTraceFailed,"trackTrace failed, trace will not be collected: "+ge(t),{exception:Ve(t)})}},e.startTrackEvent=function(t){try{n.start(t)}catch(t){e.diagLog().throwInternal(H.CRITICAL,q.StartTrackEventFailed,"startTrackEvent failed, event will not be collected: "+ge(t),{exception:Ve(t)})}},e.stopTrackEvent=function(t,r,o){try{n.stop(t,void 0,r)}catch(t){e.diagLog().throwInternal(H.CRITICAL,q.StopTrackEventFailed,"stopTrackEvent failed, event will not be collected: "+ge(t),{exception:Ve(t)})}},e.trackTrace=function(t,n){try{var r=Mn.create(t,Ln.dataType,Ln.envelopeType,e.diagLog(),n);e.core.track(r)}catch(t){e.diagLog().throwInternal(H.WARNING,q.TrackTraceFailed,"trackTrace failed, trace will not be collected: "+ge(t),{exception:Ve(t)})}},e.trackMetric=function(t,n){try{var r=Mn.create(t,Dn.dataType,Dn.envelopeType,e.diagLog(),n);e.core.track(r)}catch(t){e.diagLog().throwInternal(H.CRITICAL,q.TrackMetricFailed,"trackMetric failed, metric will not be collected: "+ge(t),{exception:Ve(t)})}},e.trackPageView=function(t,n){try{var r=t||{};e._pageViewManager.trackPageView(r,g(g(g({},r.properties),r.measurements),n)),e.config.autoTrackPageVisitTime&&e._pageVisitTimeManager.trackPreviousPageVisit(r.name,r.uri)}catch(t){e.diagLog().throwInternal(H.CRITICAL,q.TrackPVFailed,"trackPageView failed, page view will not be collected: "+ge(t),{exception:Ve(t)})}},e.sendPageViewInternal=function(t,n,r){var o=Le();o&&(t.refUri=void 0===t.refUri?o.referrer:t.refUri);var i=Mn.create(t,zn.dataType,zn.envelopeType,e.diagLog(),n,r);e.core.track(i)},e.sendPageViewPerformanceInternal=function(t,n,r){var o=Mn.create(t,Vn.dataType,Vn.envelopeType,e.diagLog(),n,r);e.core.track(o)},e.trackPageViewPerformance=function(t,n){try{e._pageViewPerformanceManager.populatePageViewPerformanceEvent(t),e.sendPageViewPerformanceInternal(t,n)}catch(t){e.diagLog().throwInternal(H.CRITICAL,q.TrackPVFailed,"trackPageViewPerformance failed, page view will not be collected: "+ge(t),{exception:Ve(t)})}},e.startTrackPage=function(t){try{if("string"!=typeof t){var n=Le();t=n&&n.title||""}r.start(t)}catch(t){e.diagLog().throwInternal(H.CRITICAL,q.StartTrackFailed,"startTrackPage failed, page view may not be collected: "+ge(t),{exception:Ve(t)})}},e.stopTrackPage=function(t,n,o,i){try{if("string"!=typeof t){var a=Le();t=a&&a.title||""}if("string"!=typeof n){var s=He();n=s&&s.href||""}r.stop(t,n,o,i),e.config.autoTrackPageVisitTime&&e._pageVisitTimeManager.trackPreviousPageVisit(t,n)}catch(t){e.diagLog().throwInternal(H.CRITICAL,q.StopTrackFailed,"stopTrackPage failed, page view will not be collected: "+ge(t),{exception:Ve(t)})}},e.sendExceptionInternal=function(t,n,r){var o=t.exception||t.error||new Error(Nn),i=new nr(e.diagLog(),o,t.properties||n,t.measurements,t.severityLevel,t.id).toInterface(),a=Mn.create(i,nr.dataType,nr.envelopeType,e.diagLog(),n,r);e.core.track(a)},e.trackException=function(t,n){try{e.sendExceptionInternal(t,n)}catch(t){e.diagLog().throwInternal(H.CRITICAL,q.TrackExceptionFailed,"trackException failed, exception will not be collected: "+ge(t),{exception:Ve(t)})}},e._onerror=function(t){var n=t&&t.error,r=t&&t.evt;try{if(!r){var o=xe();o&&(r=o.event)}var i=t&&t.url||(Le()||{}).URL,a=t.errorSrc||"window.onerror@"+i+":"+(t.lineNumber||0)+":"+(t.columnNumber||0),s={errorSrc:a,url:i,lineNumber:t.lineNumber||0,columnNumber:t.columnNumber||0,message:t.message};jn(t.message,t.url,t.lineNumber,t.columnNumber,t.error)?function(t,n){var r=Mn.create(t,nr.dataType,nr.envelopeType,e.diagLog(),n);e.core.track(r)}(nr.CreateAutoException("Script error: The browser's same-origin policy prevents us from getting the details of this exception. Consider using the 'crossorigin' attribute.",i,t.lineNumber||0,t.columnNumber||0,n,r,null,a),s):(t.errorSrc||(t.errorSrc=a),e.trackException({exception:t,severityLevel:$n.Error},s))}catch(t){var c=n?n.name+", "+n.message:"null";e.diagLog().throwInternal(H.CRITICAL,q.ExceptionWhileLoggingError,"_onError threw exception while logging error, error will not be collected: "+ge(t),{exception:Ve(t),errorString:c})}},e.addTelemetryInitializer=function(t){e._telemetryInitializers.push(t)},e.initialize=function(l,d,p,h){if(!e.isInitialized()){if(z(d))throw Error("Error initializing");u.initialize(l,d,p,h),e.setInitialized(!1);var f=e._getTelCtx(),g=e.identifier;e.config=f.getExtCfg(g);var m=t.getDefaultConfig(l);void 0!==m&&Q(m,(function(t,n){e.config[t]=f.getConfig(g,t,n),void 0===e.config[t]&&(e.config[t]=n)})),e.config.isStorageUseDisabled&&lr();var v={instrumentationKey:function(){return l.instrumentationKey},accountId:function(){return e.config.accountId||l.accountId},sessionRenewalMs:function(){return e.config.sessionRenewalMs||l.sessionRenewalMs},sessionExpirationMs:function(){return e.config.sessionExpirationMs||l.sessionExpirationMs},sampleRate:function(){return e.config.samplingPercentage||l.samplingPercentage},sdkExtension:function(){return e.config.sdkExtension||l.sdkExtension},isBrowserLinkTrackingEnabled:function(){return e.config.isBrowserLinkTrackingEnabled||l.isBrowserLinkTrackingEnabled},appId:function(){return e.config.appId||l.appId}};e._pageViewPerformanceManager=new Br(e.core),e._pageViewManager=new Dr(c,e.config.overridePageViewDuration,e.core,e._pageViewPerformanceManager),e._pageVisitTimeManager=new Hr(e.diagLog(),(function(t,n,r){return function(t,n,r){var o={PageName:t,PageUrl:n};e.trackMetric({name:"PageVisitTime",average:r,max:r,min:r,sampleCount:1},o)}(t,n,r)})),e._telemetryInitializers=e._telemetryInitializers||[],function(t){if(!t.isBrowserLinkTrackingEnabled()){var n=["/browserLinkSignalR/","/__browserLink/"];r=function(e){if(e.baseType===Ur.dataType){var t=e.baseData;if(t)for(var r=0;r<n.length;r++)if(t.target&&t.target.indexOf(n[r])>=0)return!1}return!0},e._telemetryInitializers.push(r)}var r}(v),(n=new zr(e.diagLog(),"trackEvent")).action=function(t,n,r,o){o||(o={}),o.duration=r.toString(),e.trackEvent({name:t,properties:o})},(r=new zr(e.diagLog(),"trackPageView")).action=function(t,n,r,o,i){z(o)&&(o={}),o.duration=r.toString();var a={name:t,uri:n,properties:o,measurements:i};e.sendPageViewInternal(a,o)};var y,C=xe(),E=Boolean(typeof history===o&&history)?history:Ne("history"),T=He(),w=c;if(!1===e.config.disableExceptionTracking&&!e.config.autoExceptionInstrumented&&C){var b=C.onerror;C.onerror=function(e,t,n,r,o){var i=C.event,a=b&&b(e,t,n,r,o);return!0!==a&&w._onerror(nr.CreateAutoException(e,t,n,r,o,i)),a},e.config.autoExceptionInstrumented=!0}if(!1===e.config.disableExceptionTracking&&!0===e.config.enableUnhandledPromiseRejectionTracking&&!e.config.autoUnhandledPromiseInstrumented&&C){var S=C.onunhandledrejection;C.onunhandledrejection=function(e){var t=C.event,n=S&&S.call(C,e);return!0!==n&&w._onerror(nr.CreateAutoException(function(e){if(e&&e.reason){var t=e.reason;return!te(t)&&J(t.toString)?t.toString():Ve(t)}return e||""}(e),T?T.href:"",0,0,e,t)),n},e.config.autoUnhandledPromiseInstrumented=!0}if(!0===e.config.enableAutoRouteTracking&&E&&J(E.pushState)&&J(E.replaceState)&&C&&"undefined"!=typeof Event){var I=c;ie(p,(function(e){e.identifier===hn&&(i=e)})),E.pushState=(y=E.pushState,function(){var e=y.apply(this,arguments);return Gr(C,Cr(I.config.namePrefix+"pushState")),Gr(C,Cr(I.config.namePrefix+"locationchange")),e}),E.replaceState=function(e){return function(){var t=e.apply(this,arguments);return Gr(C,Cr(I.config.namePrefix+"replaceState")),Gr(C,Cr(I.config.namePrefix+"locationchange")),t}}(E.replaceState),C.addEventListener&&(C.addEventListener(I.config.namePrefix+"popstate",(function(){Gr(C,Cr(I.config.namePrefix+"locationchange"))})),C.addEventListener(I.config.namePrefix+"locationchange",(function(){if(i&&i.context&&i.context.telemetryTrace){i.context.telemetryTrace.traceID=cn();var e="_unknown_";T&&T.pathname&&(e=T.pathname+(T.hash||"")),i.context.telemetryTrace.name=yn(I.diagLog(),e)}s?(a=s,s=T&&T.href||""):s=T&&T.href||"",setTimeout(function(e){I.trackPageView({refUri:e,properties:{duration:0}})}.bind(c,a),I.autoRoutePVDelay)})))}e.setInitialized(!0)}}})),c}return v(t,e),t.getDefaultConfig=function(e){return e||(e={}),e.sessionRenewalMs=18e5,e.sessionExpirationMs=864e5,e.disableExceptionTracking=qn(e.disableExceptionTracking),e.autoTrackPageVisitTime=qn(e.autoTrackPageVisitTime),e.overridePageViewDuration=qn(e.overridePageViewDuration),e.enableUnhandledPromiseRejectionTracking=qn(e.enableUnhandledPromiseRejectionTracking),(isNaN(e.samplingPercentage)||e.samplingPercentage<=0||e.samplingPercentage>=100)&&(e.samplingPercentage=100),e.isStorageUseDisabled=qn(e.isStorageUseDisabled),e.isBrowserLinkTrackingEnabled=qn(e.isBrowserLinkTrackingEnabled),e.enableAutoRouteTracking=qn(e.enableAutoRouteTracking),e.namePrefix=e.namePrefix||"",e.enableDebug=qn(e.enableDebug),e.disableFlushOnBeforeUnload=qn(e.disableFlushOnBeforeUnload),e.disableFlushOnUnload=qn(e.disableFlushOnUnload,e.disableFlushOnBeforeUnload),e},t.Version="2.7.2",t}(ft),zr=function(e,t){var n=this,r={};n.start=function(t){void 0!==r[t]&&e.throwInternal(H.WARNING,q.StartCalledMoreThanOnce,"start was called more than once for this event without calling stop.",{name:t,key:t},!0),r[t]=+new Date},n.stop=function(t,o,i,a){var s=r[t];if(isNaN(s))e.throwInternal(H.WARNING,q.StopCalledWithoutStart,"stop was called without a corresponding start.",{name:t,key:t},!0);else{var c=Fr(s,+new Date);n.action(t,o,c,i,a)}delete r[t],r[t]=void 0}},Vr=function e(t,n){var r=[],o=!1;this._get=function(){return r},this._set=function(e){return r=e},D(e,this,(function(e){e.enqueue=function(i){e.count()>=n.eventsLimitInMem()?o||(t.throwInternal(H.WARNING,q.InMemoryStorageBufferFull,"Maximum in-memory buffer size reached: "+e.count(),!0),o=!0):r.push(i)},e.count=function(){return r.length},e.size=function(){for(var e=r.length,t=0;t<r.length;t++)e+=r[t].length;return n.emitLineDelimitedJson()||(e+=2),e},e.clear=function(){r=[],o=!1},e.getItems=function(){return r.slice(0)},e.batchPayloads=function(e){return e&&e.length>0?n.emitLineDelimitedJson()?e.join("\n"):"["+e.join(",")+"]":null}}))},Kr=function(e){function t(n,r){var o=e.call(this,n,r)||this;return D(t,o,(function(e,t){e.markAsSent=function(e){t.clear()},e.clearSent=function(e){}})),o}return v(t,e),t}(Vr),Wr=function(e){function t(n,r){var o=e.call(this,n,r)||this,i=!1;return D(t,o,(function(e,o){var a=l(t.BUFFER_KEY),s=l(t.SENT_BUFFER_KEY),c=e._set(a.concat(s));function u(e,t){var n=[];return ie(t,(function(t){J(t)||-1!==ae(e,t)||n.push(t)})),n}function l(e){var t=e;try{t=r.namePrefix&&r.namePrefix()?r.namePrefix()+"_"+t:t;var o=mr(n,t);if(o){var i=Ge().parse(o);if(te(i)&&(i=Ge().parse(i)),i&&$(i))return i}}catch(e){n.throwInternal(H.CRITICAL,q.FailedToRestoreStorageBuffer," storage key: "+t+", "+ge(e),{exception:Ve(e)})}return[]}function d(e,t){var o=e;try{o=r.namePrefix&&r.namePrefix()?r.namePrefix()+"_"+o:o;var i=JSON.stringify(t);vr(n,o,i)}catch(e){vr(n,o,JSON.stringify([])),n.throwInternal(H.WARNING,q.FailedToSetStorageBuffer," storage key: "+o+", "+ge(e)+". Buffer cleared",{exception:Ve(e)})}}c.length>t.MAX_BUFFER_SIZE&&(c.length=t.MAX_BUFFER_SIZE),d(t.SENT_BUFFER_KEY,[]),d(t.BUFFER_KEY,c),e.enqueue=function(r){e.count()>=t.MAX_BUFFER_SIZE?i||(n.throwInternal(H.WARNING,q.SessionStorageBufferFull,"Maximum buffer size reached: "+e.count(),!0),i=!0):(o.enqueue(r),d(t.BUFFER_KEY,e._get()))},e.clear=function(){o.clear(),d(t.BUFFER_KEY,e._get()),d(t.SENT_BUFFER_KEY,[]),i=!1},e.markAsSent=function(r){d(t.BUFFER_KEY,e._set(u(r,e._get())));var o=l(t.SENT_BUFFER_KEY);o instanceof Array&&r instanceof Array&&((o=o.concat(r)).length>t.MAX_BUFFER_SIZE&&(n.throwInternal(H.CRITICAL,q.SessionStorageBufferFull,"Sent buffer reached its maximum size: "+o.length,!0),o.length=t.MAX_BUFFER_SIZE),d(t.SENT_BUFFER_KEY,o))},e.clearSent=function(e){var n=l(t.SENT_BUFFER_KEY);n=u(e,n),d(t.SENT_BUFFER_KEY,n)}})),o}return v(t,e),t.BUFFER_KEY="AI_buffer",t.SENT_BUFFER_KEY="AI_sentBuffer",t.MAX_BUFFER_SIZE=2e3,t}(Vr);function Jr(e){var t="ai."+e+".";return function(e){return t+e}}var Yr,Qr=Jr("application"),Xr=Jr("device"),Zr=Jr("location"),$r=Jr("operation"),eo=Jr("session"),to=Jr("user"),no=Jr("cloud"),ro=Jr("internal"),oo=function(e){function t(){return e.call(this)||this}return v(t,e),t}((Yr={applicationVersion:Qr("ver"),applicationBuild:Qr("build"),applicationTypeId:Qr("typeId"),applicationId:Qr("applicationId"),applicationLayer:Qr("layer"),deviceId:Xr("id"),deviceIp:Xr("ip"),deviceLanguage:Xr("language"),deviceLocale:Xr("locale"),deviceModel:Xr("model"),deviceFriendlyName:Xr("friendlyName"),deviceNetwork:Xr("network"),deviceNetworkName:Xr("networkName"),deviceOEMName:Xr("oemName"),deviceOS:Xr("os"),deviceOSVersion:Xr("osVersion"),deviceRoleInstance:Xr("roleInstance"),deviceRoleName:Xr("roleName"),deviceScreenResolution:Xr("screenResolution"),deviceType:Xr("type"),deviceMachineName:Xr("machineName"),deviceVMName:Xr("vmName"),deviceBrowser:Xr("browser"),deviceBrowserVersion:Xr("browserVersion"),locationIp:Zr("ip"),locationCountry:Zr("country"),locationProvince:Zr("province"),locationCity:Zr("city"),operationId:$r("id"),operationName:$r("name"),operationParentId:$r("parentId"),operationRootId:$r("rootId"),operationSyntheticSource:$r("syntheticSource"),operationCorrelationVector:$r("correlationVector"),sessionId:eo("id"),sessionIsFirst:eo("isFirst"),sessionIsNew:eo("isNew"),userAccountAcquisitionDate:to("accountAcquisitionDate"),userAccountId:to("accountId"),userAgent:to("userAgent"),userId:to("id"),userStoreRegion:to("storeRegion"),userAuthUserId:to("authUserId"),userAnonymousUserAcquisitionDate:to("anonUserAcquisitionDate"),userAuthenticatedUserAcquisitionDate:to("authUserAcquisitionDate"),cloudName:no("name"),cloudRole:no("role"),cloudRoleVer:no("roleVer"),cloudRoleInstance:no("roleInstance"),cloudEnvironment:no("environment"),cloudLocation:no("location"),cloudDeploymentUnit:no("deploymentUnit"),internalNodeName:ro("nodeName"),internalSdkVersion:ro("sdkVersion"),internalAgentVersion:ro("agentVersion"),internalSnippet:ro("snippet"),internalSdkSrc:ro("sdkSrc")},function(){var e=this;Yr&&Q(Yr,(function(t,n){e[t]=n}))})),io={UserExt:"user",DeviceExt:"device",TraceExt:"trace",WebExt:"web",AppExt:"app",OSExt:"os",SessionExt:"ses",SDKExt:"sdk"},ao=new oo,so=function(e){function t(t,n,r){var o=e.call(this)||this;return o.name=yn(t,r)||Nn,o.data=n,o.time=oe(new Date),o.aiDataContract={time:1,iKey:1,name:1,sampleRate:function(){return 100===o.sampleRate?4:1},tags:1,data:1},o}return v(t,e),t}((function(){this.ver=1,this.sampleRate=100,this.tags={}})),co=function(){},uo=function(e){function t(){return e.call(this)||this}return v(t,e),t}(co),lo=function(e){function t(t,n){var r=e.call(this)||this;return r.aiDataContract={baseType:1,baseData:1},r.baseType=t,r.baseData=n,r}return v(t,e),t}(uo),po="true";function ho(e,t,n){return me(e,t,n,Ce)}function fo(e,t,n){z(e)||Q(e,(function(e,r){ne(r)?n[e]=r:te(r)?t[e]=r:Be()&&(t[e]=Ge().stringify(r))}))}function go(e,t){z(e)||Q(e,(function(n,r){e[n]=r||t}))}function mo(e,t,n,r){var o=new so(e,r,t);ho(o,"sampleRate",n.sampleRate),(n.baseData||{}).startTime&&(o.time=oe(n.baseData.startTime)),o.iKey=n.iKey;var i=n.iKey.replace(/-/g,"");return o.name=o.name.replace("{0}",i),function(e,t,n){var r=n.tags=n.tags||{},o=t.ext=t.ext||{},i=t.tags=t.tags||[],a=o.user;a&&(ho(r,ao.userAuthUserId,a.authId),ho(r,ao.userId,a.id||a.localId));var s=o.app;s&&ho(r,ao.sessionId,s.sesId);var c=o.device;c&&(ho(r,ao.deviceId,c.id||c.localId),ho(r,ao.deviceType,c.deviceClass),ho(r,ao.deviceIp,c.ip),ho(r,ao.deviceModel,c.model),ho(r,ao.deviceType,c.deviceType));var u=t.ext.web;if(u){ho(r,ao.deviceLanguage,u.browserLang),ho(r,ao.deviceBrowserVersion,u.browserVer),ho(r,ao.deviceBrowser,u.browser);var l=n.data=n.data||{},d=l.baseData=l.baseData||{},p=d.properties=d.properties||{};ho(p,"domain",u.domain),ho(p,"isManual",u.isManual?po:null),ho(p,"screenRes",u.screenRes),ho(p,"userConsent",u.userConsent?po:null)}var h=o.os;h&&ho(r,ao.deviceOS,h.name);var f=o.trace;f&&(ho(r,ao.operationParentId,f.parentID),ho(r,ao.operationName,yn(e,f.name)),ho(r,ao.operationId,f.traceID));for(var m={},v=i.length-1;v>=0;v--)Q(i[v],(function(e,t){m[e]=t})),i.splice(v,1);Q(i,(function(e,t){m[e]=t}));var y=g(g({},r),m);y[ao.internalSdkVersion]||(y[ao.internalSdkVersion]="javascript:".concat(yo.Version)),n.tags=we(y)}(e,n,o),n.tags=n.tags||[],we(o)}function vo(e,t){z(t.baseData)&&e.throwInternal(H.CRITICAL,q.TelemetryEnvelopeInvalid,"telemetryItem.baseData cannot be null.")}var yo={Version:"2.7.2"};function Co(e,t,n){vo(e,t);var r={},o={};t.baseType!==Fn.dataType&&(r.baseTypeSource=t.baseType),t.baseType===Fn.dataType?(r=t.baseData.properties||{},o=t.baseData.measurements||{}):t.baseData&&fo(t.baseData,r,o),fo(t.data,r,o),z(n)||go(r,n);var i=t.baseData.name,a=new Fn(e,i,r,o),s=new lo(Fn.dataType,a);return mo(e,Fn.envelopeType,t,s)}var Eo,To=function e(t){D(e,this,(function(e){function n(e,i){var a={};if(!e)return t.throwInternal(H.CRITICAL,q.CannotSerializeObject,"cannot serialize object because it is null or undefined",{name:i},!0),a;if(e.__aiCircularRefCheck)return t.throwInternal(H.WARNING,q.CircularReferenceDetected,"Circular reference detected while serializing object",{name:i},!0),a;if(!e.aiDataContract){if("measurements"===i)a=o(e,"number",i);else if("properties"===i)a=o(e,"string",i);else if("tags"===i)a=o(e,"string",i);else if($(e))a=r(e,i);else{t.throwInternal(H.WARNING,q.CannotSerializeObjectNonSerializable,"Attempting to serialize an object which does not implement ISerializable",{name:i},!0);try{Ge().stringify(e),a=e}catch(e){t.throwInternal(H.CRITICAL,q.CannotSerializeObject,e&&J(e.toString)?e.toString():"Error serializing object",null,!0)}}return a}return e.__aiCircularRefCheck=!0,Q(e.aiDataContract,(function(o,s){var c=J(s)?1&s():1&s,u=J(s)?4&s():4&s,l=2&s,d=void 0!==e[o],p=W(e[o])&&null!==e[o];if(!c||d||l){if(!u){var h;void 0!==(h=p?l?r(e[o],o):n(e[o],o):e[o])&&(a[o]=h)}}else t.throwInternal(H.CRITICAL,q.MissingRequiredFieldSpecification,"Missing required field specification. The field is required but not present on source",{field:o,name:i})})),delete e.__aiCircularRefCheck,a}function r(e,r){var o;if(e)if($(e)){o=[];for(var i=0;i<e.length;i++){var a=n(e[i],r+"["+i+"]");o.push(a)}}else t.throwInternal(H.CRITICAL,q.ItemNotInArray,"This field was specified as an array in the contract but the item is not an array.\r\n",{name:r},!0);return o}function o(e,n,r){var o;return e&&(o={},Q(e,(function(e,i){if("string"===n)void 0===i?o[e]="undefined":null===i?o[e]="null":i.toString?o[e]=i.toString():o[e]="invalid field: toString() is not defined.";else if("number"===n)if(void 0===i)o[e]="undefined";else if(null===i)o[e]="null";else{var a=parseFloat(i);isNaN(a)?o[e]="NaN":o[e]=a}else o[e]="invalid field: "+r+" is of unknown type.",t.throwInternal(H.CRITICAL,o[e],null,!0)}))),o}e.serialize=function(e){var r=n(e,"root");try{return Ge().stringify(r)}catch(e){t.throwInternal(H.CRITICAL,q.CannotSerializeObject,e&&J(e.toString)?e.toString():"Error serializing object",null,!0)}}}))},wo=function(){function e(){var t=xe(),n=Le(),r=!1,o=!0;D(e,this,(function(e){try{if(t&&Y(t,"online",s)&&(Y(t,"offline",c),r=!0),n){var i=n.body||n;j(i.ononline)||(i.ononline=s,i.onoffline=c,r=!0)}if(r){var a=De();a&&!z(a.onLine)&&(o=a.onLine)}}catch(e){r=!1}function s(){o=!0}function c(){o=!1}e.isListening=r,e.isOnline=function(){var e=!0,t=De();return r?e=o:t&&!z(t.onLine)&&(e=t.onLine),e},e.isOffline=function(){return!e.isOnline()}}))}return e.Offline=new e,e}(),bo=wo.Offline,So=function(){function e(){}return e.prototype.getHashCodeScore=function(t){return this.getHashCode(t)/e.INT_MAX_VALUE*100},e.prototype.getHashCode=function(e){if(""===e)return 0;for(;e.length<8;)e=e.concat(e);for(var t=5381,n=0;n<e.length;++n)t=(t<<5)+t+e.charCodeAt(n),t&=t;return Math.abs(t)},e.INT_MAX_VALUE=2147483647,e}(),Io=function(){var e=new So,t=new oo;this.getSamplingScore=function(n){return n.tags&&n.tags[t.userId]?e.getHashCodeScore(n.tags[t.userId]):n.ext&&n.ext.user&&n.ext.user.id?e.getHashCodeScore(n.ext.user.id):n.tags&&n.tags[t.operationId]?e.getHashCodeScore(n.tags[t.operationId]):n.ext&&n.ext.telemetryTrace&&n.ext.telemetryTrace.traceID?e.getHashCodeScore(n.ext.telemetryTrace.traceID):100*Math.random()}},Ao=function(){function e(e,t){this.INT_MAX_VALUE=2147483647;var n=t||ot(null);(e>100||e<0)&&(n.throwInternal(H.WARNING,q.SampleRateOutOfRange,"Sampling rate is out of range (0..100). Sampling will be disabled, you may be sending too much data which may affect your AI service level.",{samplingRate:e},!0),e=100),this.sampleRate=e,this.samplingScoreGenerator=new Io}return e.prototype.isSampledIn=function(e){var t=this.sampleRate;return null==t||t>=100||e.baseType===Dn.dataType||this.samplingScoreGenerator.getSamplingScore(e)<t},e}();function _o(e){try{return e.responseText}catch(e){}return null}var Ro=((Eo={})[Fn.dataType]=Co,Eo[Ln.dataType]=function(e,t,n){vo(e,t);var r=t.baseData.message,o=t.baseData.severityLevel,i=t.baseData.properties||{},a=t.baseData.measurements||{};fo(t.data,i,a),z(n)||go(i,n);var s=new Ln(e,r,o,i,a),c=new lo(Ln.dataType,s);return mo(e,Ln.envelopeType,t,c)},Eo[zn.dataType]=function(e,t,n){vo(e,t);var r,o=t.baseData;z(o)||z(o.properties)||z(o.properties.duration)?z(t.data)||z(t.data.duration)||(r=t.data.duration,delete t.data.duration):(r=o.properties.duration,delete o.properties.duration);var i,a=t.baseData;((t.ext||{}).trace||{}).traceID&&(i=t.ext.trace.traceID);var s=a.id||i,c=a.name,u=a.uri,l=a.properties||{},d=a.measurements||{};z(a.refUri)||(l.refUri=a.refUri),z(a.pageType)||(l.pageType=a.pageType),z(a.isLoggedIn)||(l.isLoggedIn=a.isLoggedIn.toString()),z(a.properties)||Q(a.properties,(function(e,t){l[e]=t})),fo(t.data,l,d),z(n)||go(l,n);var p=new zn(e,c,u,r,l,d,s),h=new lo(zn.dataType,p);return mo(e,zn.envelopeType,t,h)},Eo[Vn.dataType]=function(e,t,n){vo(e,t);var r=t.baseData,o=r.name,i=r.uri||r.url,a=r.properties||{},s=r.measurements||{};fo(t.data,a,s),z(n)||go(a,n);var c=new Vn(e,o,i,void 0,a,s,r),u=new lo(Vn.dataType,c);return mo(e,Vn.envelopeType,t,u)},Eo[nr.dataType]=function(e,t,n){vo(e,t);var r=t.baseData.measurements||{},o=t.baseData.properties||{};fo(t.data,o,r),z(n)||go(o,n);var i=t.baseData,a=nr.CreateFromInterface(e,i,o,r),s=new lo(nr.dataType,a);return mo(e,nr.envelopeType,t,s)},Eo[Dn.dataType]=function(e,t,n){vo(e,t);var r=t.baseData,o=r.properties||{},i=r.measurements||{};fo(t.data,o,i),z(n)||go(o,n);var a=new Dn(e,r.name,r.average,r.sampleCount,r.min,r.max,r.stdDev,o,i),s=new lo(Dn.dataType,a);return mo(e,Dn.envelopeType,t,s)},Eo[Ur.dataType]=function(e,t,n){vo(e,t);var r=t.baseData.measurements||{},o=t.baseData.properties||{};fo(t.data,o,r),z(n)||go(o,n);var i=t.baseData;if(z(i))return e.warnToConsole("Invalid input for dependency data"),null;var a=i.properties&&i.properties[kn]?i.properties[kn]:"GET",s=new Ur(e,i.id,i.target,i.name,i.duration,i.success,i.responseCode,a,i.type,i.correlationContext,o,r),c=new lo(Ur.dataType,s);return mo(e,Ur.envelopeType,t,c)},Eo),Po=function(e){function t(){var n,r,o=e.call(this)||this;o.priority=1001,o.identifier=fn;var i,a,s,c,u,l=!1,d={},p=0;return o._senderConfig={endpointUrl:function(){return"https://dc.services.visualstudio.com/v2/track"},emitLineDelimitedJson:function(){return!1},maxBatchInterval:function(){return 15e3},maxBatchSizeInBytes:function(){return 102400},disableTelemetry:function(){return!1},enableSessionStorageBuffer:function(){return!0},isRetryDisabled:function(){return!1},isBeaconApiDisabled:function(){return!0},disableXhr:function(){return!1},onunloadDisableFetch:function(){return!1},onunloadDisableBeacon:function(){return!1},instrumentationKey:function(){},namePrefix:function(){},samplingPercentage:function(){return 100},customHeaders:function(){},convertUndefined:function(){},eventsLimitInMem:function(){return 1e4}},D(t,o,(function(e,h){function f(t,r,o,i,a,s){var c=null;if(e._appId||(c=b(s))&&c.appId&&(e._appId=c.appId),(t<200||t>=300)&&0!==t){if((301===t||307===t||308===t)&&!g(o))return void e._onError(r,a);!e._senderConfig.isRetryDisabled()&&_(t)?(S(r),e.diagLog().throwInternal(H.WARNING,q.TransmissionFailed,". Response code "+t+". Will retry to send "+r.length+" items.")):e._onError(r,a)}else bo.isOffline()?e._senderConfig.isRetryDisabled()||(S(r,10),e.diagLog().throwInternal(H.WARNING,q.TransmissionFailed,". Offline - Response Code: ".concat(t,". Offline status: ").concat(bo.isOffline(),". Will retry to send ").concat(r.length," items."))):(g(o),206===t?(c||(c=b(s)),c&&!e._senderConfig.isRetryDisabled()?e._onPartialSuccess(r,c):e._onError(r,a)):(n=0,e._onSuccess(r,i)))}function g(t){return!(s>=10||z(t)||""===t||t===e._senderConfig.endpointUrl()||(e._senderConfig.endpointUrl=function(){return t},++s,0))}function m(e,t){u?u(e,!1):y(e)}function v(t){var n=De(),r=e._buffer,o=e._senderConfig.endpointUrl(),i=e._buffer.batchPayloads(t),a=new Blob([i],{type:"text/plain;charset=UTF-8"}),s=n.sendBeacon(o,a);return s&&(r.markAsSent(t),e._onSuccess(t,t.length)),s}function y(t,n){if($(t)&&t.length>0&&!v(t)){for(var r=[],o=0;o<t.length;o++){var i=t[o];v([i])||r.push(i)}r.length>0&&(c(r,!0),e.diagLog().throwInternal(H.WARNING,q.TransmissionFailed,". Failed to send telemetry with Beacon API, retried with normal sender."))}}function C(t,n){var r=new XMLHttpRequest,o=e._senderConfig.endpointUrl();try{r[Pn]=!0}catch(e){}r.open("POST",o,n),r.setRequestHeader("Content-type","application/json"),kr(o)&&r.setRequestHeader(Er.sdkContextHeader,Er.sdkContextHeaderAppIdRequest),ie(pe(d),(function(e){r.setRequestHeader(e,d[e])})),r.onreadystatechange=function(){return e._xhrReadyStateChange(r,t,t.length)},r.onerror=function(n){return e._onError(t,R(r),n)};var i=e._buffer.batchPayloads(t);r.send(i),e._buffer.markAsSent(t)}function E(t,n){if($(t)){for(var r=t.length,o=0;o<t.length;o++)r+=t[o].length;p+r<=65e3?w(t,!1):Ke()?y(t):(c&&c(t,!0),e.diagLog().throwInternal(H.WARNING,q.TransmissionFailed,". Failed to send telemetry with Beacon API, retried with xhrSender."))}}function T(e,t){w(e,!0)}function w(t,n){var r,o=e._senderConfig.endpointUrl(),i=e._buffer.batchPayloads(t),a=new Blob([i],{type:"application/json"}),s=new Headers,c=i.length;kr(o)&&s.append(Er.sdkContextHeader,Er.sdkContextHeaderAppIdRequest),ie(pe(d),(function(e){s.append(e,d[e])}));var u=((r={method:"POST",headers:s,body:a})[Pn]=!0,r);n||(u.keepalive=!0,p+=c);var l=new Request(o,u);try{l[Pn]=!0}catch(e){}fetch(l).then((function(r){n||(p-=c,c=0),r.ok?r.text().then((function(e){f(r.status,t,r.url,t.length,r.statusText,e)})):e._onError(t,r.statusText)})).catch((function(r){n||(p-=c,c=0),e._onError(t,r.message)})),e._buffer.markAsSent(t)}function b(t){try{if(t&&""!==t){var n=Ge().parse(t);if(n&&n.itemsReceived&&n.itemsReceived>=n.itemsAccepted&&n.itemsReceived-n.itemsAccepted===n.errors.length)return n}}catch(n){e.diagLog().throwInternal(H.CRITICAL,q.InvalidBackendResponse,"Cannot parse the response. "+ge(n),{response:t})}return null}function S(t,o){if(void 0===o&&(o=1),t&&0!==t.length){var i=e._buffer;i.clearSent(t),n++;for(var a=0,s=t;a<s.length;a++){var c=s[a];i.enqueue(c)}!function(e){var t;if(n<=1)t=10;else{var o=(Math.pow(2,n)-1)/2,i=Math.floor(Math.random()*o*10)+1;i*=e,t=Math.max(Math.min(i,3600),10)}var a=fe()+1e3*t;r=a}(o),I()}}function I(){if(!i&&!l){var t=r?Math.max(0,r-fe()):0,n=Math.max(e._senderConfig.maxBatchInterval(),t);i=setTimeout((function(){i=null,e.triggerSend(!0,null,1)}),n)}}function A(){clearTimeout(i),i=null,r=null}function _(e){return 408===e||429===e||500===e||503===e}function R(e,t){return e?"XMLHttpRequest,Status:"+e.status+",Response:"+_o(e)||0:t}function P(t,n){var r=e._buffer,o=xe(),i=new XDomainRequest;i.onload=function(){return e._xdrOnLoad(i,t)},i.onerror=function(n){return e._onError(t,k(i),n)};var a=o&&o.location&&o.location.protocol||"";if(0!==e._senderConfig.endpointUrl().lastIndexOf(a,0))return e.diagLog().throwInternal(H.WARNING,q.TransmissionFailed,". Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol."),void r.clear();var s=e._senderConfig.endpointUrl().replace(/^(https?:)/,"");i.open("POST",s);var c=r.batchPayloads(t);i.send(c),r.markAsSent(t)}function k(e,t){return e?"XDomainRequest,Response:"+_o(e)||0:t}e.pause=function(){A(),l=!0},e.resume=function(){l&&(l=!1,r=null,e._buffer.size()>e._senderConfig.maxBatchSizeInBytes()&&e.triggerSend(!0,null,10),I())},e.flush=function(){if(!l){A();try{e.triggerSend(!0,null,1)}catch(t){e.diagLog().throwInternal(H.CRITICAL,q.FlushFailed,"flush failed, telemetry will not be collected: "+ge(t),{exception:Ve(t)})}}},e.onunloadFlush=function(){if(!l)if(!1!==e._senderConfig.onunloadDisableBeacon()&&!1!==e._senderConfig.isBeaconApiDisabled()||!Ke())e.flush();else try{e.triggerSend(!0,m,2)}catch(t){e.diagLog().throwInternal(H.CRITICAL,q.FailedToSendQueuedTelemetry,"failed to flush with beacon sender on page unload, telemetry will not be collected: "+ge(t),{exception:Ve(t)})}},e.teardown=function(){Ee("Method not implemented.")},e.addHeader=function(e,t){d[e]=t},e.initialize=function(t,i,l,d){h.initialize(t,i,l,d);var p=e._getTelCtx(),f=e.identifier;a=new To(i.logger),n=0,r=null,e._sender=null,s=0;var g=e.diagLog();Q({endpointUrl:function(){return"https://dc.services.visualstudio.com/v2/track"},emitLineDelimitedJson:function(){return!1},maxBatchInterval:function(){return 15e3},maxBatchSizeInBytes:function(){return 102400},disableTelemetry:function(){return!1},enableSessionStorageBuffer:function(){return!0},isRetryDisabled:function(){return!1},isBeaconApiDisabled:function(){return!0},disableXhr:function(){return!1},onunloadDisableFetch:function(){return!1},onunloadDisableBeacon:function(){return!1},instrumentationKey:function(){},namePrefix:function(){},samplingPercentage:function(){return 100},customHeaders:function(){},convertUndefined:function(){},eventsLimitInMem:function(){return 1e4}},(function(t,n){e._senderConfig[t]=function(){return p.getConfig(f,t,n())}})),e._buffer=e._senderConfig.enableSessionStorageBuffer()&&gr()?new Wr(g,e._senderConfig):new Kr(g,e._senderConfig),e._sample=new Ao(e._senderConfig.samplingPercentage(),g),function(e){return!(z(e.disableInstrumentationKeyValidation)||!e.disableInstrumentationKeyValidation)||new RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(e.instrumentationKey)}(t)||g.throwInternal(H.CRITICAL,q.InvalidInstrumentationKey,"Invalid Instrumentation key "+t.instrumentationKey),!kr(e._senderConfig.endpointUrl())&&e._senderConfig.customHeaders()&&e._senderConfig.customHeaders().length>0&&ie(e._senderConfig.customHeaders(),(function(e){o.addHeader(e.header,e.value)}));var m=e._senderConfig,v=null;!m.disableXhr()&&Je()?v=P:!m.disableXhr()&&Ye()&&(v=C),!v&&We()&&(v=T),c=v||C,!m.isBeaconApiDisabled()&&Ke()&&(v=y),e._sender=v||C,u=!m.onunloadDisableFetch()&&We(!0)?E:Ke()?y:!m.disableXhr()&&Je()?P:!m.disableXhr()&&Ye()?C:c},e.processTelemetry=function(n,r){r=e._getTelCtx(r);try{if(e._senderConfig.disableTelemetry())return;if(!n)return void r.diagLog().throwInternal(H.CRITICAL,q.CannotSendEmptyTelemetry,"Cannot send empty telemetry");if(n.baseData&&!n.baseType)return void r.diagLog().throwInternal(H.CRITICAL,q.InvalidEvent,"Cannot send telemetry without baseData and baseType");if(n.baseType||(n.baseType="EventData"),!e._sender)return void r.diagLog().throwInternal(H.CRITICAL,q.SenderNotInitialized,"Sender was not initialized");if(d=n,!e._sample.isSampledIn(d))return void r.diagLog().throwInternal(H.WARNING,q.TelemetrySampledAndNotSent,"Telemetry item was sampled out and not sent",{SampleRate:e._sample.sampleRate});n.sampleRate=e._sample.sampleRate;var o=e._senderConfig.convertUndefined()||void 0,i=n.iKey||e._senderConfig.instrumentationKey(),s=t.constructEnvelope(n,i,r.diagLog(),o);if(!s)return void r.diagLog().throwInternal(H.CRITICAL,q.CreateEnvelopeError,"Unable to create an AppInsights envelope");var c=!1;if(n.tags&&n.tags.ProcessLegacy&&(ie(n.tags.ProcessLegacy,(function(e){try{e&&!1===e(s)&&(c=!0,r.diagLog().warnToConsole("Telemetry processor check returns false"))}catch(e){r.diagLog().throwInternal(H.CRITICAL,q.TelemetryInitializerFailed,"One of telemetry initializers failed, telemetry item will not be sent: "+ge(e),{exception:Ve(e)},!0)}})),delete n.tags.ProcessLegacy),c)return;var u=a.serialize(s),l=e._buffer;l.size()+u.length>e._senderConfig.maxBatchSizeInBytes()&&e.triggerSend(!0,null,10),l.enqueue(u),I()}catch(e){r.diagLog().throwInternal(H.WARNING,q.FailedAddingTelemetryToBuffer,"Failed adding telemetry to the sender's buffer, some telemetry will be lost: "+ge(e),{exception:Ve(e)})}var d;e.processNext(n,r)},e._xhrReadyStateChange=function(e,t,n){4===e.readyState&&f(e.status,t,e.responseURL,n,R(e),_o(e)||e.response)},e.triggerSend=function(t,n,r){if(void 0===t&&(t=!0),!l)try{var i=e._buffer;if(e._senderConfig.disableTelemetry())i.clear();else{if(i.count()>0){var a=i.getItems();!function(t,n){var r,o=(r="getNotifyMgr",e.core[r]?e.core[r]():e.core._notificationManager);if(o&&o.eventsSendRequest)try{o.eventsSendRequest(t,n)}catch(t){e.diagLog().throwInternal(H.CRITICAL,q.NotificationException,"send request notification failed: "+ge(t),{exception:Ve(t)})}}(r||0,t),n?n.call(o,a,t):e._sender(a,t)}new Date}A()}catch(t){var s=ze();(!s||s>9)&&e.diagLog().throwInternal(H.CRITICAL,q.TransmissionFailed,"Telemetry transmission failed, some telemetry will be lost: "+ge(t),{exception:Ve(t)})}},e._onError=function(t,n,r){e.diagLog().throwInternal(H.WARNING,q.OnError,"Failed to send telemetry.",{message:n}),e._buffer.clearSent(t)},e._onPartialSuccess=function(t,n){for(var r=[],o=[],i=0,a=n.errors.reverse();i<a.length;i++){var s=a[i],c=t.splice(s.index,1)[0];_(s.statusCode)?o.push(c):r.push(c)}t.length>0&&e._onSuccess(t,n.itemsAccepted),r.length>0&&e._onError(r,R(null,["partial success",n.itemsAccepted,"of",n.itemsReceived].join(" "))),o.length>0&&(S(o),e.diagLog().throwInternal(H.WARNING,q.TransmissionFailed,"Partial success. Delivered: "+t.length+", Failed: "+r.length+". Will retry to send "+o.length+" our of "+n.itemsReceived+" items"))},e._onSuccess=function(t,n){e._buffer.clearSent(t)},e._xdrOnLoad=function(t,r){var o=_o(t);if(!t||o+""!="200"&&""!==o){var i=b(o);i&&i.itemsReceived&&i.itemsReceived>i.itemsAccepted&&!e._senderConfig.isRetryDisabled()?e._onPartialSuccess(r,i):e._onError(r,k(t))}else n=0,e._onSuccess(r,0)}})),o}return v(t,e),t.constructEnvelope=function(e,t,n,r){var o;return o=t===e.iKey||z(t)?e:g(g({},e),{iKey:t}),(Ro[o.baseType]||Co)(n,o,r)},t}(ft),ko=function(){},Oo=function(){function e(t,n){var r,o,i=ot(n),a=Pt(n);D(e,this,(function(n){t||(t={}),J(t.sessionExpirationMs)||(t.sessionExpirationMs=function(){return e.acquisitionSpan}),J(t.sessionRenewalMs)||(t.sessionRenewalMs=function(){return e.renewalSpan}),n.config=t;var s=n.config.sessionCookiePostfix&&n.config.sessionCookiePostfix()?n.config.sessionCookiePostfix():n.config.namePrefix&&n.config.namePrefix()?n.config.namePrefix():"";function c(e,t){var n=!1,r=", session will be reset",o=t.split("|");if(o.length>=2)try{var a=+o[1]||0,s=+o[2]||0;isNaN(a)||a<=0?i.throwInternal(H.WARNING,q.SessionRenewalDateIsZero,"AI session acquisition date is 0"+r):isNaN(s)||s<=0?i.throwInternal(H.WARNING,q.SessionRenewalDateIsZero,"AI session renewal date is 0"+r):o[0]&&(e.id=o[0],e.acquisitionDate=a,e.renewalDate=s,n=!0)}catch(e){i.throwInternal(H.CRITICAL,q.ErrorParsingAISessionCookie,"Error parsing ai_session value ["+(t||"")+"]"+r+" - "+ge(e),{exception:Ve(e)})}return n}function u(e,t){var i=e.acquisitionDate;e.renewalDate=t;var s,c=n.config,u=c.sessionRenewalMs(),l=i+c.sessionExpirationMs()-t,d=[e.id,i,t];s=l<u?l/1e3:u/1e3;var p=c.cookieDomain?c.cookieDomain():null;a.set(r(),d.join("|"),c.sessionExpirationMs()>0?s:null,p),o=t}r=function(){return"ai_session"+s},n.automaticSession=new ko,n.update=function(){var t=fe(),s=!1,l=n.automaticSession;l.id||(s=!function(e,t){var n=!1,o=a.get(r());if(o&&J(o.split))n=c(e,o);else{var s=pr(i,r());s&&(n=c(e,s))}return n||!!e.id}(l));var d=n.config.sessionExpirationMs();if(!s&&d>0){var p=n.config.sessionRenewalMs(),h=t-l.acquisitionDate,f=t-l.renewalDate;s=(s=(s=h<0||f<0)||h>d)||f>p}s?function(e){var t=n.config||{},r=(t.getNewId?t.getNewId():null)||sn;n.automaticSession.id=r(t.idLength?t.idLength():22),n.automaticSession.acquisitionDate=e,u(n.automaticSession,e),dr()||i.throwInternal(H.WARNING,q.BrowserDoesNotSupportLocalStorage,"Browser does not support local storage. Session durations will be inaccurate.")}(t):(!o||t-o>e.cookieUpdateInterval)&&u(l,t)},n.backup=function(){var e,t,o,a=n.automaticSession;e=a.id,t=a.acquisitionDate,o=a.renewalDate,hr(i,r(),[e,t,o].join("|"))}}))}return e.acquisitionSpan=864e5,e.renewalSpan=18e5,e.cookieUpdateInterval=6e4,e}(),No=function(){},Mo=function(){this.id="browser",this.deviceClass="Browser"},xo=function(e){this.sdkVersion=(e.sdkExtension&&e.sdkExtension()?e.sdkExtension()+"_":"")+"javascript:2.7.2"};function Fo(e){return!("string"!=typeof e||!e||e.match(/,|;|=| |\|/))}var Lo=function(){function e(t,n){this.isNewUser=!1,this.isUserCookieSet=!1;var r,o=ot(n),i=Pt(n);D(e,this,(function(n){n.config=t;var a=n.config.userCookiePostfix&&n.config.userCookiePostfix()?n.config.userCookiePostfix():"";r=function(){return e.userCookieName+a};var s=i.get(r());if(s){n.isNewUser=!1;var c=s.split(e.cookieSeparator);c.length>0&&(n.id=c[0],n.isUserCookieSet=!!n.id)}function u(){var e=t||{};return((e.getNewId?e.getNewId():null)||sn)(e.idLength?t.idLength():22)}function l(e){var t=oe(new Date);return n.accountAcquisitionDate=t,n.isNewUser=!0,[e,t]}function d(e){n.isUserCookieSet=i.set(r(),e,31536e3)}if(!n.id){n.id=u(),d(l(n.id).join(e.cookieSeparator));var p=t.namePrefix&&t.namePrefix()?t.namePrefix()+"ai_session":"ai_session";fr(o,p)}n.accountId=t.accountId?t.accountId():void 0;var h=i.get(e.authUserCookieName);if(h){var f=(h=decodeURI(h)).split(e.cookieSeparator);f[0]&&(n.authenticatedId=f[0]),f.length>1&&f[1]&&(n.accountId=f[1])}n.setAuthenticatedUserContext=function(t,r,a){if(void 0===a&&(a=!1),!Fo(t)||r&&!Fo(r))o.throwInternal(H.WARNING,q.SetAuthContextFailedAccountName,"Setting auth user context failed. User auth/account id should be of type string, and not contain commas, semi-colons, equal signs, spaces, or vertical-bars.",!0);else{n.authenticatedId=t;var s=n.authenticatedId;r&&(n.accountId=r,s=[n.authenticatedId,n.accountId].join(e.cookieSeparator)),a&&i.set(e.authUserCookieName,encodeURI(s))}},n.clearAuthenticatedUserContext=function(){n.authenticatedId=null,n.accountId=null,i.del(e.authUserCookieName)},n.update=function(t){n.id===t&&n.isUserCookieSet||d(l(t||u()).join(e.cookieSeparator))}}))}return e.cookieSeparator="|",e.userCookieName="ai_user",e.authUserCookieName="ai_authUser",e}(),Uo=function(){},Do=function(e,t,n,r){var o=this;o.traceID=e||cn(),o.parentID=t,o.name=n;var i=He();!n&&i&&i.pathname&&(o.name=i.pathname),o.name=yn(r,o.name)},Ho="ext",qo="tags";function Bo(e,t){e&&e[t]&&0===pe(e[t]).length&&delete e[t]}var Go=function e(t,n){var r=this,o=t.logger;this.appId=function(){return null},this.getSessionId=function(){return null},D(e,this,(function(e){e.application=new No,e.internal=new xo(n),Me()&&(e.sessionManager=new Oo(n,t),e.device=new Mo,e.location=new Uo,e.user=new Lo(n,t),e.telemetryTrace=new Do(void 0,void 0,void 0,o),e.session=new ko),e.getSessionId=function(){var t=e.session,n=null;if(t&&te(t.id))n=t.id;else{var r=(e.sessionManager||{}).automaticSession;n=r&&te(r.id)?r.id:null}return n},e.applySessionContext=function(t,n){me(ve(t.ext,io.AppExt),"sesId",e.getSessionId(),te)},e.applyOperatingSystemContxt=function(t,n){me(t.ext,io.OSExt,e.os)},e.applyApplicationContext=function(t,n){var r=e.application;if(r){var o=ve(t,qo);me(o,ao.applicationVersion,r.ver,te),me(o,ao.applicationBuild,r.build,te)}},e.applyDeviceContext=function(t,n){var r=e.device;if(r){var o=ve(ve(t,Ho),io.DeviceExt);me(o,"localId",r.id,te),me(o,"ip",r.ip,te),me(o,"model",r.model,te),me(o,"deviceClass",r.deviceClass,te)}},e.applyInternalContext=function(t,n){var r=e.internal;if(r){var o=ve(t,qo);me(o,ao.internalAgentVersion,r.agentVersion,te),me(o,ao.internalSdkVersion,r.sdkVersion,te),t.baseType!==rt.dataType&&t.baseType!==zn.dataType||(me(o,ao.internalSnippet,r.snippetVer,te),me(o,ao.internalSdkSrc,r.sdkSrc,te))}},e.applyLocationContext=function(e,t){var n=r.location;n&&me(ve(e,qo,[]),ao.locationIp,n.ip,te)},e.applyOperationContext=function(t,n){var r=e.telemetryTrace;if(r){var o=ve(ve(t,Ho),io.TraceExt,{traceID:void 0,parentID:void 0});me(o,"traceID",r.traceID,te),me(o,"name",r.name,te),me(o,"parentID",r.parentID,te)}},e.applyWebContext=function(e,t){var n=r.web;n&&me(ve(e,Ho),io.WebExt,n)},e.applyUserContext=function(t,n){var r=e.user;if(r){me(ve(t,qo,[]),ao.userAccountId,r.accountId,te);var o=ve(ve(t,Ho),io.UserExt);me(o,"id",r.id,te),me(o,"authId",r.authenticatedId,te)}},e.cleanUp=function(e,t){var n=e.ext;n&&(Bo(n,io.DeviceExt),Bo(n,io.UserExt),Bo(n,io.WebExt),Bo(n,io.OSExt),Bo(n,io.AppExt),Bo(n,io.TraceExt))}}))};const jo=function(e){function t(){var n,r,o=e.call(this)||this;return o.priority=110,o.identifier=hn,D(t,o,(function(e,o){e.initialize=function(i,a,s,c){o.initialize(i,a,s,c);var u=e._getTelCtx(),l=e.identifier,d=t.getDefaultConfig();r=r||{},Q(d,(function(e,t){r[e]=function(){return u.getConfig(l,e,t())}})),e.context=new Go(a,r),n=Gn(s,fn),e.context.appId=function(){return n?n._appId:null},e._extConfig=r},e.processTelemetry=function(t,n){if(z(t));else{n=e._getTelCtx(n),t.name===zn.envelopeType&&n.diagLog().resetInternalMessageCount();var r=e.context||{};r.session&&"string"!=typeof e.context.session.id&&r.sessionManager&&r.sessionManager.update();var o=r.user;if(o&&!o.isUserCookieSet&&o.update(r.user.id),function(t,n){ve(t,"tags",[]),ve(t,"ext",{});var r=e.context;r.applySessionContext(t,n),r.applyApplicationContext(t,n),r.applyDeviceContext(t,n),r.applyOperationContext(t,n),r.applyUserContext(t,n),r.applyOperatingSystemContxt(t,n),r.applyWebContext(t,n),r.applyLocationContext(t,n),r.applyInternalContext(t,n),r.cleanUp(t,n)}(t,n),o&&o.isNewUser){o.isNewUser=!1;var i=new rt(q.SendBrowserInfoOnUserInit,(De()||{}).userAgent||"");n.diagLog().logInternalMessage(H.CRITICAL,i)}e.processNext(t,n)}}})),o}return v(t,e),t.getDefaultConfig=function(){return{instrumentationKey:function(){},accountId:function(){return null},sessionRenewalMs:function(){return 18e5},samplingPercentage:function(){return 100},sessionExpirationMs:function(){return 864e5},cookieDomain:function(){return null},sdkExtension:function(){return null},isBrowserLinkTrackingEnabled:function(){return!1},appId:function(){return null},getSessionId:function(){return null},namePrefix:function(){},sessionCookiePostfix:function(){},userCookiePostfix:function(){},idLength:function(){return 22},getNewId:function(){return null}}},t}(ft);var zo=["req","rsp","hkErr","fnErr"];function Vo(e,t){if(e)for(var n=0;n<e.length&&!t(e[n],n);n++);}function Ko(e,t,n,r,o){o>=0&&o<=2&&Vo(e,(function(e,i){var a=e.cbks,s=a[zo[o]];if(s){t.ctx=function(){return r[i]=r[i]||{}};try{s.apply(t.inst,n)}catch(e){var c=t.err;try{var u=a[zo[2]];u&&(t.err=e,u.apply(t.inst,n))}catch(e){}finally{t.err=c}}}}))}var Wo=Object.getPrototypeOf;function Jo(e,t,n){var r=null;return e&&(K(e,t)?r=e:n&&(r=Jo(function(e){if(e){if(Wo)return Wo(e);var t=e.__proto__||e.prototype||e.constructor;if(t)return t}return null}(e),t,!1))),r}function Yo(e,t,n,o){if(void 0===o&&(o=!0),e&&t&&n){var i=Jo(e,t,o);if(i){var a=i[t];if(typeof a===r){var s=a._aiHooks;if(!s){var c=(l=s={i:0,n:t,f:a,h:[]},function(){var e=this,t=arguments,n=l.h,r={name:l.n,inst:e,ctx:null,set:s},o=[],i=a([r],t);function a(e,t){return Vo(t,(function(t){e.push(t)})),e}function s(e,n){(t=a([],t))[e]=n,i=a([r],t)}Ko(n,r,i,o,0);var c=l.f;try{r.rslt=c.apply(e,t)}catch(e){throw r.err=e,Ko(n,r,i,o,3),e}return Ko(n,r,i,o,1),r.rslt});c._aiHooks=s,i[t]=c}var u={id:s.i,cbks:n,rm:function(){var e=this.id;Vo(s.h,(function(t,n){if(t.id===e)return s.h.splice(n,1),1}))}};return s.i++,s.h.push(u),u}}}var l;return null}function Qo(e,t,n){var r=0,o=e[t],i=e[n];return o&&i&&(r=Fr(o,i)),r}function Xo(e,t,n,r,o){var i=0,a=Qo(n,r,o);return a&&(i=Zo(e,t,Bn(a))),i}function Zo(e,t,n){var r=0;return e&&t&&n&&((e.ajaxPerf=e.ajaxPerf||{})[t]=n,r=1),r}var $o=function(){var e=this;e.openDone=!1,e.setRequestHeaderDone=!1,e.sendDone=!1,e.abortDone=!1,e.stateChangeAttached=!1},ei=function e(t,n,r){var o=this,i=r;o.perfMark=null,o.completed=!1,o.requestHeadersSize=null,o.requestHeaders=null,o.responseReceivingDuration=null,o.callbackDuration=null,o.ajaxTotalDuration=null,o.aborted=0,o.pageUrl=null,o.requestUrl=null,o.requestSize=0,o.method=null,o.status=null,o.requestSentTime=null,o.responseStartedTime=null,o.responseFinishedTime=null,o.callbackFinishedTime=null,o.endTime=null,o.xhrMonitoringState=new $o,o.clientFailure=0,o.traceID=t,o.spanID=n,D(e,o,(function(e){e.getAbsoluteUrl=function(){return e.requestUrl?Ir(e.requestUrl):null},e.getPathName=function(){return e.requestUrl?Cn(i,Ar(e.method,e.requestUrl)):null},e.CreateTrackItem=function(t,n,r){var o;if(e.ajaxTotalDuration=Math.round(1e3*Fr(e.requestSentTime,e.responseFinishedTime))/1e3,e.ajaxTotalDuration<0)return null;var i=((o={id:"|"+e.traceID+"."+e.spanID,target:e.getAbsoluteUrl(),name:e.getPathName(),type:t,startTime:null,duration:e.ajaxTotalDuration,success:+e.status>=200&&+e.status<400,responseCode:+e.status,method:e.method}).properties={HttpMethod:e.method},o);if(e.requestSentTime&&(i.startTime=new Date,i.startTime.setTime(e.requestSentTime)),function(e,t){var n=e.perfTiming,r=t.properties||{},o=0,i="redirect",a="startTime",s="connectEnd",c="requestStart",u="responseEnd",l=i+"Start",d=i="End";if(n){o|=Xo(r,i,n,l,d),o|=Xo(r,"domainLookup",n,"domainLookupStart","domainLookupEnd"),o|=Xo(r,"connect",n,"connectStart",s),o|=Xo(r,"request",n,c,"requestEnd"),o|=Xo(r,"response",n,"responseStart",u),o|=Xo(r,"networkConnect",n,a,s),o|=Xo(r,"sentRequest",n,c,u);var p=n.duration;p||(p=Qo(n,a,u)||0),o|=Zo(r,"duration",p),o|=Zo(r,"perfTotal",p);var h=n.serverTiming;if(h){var f={};ie(h,(function(e,t){var n=function(e){var t=e,n=/([^\w\d_$])/g;return n.test(e)&&(t=e.replace(n,"_")),t}(e.name||""+t),r=f[n]||{};Q(e,(function(e,t){("name"!==e&&te(t)||ne(t))&&(r[e]&&(t=r[e]+";"+t),!t&&te(t)||(r[e]=t))})),f[n]=r})),o|=Zo(r,"serverTiming",f)}o|=Zo(r,"transferSize",n.transferSize),o|=Zo(r,"encodedBodySize",n.encodedBodySize),o|=Zo(r,"decodedBodySize",n.decodedBodySize)}else e.perfMark&&(o|=Zo(r,"missing",e.perfAttempts));o&&(t.properties=r)}(e,i),n&&pe(e.requestHeaders).length>0&&(i.properties=i.properties||{},i.properties.requestHeaders=e.requestHeaders),r){var a=r();if(a){var s=a.correlationContext;if(s&&(i.correlationContext=s),a.headerMap&&pe(a.headerMap).length>0&&(i.properties=i.properties||{},i.properties.responseHeaders=a.headerMap),e.errorStatusText&&e.status>=400){var c=a.type;i.properties=i.properties||{},""!==c&&"text"!==c||(i.properties.responseText=a.responseText?a.statusText+" - "+a.responseText:a.statusText),"json"===c&&(i.properties.responseText=a.response?a.statusText+" - "+JSON.stringify(a.response):a.statusText)}}}return i}}))},ti=function(){function e(t,n){var r=this;r.traceFlag=e.DEFAULT_TRACE_FLAG,r.version=e.DEFAULT_VERSION,t&&e.isValidTraceId(t)?r.traceId=t:r.traceId=cn(),n&&e.isValidSpanId(n)?r.spanId=n:r.spanId=cn().substr(0,16)}return e.isValidTraceId=function(e){return e.match(/^[0-9a-f]{32}$/)&&"00000000000000000000000000000000"!==e},e.isValidSpanId=function(e){return e.match(/^[0-9a-f]{16}$/)&&"0000000000000000"!==e},e.prototype.toString=function(){var e=this;return"".concat(e.version,"-").concat(e.traceId,"-").concat(e.spanId,"-").concat(e.traceFlag)},e.DEFAULT_TRACE_FLAG="01",e.DEFAULT_VERSION="00",e}(),ni="ai.ajxmn.",ri="fetch",oi=0;function ii(e){var t="";try{z(e)||z(e.ajaxData)||z(e.ajaxData.requestUrl)||(t+="(url: '"+e.ajaxData.requestUrl+"')")}catch(e){}return t}function ai(e,t,n,r,o){e.diagLog().throwInternal(H.CRITICAL,t,n,r,o)}function si(e,t,n,r,o){e.diagLog().throwInternal(H.WARNING,t,n,r,o)}function ci(e,t,n){return function(r){ai(e,t,n,{ajaxDiagnosticsMessage:ii(r.inst),exception:Ve(r.err)})}}function ui(e,t){return e&&t?e.indexOf(t):-1}var li=function(e){function t(){var n=e.call(this)||this;n.identifier=t.identifier,n.priority=120;var r,o,i,a,s,c,u=He(),l=!1,d=!1,h=u&&u.host&&u.host.toLowerCase(),f=t.getEmptyConfig(),m=!1,v=!1,y=0,C=!1,E=0,T=!1,w=[],b={};return D(t,n,(function(e,n){function u(e){var t=!0;return(e||f.ignoreHeaders)&&ie(f.ignoreHeaders,(function(n){if(n.toLowerCase()===e.toLowerCase())return t=!1,-1})),t}function S(e,t,n){w.push(function(e,t,n){return e?Yo(e.prototype,t,n,!1):null}(e,t,n))}function I(e,t,n){var r=!1,o=((te(t)?t:(t||{}).url||"")||"").toLowerCase();if(ie(s,(function(e){var t=e;te(e)&&(t=new RegExp(e)),r||(r=t.test(o))})),r)return r;var i=ui(o,"?"),a=ui(o,"#");return(-1===i||-1!==a&&a<i)&&(i=a),-1!==i&&(o=o.substring(0,i)),z(e)?z(t)||(r="object"==typeof t&&!0===t[Pn]||!!n&&!0===n[Pn]):r=!0===e[Pn]||!0===o[Pn],!r&&o&&kr(o)&&(r=!0),r?b[o]||(b[o]=1):b[o]&&(r=!0),r}function A(e,t){var n=!0,r=d;return z(e)||(n=!0===t||!z(e.ajaxData)),r&&n}function _(e){try{var t=e.responseType;if(""===t||"text"===t)return e.responseText}catch(e){}return null}function R(t){try{var n=t.getAllResponseHeaders();if(null!==n&&-1!==ui(n.toLowerCase(),Er.requestContextHeaderLowerCase)){var r=t.getResponseHeader(Er.requestContextHeader);return Mr.getCorrelationContext(r)}}catch(n){si(e,q.FailedMonitorAjaxGetCorrelationHeader,"Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",{ajaxDiagnosticsMessage:ii(t),exception:Ve(n)})}}function P(e,t){if(t.requestUrl&&a&&C){var n=qe();if(n&&J(n.mark)){oi++;var r=a+e+"#"+oi;n.mark(r);var o=n.getEntriesByName(r);o&&1===o.length&&(t.perfMark=o[0])}}}function k(e,t,n,r){var o=t.perfMark,i=qe(),a=f.maxAjaxPerfLookupAttempts,s=f.ajaxPerfLookupDelay,c=t.requestUrl,u=0;!function l(){try{if(i&&o){u++;for(var d=null,p=i.getEntries(),h=p.length-1;h>=0;h--){var f=p[h];if(f){if("resource"===f.entryType)f.initiatorType!==e||-1===ui(f.name,c)&&-1===ui(c,f.name)||(d=f);else if("mark"===f.entryType&&f.name===o.name){t.perfTiming=d;break}if(f.startTime<o.startTime-1e3)break}}}!o||t.perfTiming||u>=a||!1===t.async?(o&&J(i.clearMarks)&&i.clearMarks(o.name),t.perfAttempts=u,n()):setTimeout(l,s)}catch(e){r(e)}}()}function O(t){var n="";try{z(t)||(n+="(url: '".concat("string"==typeof t?t:t.url,"')"))}catch(t){ai(e,q.FailedMonitorAjaxOpen,"Failed to grab failed fetch diagnostics message",{exception:Ve(t)})}return n}function N(t,n,r,o,i,a,s){function u(t,n,o){var i=o||{};i.fetchDiagnosticsMessage=O(r),n&&(i.exception=Ve(n)),si(e,t,"Failed to calculate the duration of the fetch call, monitoring data for this fetch call won't be sent.",i)}i&&(i.responseFinishedTime=xr(),i.status=n,k("fetch",i,(function(){var t,s=i.CreateTrackItem("Fetch",m,a);try{c&&(t=c({status:n,request:r,response:o}))}catch(t){si(e,q.FailedAddingCustomDefinedRequestContext,"Failed to add custom defined request context as configured call back may missing a null check.")}s?(void 0!==t&&(s.properties=g(g({},s.properties),t)),e.trackDependencyDataInternal(s)):u(q.FailedMonitorAjaxDur,null,{requestSentTime:i.requestSentTime,responseFinishedTime:i.responseFinishedTime})}),(function(e){u(q.FailedMonitorAjaxGetCorrelationHeader,e,null)})))}function M(t){if(t&&t.headers)try{var n=t.headers.get(Er.requestContextHeader);return Mr.getCorrelationContext(n)}catch(n){si(e,q.FailedMonitorAjaxGetCorrelationHeader,"Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",{fetchDiagnosticsMessage:O(t),exception:Ve(n)})}}e.initialize=function(h,y,b,O){if(!e.isInitialized()){n.initialize(h,y,b,O);var x=e._getTelCtx();Q(t.getDefaultConfig(),(function(e,n){f[e]=x.getConfig(t.identifier,e,n)}));var F=f.distributedTracingMode;if(m=f.enableRequestHeaderTracking,v=f.enableAjaxErrorStatusText,C=f.enableAjaxPerfTracking,E=f.maxAjaxCallsPerView,T=f.enableResponseHeaderTracking,s=f.excludeRequestFromAutoTrackingPatterns,c=f.addRequestContext,i=F===tr.AI||F===tr.AI_AND_W3C,o=F===tr.AI_AND_W3C||F===tr.W3C,C){var L=h.instrumentationKey||"unkwn";a=L.length>5?ni+L.substring(L.length-5)+".":ni+L+"."}if(!1===f.disableAjaxTracking&&function(e){var t=!1;if(Ye()){var n=XMLHttpRequest.prototype;t=!(z(n)||z(n.open)||z(n.send)||z(n.abort))}var r=ze();if(r&&r<9&&(t=!1),t)try{(new XMLHttpRequest).ajaxData={};var o=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=o}catch(n){t=!1,ai(e,q.FailedMonitorAjaxOpen,"Failed to enable XMLHttpRequest monitoring, extension is not supported",{exception:Ve(n)})}return t}(e)&&!d&&(S(XMLHttpRequest,"open",{req:function(t,n,o,i){var a=t.inst,s=a.ajaxData;!I(a,o)&&A(a,!0)&&(s&&s.xhrMonitoringState.openDone||function(t,n,o,i){var a=r&&r.telemetryTrace&&r.telemetryTrace.traceID||cn(),s=cn().substr(0,16),c=new ei(a,s,e.diagLog());c.method=n,c.requestUrl=o,c.xhrMonitoringState.openDone=!0,c.requestHeaders={},c.async=i,c.errorStatusText=v,t.ajaxData=c}(a,n,o,i),function(t){t.ajaxData.xhrMonitoringState.stateChangeAttached=Y(t,"readystatechange",(function(){try{t&&4===t.readyState&&A(t)&&function(t){var n=t.ajaxData;function r(n,r){var o=r||{};o.ajaxDiagnosticsMessage=ii(t),n&&(o.exception=Ve(n)),si(e,q.FailedMonitorAjaxDur,"Failed to calculate the duration of the ajax call, monitoring data for this ajax call won't be sent.",o)}n.responseFinishedTime=xr(),n.status=t.status,k("xmlhttprequest",n,(function(){try{var o=n.CreateTrackItem("Ajax",m,(function(){var e={statusText:t.statusText,headerMap:null,correlationContext:R(t),type:t.responseType,responseText:_(t),response:t.response};if(T){var n=t.getAllResponseHeaders();if(n){var r=ue(n).split(/[\r\n]+/),o={};ie(r,(function(e){var t=e.split(": "),n=t.shift(),r=t.join(": ");u(n)&&(o[n]=r)})),e.headerMap=o}}return e})),i=void 0;try{c&&(i=c({status:t.status,xhr:t}))}catch(t){si(e,q.FailedAddingCustomDefinedRequestContext,"Failed to add custom defined request context as configured call back may missing a null check.")}o?(void 0!==i&&(o.properties=g(g({},o.properties),i)),e.trackDependencyDataInternal(o)):r(null,{requestSentTime:n.requestSentTime,responseFinishedTime:n.responseFinishedTime})}finally{try{t.ajaxData=null}catch(e){}}}),(function(e){r(e,null)}))}(t)}catch(r){var n=Ve(r);n&&-1!==ui(n.toLowerCase(),"c00c023f")||ai(e,q.FailedMonitorAjaxRSC,"Failed to monitor XMLHttpRequest 'readystatechange' event handler, monitoring data for this ajax call may be incorrect.",{ajaxDiagnosticsMessage:ii(t),exception:n})}}))}(a))},hkErr:ci(e,q.FailedMonitorAjaxOpen,"Failed to monitor XMLHttpRequest.open, monitoring data for this ajax call may be incorrect.")}),S(XMLHttpRequest,"send",{req:function(t,n){var r=t.inst,o=r.ajaxData;A(r)&&!o.xhrMonitoringState.sendDone&&(P("xhr",o),o.requestSentTime=xr(),e.includeCorrelationHeaders(o,void 0,void 0,r),o.xhrMonitoringState.sendDone=!0)},hkErr:ci(e,q.FailedMonitorAjaxSend,"Failed to monitor XMLHttpRequest, monitoring data for this ajax call may be incorrect.")}),S(XMLHttpRequest,"abort",{req:function(e){var t=e.inst,n=t.ajaxData;A(t)&&!n.xhrMonitoringState.abortDone&&(n.aborted=1,n.xhrMonitoringState.abortDone=!0)},hkErr:ci(e,q.FailedMonitorAjaxAbort,"Failed to monitor XMLHttpRequest.abort, monitoring data for this ajax call may be incorrect.")}),m&&S(XMLHttpRequest,"setRequestHeader",{req:function(e,t,n){var r=e.inst;A(r)&&u(t)&&(r.ajaxData.requestHeaders[t]=n)},hkErr:ci(e,q.FailedMonitorAjaxSetRequestHeader,"Failed to monitor XMLHttpRequest.setRequestHeader, monitoring data for this ajax call may be incorrect.")}),d=!0),function(){var t,n=!(t=p())||z(t.Request)||z(t.Request.prototype)||z(t.fetch)?null:t.fetch;if(n){var o=p(),i=n.polyfill;!1===f.disableFetchTracking?(w.push(Yo(o,ri,{req:function(t,n,o){var a;if(l&&!I(null,n,o)&&(!i||!d)){var s=t.ctx();a=function(t,n){var o=r&&r.telemetryTrace&&r.telemetryTrace.traceID||cn(),i=cn().substr(0,16),a=new ei(o,i,e.diagLog());a.requestSentTime=xr(),a.errorStatusText=v,t instanceof Request?a.requestUrl=t?t.url:"":a.requestUrl=t;var s="GET";n&&n.method?s=n.method:t&&t instanceof Request&&(s=t.method),a.method=s;var c={};return m&&new Headers((n?n.headers:0)||t instanceof Request&&t.headers||{}).forEach((function(e,t){u(t)&&(c[t]=e)})),a.requestHeaders=c,P("fetch",a),a}(n,o);var c=e.includeCorrelationHeaders(a,n,o);c!==o&&t.set(1,c),s.data=a}},rsp:function(e,t){var n=e.ctx().data;n&&(e.rslt=e.rslt.then((function(e){return N(0,(e||{}).status,t,e,n,(function(){var t={statusText:e.statusText,headerMap:null,correlationContext:M(e)};if(T){var n={};e.headers.forEach((function(e,t){u(t)&&(n[t]=e)})),t.headerMap=n}return t})),e})).catch((function(e){throw N(0,0,t,null,n,null,e.message),e})))},hkErr:ci(e,q.FailedMonitorAjaxOpen,"Failed to monitor Window.fetch, monitoring data for this fetch call may be incorrect.")})),l=!0):i&&w.push(Yo(o,ri,{req:function(e,t,n){I(null,t,n)}})),i&&(o.fetch.polyfill=i)}}(),b.length>0&&b){for(var U=void 0,D=0;!U&&D<b.length;)b[D]&&b[D].identifier===hn&&(U=b[D]),D++;U&&(r=U.context)}}},e.teardown=function(){ie(w,(function(e){e.rm()})),w=[],l=!1,d=!1,e.setInitialized(!1)},e.trackDependencyData=function(t,n){e.trackDependencyDataInternal(t,n)},e.includeCorrelationHeaders=function(t,n,a,s){var c=e._currentWindowHost||h;if(n){if(Mr.canIncludeCorrelationHeader(f,t.getAbsoluteUrl(),c)){if(a||(a={}),a.headers=new Headers(a.headers||n instanceof Request&&n.headers||{}),i){var u="|"+t.traceID+"."+t.spanID;a.headers.set(Er.requestIdHeader,u),m&&(t.requestHeaders[Er.requestIdHeader]=u)}if((d=f.appId||r&&r.appId())&&(a.headers.set(Er.requestContextHeader,Er.requestContextAppIdFormat+d),m&&(t.requestHeaders[Er.requestContextHeader]=Er.requestContextAppIdFormat+d)),o){var l=new ti(t.traceID,t.spanID);a.headers.set(Er.traceParentHeader,l.toString()),m&&(t.requestHeaders[Er.traceParentHeader]=l.toString())}}return a}if(s){var d;if(Mr.canIncludeCorrelationHeader(f,t.getAbsoluteUrl(),c))i&&(u="|"+t.traceID+"."+t.spanID,s.setRequestHeader(Er.requestIdHeader,u),m&&(t.requestHeaders[Er.requestIdHeader]=u)),(d=f.appId||r&&r.appId())&&(s.setRequestHeader(Er.requestContextHeader,Er.requestContextAppIdFormat+d),m&&(t.requestHeaders[Er.requestContextHeader]=Er.requestContextAppIdFormat+d)),o&&(l=new ti(t.traceID,t.spanID),s.setRequestHeader(Er.traceParentHeader,l.toString()),m&&(t.requestHeaders[Er.traceParentHeader]=l.toString()));return s}},e.trackDependencyDataInternal=function(t,n,r){if(-1===E||y<E){f.distributedTracingMode!==tr.W3C&&f.distributedTracingMode!==tr.AI_AND_W3C||"string"!=typeof t.id||"."===t.id[t.id.length-1]||(t.id+="."),z(t.startTime)&&(t.startTime=new Date);var o=Mn.create(t,Ur.dataType,Ur.envelopeType,e.diagLog(),n,r);e.core.track(o)}else y===E&&ai(e,q.MaxAjaxPerPVExceeded,"Maximum ajax per page view limit reached, ajax monitoring is paused until the next trackPageView(). In order to increase the limit set the maxAjaxCallsPerView configuration parameter.",!0);++y}})),n}return v(t,e),t.getDefaultConfig=function(){return{maxAjaxCallsPerView:500,disableAjaxTracking:!1,disableFetchTracking:!0,excludeRequestFromAutoTrackingPatterns:void 0,disableCorrelationHeaders:!1,distributedTracingMode:tr.AI_AND_W3C,correlationHeaderExcludedDomains:["*.blob.core.windows.net","*.blob.core.chinacloudapi.cn","*.blob.core.cloudapi.de","*.blob.core.usgovcloudapi.net"],correlationHeaderDomains:void 0,correlationHeaderExcludePatterns:void 0,appId:void 0,enableCorsCorrelation:!1,enableRequestHeaderTracking:!1,enableResponseHeaderTracking:!1,enableAjaxErrorStatusText:!1,enableAjaxPerfTracking:!1,maxAjaxPerfLookupAttempts:3,ajaxPerfLookupDelay:25,ignoreHeaders:["Authorization","X-API-Key","WWW-Authenticate"],addRequestContext:void 0}},t.getEmptyConfig=function(){var e=this.getDefaultConfig();return Q(e,(function(t){e[t]=void 0})),e},t.prototype.processTelemetry=function(e,t){this.processNext(e,t)},t.identifier="AjaxDependencyPlugin",t}(ft);function di(e){if(!e)return{};var t=ce(e.split(";"),(function(e,t){var n=t.split("=");if(2===n.length){var r=n[0].toLowerCase(),o=n[1];e[r]=o}return e}),{});if(pe(t).length>0){if(t.endpointsuffix){var n=t.location?t.location+".":"";t.ingestionendpoint=t.ingestionendpoint||"https://"+n+"dc."+t.endpointsuffix}t.ingestionendpoint=t.ingestionendpoint||On}return t}var pi,hi={parse:di},fi=function(){function e(){}return e.getConfig=function(e,t,n,r){var o;return void 0===r&&(r=!1),o=n&&e.extensionConfig&&e.extensionConfig[n]&&!z(e.extensionConfig[n][t])?e.extensionConfig[n][t]:e[t],z(o)?r:o},e}(),gi=["snippet","dependencies","properties","_snippetVersion","appInsightsNew","getSKUDefaults"],mi={__proto__:null,PropertiesPluginIdentifier:hn,BreezeChannelIdentifier:fn,AnalyticsPluginIdentifier:gn,Util:Or,CorrelationIdHelper:Mr,UrlHelper:Nr,DateTimeUtils:Lr,ConnectionStringParser:hi,FieldType:{Default:0,Required:1,Array:2,Hidden:4},RequestHeaders:Er,DisabledPropertyName:Pn,ProcessLegacy:"ProcessLegacy",SampleRate:"sampleRate",HttpMethod:kn,DEFAULT_BREEZE_ENDPOINT:On,AIData:uo,AIBase:co,Envelope:so,Event:Fn,Exception:nr,Metric:Dn,PageView:zn,PageViewData:Hn,RemoteDependencyData:Ur,Trace:Ln,PageViewPerformance:Vn,Data:lo,SeverityLevel:$n,ConfigurationManager:fi,ContextTagKeys:oo,DataSanitizer:Rn,TelemetryItemCreator:Mn,CtxTagKeys:ao,Extensions:io,DistributedTracingModes:tr},vi=function(){function e(e){var t=this;t._snippetVersion=""+(e.sv||e.version||""),e.queue=e.queue||[],e.version=e.version||2;var n=e.config||{};if(n.connectionString){var r=di(n.connectionString),o=r.ingestionendpoint;n.endpointUrl=o?"".concat(o,"/v2/track"):n.endpointUrl,n.instrumentationKey=r.instrumentationkey||n.instrumentationKey}t.appInsights=new jr,t.properties=new jo,t.dependencies=new li,t.core=new Bt,t._sender=new Po,t.snippet=e,t.config=n,t.getSKUDefaults()}return e.prototype.getCookieMgr=function(){return this.appInsights.getCookieMgr()},e.prototype.trackEvent=function(e,t){this.appInsights.trackEvent(e,t)},e.prototype.trackPageView=function(e){var t=e||{};this.appInsights.trackPageView(t)},e.prototype.trackPageViewPerformance=function(e){var t=e||{};this.appInsights.trackPageViewPerformance(t)},e.prototype.trackException=function(e,t){e&&!e.exception&&e.error&&(e.exception=e.error),this.appInsights.trackException(e,t)},e.prototype._onerror=function(e){this.appInsights._onerror(e)},e.prototype.trackTrace=function(e,t){this.appInsights.trackTrace(e,t)},e.prototype.trackMetric=function(e,t){this.appInsights.trackMetric(e,t)},e.prototype.startTrackPage=function(e){this.appInsights.startTrackPage(e)},e.prototype.stopTrackPage=function(e,t,n,r){this.appInsights.stopTrackPage(e,t,n,r)},e.prototype.startTrackEvent=function(e){this.appInsights.startTrackEvent(e)},e.prototype.stopTrackEvent=function(e,t,n){this.appInsights.stopTrackEvent(e,t,n)},e.prototype.addTelemetryInitializer=function(e){return this.appInsights.addTelemetryInitializer(e)},e.prototype.setAuthenticatedUserContext=function(e,t,n){void 0===n&&(n=!1),this.properties.context.user.setAuthenticatedUserContext(e,t,n)},e.prototype.clearAuthenticatedUserContext=function(){this.properties.context.user.clearAuthenticatedUserContext()},e.prototype.trackDependencyData=function(e){this.dependencies.trackDependencyData(e)},e.prototype.flush=function(e){var t=this;void 0===e&&(e=!0),ut(this.core,(function(){return"AISKU.flush"}),(function(){ie(t.core.getTransmissionControls(),(function(t){ie(t,(function(t){t.flush(e)}))}))}),null,e)},e.prototype.onunloadFlush=function(e){void 0===e&&(e=!0),ie(this.core.getTransmissionControls(),(function(t){ie(t,(function(t){t.onunloadFlush?t.onunloadFlush():t.flush(e)}))}))},e.prototype.loadAppInsights=function(e,t,n){var r=this;void 0===e&&(e=!1);var o=this;return e&&o.config.extensions&&o.config.extensions.length>0&&Ee("Extensions not allowed in legacy mode"),ut(o.core,(function(){return"AISKU.loadAppInsights"}),(function(){var i=[];i.push(o._sender),i.push(o.properties),i.push(o.dependencies),i.push(o.appInsights),o.core.initialize(o.config,i,t,n),o.context=o.properties.context,pi&&o.context&&(o.context.internal.sdkSrc=pi),function(t){if(t){var n="";z(o._snippetVersion)||(n+=o._snippetVersion),e&&(n+=".lg"),o.context&&o.context.internal&&(o.context.internal.snippetVer=n||"-"),Q(o,(function(e,n){te(e)&&!J(n)&&e&&"_"!==e[0]&&-1===gi.indexOf(e)&&(t[e]=n)}))}}(o.snippet),o.emptyQueue(),o.pollInternalLogs(),o.addHousekeepingBeforeUnload(r)})),o},e.prototype.updateSnippetDefinitions=function(e){Te(e,this,(function(e){return e&&-1===gi.indexOf(e)}))},e.prototype.emptyQueue=function(){var e=this;try{if($(e.snippet.queue)){for(var t=e.snippet.queue.length,n=0;n<t;n++)(0,e.snippet.queue[n])();e.snippet.queue=void 0,delete e.snippet.queue}}catch(e){e&&J(e.toString)&&e.toString()}},e.prototype.pollInternalLogs=function(){this.core.pollInternalLogs()},e.prototype.stopPollingInternalLogs=function(){this.core.stopPollingInternalLogs()},e.prototype.addHousekeepingBeforeUnload=function(e){if(Me()||Fe()){var t=function(){e.onunloadFlush(!1),ie(e.appInsights.core._extensions,(function(e){if(e.identifier===hn)return e&&e.context&&e.context._sessionManager&&e.context._sessionManager.backup(),-1}))},n=!1,r=e.appInsights.config.disablePageUnloadEvents;e.appInsights.config.disableFlushOnBeforeUnload||(n=on(t,r),(n=an(t,r)||n)||(o=De())&&o.product&&"ReactNative"===o.product||e.appInsights.core.logger.throwInternal(H.CRITICAL,q.FailedToAddHandlerForOnBeforeUnload,"Could not add handler for beforeunload and pagehide")),n||e.appInsights.config.disableFlushOnUnload||an(t,r)}var o},e.prototype.getSender=function(){return this._sender},e.prototype.getSKUDefaults=function(){var e=this;e.config.diagnosticLogInterval=e.config.diagnosticLogInterval&&e.config.diagnosticLogInterval>0?e.config.diagnosticLogInterval:1e4},e}();!function(){var e=null,t=["://js.monitor.azure.com/","://az416426.vo.msecnd.net/"];try{var n=(document||{}).currentScript;n&&(e=n.src)}catch(e){}if(e)try{var r=e.toLowerCase();if(r)for(var o="",i=0;i<t.length;i++)if(-1!==r.indexOf(t[i])){o="cdn"+(i+1),-1===r.indexOf("/scripts/")&&(-1!==r.indexOf("/next/")?o+="-next":-1!==r.indexOf("/beta/")&&(o+="-beta")),pi=o+"";break}}catch(e){}}();var yi=["snippet","getDefaultConfig","_hasLegacyInitializers","_queue","_processLegacyInitializers"],Ci=function(){function e(t,n){this._hasLegacyInitializers=!1,this._queue=[],this.config=e.getDefaultConfig(t.config),this.appInsightsNew=n,this.context={addTelemetryInitializer:this.addTelemetryInitializers.bind(this)}}return e.getDefaultConfig=function(e){return e||(e={}),e.endpointUrl=e.endpointUrl||"https://dc.services.visualstudio.com/v2/track",e.sessionRenewalMs=18e5,e.sessionExpirationMs=864e5,e.maxBatchSizeInBytes=e.maxBatchSizeInBytes>0?e.maxBatchSizeInBytes:102400,e.maxBatchInterval=isNaN(e.maxBatchInterval)?15e3:e.maxBatchInterval,e.enableDebug=qn(e.enableDebug),e.disableExceptionTracking=qn(e.disableExceptionTracking),e.disableTelemetry=qn(e.disableTelemetry),e.verboseLogging=qn(e.verboseLogging),e.emitLineDelimitedJson=qn(e.emitLineDelimitedJson),e.diagnosticLogInterval=e.diagnosticLogInterval||1e4,e.autoTrackPageVisitTime=qn(e.autoTrackPageVisitTime),(isNaN(e.samplingPercentage)||e.samplingPercentage<=0||e.samplingPercentage>=100)&&(e.samplingPercentage=100),e.disableAjaxTracking=qn(e.disableAjaxTracking),e.maxAjaxCallsPerView=isNaN(e.maxAjaxCallsPerView)?500:e.maxAjaxCallsPerView,e.isBeaconApiDisabled=qn(e.isBeaconApiDisabled,!0),e.disableCorrelationHeaders=qn(e.disableCorrelationHeaders),e.correlationHeaderExcludedDomains=e.correlationHeaderExcludedDomains||["*.blob.core.windows.net","*.blob.core.chinacloudapi.cn","*.blob.core.cloudapi.de","*.blob.core.usgovcloudapi.net"],e.disableFlushOnBeforeUnload=qn(e.disableFlushOnBeforeUnload),e.disableFlushOnUnload=qn(e.disableFlushOnUnload,e.disableFlushOnBeforeUnload),e.enableSessionStorageBuffer=qn(e.enableSessionStorageBuffer,!0),e.isRetryDisabled=qn(e.isRetryDisabled),e.isCookieUseDisabled=qn(e.isCookieUseDisabled),e.isStorageUseDisabled=qn(e.isStorageUseDisabled),e.isBrowserLinkTrackingEnabled=qn(e.isBrowserLinkTrackingEnabled),e.enableCorsCorrelation=qn(e.enableCorsCorrelation),e},e.prototype.addTelemetryInitializers=function(e){var t=this;this._hasLegacyInitializers||(this.appInsightsNew.addTelemetryInitializer((function(e){t._processLegacyInitializers(e)})),this._hasLegacyInitializers=!0),this._queue.push(e)},e.prototype.getCookieMgr=function(){return this.appInsightsNew.getCookieMgr()},e.prototype.startTrackPage=function(e){this.appInsightsNew.startTrackPage(e)},e.prototype.stopTrackPage=function(e,t,n,r){this.appInsightsNew.stopTrackPage(e,t,n)},e.prototype.trackPageView=function(e,t,n,r,o){var i={name:e,uri:t,properties:n,measurements:r};this.appInsightsNew.trackPageView(i)},e.prototype.trackEvent=function(e,t,n){this.appInsightsNew.trackEvent({name:e})},e.prototype.trackDependency=function(e,t,n,r,o,i,a){this.appInsightsNew.trackDependencyData({id:e,target:n,type:r,duration:o,properties:{HttpMethod:t},success:i,responseCode:a})},e.prototype.trackException=function(e,t,n,r,o){this.appInsightsNew.trackException({exception:e})},e.prototype.trackMetric=function(e,t,n,r,o,i){this.appInsightsNew.trackMetric({name:e,average:t,sampleCount:n,min:r,max:o})},e.prototype.trackTrace=function(e,t,n){this.appInsightsNew.trackTrace({message:e,severityLevel:n})},e.prototype.flush=function(e){this.appInsightsNew.flush(e)},e.prototype.setAuthenticatedUserContext=function(e,t,n){this.appInsightsNew.context.user.setAuthenticatedUserContext(e,t,n)},e.prototype.clearAuthenticatedUserContext=function(){this.appInsightsNew.context.user.clearAuthenticatedUserContext()},e.prototype._onerror=function(e,t,n,r,o){this.appInsightsNew._onerror({message:e,url:t,lineNumber:n,columnNumber:r,error:o})},e.prototype.startTrackEvent=function(e){this.appInsightsNew.startTrackEvent(e)},e.prototype.stopTrackEvent=function(e,t,n){this.appInsightsNew.stopTrackEvent(e,t,n)},e.prototype.downloadAndSetup=function(e){Ee("downloadAndSetup not implemented in web SKU")},e.prototype.updateSnippetDefinitions=function(e){Te(e,this,(function(e){return e&&-1===yi.indexOf(e)}))},e.prototype.loadAppInsights=function(){var e=this;if(this.config.iKey){var t=this.trackPageView;this.trackPageView=function(n,r,o){t.apply(e,[null,n,r,o])}}return"function"==typeof this.snippet.logPageView&&(this.logPageView=function(t,n,r){e.trackPageView(null,t,n,r)}),"function"==typeof this.snippet.logEvent&&(this.logEvent=function(t,n,r){e.trackEvent(t,n,r)}),this},e.prototype._processLegacyInitializers=function(e){return e.tags.ProcessLegacy=this._queue,e},e}(),Ei=function(){function e(){}return e.getAppInsights=function(e,t){var n=new vi(e),r=2!==t;if(dn(),2===t)return n.updateSnippetDefinitions(e),n.loadAppInsights(r),n;var o=new Ci(e,n);return o.updateSnippetDefinitions(e),n.loadAppInsights(r),o},e}()},52303:e=>{window,e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=19)}([function(e,t,n){"use strict";var r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||((r=r||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.sendMessageEventToChild=t.waitForMessageQueue=t.sendMessageToParent=t.uninitializeCommunication=t.initializeCommunication=t.Communication=void 0;var o=n(4),i=n(6),a=n(3),s=function(){};t.Communication=s;var c=function(){function e(){}return e.parentMessageQueue=[],e.childMessageQueue=[],e.nextMessageId=0,e.callbacks={},e}();function u(e,t,n){var r;t instanceof Function?n=t:t instanceof Array&&(r=t),t=s.parentWindow,e=function(e,t){return{id:c.nextMessageId++,func:e,timestamp:Date.now(),args:t||[]}}(e,r),i.GlobalVars.isFramelessWindow?s.currentWindow&&s.currentWindow.nativeInterface&&s.currentWindow.nativeInterface.framelessPostMessage(JSON.stringify(e)):(r=h(t),t&&r?t.postMessage(e,r):p(t).push(e)),n&&(c.callbacks[e.id]=n)}function l(e){var t,n;e&&e.data&&"object"==typeof e.data&&function(e,t){return(!s.currentWindow||e!==s.currentWindow)&&(s.currentWindow&&s.currentWindow.location&&t&&t===s.currentWindow.location.origin||!!(o.validOriginRegExp.test(t.toLowerCase())||i.GlobalVars.additionalValidOriginsRegexp&&i.GlobalVars.additionalValidOriginsRegexp.test(t.toLowerCase())))}(t=e.source||e.originalEvent&&e.originalEvent.source,n=e.origin||e.originalEvent&&e.originalEvent.origin)&&(function(e,t){i.GlobalVars.isFramelessWindow||s.parentWindow&&!s.parentWindow.closed&&e!==s.parentWindow?s.childWindow&&!s.childWindow.closed&&e!==s.childWindow||(s.childWindow=e,s.childOrigin=t):(s.parentWindow=e,s.parentOrigin=t),s.parentWindow&&s.parentWindow.closed&&(s.parentWindow=null,s.parentOrigin=null),s.childWindow&&s.childWindow.closed&&(s.childWindow=null,s.childOrigin=null),f(s.parentWindow),f(s.childWindow)}(t,n),t===s.parentWindow?d(e):t===s.childWindow&&function(e){var t,n;"id"in e.data&&"func"in e.data&&(t=e.data,e=(n=(0,a.callHandler)(t.func,t.args))[0],n=n[1],e&&void 0!==n?g(t.id,Array.isArray(n)?n:[n]):u(t.func,t.args,(function(){for(var e,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];s.childWindow&&(e=n.pop(),g(t.id,n,e))})))}(e))}function d(e){var t,n;"id"in e.data&&"number"==typeof e.data.id?(n=e.data,(t=c.callbacks[n.id])&&(t.apply(null,r(r([],n.args,!0),[n.isPartialResponse],!1)),function(e){return!0===e.data.isPartialResponse}(e)||delete c.callbacks[n.id])):"func"in e.data&&"string"==typeof e.data.func&&(n=e.data,(0,a.callHandler)(n.func,n.args))}function p(e){return e===s.parentWindow?c.parentMessageQueue:e===s.childWindow?c.childMessageQueue:[]}function h(e){return e===s.parentWindow?s.parentOrigin:e===s.childWindow?s.childOrigin:null}function f(e){for(var t=h(e),n=p(e);e&&t&&0<n.length;)e.postMessage(n.shift(),t)}function g(e,t,n){var r=s.childWindow;t=function(e,t,n){return{id:e,args:t||[],isPartialResponse:n}}(e,t,n),n=h(r),r&&n&&r.postMessage(t,n)}t.initializeCommunication=function(e,t){c.messageListener=function(e){return l(e)},s.currentWindow=s.currentWindow||window,((s.parentWindow=s.currentWindow.parent!==s.currentWindow.self?s.currentWindow.parent:s.currentWindow.opener)||t)&&s.currentWindow.addEventListener("message",c.messageListener,!1),s.parentWindow||(i.GlobalVars.isFramelessWindow=!0,window.onNativeMessage=d);try{s.parentOrigin="*",u("initialize",[o.version],e)}finally{s.parentOrigin=null}},t.uninitializeCommunication=function(){s.currentWindow.removeEventListener("message",c.messageListener,!1),s.parentWindow=null,s.parentOrigin=null,s.childWindow=null,s.childOrigin=null,c.parentMessageQueue=[],c.childMessageQueue=[],c.nextMessageId=0,c.callbacks={}},t.sendMessageToParent=u,t.waitForMessageQueue=function(e,t){var n=s.currentWindow.setInterval((function(){0===p(e).length&&(clearInterval(n),t())}),100)},t.sendMessageEventToChild=function(e,t){var n=s.childWindow;e=function(e,t){return{func:e,args:t||[]}}(e,t),t=h(n),n&&t?n.postMessage(e,t):p(n).push(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processAdditionalValidOrigins=t.isAPISupportedByPlatform=t.ensureInitialized=void 0;var r=n(4),o=n(6),i=n(5);t.ensureInitialized=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!o.GlobalVars.initializeCalled)throw new Error("The library has not yet been initialized");if(o.GlobalVars.frameContext&&e&&0<e.length){for(var n=!1,r=0;r<e.length;r++)if(e[r]===o.GlobalVars.frameContext){n=!0;break}if(!n)throw new Error("This call is not allowed in the '"+o.GlobalVars.frameContext+"' context")}},t.isAPISupportedByPlatform=function(e){return void 0===e&&(e=r.defaultSDKVersionForCompatCheck),e=(0,i.compareSDKVersions)(o.GlobalVars.clientSupportedSDKVersion,e),!isNaN(e)&&0<=e},t.processAdditionalValidOrigins=function(e){e=o.GlobalVars.additionalValidOrigins.concat(e.filter((function(e){return"string"==typeof e&&r.userOriginUrlValidationRegExp.test(e)})));var t={};e=e.filter((function(e){return!t[e]&&(t[e]=!0)})),o.GlobalVars.additionalValidOrigins=e,0<o.GlobalVars.additionalValidOrigins.length?o.GlobalVars.additionalValidOriginsRegexp=(0,i.generateRegExpFromUrls)(o.GlobalVars.additionalValidOrigins):o.GlobalVars.additionalValidOriginsRegexp=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelType=t.TaskModuleDimension=t.UserTeamRole=t.TeamType=t.FrameContexts=t.HostClientType=void 0,function(e){e.desktop="desktop",e.web="web",e.android="android",e.ios="ios",e.rigel="rigel",e.surfaceHub="surfaceHub",e.teamsRoomsWindows="teamsRoomsWindows",e.teamsRoomsAndroid="teamsRoomsAndroid",e.teamsPhones="teamsPhones",e.teamsDisplays="teamsDisplays"}(t.HostClientType||(t.HostClientType={})),function(e){e.settings="settings",e.content="content",e.authentication="authentication",e.remove="remove",e.task="task",e.sidePanel="sidePanel",e.stage="stage",e.meetingStage="meetingStage"}(t.FrameContexts||(t.FrameContexts={})),function(e){e[e.Standard=0]="Standard",e[e.Edu=1]="Edu",e[e.Class=2]="Class",e[e.Plc=3]="Plc",e[e.Staff=4]="Staff"}(t.TeamType||(t.TeamType={})),function(e){e[e.Admin=0]="Admin",e[e.User=1]="User",e[e.Guest=2]="Guest"}(t.UserTeamRole||(t.UserTeamRole={})),function(e){e.Large="large",e.Medium="medium",e.Small="small"}(t.TaskModuleDimension||(t.TaskModuleDimension={})),function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared"}(t.ChannelType||(t.ChannelType={}))},function(e,t,n){"use strict";var r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||((r=r||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.registerBeforeUnloadHandler=t.registerOnLoadHandler=t.registerFocusEnterHandler=t.registerBackButtonHandler=t.handleThemeChange=t.registerOnThemeChangeHandler=t.removeHandler=t.registerHandler=t.callHandler=t.initializeHandlers=void 0;var o=n(8),i=n(0),a=function(){function e(){}return e.handlers={},e}();function s(e){a.themeChangeHandler&&a.themeChangeHandler(e),i.Communication.childWindow&&(0,i.sendMessageEventToChild)("themeChange",[e])}function c(){a.backButtonPressHandler&&a.backButtonPressHandler()||(0,o.navigateBack)()}function u(e){a.focusEnterHandler&&a.focusEnterHandler(e)}function l(e){a.loadHandler&&a.loadHandler(e),i.Communication.childWindow&&(0,i.sendMessageEventToChild)("load",[e])}function d(){function e(){(0,i.sendMessageToParent)("readyToUnload",[])}a.beforeUnloadHandler&&a.beforeUnloadHandler(e)||e()}t.initializeHandlers=function(){a.handlers.themeChange=s,a.handlers.backButtonPress=c,a.handlers.load=l,a.handlers.beforeUnload=d,a.handlers.focusEnter=u},t.callHandler=function(e,t){return(e=a.handlers[e])?[!0,e.apply(this,t)]:[!1,void 0]},t.registerHandler=function(e,t,n,o){void 0===n&&(n=!0),void 0===o&&(o=[]),t?(a.handlers[e]=t,n&&(0,i.sendMessageToParent)("registerHandler",r([e],o,!0))):delete a.handlers[e]},t.removeHandler=function(e){delete a.handlers[e]},t.registerOnThemeChangeHandler=function(e){(a.themeChangeHandler=e)&&(0,i.sendMessageToParent)("registerHandler",["themeChange"])},t.handleThemeChange=s,t.registerBackButtonHandler=function(e){(a.backButtonPressHandler=e)&&(0,i.sendMessageToParent)("registerHandler",["backButton"])},t.registerFocusEnterHandler=function(e){(a.focusEnterHandler=e)&&(0,i.sendMessageToParent)("registerHandler",["focusEnter"])},t.registerOnLoadHandler=function(e){(a.loadHandler=e)&&(0,i.sendMessageToParent)("registerHandler",["load"])},t.registerBeforeUnloadHandler=function(e){(a.beforeUnloadHandler=e)&&(0,i.sendMessageToParent)("registerHandler",["beforeUnload"])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.userOriginUrlValidationRegExp=t.validOriginRegExp=t.validOrigins=t.scanBarCodeAPIMobileSupportVersion=t.getMediaCallbackSupportVersion=t.mediaAPISupportVersion=t.captureImageMobileSupportVersion=t.peoplePickerRequiredVersion=t.locationAPIsRequiredVersion=t.getUserJoinedTeamsSupportedAndroidClientVersion=t.videoAndImageMediaAPISupportVersion=t.defaultSDKVersionForCompatCheck=t.version=void 0,n=n(5),t.version="1.11.0",t.defaultSDKVersionForCompatCheck="2.0.1",t.videoAndImageMediaAPISupportVersion="2.0.2",t.getUserJoinedTeamsSupportedAndroidClientVersion="2.0.1",t.locationAPIsRequiredVersion="1.9.0",t.peoplePickerRequiredVersion="2.0.0",t.captureImageMobileSupportVersion="1.7.0",t.mediaAPISupportVersion="1.8.0",t.getMediaCallbackSupportVersion="2.0.0",t.scanBarCodeAPIMobileSupportVersion="1.9.0",t.validOrigins=["https://teams.microsoft.com","https://teams.microsoft.us","https://gov.teams.microsoft.us","https://dod.teams.microsoft.us","https://int.teams.microsoft.com","https://teams.live.com","https://devspaces.skype.com","https://ssauth.skype.com","https://local.teams.live.com","https://local.teams.live.com:8080","https://local.teams.office.com","https://local.teams.office.com:8080","https://msft.spoppe.com","https://*.sharepoint.com","https://*.sharepoint-df.com","https://*.sharepointonline.com","https://outlook.office.com","https://outlook-sdf.office.com","https://*.teams.microsoft.com","https://www.office.com","https://word.office.com","https://excel.office.com","https://powerpoint.office.com","https://www.officeppe.com","https://*.www.office.com"],t.validOriginRegExp=(0,n.generateRegExpFromUrls)(t.validOrigins),t.userOriginUrlValidationRegExp=/^https\:\/\//},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateGUID=t.compareSDKVersions=t.getGenericOnCompleteHandler=t.generateRegExpFromUrls=void 0;var r=n(22);function o(e){for(var t="^",n=e.split("."),r=0;r<n.length;r++)t+=(0<r?"[.]":"")+n[r].replace("*","[^/^.]+");return t+"$"}t.generateRegExpFromUrls=function(e){for(var t="",n=0;n<e.length;n++)t+=(0===n?"":"|")+o(e[n]);return new RegExp(t)},t.getGenericOnCompleteHandler=function(e){return function(t,n){if(!t)throw new Error(e||n)}},t.compareSDKVersions=function(e,t){if("string"!=typeof e||"string"!=typeof t)return NaN;var n=e.split("."),r=t.split(".");function o(e){return/^\d+$/.test(e)}if(!n.every(o)||!r.every(o))return NaN;for(;n.length<r.length;)n.push("0");for(;r.length<n.length;)r.push("0");for(var i=0;i<n.length;++i)if(Number(n[i])!=Number(r[i]))return Number(n[i])>Number(r[i])?1:-1;return 0},t.generateGUID=function(){return r.v4()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalVars=void 0;var r=function(){function e(){}return e.initializeCalled=!1,e.initializeCompleted=!1,e.additionalValidOrigins=[],e.additionalValidOriginsRegexp=null,e.initializeCallbacks=[],e.isFramelessWindow=!1,e.printCapabilityEnabled=!1,e}();t.GlobalVars=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorCode=t.FileOpenPreference=void 0,function(e){e.Inline="inline",e.Desktop="desktop",e.Web="web"}(t.FileOpenPreference||(t.FileOpenPreference={})),function(e){e[e.NOT_SUPPORTED_ON_PLATFORM=100]="NOT_SUPPORTED_ON_PLATFORM",e[e.INTERNAL_ERROR=500]="INTERNAL_ERROR",e[e.NOT_SUPPORTED_IN_CURRENT_CONTEXT=501]="NOT_SUPPORTED_IN_CURRENT_CONTEXT",e[e.PERMISSION_DENIED=1e3]="PERMISSION_DENIED",e[e.NETWORK_ERROR=2e3]="NETWORK_ERROR",e[e.NO_HW_SUPPORT=3e3]="NO_HW_SUPPORT",e[e.INVALID_ARGUMENTS=4e3]="INVALID_ARGUMENTS",e[e.UNAUTHORIZED_USER_OPERATION=5e3]="UNAUTHORIZED_USER_OPERATION",e[e.INSUFFICIENT_RESOURCES=6e3]="INSUFFICIENT_RESOURCES",e[e.THROTTLE=7e3]="THROTTLE",e[e.USER_ABORT=8e3]="USER_ABORT",e[e.OPERATION_TIMED_OUT=8001]="OPERATION_TIMED_OUT",e[e.OLD_PLATFORM=9e3]="OLD_PLATFORM",e[e.FILE_NOT_FOUND=404]="FILE_NOT_FOUND",e[e.SIZE_EXCEEDED=1e4]="SIZE_EXCEEDED"}(t.ErrorCode||(t.ErrorCode={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sharing=t.video=t.people=t.monetization=t.meeting=t.location=t.media=t.ParentAppWindow=t.ChildAppWindow=t.tasks=t.settings=t.navigateToTab=t.navigateCrossDomain=t.navigateBack=t.returnFocus=t.shareDeepLink=t.setFrameContext=t.registerAppButtonHoverLeaveHandler=t.registerAppButtonHoverEnterHandler=t.registerAppButtonClickHandler=t.registerOnThemeChangeHandler=t.registerOnLoadHandler=t.registerFullScreenHandler=t.registerEnterSettingsHandler=t.registerFocusEnterHandler=t.registerBeforeUnloadHandler=t.registerBackButtonHandler=t.print=t.initializeWithFrameContext=t.initialize=t.getTabInstances=t.getMruTabInstances=t.getContext=t.executeDeepLink=t.enablePrintCapability=t.FileOpenPreference=t.ErrorCode=t.ChannelType=t.UserTeamRole=t.TeamType=t.TaskModuleDimension=t.HostClientType=t.FrameContexts=t.authentication=t.appInitialization=void 0;var r=n(25);Object.defineProperty(t,"appInitialization",{enumerable:!0,get:function(){return r.appInitialization}});var o=n(11);Object.defineProperty(t,"authentication",{enumerable:!0,get:function(){return o.authentication}});var i=n(2);Object.defineProperty(t,"FrameContexts",{enumerable:!0,get:function(){return i.FrameContexts}}),Object.defineProperty(t,"HostClientType",{enumerable:!0,get:function(){return i.HostClientType}}),Object.defineProperty(t,"TaskModuleDimension",{enumerable:!0,get:function(){return i.TaskModuleDimension}}),Object.defineProperty(t,"TeamType",{enumerable:!0,get:function(){return i.TeamType}}),Object.defineProperty(t,"UserTeamRole",{enumerable:!0,get:function(){return i.UserTeamRole}}),Object.defineProperty(t,"ChannelType",{enumerable:!0,get:function(){return i.ChannelType}});var a=n(7);Object.defineProperty(t,"ErrorCode",{enumerable:!0,get:function(){return a.ErrorCode}}),Object.defineProperty(t,"FileOpenPreference",{enumerable:!0,get:function(){return a.FileOpenPreference}});var s=n(26);Object.defineProperty(t,"enablePrintCapability",{enumerable:!0,get:function(){return s.enablePrintCapability}}),Object.defineProperty(t,"executeDeepLink",{enumerable:!0,get:function(){return s.executeDeepLink}}),Object.defineProperty(t,"getContext",{enumerable:!0,get:function(){return s.getContext}}),Object.defineProperty(t,"getMruTabInstances",{enumerable:!0,get:function(){return s.getMruTabInstances}}),Object.defineProperty(t,"getTabInstances",{enumerable:!0,get:function(){return s.getTabInstances}}),Object.defineProperty(t,"initialize",{enumerable:!0,get:function(){return s.initialize}}),Object.defineProperty(t,"initializeWithFrameContext",{enumerable:!0,get:function(){return s.initializeWithFrameContext}}),Object.defineProperty(t,"print",{enumerable:!0,get:function(){return s.print}}),Object.defineProperty(t,"registerBackButtonHandler",{enumerable:!0,get:function(){return s.registerBackButtonHandler}}),Object.defineProperty(t,"registerBeforeUnloadHandler",{enumerable:!0,get:function(){return s.registerBeforeUnloadHandler}}),Object.defineProperty(t,"registerFocusEnterHandler",{enumerable:!0,get:function(){return s.registerFocusEnterHandler}}),Object.defineProperty(t,"registerEnterSettingsHandler",{enumerable:!0,get:function(){return s.registerEnterSettingsHandler}}),Object.defineProperty(t,"registerFullScreenHandler",{enumerable:!0,get:function(){return s.registerFullScreenHandler}}),Object.defineProperty(t,"registerOnLoadHandler",{enumerable:!0,get:function(){return s.registerOnLoadHandler}}),Object.defineProperty(t,"registerOnThemeChangeHandler",{enumerable:!0,get:function(){return s.registerOnThemeChangeHandler}}),Object.defineProperty(t,"registerAppButtonClickHandler",{enumerable:!0,get:function(){return s.registerAppButtonClickHandler}}),Object.defineProperty(t,"registerAppButtonHoverEnterHandler",{enumerable:!0,get:function(){return s.registerAppButtonHoverEnterHandler}}),Object.defineProperty(t,"registerAppButtonHoverLeaveHandler",{enumerable:!0,get:function(){return s.registerAppButtonHoverLeaveHandler}}),Object.defineProperty(t,"setFrameContext",{enumerable:!0,get:function(){return s.setFrameContext}}),Object.defineProperty(t,"shareDeepLink",{enumerable:!0,get:function(){return s.shareDeepLink}});var c=n(27);Object.defineProperty(t,"returnFocus",{enumerable:!0,get:function(){return c.returnFocus}}),Object.defineProperty(t,"navigateBack",{enumerable:!0,get:function(){return c.navigateBack}}),Object.defineProperty(t,"navigateCrossDomain",{enumerable:!0,get:function(){return c.navigateCrossDomain}}),Object.defineProperty(t,"navigateToTab",{enumerable:!0,get:function(){return c.navigateToTab}});var u=n(12);Object.defineProperty(t,"settings",{enumerable:!0,get:function(){return u.settings}});var l=n(28);Object.defineProperty(t,"tasks",{enumerable:!0,get:function(){return l.tasks}});var d=n(16);Object.defineProperty(t,"ChildAppWindow",{enumerable:!0,get:function(){return d.ChildAppWindow}}),Object.defineProperty(t,"ParentAppWindow",{enumerable:!0,get:function(){return d.ParentAppWindow}});var p=n(17);Object.defineProperty(t,"media",{enumerable:!0,get:function(){return p.media}});var h=n(29);Object.defineProperty(t,"location",{enumerable:!0,get:function(){return h.location}});var f=n(30);Object.defineProperty(t,"meeting",{enumerable:!0,get:function(){return f.meeting}});var g=n(31);Object.defineProperty(t,"monetization",{enumerable:!0,get:function(){return g.monetization}});var m=n(32);Object.defineProperty(t,"people",{enumerable:!0,get:function(){return m.people}});var v=n(33);Object.defineProperty(t,"video",{enumerable:!0,get:function(){return v.video}});var y=n(34);Object.defineProperty(t,"sharing",{enumerable:!0,get:function(){return y.sharing}})},function(e,t){var n,r,o="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);o?(n=new Uint8Array(16),e.exports=function(){return o(n),n}):(r=new Array(16),e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r})},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0;return[(t=n)[e[r++]],t[e[r++]],t[e[r++]],t[e[r++]],"-",t[e[r++]],t[e[r++]],"-",t[e[r++]],t[e[r++]],"-",t[e[r++]],t[e[r++]],"-",t[e[r++]],t[e[r++]],t[e[r++]],t[e[r++]],t[e[r++]],t[e[+r]]].join("")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.authentication=void 0;var r=n(1),o=n(6),i=n(2),a=n(0),s=n(3);!function(e){var t,n;function c(){u();try{a.Communication.childWindow&&a.Communication.childWindow.close()}finally{a.Communication.childWindow=null,a.Communication.childOrigin=null}}function u(){n&&(clearInterval(n),n=0),(0,s.removeHandler)("initialize"),(0,s.removeHandler)("navigateCrossDomain")}function l(){u(),n=a.Communication.currentWindow.setInterval((function(){if(!a.Communication.childWindow||a.Communication.childWindow.closed)p("CancelledByUser");else{var e=a.Communication.childOrigin;try{a.Communication.childOrigin="*",(0,a.sendMessageEventToChild)("ping")}finally{a.Communication.childOrigin=e}}}),100),(0,s.registerHandler)("initialize",(function(){return[i.FrameContexts.authentication,o.GlobalVars.hostClientType]})),(0,s.registerHandler)("navigateCrossDomain",(function(){return!1}))}function d(e){try{t&&t.successCallback&&t.successCallback(e)}finally{t=null,c()}}function p(e){try{t&&t.failureCallback&&t.failureCallback(e)}finally{t=null,c()}}function h(e,t,n){var r;e&&((r=document.createElement("a")).href=decodeURIComponent(e),r.host&&r.host!==window.location.host&&"outlook.office.com"===r.host&&-1<r.search.indexOf("client_type=Win32_Outlook")&&(t&&"result"===t&&(n&&(r.href=f(r.href,"result",n)),a.Communication.currentWindow.location.assign(f(r.href,"authSuccess",""))),t&&"reason"===t&&(n&&(r.href=f(r.href,"reason",n)),a.Communication.currentWindow.location.assign(f(r.href,"authFailure","")))))}function f(e,t,n){var r=e.indexOf("#"),o=(o=-1===r?"#":e.substr(r))+"&"+t+(""!==n?"="+n:"");return(e=-1===r?e:e.substr(0,r))+o}e.initialize=function(){(0,s.registerHandler)("authentication.authenticate.success",d,!1),(0,s.registerHandler)("authentication.authenticate.failure",p,!1)},e.registerAuthenticationHandlers=function(e){t=e},e.authenticate=function(e){var n=void 0!==e?e:t;(0,r.ensureInitialized)(i.FrameContexts.content,i.FrameContexts.sidePanel,i.FrameContexts.settings,i.FrameContexts.remove,i.FrameContexts.task,i.FrameContexts.stage,i.FrameContexts.meetingStage),o.GlobalVars.hostClientType===i.HostClientType.desktop||o.GlobalVars.hostClientType===i.HostClientType.android||o.GlobalVars.hostClientType===i.HostClientType.ios||o.GlobalVars.hostClientType===i.HostClientType.rigel||o.GlobalVars.hostClientType===i.HostClientType.teamsRoomsWindows||o.GlobalVars.hostClientType===i.HostClientType.teamsRoomsAndroid||o.GlobalVars.hostClientType===i.HostClientType.teamsPhones||o.GlobalVars.hostClientType===i.HostClientType.teamsDisplays?((e=document.createElement("a")).href=n.url,(0,a.sendMessageToParent)("authentication.authenticate",[e.href,n.width,n.height],(function(e,t){e?n.successCallback(t):n.failureCallback(t)}))):function(e){t=e,c();var n=t.width||600,r=t.height||400,o=(n=Math.min(n,a.Communication.currentWindow.outerWidth-400),r=Math.min(r,a.Communication.currentWindow.outerHeight-200),document.createElement("a"));o.href=t.url;var i=void 0!==a.Communication.currentWindow.screenLeft?a.Communication.currentWindow.screenLeft:a.Communication.currentWindow.screenX;e=void 0!==a.Communication.currentWindow.screenTop?a.Communication.currentWindow.screenTop:a.Communication.currentWindow.screenY,i+=a.Communication.currentWindow.outerWidth/2-n/2,e+=a.Communication.currentWindow.outerHeight/2-r/2,a.Communication.childWindow=a.Communication.currentWindow.open(o.href,"_blank","toolbar=no, location=yes, status=no, menubar=no, scrollbars=yes, top="+e+", left="+i+", width="+n+", height="+r),a.Communication.childWindow?l():p("FailedToOpenWindow")}(n)},e.getAuthToken=function(e){(0,r.ensureInitialized)(),(0,a.sendMessageToParent)("authentication.getAuthToken",[e.resources,e.claims,e.silent],(function(t,n){t?e.successCallback(n):e.failureCallback(n)}))},e.getUser=function(e){(0,r.ensureInitialized)(),(0,a.sendMessageToParent)("authentication.getUser",(function(t,n){t?e.successCallback(n):e.failureCallback(n)}))},e.notifySuccess=function(e,t){h(t,"result",e),(0,r.ensureInitialized)(i.FrameContexts.authentication),(0,a.sendMessageToParent)("authentication.authenticate.success",[e]),(0,a.waitForMessageQueue)(a.Communication.parentWindow,(function(){return setTimeout((function(){return a.Communication.currentWindow.close()}),200)}))},e.notifyFailure=function(e,t){h(t,"reason",e),(0,r.ensureInitialized)(i.FrameContexts.authentication),(0,a.sendMessageToParent)("authentication.authenticate.failure",[e]),(0,a.waitForMessageQueue)(a.Communication.parentWindow,(function(){return setTimeout((function(){return a.Communication.currentWindow.close()}),200)}))}}(t.authentication||(t.authentication={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.settings=void 0;var r=n(1),o=n(2),i=n(5),a=n(0),s=n(3);!function(e){var t,n;function c(e){e=new u(e),t?t(e):e.notifySuccess()}e.initialize=function(){(0,s.registerHandler)("settings.save",c,!1),(0,s.registerHandler)("settings.remove",l,!1)},e.setValidityState=function(e){(0,r.ensureInitialized)(o.FrameContexts.settings,o.FrameContexts.remove),(0,a.sendMessageToParent)("settings.setValidityState",[e])},e.getSettings=function(e){(0,r.ensureInitialized)(o.FrameContexts.content,o.FrameContexts.settings,o.FrameContexts.remove,o.FrameContexts.sidePanel),(0,a.sendMessageToParent)("settings.getSettings",e)},e.setSettings=function(e,t){(0,r.ensureInitialized)(o.FrameContexts.content,o.FrameContexts.settings,o.FrameContexts.sidePanel),(0,a.sendMessageToParent)("settings.setSettings",[e],t||(0,i.getGenericOnCompleteHandler)())},e.registerOnSaveHandler=function(e){(0,r.ensureInitialized)(o.FrameContexts.settings),(t=e)&&(0,a.sendMessageToParent)("registerHandler",["save"])},e.registerOnRemoveHandler=function(e){(0,r.ensureInitialized)(o.FrameContexts.remove,o.FrameContexts.settings),(n=e)&&(0,a.sendMessageToParent)("registerHandler",["remove"])};var u=function(){function e(e){this.notified=!1,this.result=e||{}}return e.prototype.notifySuccess=function(){this.ensureNotNotified(),(0,a.sendMessageToParent)("settings.save.success"),this.notified=!0},e.prototype.notifyFailure=function(e){this.ensureNotNotified(),(0,a.sendMessageToParent)("settings.save.failure",[e]),this.notified=!0},e.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The SaveEvent may only notify success or failure once.")},e}();function l(){var e=new d;n?n(e):e.notifySuccess()}var d=function(){function e(){this.notified=!1}return e.prototype.notifySuccess=function(){this.ensureNotNotified(),(0,a.sendMessageToParent)("settings.remove.success"),this.notified=!0},e.prototype.notifyFailure=function(e){this.ensureNotNotified(),(0,a.sendMessageToParent)("settings.remove.failure",[e]),this.notified=!0},e.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The removeEvent may only notify success or failure once.")},e}()}(t.settings||(t.settings={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logs=void 0;var r=n(1),o=n(0),i=n(3);(t.logs||(t.logs={})).registerGetLogHandler=function(e){(0,r.ensureInitialized)(),e?(0,i.registerHandler)("log.request",(function(){var t=e();(0,o.sendMessageToParent)("log.receive",[t])})):(0,i.removeHandler)("log.request")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerUserSettingsChangeHandler=t.getConfigSetting=t.getChatMembers=t.registerCustomHandler=t.sendCustomEvent=t.sendCustomMessage=t.uploadCustomApp=t.showNotification=t.openFilePreview=t.exitFullscreen=t.enterFullscreen=t.getUserJoinedTeams=t.initializePrivateApis=void 0;var r=n(1),o=n(2),i=n(5),a=n(0),s=n(15),c=n(3),u=n(6),l=n(7),d=n(4);t.initializePrivateApis=function(){s.menus.initialize()},t.getUserJoinedTeams=function(e,t){if((0,r.ensureInitialized)(),(u.GlobalVars.hostClientType===o.HostClientType.android||u.GlobalVars.hostClientType===o.HostClientType.teamsRoomsAndroid||u.GlobalVars.hostClientType===o.HostClientType.teamsPhones||u.GlobalVars.hostClientType===o.HostClientType.teamsDisplays)&&!(0,r.isAPISupportedByPlatform)(d.getUserJoinedTeamsSupportedAndroidClientVersion)){var n={errorCode:l.ErrorCode.OLD_PLATFORM};throw new Error(JSON.stringify(n))}(0,a.sendMessageToParent)("getUserJoinedTeams",[t],e)},t.enterFullscreen=function(){(0,r.ensureInitialized)(o.FrameContexts.content),(0,a.sendMessageToParent)("enterFullscreen",[])},t.exitFullscreen=function(){(0,r.ensureInitialized)(o.FrameContexts.content),(0,a.sendMessageToParent)("exitFullscreen",[])},t.openFilePreview=function(e){(0,r.ensureInitialized)(o.FrameContexts.content),e=[e.entityId,e.title,e.description,e.type,e.objectUrl,e.downloadUrl,e.webPreviewUrl,e.webEditUrl,e.baseUrl,e.editFile,e.subEntityId,e.viewerAction,e.fileOpenPreference,e.conversationId],(0,a.sendMessageToParent)("openFilePreview",e)},t.showNotification=function(e){(0,r.ensureInitialized)(o.FrameContexts.content),e=[e.message,e.notificationType],(0,a.sendMessageToParent)("showNotification",e)},t.uploadCustomApp=function(e,t){(0,r.ensureInitialized)(),(0,a.sendMessageToParent)("uploadCustomApp",[e],t||(0,i.getGenericOnCompleteHandler)())},t.sendCustomMessage=function(e,t,n){(0,r.ensureInitialized)(),(0,a.sendMessageToParent)(e,t,n)},t.sendCustomEvent=function(e,t){if((0,r.ensureInitialized)(),!a.Communication.childWindow)throw new Error("The child window has not yet been initialized or is not present");(0,a.sendMessageEventToChild)(e,t)},t.registerCustomHandler=function(e,t){var n=this;(0,r.ensureInitialized)(),(0,c.registerHandler)(e,(function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t.apply(n,e)}))},t.getChatMembers=function(e){(0,r.ensureInitialized)(),(0,a.sendMessageToParent)("getChatMembers",e)},t.getConfigSetting=function(e,t){(0,r.ensureInitialized)(),(0,a.sendMessageToParent)("getConfigSetting",[t],e)},t.registerUserSettingsChangeHandler=function(e,t){(0,r.ensureInitialized)(),(0,c.registerHandler)("userSettingsChange",t,!0,[e])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.menus=void 0;var r=n(1),o=n(0),i=n(3);!function(e){var t,n,a;function s(e){a&&a(e)||((0,r.ensureInitialized)(),(0,o.sendMessageToParent)("viewConfigItemPress",[e]))}function c(e){t&&t(e)||((0,r.ensureInitialized)(),(0,o.sendMessageToParent)("handleNavBarMenuItemPress",[e]))}function u(e){n&&n(e)||((0,r.ensureInitialized)(),(0,o.sendMessageToParent)("handleActionMenuItemPress",[e]))}e.MenuItem=function(){this.enabled=!0,this.selected=!1},function(e){e.dropDown="dropDown",e.popOver="popOver"}(e.MenuListType||(e.MenuListType={})),e.initialize=function(){(0,i.registerHandler)("navBarMenuItemPress",c,!1),(0,i.registerHandler)("actionMenuItemPress",u,!1),(0,i.registerHandler)("setModuleView",s,!1)},e.setUpViews=function(e,t){(0,r.ensureInitialized)(),a=t,(0,o.sendMessageToParent)("setUpViews",[e])},e.setNavBarMenu=function(e,n){(0,r.ensureInitialized)(),t=n,(0,o.sendMessageToParent)("setNavBarMenu",[e])},e.showActionMenu=function(e,t){(0,r.ensureInitialized)(),n=t,(0,o.sendMessageToParent)("showActionMenu",[e])}}(t.menus||(t.menus={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ParentAppWindow=t.ChildAppWindow=void 0;var r=n(1),o=n(2),i=n(5),a=n(0),s=n(3);n=function(){function e(){}return e.prototype.postMessage=function(e,t){(0,r.ensureInitialized)(),(0,a.sendMessageToParent)("messageForChild",[e],t||(0,i.getGenericOnCompleteHandler)())},e.prototype.addEventListener=function(e,t){"message"===e&&(0,s.registerHandler)("messageForParent",t)},e}(),t.ChildAppWindow=n,n=function(){function e(){}return Object.defineProperty(e,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!1,configurable:!0}),e.prototype.postMessage=function(e,t){(0,r.ensureInitialized)(o.FrameContexts.task),(0,a.sendMessageToParent)("messageForParent",[e],t||(0,i.getGenericOnCompleteHandler)())},e.prototype.addEventListener=function(e,t){"message"===e&&(0,s.registerHandler)("messageForChild",t)},e}(),t.ParentAppWindow=n},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.media=void 0;var o=n(6),i=n(7),a=n(1),s=n(2),c=n(5),u=n(18),l=n(0),d=n(3),p=n(4);!function(e){!function(e){e.Base64="base64",e.ID="id"}(e.FileFormat||(e.FileFormat={}));var t=function(){};e.File=t,e.captureImage=function(e){if(!e)throw new Error("[captureImage] Callback cannot be null");(0,a.ensureInitialized)(s.FrameContexts.content,s.FrameContexts.task),o.GlobalVars.isFramelessWindow?(0,a.isAPISupportedByPlatform)(p.captureImageMobileSupportVersion)?(0,l.sendMessageToParent)("captureImage",e):e({errorCode:i.ErrorCode.OLD_PLATFORM},void 0):e({errorCode:i.ErrorCode.NOT_SUPPORTED_ON_PLATFORM},void 0)};var n=function(e){function t(t){void 0===t&&(t=null);var n=e.call(this)||this;return t&&(n.content=t.content,n.format=t.format,n.mimeType=t.mimeType,n.name=t.name,n.preview=t.preview,n.size=t.size),n}return r(t,e),t.prototype.getMedia=function(e){if(!e)throw new Error("[get Media] Callback cannot be null");(0,a.ensureInitialized)(s.FrameContexts.content,s.FrameContexts.task),(0,a.isAPISupportedByPlatform)(p.mediaAPISupportVersion)?(0,u.validateGetMediaInputs)(this.mimeType,this.format,this.content)?(0,a.isAPISupportedByPlatform)(p.getMediaCallbackSupportVersion)?this.getMediaViaCallback(e):this.getMediaViaHandler(e):e({errorCode:i.ErrorCode.INVALID_ARGUMENTS},null):e({errorCode:i.ErrorCode.OLD_PLATFORM},null)},t.prototype.getMediaViaCallback=function(e){var t={mediaMimeType:this.mimeType,assembleAttachment:[]},n=[this.content];(0,l.sendMessageToParent)("getMedia",n,(function(n){var r;e&&(n&&n.error?e(n.error,null):n&&n.mediaChunk?n.mediaChunk.chunkSequence<=0?(r=(0,u.createFile)(t.assembleAttachment,t.mediaMimeType),e(n.error,r)):(n=(0,u.decodeAttachment)(n.mediaChunk,t.mediaMimeType),t.assembleAttachment.push(n)):e({errorCode:i.ErrorCode.INTERNAL_ERROR,message:"data received is null"},null))}))},t.prototype.getMediaViaHandler=function(e){var t=(0,c.generateGUID)(),n={mediaMimeType:this.mimeType,assembleAttachment:[]},r=[t,this.content];this.content&&e&&(0,l.sendMessageToParent)("getMedia",r),(0,d.registerHandler)("getMedia"+t,(function(r){var o;e&&((o=JSON.parse(r)).error?(e(o.error,null),(0,d.removeHandler)("getMedia"+t)):o.mediaChunk?o.mediaChunk.chunkSequence<=0?(r=(0,u.createFile)(n.assembleAttachment,n.mediaMimeType),e(o.error,r),(0,d.removeHandler)("getMedia"+t)):(o=(0,u.decodeAttachment)(o.mediaChunk,n.mediaMimeType),n.assembleAttachment.push(o)):(e({errorCode:i.ErrorCode.INTERNAL_ERROR,message:"data received is null"},null),(0,d.removeHandler)("getMedia"+t)))}))},t}(t);e.Media=n,function(e){e[e.Photo=1]="Photo",e[e.Document=2]="Document",e[e.Whiteboard=3]="Whiteboard",e[e.BusinessCard=4]="BusinessCard"}(e.CameraStartMode||(e.CameraStartMode={})),function(e){e[e.Camera=1]="Camera",e[e.Gallery=2]="Gallery"}(e.Source||(e.Source={})),function(e){e[e.Image=1]="Image",e[e.VideoAndImage=3]="VideoAndImage",e[e.Audio=4]="Audio"}(e.MediaType||(e.MediaType={})),function(e){e[e.ID=1]="ID",e[e.URL=2]="URL"}(e.ImageUriType||(e.ImageUriType={})),e.selectMedia=function(e,t){if(!t)throw new Error("[select Media] Callback cannot be null");if((0,a.ensureInitialized)(s.FrameContexts.content,s.FrameContexts.task),(0,a.isAPISupportedByPlatform)(p.mediaAPISupportVersion)){if((0,u.isMediaCallForVideoAndImageInputs)(e)){if(o.GlobalVars.hostClientType!=s.HostClientType.android&&o.GlobalVars.hostClientType!=s.HostClientType.ios){var r={errorCode:i.ErrorCode.NOT_SUPPORTED_ON_PLATFORM};return void t(r,null)}if(!(0,a.isAPISupportedByPlatform)(p.videoAndImageMediaAPISupportVersion))return c={errorCode:i.ErrorCode.OLD_PLATFORM},void t(c,null)}(0,u.validateSelectMediaInputs)(e)?(0,l.sendMessageToParent)("selectMedia",[e],(function(e,r){if(r){for(var o=[],i=0,a=r;i<a.length;i++){var s=a[i];o.push(new n(s))}t(e,o)}else t(e,null)})):(e={errorCode:i.ErrorCode.INVALID_ARGUMENTS},t(e,null))}else{var c={errorCode:i.ErrorCode.OLD_PLATFORM};t(c,null)}},e.viewImages=function(e,t){if(!t)throw new Error("[view images] Callback cannot be null");(0,a.ensureInitialized)(s.FrameContexts.content,s.FrameContexts.task),(0,a.isAPISupportedByPlatform)(p.mediaAPISupportVersion)?(0,u.validateViewImagesInput)(e)?(0,l.sendMessageToParent)("viewImages",[e],t):t({errorCode:i.ErrorCode.INVALID_ARGUMENTS}):t({errorCode:i.ErrorCode.OLD_PLATFORM})},e.scanBarCode=function(e,t){if(!e)throw new Error("[media.scanBarCode] Callback cannot be null");(0,a.ensureInitialized)(s.FrameContexts.content,s.FrameContexts.task),o.GlobalVars.hostClientType!==s.HostClientType.desktop&&o.GlobalVars.hostClientType!==s.HostClientType.web&&o.GlobalVars.hostClientType!==s.HostClientType.rigel&&o.GlobalVars.hostClientType!==s.HostClientType.teamsRoomsWindows&&o.GlobalVars.hostClientType!==s.HostClientType.teamsRoomsAndroid&&o.GlobalVars.hostClientType!==s.HostClientType.teamsPhones&&o.GlobalVars.hostClientType!==s.HostClientType.teamsDisplays?(0,a.isAPISupportedByPlatform)(p.scanBarCodeAPIMobileSupportVersion)?(0,u.validateScanBarCodeInput)(t)?(0,l.sendMessageToParent)("media.scanBarCode",[t],e):e({errorCode:i.ErrorCode.INVALID_ARGUMENTS},null):e({errorCode:i.ErrorCode.OLD_PLATFORM},null):e({errorCode:i.ErrorCode.NOT_SUPPORTED_ON_PLATFORM},null)}}(t.media||(t.media={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validatePeoplePickerInput=t.validateScanBarCodeInput=t.validateViewImagesInput=t.validateGetMediaInputs=t.isMediaCallForVideoAndImageInputs=t.validateSelectMediaInputs=t.decodeAttachment=t.createFile=void 0;var r=n(17);t.createFile=function(e,t){if(null==e||null==t||e.length<=0)return null;var n,r=1;return e.sort((function(e,t){return e.sequence>t.sequence?1:-1})),e.forEach((function(e){e.sequence==r&&(n=n?new Blob([n,e.file],{type:t}):new Blob([e.file],{type:t}),r++)})),n},t.decodeAttachment=function(e,t){if(null==e||null==t)return null;for(var n=atob(e.chunk),r=new Array(n.length),o=0;o<n.length;o++)r[o]=n.charCodeAt(o);var i=new Uint8Array(r);return t=new Blob([i],{type:t}),{sequence:e.chunkSequence,file:t}},t.validateSelectMediaInputs=function(e){return!(null==e||10<e.maxMediaCount)},t.isMediaCallForVideoAndImageInputs=function(e){return!(!e||e.mediaType!=r.media.MediaType.VideoAndImage&&!e.videoAndImageProps)},t.validateGetMediaInputs=function(e,t,n){return null!=e&&null!=t&&t==r.media.FileFormat.ID&&null!=n},t.validateViewImagesInput=function(e){return!(null==e||e.length<=0||10<e.length)},t.validateScanBarCodeInput=function(e){return!e||!(null===e.timeOutIntervalInSec||e.timeOutIntervalInSec<=0||60<e.timeOutIntervalInSec)},t.validatePeoplePickerInput=function(e){if(e){if(e.title&&"string"!=typeof e.title)return!1;if(e.setSelected&&"object"!=typeof e.setSelected)return!1;if(e.openOrgWideSearchInChatOrChannel&&"boolean"!=typeof e.openOrgWideSearchInChatOrChannel)return!1;if(e.singleSelect&&"boolean"!=typeof e.singleSelect)return!1}return!0}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(20),t),o(n(8),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.teams=t.appEntity=t.files=t.remoteCamera=t.meetingRoom=t.conversations=t.registerUserSettingsChangeHandler=t.uploadCustomApp=t.registerCustomHandler=t.sendCustomEvent=t.showNotification=t.sendCustomMessage=t.openFilePreview=t.getUserJoinedTeams=t.getConfigSetting=t.getChatMembers=t.exitFullscreen=t.enterFullscreen=t.UserSettingTypes=t.ViewerActionTypes=t.NotificationTypes=t.logs=t.menus=t.bot=void 0;var r=n(21);Object.defineProperty(t,"bot",{enumerable:!0,get:function(){return r.bot}});var o=n(15);Object.defineProperty(t,"menus",{enumerable:!0,get:function(){return o.menus}});var i=n(13);Object.defineProperty(t,"logs",{enumerable:!0,get:function(){return i.logs}});var a=n(35);Object.defineProperty(t,"NotificationTypes",{enumerable:!0,get:function(){return a.NotificationTypes}}),Object.defineProperty(t,"ViewerActionTypes",{enumerable:!0,get:function(){return a.ViewerActionTypes}}),Object.defineProperty(t,"UserSettingTypes",{enumerable:!0,get:function(){return a.UserSettingTypes}});var s=n(14);Object.defineProperty(t,"enterFullscreen",{enumerable:!0,get:function(){return s.enterFullscreen}}),Object.defineProperty(t,"exitFullscreen",{enumerable:!0,get:function(){return s.exitFullscreen}}),Object.defineProperty(t,"getChatMembers",{enumerable:!0,get:function(){return s.getChatMembers}}),Object.defineProperty(t,"getConfigSetting",{enumerable:!0,get:function(){return s.getConfigSetting}}),Object.defineProperty(t,"getUserJoinedTeams",{enumerable:!0,get:function(){return s.getUserJoinedTeams}}),Object.defineProperty(t,"openFilePreview",{enumerable:!0,get:function(){return s.openFilePreview}}),Object.defineProperty(t,"sendCustomMessage",{enumerable:!0,get:function(){return s.sendCustomMessage}}),Object.defineProperty(t,"showNotification",{enumerable:!0,get:function(){return s.showNotification}}),Object.defineProperty(t,"sendCustomEvent",{enumerable:!0,get:function(){return s.sendCustomEvent}}),Object.defineProperty(t,"registerCustomHandler",{enumerable:!0,get:function(){return s.registerCustomHandler}}),Object.defineProperty(t,"uploadCustomApp",{enumerable:!0,get:function(){return s.uploadCustomApp}}),Object.defineProperty(t,"registerUserSettingsChangeHandler",{enumerable:!0,get:function(){return s.registerUserSettingsChangeHandler}});var c=n(36);Object.defineProperty(t,"conversations",{enumerable:!0,get:function(){return c.conversations}});var u=n(37);Object.defineProperty(t,"meetingRoom",{enumerable:!0,get:function(){return u.meetingRoom}});var l=n(38);Object.defineProperty(t,"remoteCamera",{enumerable:!0,get:function(){return l.remoteCamera}});var d=n(39);Object.defineProperty(t,"files",{enumerable:!0,get:function(){return d.files}});var p=n(40);Object.defineProperty(t,"appEntity",{enumerable:!0,get:function(){return p.appEntity}});var h=n(41);Object.defineProperty(t,"teams",{enumerable:!0,get:function(){return h.teams}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bot=void 0;var r=n(0),o=n(1);!function(e){e.sendQuery=function(e,t,n){(0,o.ensureInitialized)(),(0,r.sendMessageToParent)("bot.executeQuery",[e],(function(e,r){(e?t:n)(r)}))},e.getSupportedCommands=function(e,t){(0,o.ensureInitialized)(),(0,r.sendMessageToParent)("bot.getSupportedCommands",(function(n,r){(n?e:t)(r)}))},e.authenticate=function(e,t,n){(0,o.ensureInitialized)(),(0,r.sendMessageToParent)("bot.authenticate",[e],(function(e,r){(e?t:n)(r)}))},function(e){e.Results="Results",e.Auth="Auth"}(e.ResponseType||(e.ResponseType={}))}(t.bot||(t.bot={}))},function(e,t,n){var r=n(23),o=n(24);(n=o).v1=r,n.v4=o,e.exports=n},function(e,t,n){var r,o,i=n(9),a=n(10),s=0,c=0;e.exports=function(e,t,n){var u=t&&n||0,l=t||[],d=(e=e||{}).node||r,p=void 0!==e.clockseq?e.clockseq:o;null!=d&&null!=p||(f=i(),null==d&&(d=r=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==p&&(p=o=16383&(f[6]<<8|f[7])));var h=void 0!==e.msecs?e.msecs:(new Date).getTime(),f=(n=void 0!==e.nsecs?e.nsecs:c+1,h-s+(n-c)/1e4);if(f<0&&void 0===e.clockseq&&(p=p+1&16383),1e4<=(n=(f<0||s<h)&&void 0===e.nsecs?0:n))throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=h,o=p,n=(1e4*(268435455&(h+=122192928e5))+(c=n))%4294967296,l[u++]=n>>>24&255,l[u++]=n>>>16&255,l[u++]=n>>>8&255,l[u++]=255&n,h=h/4294967296*1e4&268435455,l[u++]=h>>>8&255,l[u++]=255&h,l[u++]=h>>>24&15|16,l[u++]=h>>>16&255,l[u++]=p>>>8|128,l[u++]=255&p;for(var g=0;g<6;++g)l[u+g]=d[g];return t||a(l)}},function(e,t,n){var r=n(9),o=n(10);e.exports=function(e,t,n){var i=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[i+s]=a[s];return t||o(a)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.appInitialization=void 0;var r=n(1),o=n(4),i=n(0);!function(e){e.Messages={AppLoaded:"appInitialization.appLoaded",Success:"appInitialization.success",Failure:"appInitialization.failure",ExpectedFailure:"appInitialization.expectedFailure"},function(e){e.AuthFailed="AuthFailed",e.Timeout="Timeout",e.Other="Other"}(e.FailedReason||(e.FailedReason={})),function(e){e.PermissionError="PermissionError",e.NotFound="NotFound",e.Throttling="Throttling",e.Offline="Offline",e.Other="Other"}(e.ExpectedFailureReason||(e.ExpectedFailureReason={})),e.notifyAppLoaded=function(){(0,r.ensureInitialized)(),(0,i.sendMessageToParent)(e.Messages.AppLoaded,[o.version])},e.notifySuccess=function(){(0,r.ensureInitialized)(),(0,i.sendMessageToParent)(e.Messages.Success,[o.version])},e.notifyFailure=function(t){(0,r.ensureInitialized)(),(0,i.sendMessageToParent)(e.Messages.Failure,[t.reason,t.message])},e.notifyExpectedFailure=function(t){(0,r.ensureInitialized)(),(0,i.sendMessageToParent)(e.Messages.ExpectedFailure,[t.reason,t.message])}}(t.appInitialization||(t.appInitialization={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initializeWithFrameContext=t.setFrameContext=t.executeDeepLink=t.shareDeepLink=t.getMruTabInstances=t.getTabInstances=t.registerEnterSettingsHandler=t.registerFocusEnterHandler=t.registerBeforeUnloadHandler=t.registerOnLoadHandler=t.registerBackButtonHandler=t.registerAppButtonHoverLeaveHandler=t.registerAppButtonHoverEnterHandler=t.registerAppButtonClickHandler=t.registerFullScreenHandler=t.registerOnThemeChangeHandler=t.getContext=t.print=t.enablePrintCapability=t._uninitialize=t._initialize=t.initialize=void 0;var r=n(1),o=n(6),i=n(4),a=n(12),s=n(5),c=n(13),u=n(2),l=n(0),d=n(11),p=n(14),h=n(3);function f(e,t){o.GlobalVars.initializeCalled||(o.GlobalVars.initializeCalled=!0,h.initializeHandlers(),(0,l.initializeCommunication)((function(e,t,n){void 0===n&&(n=i.defaultSDKVersionForCompatCheck),o.GlobalVars.frameContext=e,o.GlobalVars.hostClientType=t,o.GlobalVars.clientSupportedSDKVersion=n,o.GlobalVars.initializeCallbacks.forEach((function(e){return e()})),o.GlobalVars.initializeCallbacks=[],o.GlobalVars.initializeCompleted=!0}),t),d.authentication.initialize(),a.settings.initialize(),(0,p.initializePrivateApis)()),Array.isArray(t)&&(0,r.processAdditionalValidOrigins)(t),e&&(o.GlobalVars.initializeCompleted?e():o.GlobalVars.initializeCallbacks.push(e))}function g(){window.print()}function m(e){(0,r.ensureInitialized)(),h.registerOnThemeChangeHandler(e)}function v(e){(0,r.ensureInitialized)(),h.registerHandler("fullScreenChange",e)}function y(e){(0,r.ensureInitialized)(),h.registerBackButtonHandler(e)}function C(e){(0,r.ensureInitialized)(),h.registerOnLoadHandler(e)}function E(e){(0,r.ensureInitialized)(),h.registerBeforeUnloadHandler(e)}function T(e){(0,r.ensureInitialized)(),h.registerFocusEnterHandler(e)}function w(e){(0,r.ensureInitialized)(u.FrameContexts.content),(0,l.sendMessageToParent)("setFrameContext",[e])}t.initialize=f,t._initialize=function(e){l.Communication.currentWindow=e},t._uninitialize=function(){o.GlobalVars.initializeCalled&&(o.GlobalVars.frameContext&&(m(null),v(null),y(null),E(null),T(null),C(null),c.logs.registerGetLogHandler(null)),o.GlobalVars.frameContext===u.FrameContexts.settings&&a.settings.registerOnSaveHandler(null),o.GlobalVars.frameContext===u.FrameContexts.remove&&a.settings.registerOnRemoveHandler(null),o.GlobalVars.initializeCalled=!1,o.GlobalVars.initializeCompleted=!1,o.GlobalVars.initializeCallbacks=[],o.GlobalVars.additionalValidOrigins=[],o.GlobalVars.frameContext=null,o.GlobalVars.hostClientType=null,(o.GlobalVars.isFramelessWindow=!1,l.uninitializeCommunication)())},t.enablePrintCapability=function(){o.GlobalVars.printCapabilityEnabled||(o.GlobalVars.printCapabilityEnabled=!0,(0,r.ensureInitialized)(),document.addEventListener("keydown",(function(e){(e.ctrlKey||e.metaKey)&&80===e.keyCode&&(g(),e.cancelBubble=!0,e.preventDefault(),e.stopImmediatePropagation())})))},t.print=g,t.getContext=function(e){(0,r.ensureInitialized)(),(0,l.sendMessageToParent)("getContext",(function(t){t.frameContext||(t.frameContext=o.GlobalVars.frameContext),e(t)}))},t.registerOnThemeChangeHandler=m,t.registerFullScreenHandler=v,t.registerAppButtonClickHandler=function(e){(0,r.ensureInitialized)(u.FrameContexts.content),h.registerHandler("appButtonClick",e)},t.registerAppButtonHoverEnterHandler=function(e){(0,r.ensureInitialized)(u.FrameContexts.content),h.registerHandler("appButtonHoverEnter",e)},t.registerAppButtonHoverLeaveHandler=function(e){(0,r.ensureInitialized)(u.FrameContexts.content),h.registerHandler("appButtonHoverLeave",e)},t.registerBackButtonHandler=y,t.registerOnLoadHandler=C,t.registerBeforeUnloadHandler=E,t.registerFocusEnterHandler=T,t.registerEnterSettingsHandler=function(e){(0,r.ensureInitialized)(u.FrameContexts.content),h.registerHandler("changeSettings",e)},t.getTabInstances=function(e,t){(0,r.ensureInitialized)(),(0,l.sendMessageToParent)("getTabInstances",[t],e)},t.getMruTabInstances=function(e,t){(0,r.ensureInitialized)(),(0,l.sendMessageToParent)("getMruTabInstances",[t],e)},t.shareDeepLink=function(e){(0,r.ensureInitialized)(u.FrameContexts.content,u.FrameContexts.sidePanel,u.FrameContexts.meetingStage),(0,l.sendMessageToParent)("shareDeepLink",[e.subEntityId,e.subEntityLabel,e.subEntityWebUrl])},t.executeDeepLink=function(e,t){(0,r.ensureInitialized)(u.FrameContexts.content,u.FrameContexts.sidePanel,u.FrameContexts.settings,u.FrameContexts.task,u.FrameContexts.stage,u.FrameContexts.meetingStage),(0,l.sendMessageToParent)("executeDeepLink",[e],t||(0,s.getGenericOnCompleteHandler)())},t.setFrameContext=w,t.initializeWithFrameContext=function(e,t,n){f(t,n),w(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.navigateBack=t.navigateCrossDomain=t.navigateToTab=t.returnFocus=void 0;var r=n(1),o=n(5),i=n(2),a=n(0);t.returnFocus=function(e){(0,r.ensureInitialized)(i.FrameContexts.content),(0,a.sendMessageToParent)("returnFocus",[e])},t.navigateToTab=function(e,t){(0,r.ensureInitialized)(),(0,a.sendMessageToParent)("navigateToTab",[e],t||(0,o.getGenericOnCompleteHandler)("Invalid internalTabInstanceId and/or channelId were/was provided"))},t.navigateCrossDomain=function(e,t){(0,r.ensureInitialized)(i.FrameContexts.content,i.FrameContexts.sidePanel,i.FrameContexts.settings,i.FrameContexts.remove,i.FrameContexts.task,i.FrameContexts.stage,i.FrameContexts.meetingStage),(0,a.sendMessageToParent)("navigateCrossDomain",[e],t||(0,o.getGenericOnCompleteHandler)("Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest."))},t.navigateBack=function(e){(0,r.ensureInitialized)(),(0,a.sendMessageToParent)("navigateBack",[],e||(0,o.getGenericOnCompleteHandler)("Back navigation is not supported in the current client or context."))}},function(e,t,n){"use strict";var r=this&&this.__rest||function(e,t){var n={};for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]]);return n};Object.defineProperty(t,"__esModule",{value:!0}),t.tasks=void 0;var o=n(2),i=n(16),a=n(0),s=n(1);!function(e){e.startTask=function(e,t){return(0,s.ensureInitialized)(o.FrameContexts.content,o.FrameContexts.sidePanel,o.FrameContexts.meetingStage),(0,a.sendMessageToParent)("tasks.startTask",[e],t),new i.ChildAppWindow},e.updateTask=function(e){(0,s.ensureInitialized)(o.FrameContexts.task),e.width,e.height;var t=r(e,["width","height"]);if(Object.keys(t).length)throw new Error("updateTask requires a taskInfo argument containing only width and height");(0,a.sendMessageToParent)("tasks.updateTask",[e])},e.submitTask=function(e,t){(0,s.ensureInitialized)(o.FrameContexts.task),(0,a.sendMessageToParent)("tasks.completeTask",[e,Array.isArray(t)?t:[t]])}}(t.tasks||(t.tasks={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.location=void 0;var r=n(7),o=n(1),i=n(2),a=n(0),s=n(4);!function(e){e.getLocation=function(e,t){if(!t)throw new Error("[location.getLocation] Callback cannot be null");(0,o.ensureInitialized)(i.FrameContexts.content,i.FrameContexts.task),(0,o.isAPISupportedByPlatform)(s.locationAPIsRequiredVersion)?e?(0,a.sendMessageToParent)("location.getLocation",[e],t):t({errorCode:r.ErrorCode.INVALID_ARGUMENTS},void 0):t({errorCode:r.ErrorCode.OLD_PLATFORM},void 0)},e.showLocation=function(e,t){if(!t)throw new Error("[location.showLocation] Callback cannot be null");(0,o.ensureInitialized)(i.FrameContexts.content,i.FrameContexts.task),(0,o.isAPISupportedByPlatform)(s.locationAPIsRequiredVersion)?e?(0,a.sendMessageToParent)("location.showLocation",[e],t):t({errorCode:r.ErrorCode.INVALID_ARGUMENTS},void 0):t({errorCode:r.ErrorCode.OLD_PLATFORM},void 0)}}(t.location||(t.location={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.meeting=void 0;var r=n(0),o=n(3),i=n(1),a=n(2);!function(e){!function(e){e.Unknown="Unknown",e.Adhoc="Adhoc",e.Scheduled="Scheduled",e.Recurring="Recurring",e.Broadcast="Broadcast",e.MeetNow="MeetNow"}(e.MeetingType||(e.MeetingType={})),e.getIncomingClientAudioState=function(e){if(!e)throw new Error("[get incoming client audio state] Callback cannot be null");(0,i.ensureInitialized)(a.FrameContexts.sidePanel,a.FrameContexts.meetingStage),(0,r.sendMessageToParent)("getIncomingClientAudioState",e)},e.toggleIncomingClientAudio=function(e){if(!e)throw new Error("[toggle incoming client audio] Callback cannot be null");(0,i.ensureInitialized)(a.FrameContexts.sidePanel,a.FrameContexts.meetingStage),(0,r.sendMessageToParent)("toggleIncomingClientAudio",e)},e.getMeetingDetails=function(e){if(!e)throw new Error("[get meeting details] Callback cannot be null");(0,i.ensureInitialized)(a.FrameContexts.sidePanel,a.FrameContexts.meetingStage,a.FrameContexts.settings,a.FrameContexts.content),(0,r.sendMessageToParent)("meeting.getMeetingDetails",e)},e.getAuthenticationTokenForAnonymousUser=function(e){if(!e)throw new Error("[get Authentication Token For AnonymousUser] Callback cannot be null");(0,i.ensureInitialized)(a.FrameContexts.sidePanel,a.FrameContexts.meetingStage),(0,r.sendMessageToParent)("meeting.getAuthenticationTokenForAnonymousUser",e)},e.getLiveStreamState=function(e){if(!e)throw new Error("[get live stream state] Callback cannot be null");(0,i.ensureInitialized)(a.FrameContexts.sidePanel),(0,r.sendMessageToParent)("meeting.getLiveStreamState",e)},e.requestStartLiveStreaming=function(e,t,n){if(!e)throw new Error("[request start live streaming] Callback cannot be null");(0,i.ensureInitialized)(a.FrameContexts.sidePanel),(0,r.sendMessageToParent)("meeting.requestStartLiveStreaming",[t,n],e)},e.requestStopLiveStreaming=function(e){if(!e)throw new Error("[request stop live streaming] Callback cannot be null");(0,i.ensureInitialized)(a.FrameContexts.sidePanel),(0,r.sendMessageToParent)("meeting.requestStopLiveStreaming",e)},e.registerLiveStreamChangedHandler=function(e){if(!e)throw new Error("[register live stream changed handler] Handler cannot be null");(0,i.ensureInitialized)(a.FrameContexts.sidePanel),(0,o.registerHandler)("meeting.liveStreamChanged",e)},e.shareAppContentToStage=function(e,t){if(!e)throw new Error("[share app content to stage] Callback cannot be null");(0,i.ensureInitialized)(a.FrameContexts.sidePanel),(0,r.sendMessageToParent)("meeting.shareAppContentToStage",[t],e)},e.getAppContentStageSharingCapabilities=function(e){if(!e)throw new Error("[get app content stage sharing capabilities] Callback cannot be null");(0,i.ensureInitialized)(a.FrameContexts.sidePanel),(0,r.sendMessageToParent)("meeting.getAppContentStageSharingCapabilities",e)},e.stopSharingAppContentToStage=function(e){if(!e)throw new Error("[stop sharing app content to stage] Callback cannot be null");(0,i.ensureInitialized)(a.FrameContexts.sidePanel),(0,r.sendMessageToParent)("meeting.stopSharingAppContentToStage",e)},e.getAppContentStageSharingState=function(e){if(!e)throw new Error("[get app content stage sharing state] Callback cannot be null");(0,i.ensureInitialized)(a.FrameContexts.sidePanel),(0,r.sendMessageToParent)("meeting.getAppContentStageSharingState",e)}}(t.meeting||(t.meeting={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.monetization=void 0;var r=n(0),o=n(1),i=n(2);(t.monetization||(t.monetization={})).openPurchaseExperience=function(e,t){if(!e)throw new Error("[open purchase experience] Callback cannot be null");(0,o.ensureInitialized)(i.FrameContexts.content),(0,r.sendMessageToParent)("monetization.openPurchaseExperience",[t],e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.people=void 0;var r=n(1),o=n(2),i=n(7),a=n(18),s=n(0),c=n(4);(t.people||(t.people={})).selectPeople=function(e,t){if(!e)throw new Error("[people picker] Callback cannot be null");(0,r.ensureInitialized)(o.FrameContexts.content,o.FrameContexts.task,o.FrameContexts.settings),(0,r.isAPISupportedByPlatform)(c.peoplePickerRequiredVersion)?(0,a.validatePeoplePickerInput)(t)?(0,s.sendMessageToParent)("people.selectPeople",[t],e):e({errorCode:i.ErrorCode.INVALID_ARGUMENTS},null):e({errorCode:i.ErrorCode.OLD_PLATFORM},void 0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.video=void 0;var r=n(0),o=n(1),i=n(2),a=n(3);!function(e){function t(){(0,r.sendMessageToParent)("video.videoFrameProcessed")}function n(e){(0,r.sendMessageToParent)("video.notifyError",[e])}!function(e){e[e.NV12=0]="NV12"}(e.VideoFrameFormat||(e.VideoFrameFormat={})),function(e){e[e.EffectChanged=0]="EffectChanged",e[e.EffectDisabled=1]="EffectDisabled"}(e.EffectChangeType||(e.EffectChangeType={})),e.registerForVideoFrame=function(e,s){(0,o.ensureInitialized)(i.FrameContexts.sidePanel),(0,a.registerHandler)("video.newVideoFrame",(function(r){void 0!==r&&e(r,t,n)})),(0,r.sendMessageToParent)("video.registerForVideoFrame",[s])},e.notifySelectedVideoEffectChanged=function(e,t){(0,o.ensureInitialized)(i.FrameContexts.sidePanel),(0,r.sendMessageToParent)("video.videoEffectChanged",[e,t])},e.registerForVideoEffect=function(e){(0,o.ensureInitialized)(i.FrameContexts.sidePanel),(0,a.registerHandler)("video.effectParameterChange",e)}}(t.video||(t.video={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sharing=void 0;var r=n(1),o=n(0),i=n(7),a=n(2);!function(e){e.SharingAPIMessages={shareWebContent:"sharing.shareWebContent"},e.shareWebContent=function(t,n){(function(e,t){if(e&&e.content&&e.content.length)return 1;t&&t({errorCode:i.ErrorCode.INVALID_ARGUMENTS,message:"Shared content is missing"})})(t,n)&&function(e,t){if(e.content.some((function(e){return!e.type})))t&&t({errorCode:i.ErrorCode.INVALID_ARGUMENTS,message:"Shared content type cannot be undefined"});else{if(!e.content.some((function(t){return t.type!==e.content[0].type})))return 1;t&&t({errorCode:i.ErrorCode.INVALID_ARGUMENTS,message:"Shared content must be of the same type"})}}(t,n)&&function(e,t){if("URL"===e.content[0].type){if(!e.content.some((function(e){return!e.url})))return 1;t&&t({errorCode:i.ErrorCode.INVALID_ARGUMENTS,message:"URLs are required for URL content types"})}else t&&t({errorCode:i.ErrorCode.INVALID_ARGUMENTS,message:"Content type is unsupported"})}(t,n)&&((0,r.ensureInitialized)(a.FrameContexts.content,a.FrameContexts.sidePanel,a.FrameContexts.task,a.FrameContexts.stage,a.FrameContexts.meetingStage),(0,o.sendMessageToParent)(e.SharingAPIMessages.shareWebContent,[t],n))}}(t.sharing||(t.sharing={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserSettingTypes=t.ViewerActionTypes=t.NotificationTypes=void 0,function(e){e.fileDownloadStart="fileDownloadStart",e.fileDownloadComplete="fileDownloadComplete"}(t.NotificationTypes||(t.NotificationTypes={})),function(e){e.view="view",e.edit="edit",e.editNew="editNew"}(t.ViewerActionTypes||(t.ViewerActionTypes={})),function(e){e.fileOpenPreference="fileOpenPreference",e.theme="theme"}(t.UserSettingTypes||(t.UserSettingTypes={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.conversations=void 0;var r=n(1),o=n(2),i=n(0),a=n(3);!function(e){e.openConversation=function(e){(0,r.ensureInitialized)(o.FrameContexts.content),(0,i.sendMessageToParent)("conversations.openConversation",[{title:e.title,subEntityId:e.subEntityId,conversationId:e.conversationId,channelId:e.channelId,entityId:e.entityId}],(function(e,t){if(!e)throw new Error(t)})),e.onStartConversation&&(0,a.registerHandler)("startConversation",(function(t,n,r,o){return e.onStartConversation({subEntityId:t,conversationId:n,channelId:r,entityId:o})})),e.onCloseConversation&&(0,a.registerHandler)("closeConversation",(function(t,n,r,o){return e.onCloseConversation({subEntityId:t,conversationId:n,channelId:r,entityId:o})}))},e.closeConversation=function(){(0,r.ensureInitialized)(o.FrameContexts.content),(0,i.sendMessageToParent)("conversations.closeConversation"),(0,a.removeHandler)("startConversation"),(0,a.removeHandler)("closeConversation")}}(t.conversations||(t.conversations={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.meetingRoom=void 0;var r=n(1),o=n(0),i=n(3);!function(e){!function(e){e.toggleMute="toggleMute",e.toggleCamera="toggleCamera",e.toggleCaptions="toggleCaptions",e.volume="volume",e.showVideoGallery="showVideoGallery",e.showContent="showContent",e.showVideoGalleryAndContent="showVideoGalleryAndContent",e.showLargeGallery="showLargeGallery",e.showTogether="showTogether",e.leaveMeeting="leaveMeeting"}(e.Capability||(e.Capability={})),e.getPairedMeetingRoomInfo=function(e){(0,r.ensureInitialized)(),(0,o.sendMessageToParent)("meetingRoom.getPairedMeetingRoomInfo",e)},e.sendCommandToPairedMeetingRoom=function(e,t){if(!e||0==e.length)throw new Error("[meetingRoom.sendCommandToPairedMeetingRoom] Command name cannot be null or empty");if(!t)throw new Error("[meetingRoom.sendCommandToPairedMeetingRoom] Callback cannot be null");(0,r.ensureInitialized)(),(0,o.sendMessageToParent)("meetingRoom.sendCommandToPairedMeetingRoom",[e],t)},e.registerMeetingRoomCapabilitiesUpdateHandler=function(e){if(!e)throw new Error("[meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler] Handler cannot be null");(0,r.ensureInitialized)(),(0,i.registerHandler)("meetingRoom.meetingRoomCapabilitiesUpdate",(function(t){(0,r.ensureInitialized)(),e(t)}))},e.registerMeetingRoomStatesUpdateHandler=function(e){if(!e)throw new Error("[meetingRoom.registerMeetingRoomStatesUpdateHandler] Handler cannot be null");(0,r.ensureInitialized)(),(0,i.registerHandler)("meetingRoom.meetingRoomStatesUpdate",(function(t){(0,r.ensureInitialized)(),e(t)}))}}(t.meetingRoom||(t.meetingRoom={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.remoteCamera=void 0;var r=n(1),o=n(2),i=n(0),a=n(3);!function(e){!function(e){e.Reset="Reset",e.ZoomIn="ZoomIn",e.ZoomOut="ZoomOut",e.PanLeft="PanLeft",e.PanRight="PanRight",e.TiltUp="TiltUp",e.TiltDown="TiltDown"}(e.ControlCommand||(e.ControlCommand={})),function(e){e[e.CommandResetError=0]="CommandResetError",e[e.CommandZoomInError=1]="CommandZoomInError",e[e.CommandZoomOutError=2]="CommandZoomOutError",e[e.CommandPanLeftError=3]="CommandPanLeftError",e[e.CommandPanRightError=4]="CommandPanRightError",e[e.CommandTiltUpError=5]="CommandTiltUpError",e[e.CommandTiltDownError=6]="CommandTiltDownError",e[e.SendDataError=7]="SendDataError"}(e.ErrorReason||(e.ErrorReason={})),function(e){e[e.None=0]="None",e[e.ControlDenied=1]="ControlDenied",e[e.ControlNoResponse=2]="ControlNoResponse",e[e.ControlBusy=3]="ControlBusy",e[e.AckTimeout=4]="AckTimeout",e[e.ControlTerminated=5]="ControlTerminated",e[e.ControllerTerminated=6]="ControllerTerminated",e[e.DataChannelError=7]="DataChannelError",e[e.ControllerCancelled=8]="ControllerCancelled",e[e.ControlDisabled=9]="ControlDisabled",e[e.ControlTerminatedToAllowOtherController=10]="ControlTerminatedToAllowOtherController"}(e.SessionTerminatedReason||(e.SessionTerminatedReason={})),e.getCapableParticipants=function(e){if(!e)throw new Error("[remoteCamera.getCapableParticipants] Callback cannot be null");(0,r.ensureInitialized)(o.FrameContexts.sidePanel),(0,i.sendMessageToParent)("remoteCamera.getCapableParticipants",e)},e.requestControl=function(e,t){if(!e)throw new Error("[remoteCamera.requestControl] Participant cannot be null");if(!t)throw new Error("[remoteCamera.requestControl] Callback cannot be null");(0,r.ensureInitialized)(o.FrameContexts.sidePanel),(0,i.sendMessageToParent)("remoteCamera.requestControl",[e],t)},e.sendControlCommand=function(e,t){if(!e)throw new Error("[remoteCamera.sendControlCommand] ControlCommand cannot be null");if(!t)throw new Error("[remoteCamera.sendControlCommand] Callback cannot be null");(0,r.ensureInitialized)(o.FrameContexts.sidePanel),(0,i.sendMessageToParent)("remoteCamera.sendControlCommand",[e],t)},e.terminateSession=function(e){if(!e)throw new Error("[remoteCamera.terminateSession] Callback cannot be null");(0,r.ensureInitialized)(o.FrameContexts.sidePanel),(0,i.sendMessageToParent)("remoteCamera.terminateSession",e)},e.registerOnCapableParticipantsChangeHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnCapableParticipantsChangeHandler] Handler cannot be null");(0,r.ensureInitialized)(o.FrameContexts.sidePanel),(0,a.registerHandler)("remoteCamera.capableParticipantsChange",e)},e.registerOnErrorHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnErrorHandler] Handler cannot be null");(0,r.ensureInitialized)(o.FrameContexts.sidePanel),(0,a.registerHandler)("remoteCamera.handlerError",e)},e.registerOnDeviceStateChangeHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnDeviceStateChangeHandler] Handler cannot be null");(0,r.ensureInitialized)(o.FrameContexts.sidePanel),(0,a.registerHandler)("remoteCamera.deviceStateChange",e)},e.registerOnSessionStatusChangeHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnSessionStatusChangeHandler] Handler cannot be null");(0,r.ensureInitialized)(o.FrameContexts.sidePanel),(0,a.registerHandler)("remoteCamera.sessionStatusChange",e)}}(t.remoteCamera||(t.remoteCamera={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.files=void 0;var r=n(0),o=n(1),i=n(8);!function(e){!function(e){e.Dropbox="DROPBOX",e.Box="BOX",e.Sharefile="SHAREFILE",e.GoogleDrive="GOOGLEDRIVE",e.Egnyte="EGNYTE"}(e.CloudStorageProvider||(e.CloudStorageProvider={})),function(e){e[e.Sharepoint=0]="Sharepoint",e[e.WopiIntegration=1]="WopiIntegration",e[e.Google=2]="Google"}(e.CloudStorageProviderType||(e.CloudStorageProviderType={})),e.getCloudStorageFolders=function(e,t){if((0,o.ensureInitialized)(i.FrameContexts.content),!e||0==e.length)throw new Error("[files.getCloudStorageFolders] channelId name cannot be null or empty");if(!t)throw new Error("[files.getCloudStorageFolders] Callback cannot be null");(0,r.sendMessageToParent)("files.getCloudStorageFolders",[e],t)},e.addCloudStorageFolder=function(e,t){if((0,o.ensureInitialized)(i.FrameContexts.content),!e||0==e.length)throw new Error("[files.addCloudStorageFolder] channelId name cannot be null or empty");if(!t)throw new Error("[files.addCloudStorageFolder] Callback cannot be null");(0,r.sendMessageToParent)("files.addCloudStorageFolder",[e],t)},e.deleteCloudStorageFolder=function(e,t,n){if((0,o.ensureInitialized)(i.FrameContexts.content),!e)throw new Error("[files.deleteCloudStorageFolder] channelId name cannot be null or empty");if(!t)throw new Error("[files.deleteCloudStorageFolder] folderToDelete cannot be null or empty");if(!n)throw new Error("[files.deleteCloudStorageFolder] Callback cannot be null");(0,r.sendMessageToParent)("files.deleteCloudStorageFolder",[e,t],n)},e.getCloudStorageFolderContents=function(e,t,n){if((0,o.ensureInitialized)(i.FrameContexts.content),!e||!t)throw new Error("[files.getCloudStorageFolderContents] folder/providerCode name cannot be null or empty");if(!n)throw new Error("[files.getCloudStorageFolderContents] Callback cannot be null");if("isSubdirectory"in e&&!e.isSubdirectory)throw new Error("[files.getCloudStorageFolderContents] provided folder is not a subDirectory");(0,r.sendMessageToParent)("files.getCloudStorageFolderContents",[e,t],n)},e.openCloudStorageFile=function(e,t,n){if((0,o.ensureInitialized)(i.FrameContexts.content),!e||!t)throw new Error("[files.openCloudStorageFile] file/providerCode cannot be null or empty");if(e.isSubdirectory)throw new Error("[files.openCloudStorageFile] provided file is a subDirectory");(0,r.sendMessageToParent)("files.openCloudStorageFile",[e,t,n])}}(t.files||(t.files={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.appEntity=void 0;var r=n(0),o=n(1),i=n(8);(t.appEntity||(t.appEntity={})).selectAppEntity=function(e,t,n,a){if((0,o.ensureInitialized)(i.FrameContexts.content),!e||0==e.length)throw new Error("[appEntity.selectAppEntity] threadId name cannot be null or empty");if(!a)throw new Error("[appEntity.selectAppEntity] Callback cannot be null");(0,r.sendMessageToParent)("appEntity.selectAppEntity",[e,t,n],a)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.teams=void 0;var r=n(0),o=n(1),i=n(8);!function(e){!function(e){e[e.Regular=0]="Regular",e[e.Private=1]="Private",e[e.Shared=2]="Shared"}(e.ChannelType||(e.ChannelType={})),e.getTeamChannels=function(e,t){if((0,o.ensureInitialized)(i.FrameContexts.content),!e)throw new Error("[teams.getTeamChannels] groupId cannot be null or empty");if(!t)throw new Error("[teams.getTeamChannels] Callback cannot be null");(0,r.sendMessageToParent)("teams.getTeamChannels",[e],t)},e.refreshSiteUrl=function(e,t){if((0,o.ensureInitialized)(),!e)throw new Error("[teams.refreshSiteUrl] threadId cannot be null or empty");if(!t)throw new Error("[teams.refreshSiteUrl] Callback cannot be null");(0,r.sendMessageToParent)("teams.refreshSiteUrl",[e],t)}}(t.teams||(t.teams={}))}])},51206:function(e){e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=90)}({17:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r=n(18),o=function(){function e(){}return e.getFirstMatch=function(e,t){var n=t.match(e);return n&&n.length>0&&n[1]||""},e.getSecondMatch=function(e,t){var n=t.match(e);return n&&n.length>1&&n[2]||""},e.matchAndReturnConst=function(e,t,n){if(e.test(t))return n},e.getWindowsVersionName=function(e){switch(e){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},e.getMacOSVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),10===t[0])switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},e.getAndroidVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),!(1===t[0]&&t[1]<5))return 1===t[0]&&t[1]<6?"Cupcake":1===t[0]&&t[1]>=6?"Donut":2===t[0]&&t[1]<2?"Eclair":2===t[0]&&2===t[1]?"Froyo":2===t[0]&&t[1]>2?"Gingerbread":3===t[0]?"Honeycomb":4===t[0]&&t[1]<1?"Ice Cream Sandwich":4===t[0]&&t[1]<4?"Jelly Bean":4===t[0]&&t[1]>=4?"KitKat":5===t[0]?"Lollipop":6===t[0]?"Marshmallow":7===t[0]?"Nougat":8===t[0]?"Oreo":9===t[0]?"Pie":void 0},e.getVersionPrecision=function(e){return e.split(".").length},e.compareVersions=function(t,n,r){void 0===r&&(r=!1);var o=e.getVersionPrecision(t),i=e.getVersionPrecision(n),a=Math.max(o,i),s=0,c=e.map([t,n],(function(t){var n=a-e.getVersionPrecision(t),r=t+new Array(n+1).join(".0");return e.map(r.split("."),(function(e){return new Array(20-e.length).join("0")+e})).reverse()}));for(r&&(s=a-Math.min(o,i)),a-=1;a>=s;){if(c[0][a]>c[1][a])return 1;if(c[0][a]===c[1][a]){if(a===s)return 0;a-=1}else if(c[0][a]<c[1][a])return-1}},e.map=function(e,t){var n,r=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(n=0;n<e.length;n+=1)r.push(t(e[n]));return r},e.find=function(e,t){var n,r;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(n=0,r=e.length;n<r;n+=1){var o=e[n];if(t(o,n))return o}},e.assign=function(e){for(var t,n,r=e,o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];if(Object.assign)return Object.assign.apply(Object,[e].concat(i));var s=function(){var e=i[t];"object"==typeof e&&null!==e&&Object.keys(e).forEach((function(t){r[t]=e[t]}))};for(t=0,n=i.length;t<n;t+=1)s();return e},e.getBrowserAlias=function(e){return r.BROWSER_ALIASES_MAP[e]},e.getBrowserTypeByAlias=function(e){return r.BROWSER_MAP[e]||""},e}();t.default=o,e.exports=t.default},18:function(e,t,n){"use strict";t.__esModule=!0,t.ENGINE_MAP=t.OS_MAP=t.PLATFORMS_MAP=t.BROWSER_MAP=t.BROWSER_ALIASES_MAP=void 0,t.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},t.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},t.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},t.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},t.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,o=(r=n(91))&&r.__esModule?r:{default:r},i=n(18);function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(){}var t,n;return e.getParser=function(e,t){if(void 0===t&&(t=!1),"string"!=typeof e)throw new Error("UserAgent should be a string");return new o.default(e,t)},e.parse=function(e){return new o.default(e).getResult()},t=e,n=[{key:"BROWSER_MAP",get:function(){return i.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return i.ENGINE_MAP}},{key:"OS_MAP",get:function(){return i.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return i.PLATFORMS_MAP}}],null&&a(t.prototype,null),n&&a(t,n),e}();t.default=s,e.exports=t.default},91:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r=c(n(92)),o=c(n(93)),i=c(n(94)),a=c(n(95)),s=c(n(17));function c(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(e,t){if(void 0===t&&(t=!1),null==e||""===e)throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},!0!==t&&this.parse()}var t=e.prototype;return t.getUA=function(){return this._ua},t.test=function(e){return e.test(this._ua)},t.parseBrowser=function(){var e=this;this.parsedResult.browser={};var t=s.default.find(r.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser},t.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},t.getBrowserName=function(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},t.getBrowserVersion=function(){return this.getBrowser().version},t.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},t.parseOS=function(){var e=this;this.parsedResult.os={};var t=s.default.find(o.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os},t.getOSName=function(e){var t=this.getOS().name;return e?String(t).toLowerCase()||"":t||""},t.getOSVersion=function(){return this.getOS().version},t.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},t.getPlatformType=function(e){void 0===e&&(e=!1);var t=this.getPlatform().type;return e?String(t).toLowerCase()||"":t||""},t.parsePlatform=function(){var e=this;this.parsedResult.platform={};var t=s.default.find(i.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform},t.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},t.getEngineName=function(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},t.parseEngine=function(){var e=this;this.parsedResult.engine={};var t=s.default.find(a.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.engine=t.describe(this.getUA())),this.parsedResult.engine},t.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},t.getResult=function(){return s.default.assign({},this.parsedResult)},t.satisfies=function(e){var t=this,n={},r=0,o={},i=0;if(Object.keys(e).forEach((function(t){var a=e[t];"string"==typeof a?(o[t]=a,i+=1):"object"==typeof a&&(n[t]=a,r+=1)})),r>0){var a=Object.keys(n),c=s.default.find(a,(function(e){return t.isOS(e)}));if(c){var u=this.satisfies(n[c]);if(void 0!==u)return u}var l=s.default.find(a,(function(e){return t.isPlatform(e)}));if(l){var d=this.satisfies(n[l]);if(void 0!==d)return d}}if(i>0){var p=Object.keys(o),h=s.default.find(p,(function(e){return t.isBrowser(e,!0)}));if(void 0!==h)return this.compareVersion(o[h])}},t.isBrowser=function(e,t){void 0===t&&(t=!1);var n=this.getBrowserName().toLowerCase(),r=e.toLowerCase(),o=s.default.getBrowserTypeByAlias(r);return t&&o&&(r=o.toLowerCase()),r===n},t.compareVersion=function(e){var t=[0],n=e,r=!1,o=this.getBrowserVersion();if("string"==typeof o)return">"===e[0]||"<"===e[0]?(n=e.substr(1),"="===e[1]?(r=!0,n=e.substr(2)):t=[],">"===e[0]?t.push(1):t.push(-1)):"="===e[0]?n=e.substr(1):"~"===e[0]&&(r=!0,n=e.substr(1)),t.indexOf(s.default.compareVersions(o,n,r))>-1},t.isOS=function(e){return this.getOSName(!0)===String(e).toLowerCase()},t.isPlatform=function(e){return this.getPlatformType(!0)===String(e).toLowerCase()},t.isEngine=function(e){return this.getEngineName(!0)===String(e).toLowerCase()},t.is=function(e,t){return void 0===t&&(t=!1),this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)},t.some=function(e){var t=this;return void 0===e&&(e=[]),e.some((function(e){return t.is(e)}))},e}();t.default=u,e.exports=t.default},92:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,o=(r=n(17))&&r.__esModule?r:{default:r},i=/version\/(\d+(\.?_?\d+)+)/i,a=[{test:[/googlebot/i],describe:function(e){var t={name:"Googlebot"},n=o.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/opera/i],describe:function(e){var t={name:"Opera"},n=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/opr\/|opios/i],describe:function(e){var t={name:"Opera"},n=o.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/SamsungBrowser/i],describe:function(e){var t={name:"Samsung Internet for Android"},n=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Whale/i],describe:function(e){var t={name:"NAVER Whale Browser"},n=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/MZBrowser/i],describe:function(e){var t={name:"MZ Browser"},n=o.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/focus/i],describe:function(e){var t={name:"Focus"},n=o.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/swing/i],describe:function(e){var t={name:"Swing"},n=o.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/coast/i],describe:function(e){var t={name:"Opera Coast"},n=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(e){var t={name:"Opera Touch"},n=o.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,e)||o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/yabrowser/i],describe:function(e){var t={name:"Yandex Browser"},n=o.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/ucbrowser/i],describe:function(e){var t={name:"UC Browser"},n=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Maxthon|mxios/i],describe:function(e){var t={name:"Maxthon"},n=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/epiphany/i],describe:function(e){var t={name:"Epiphany"},n=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/puffin/i],describe:function(e){var t={name:"Puffin"},n=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sleipnir/i],describe:function(e){var t={name:"Sleipnir"},n=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/k-meleon/i],describe:function(e){var t={name:"K-Meleon"},n=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/micromessenger/i],describe:function(e){var t={name:"WeChat"},n=o.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/qqbrowser/i],describe:function(e){var t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},n=o.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/msie|trident/i],describe:function(e){var t={name:"Internet Explorer"},n=o.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/\sedg\//i],describe:function(e){var t={name:"Microsoft Edge"},n=o.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/edg([ea]|ios)/i],describe:function(e){var t={name:"Microsoft Edge"},n=o.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/vivaldi/i],describe:function(e){var t={name:"Vivaldi"},n=o.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/seamonkey/i],describe:function(e){var t={name:"SeaMonkey"},n=o.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sailfish/i],describe:function(e){var t={name:"Sailfish"},n=o.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return n&&(t.version=n),t}},{test:[/silk/i],describe:function(e){var t={name:"Amazon Silk"},n=o.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/phantom/i],describe:function(e){var t={name:"PhantomJS"},n=o.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/slimerjs/i],describe:function(e){var t={name:"SlimerJS"},n=o.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t={name:"BlackBerry"},n=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t={name:"WebOS Browser"},n=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/bada/i],describe:function(e){var t={name:"Bada"},n=o.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/tizen/i],describe:function(e){var t={name:"Tizen"},n=o.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/qupzilla/i],describe:function(e){var t={name:"QupZilla"},n=o.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/firefox|iceweasel|fxios/i],describe:function(e){var t={name:"Firefox"},n=o.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/electron/i],describe:function(e){var t={name:"Electron"},n=o.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/MiuiBrowser/i],describe:function(e){var t={name:"Miui"},n=o.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/chromium/i],describe:function(e){var t={name:"Chromium"},n=o.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/chrome|crios|crmo/i],describe:function(e){var t={name:"Chrome"},n=o.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/GSA/i],describe:function(e){var t={name:"Google Search"},n=o.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){var t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe:function(e){var t={name:"Android Browser"},n=o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/playstation 4/i],describe:function(e){var t={name:"PlayStation 4"},n=o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/safari|applewebkit/i],describe:function(e){var t={name:"Safari"},n=o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/.*/i],describe:function(e){var t=-1!==e.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:o.default.getFirstMatch(t,e),version:o.default.getSecondMatch(t,e)}}}];t.default=a,e.exports=t.default},93:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,o=(r=n(17))&&r.__esModule?r:{default:r},i=n(18),a=[{test:[/Roku\/DVP/],describe:function(e){var t=o.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:i.OS_MAP.Roku,version:t}}},{test:[/windows phone/i],describe:function(e){var t=o.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:i.OS_MAP.WindowsPhone,version:t}}},{test:[/windows /i],describe:function(e){var t=o.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),n=o.default.getWindowsVersionName(t);return{name:i.OS_MAP.Windows,version:t,versionName:n}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(e){var t={name:i.OS_MAP.iOS},n=o.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return n&&(t.version=n),t}},{test:[/macintosh/i],describe:function(e){var t=o.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),n=o.default.getMacOSVersionName(t),r={name:i.OS_MAP.MacOS,version:t};return n&&(r.versionName=n),r}},{test:[/(ipod|iphone|ipad)/i],describe:function(e){var t=o.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:i.OS_MAP.iOS,version:t}}},{test:function(e){var t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe:function(e){var t=o.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),n=o.default.getAndroidVersionName(t),r={name:i.OS_MAP.Android,version:t};return n&&(r.versionName=n),r}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t=o.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),n={name:i.OS_MAP.WebOS};return t&&t.length&&(n.version=t),n}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t=o.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||o.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||o.default.getFirstMatch(/\bbb(\d+)/i,e);return{name:i.OS_MAP.BlackBerry,version:t}}},{test:[/bada/i],describe:function(e){var t=o.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:i.OS_MAP.Bada,version:t}}},{test:[/tizen/i],describe:function(e){var t=o.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:i.OS_MAP.Tizen,version:t}}},{test:[/linux/i],describe:function(){return{name:i.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:i.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(e){var t=o.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:i.OS_MAP.PlayStation4,version:t}}}];t.default=a,e.exports=t.default},94:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,o=(r=n(17))&&r.__esModule?r:{default:r},i=n(18),a=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(e){var t=o.default.getFirstMatch(/(can-l01)/i,e)&&"Nova",n={type:i.PLATFORMS_MAP.mobile,vendor:"Huawei"};return t&&(n.model=t),n}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet}}},{test:function(e){var t=e.test(/ipod|iphone/i),n=e.test(/like (ipod|iphone)/i);return t&&!n},describe:function(e){var t=o.default.getFirstMatch(/(ipod|iphone)/i,e);return{type:i.PLATFORMS_MAP.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:i.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:i.PLATFORMS_MAP.mobile}}},{test:function(e){return"blackberry"===e.getBrowserName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(e){return"bada"===e.getBrowserName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.mobile}}},{test:function(e){return"windows phone"===e.getBrowserName()},describe:function(){return{type:i.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(e){var t=Number(String(e.getOSVersion()).split(".")[0]);return"android"===e.getOSName(!0)&&t>=3},describe:function(){return{type:i.PLATFORMS_MAP.tablet}}},{test:function(e){return"android"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.mobile}}},{test:function(e){return"macos"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(e){return"windows"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.desktop}}},{test:function(e){return"linux"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.desktop}}},{test:function(e){return"playstation 4"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.tv}}},{test:function(e){return"roku"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.tv}}}];t.default=a,e.exports=t.default},95:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,o=(r=n(17))&&r.__esModule?r:{default:r},i=n(18),a=[{test:function(e){return"microsoft edge"===e.getBrowserName(!0)},describe:function(e){if(/\sedg\//i.test(e))return{name:i.ENGINE_MAP.Blink};var t=o.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:i.ENGINE_MAP.EdgeHTML,version:t}}},{test:[/trident/i],describe:function(e){var t={name:i.ENGINE_MAP.Trident},n=o.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){return e.test(/presto/i)},describe:function(e){var t={name:i.ENGINE_MAP.Presto},n=o.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){var t=e.test(/gecko/i),n=e.test(/like gecko/i);return t&&!n},describe:function(e){var t={name:i.ENGINE_MAP.Gecko},n=o.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:i.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(e){var t={name:i.ENGINE_MAP.WebKit},n=o.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}}];t.default=a,e.exports=t.default}})},22827:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AI=void 0,n(96674),n(48134);t.AI=Object.freeze({custom:function(e){},trackException:function(e){},trackEvent:function(e,t){},trackMetric:function(e,t){},trackTrace:function(e,t){},startTrackEvent:function(e){},stopTrackEvent:function(e,t,n){},flushBuffer:function(){},setAuthenticatedUserContext:function(e,t){}})},98917:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.client=void 0;const r=n(80869),o=n(48134).AppConfig.AuthClient.AppId;t.client=new r.PublicClientApplication({auth:{clientId:o,authority:"https://login.microsoftonline.com/organizations/",navigateToLoginRequestUrl:!1},cache:{cacheLocation:"localStorage"}})},2264:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const a=i(n(52303)),s=n(62975),c=n(98917),u=n(22827);a.initialize((async function(){try{const e=await c.client.handleRedirectPromise();null===e?(a.authentication.notifyFailure("no redirect resonse"),u.AI.trackEvent({name:"AuthResponseNull"})):a.authentication.notifySuccess(JSON.stringify(e))}catch(e){u.AI.trackException({error:e}),(0,s.isUnknownObject)(e)&&"name"in e&&"message"in e?a.authentication.notifyFailure(`${e.name}: ${e.message}`):a.authentication.notifyFailure("Unexpected error")}}))},5341:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.traceAsync=t.trace=t.error=t.warn=t.info=void 0,n(62975),n(22827);t.info=function(...e){},t.warn=function(...e){},t.error=function(...e){},t.trace=function(e,t,n){return n},t.traceAsync=function(e=!1){return function(e,t,n){return n}}},62975:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.b64toBlob=t.blob2dataUrl=t.hashBlob=t.isGraphHostedContentUrl=t.storage=t.isUnknownObject=t.fixMessageLink=t.delay=t.safeStringify=t.cancellationNoThrow=t.cancellation=t.OperationCancelled=t.nop=t.filterNull=t.assert1=t.assertT=t.assert=void 0;const a=n(5341),s=i(n(51206));t.assert=function(e,t="value"){if(null==e)throw new Error(`${t} must not be null or undefined`);return e},t.assertT=function(e,t,n="value"){if("string"==typeof t&&typeof e!==t)throw new Error(`${n} is not of type ${t}`);if("function"==typeof t&&!t(e))throw new Error(`${n} is not of the expected type`);return e},t.assert1=function(e,t="value"){if(null==e)throw new Error(`${t} must not be null or undefined`)},t.filterNull=function(e){return null!==e},t.nop=function(){};class c extends Error{constructor(){super("Cancelled by user request")}}t.OperationCancelled=c,t.cancellation=function(){let e=!1;return[function(){e=!0},function(){if(e)throw new c}]},t.cancellationNoThrow=function(){let e=!1;return[function(){e=!0},function(){return e}]},t.safeStringify=function(e){if("string"==typeof e)return e;const t=new WeakSet,n=(e,n)=>{if("object"==typeof n&&null!==n){if(t.has(n))return"[already seen]";t.add(n)}return n};try{return JSON.stringify(e,n,4)}catch(e){return"[safeStringify: error]"}},t.delay=(e,t)=>new Promise(((n,r)=>{let o=-1,i=-1,a=!1;const s=()=>{a&&(o>=0&&clearTimeout(o),i>=0&&clearInterval(i),o=i=-1)};if(t){const e=()=>{try{if(t())return a=!0,n(),!0}catch(e){return a=!0,r(new c),!0}finally{s()}return!1};if(e())return;i=setInterval(e,50)}o=setTimeout((()=>{a=!0,n(),s()}),e)})),t.fixMessageLink=function(e){if("string"!=typeof e||""===e.trim())return"";try{const t=new URL(e);return t.pathname=decodeURIComponent(t.pathname),t.toString()}catch(e){return(0,a.warn)("invalid url",e),""}},t.isUnknownObject=function(e){return null!==e&&"object"==typeof e},t.storage=(()=>{const e="firefox"===s.getParser(navigator.userAgent).getBrowserName(!0),n=navigator.storage&&"function"==typeof navigator.storage.persist&&"function"==typeof navigator.storage.persisted,r=function(){try{return window.self!==window.top}catch(e){return!0}}();let o=!0;return async function(){if(n&&!await navigator.storage.persisted())for(o=!1;!(o=await navigator.storage.persisted());)e||(o=await navigator.storage.persist()),await(0,t.delay)(2e4)}().catch(a.error),Object.freeze({granted:()=>o,askForPermission:n&&e,needNewWindow:r&&e})})();const u=/^https:\/\/graph\.microsoft\.com\/.*\/teams\/[a-zA-Z0-9-]{36}\/channels\/[^/]+\/messages\/[0-9]+\/(replies\/[0-9]+\/)?hostedContents\//i,l=/^https:\/\/graph\.microsoft\.com\/.*\/chats\/[^/]+\/messages\/[0-9]+\/hostedContents\//i;t.isGraphHostedContentUrl=function(e){try{new URL(e)}catch(e){return!1}return u.test(e)||l.test(e)},t.hashBlob=async function(e){const t=await function(e){if(e.arrayBuffer)return e.arrayBuffer();{const t=new FileReader;return t.readAsArrayBuffer(e),new Promise((function(e,n){t.onload=t.onerror=function(r){t.onload=t.onerror=null,"load"===r.type&&t.result instanceof ArrayBuffer?e(t.result):n(new Error("Failed to read the blob"))}}))}}(e);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",t))).map((e=>e.toString(16).padStart(2,"0"))).join("")},t.blob2dataUrl=async function(e){const t=new FileReader;return t.readAsDataURL(e),new Promise((function(e,n){t.onload=t.onerror=function(r){t.onload=t.onerror=null,"load"===r.type&&"string"==typeof t.result?e(t.result):n(new Error("Failed to read the blob"))}}))},t.b64toBlob=function(e,t=512){(0,a.info)(` b64toBlob START b64Data: [${e}] `);let n="";const r=e.indexOf(";");if(r>0){const t=e.substring(0,r),o=t.indexOf(":")+1;n=t.substring(o),(0,a.info)(`header [${t} start: [${o}] ==> contentType: [${n}]`)}const o=atob(e.replace(/^.*,/,"")),i=[];for(let e=0;e<o.length;e+=t){const n=o.slice(e,e+t),r=new Array(n.length);for(let e=0;e<n.length;e++)r[e]=n.charCodeAt(e);const a=new Uint8Array(r);i.push(a)}const s=new Blob(i,{type:n});return(0,a.info)(" b64toBlob END "),s}},48134:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AppConfig=void 0,t.AppConfig={AppInfo:{name:null!=="FindMsg"?"FindMsg":"",appName:null!=="G Message Finder"?"G Message Finder":"",logo:("https://static2.sharepointonline.com/files/fabric/assets/brand-icons/product-fluent/svg/teams_48x1.svg","https://static2.sharepointonline.com/files/fabric/assets/brand-icons/product-fluent/svg/teams_48x1.svg"),host:null!=="kacomsrd.github.io"?"kacomsrd.github.io":""},AuthClient:{AppId:null!=="67dc74f0-fb8c-47a4-8435-63253a3fc3bb"?"67dc74f0-fb8c-47a4-8435-63253a3fc3bb":""},AppInsight:{instrumentationKey:null!=="474f6161-5de0-419b-baa4-9d57b2abdb37"?"474f6161-5de0-419b-baa4-9d57b2abdb37":""}}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}return n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(2264)})()}));
//# sourceMappingURL=authEnd.js.map