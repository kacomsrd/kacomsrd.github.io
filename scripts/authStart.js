!function webpackUniversalModuleDefinition(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.tased=t():e.tased=t()}(window,(function(){return function(e){var t={};function __webpack_require__(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,__webpack_require__),n.l=!0,n.exports}return __webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.d=function(e,t,r){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.t=function(e,t){if(1&t&&(e=__webpack_require__(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(__webpack_require__.r(r),
Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)__webpack_require__.d(r,n,function(t){return e[t]}.bind(null,n));return r},__webpack_require__.n=function(e){var t=e&&e.__esModule?function getDefault(){return e.default}:function getModuleExports(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="/scripts/",__webpack_require__(__webpack_require__.s=474)}({104:function(e,t,r){"use strict";r.r(t),r.d(t,"AuthError",(function(){return i})),r.d(t,"AuthErrorMessage",(function(){return o})),r.d(t,"BrowserAuthError",(function(){return Bt})),r.d(t,"BrowserAuthErrorMessage",(function(){return xt})),r.d(t,"BrowserConfigurationAuthError",(function(){return $t})),r.d(t,"BrowserConfigurationAuthErrorMessage",(function(){return Yt})),r.d(t,"InteractionRequiredAuthError",(function(){return Ct})),r.d(t,"LogLevel",(function(){return n})),
r.d(t,"Logger",(function(){return J})),r.d(t,"PublicClientApplication",(function(){return sr}));var extendStatics=function(e,t){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function __extends(e,t){function __(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}var __assign=function(){return(__assign=Object.assign||function __assign(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function __awaiter(e,t,r,n){return new(r||(r=Promise))((function(o,i){function fulfilled(e){try{step(n.next(e))}catch(e){i(e)}}function rejected(e){try{step(n.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):new r((function(t){t(e.value)})).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))}
function __generator(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function verb(i){return function(c){return function step(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){
i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}}function __spreadArrays(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,c=i.length;a<c;a++,o++)n[o]=i[a];return n}var extendStatics$1=function(e,t){return(extendStatics$1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function __extends$1(e,t){function __(){this.constructor=e}extendStatics$1(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}var __assign$1=function(){return(__assign$1=Object.assign||function __assign(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function __awaiter$1(e,t,r,n){return new(r||(r=Promise))((function(o,i){function fulfilled(e){try{
step(n.next(e))}catch(e){i(e)}}function rejected(e){try{step(n.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):new r((function(t){t(e.value)})).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))}function __generator$1(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function verb(i){return function(c){return function step(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}
if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}}var n,o={unexpectedError:{code:"unexpected_error",desc:"Unexpected error in authentication."}},i=function(e){function AuthError(t,r){var n=this,o=r?t+": "+r:t;return n=e.call(this,o)||this,Object.setPrototypeOf(n,AuthError.prototype),n.errorCode=t,n.errorMessage=r,n.name="AuthError",n}return __extends$1(AuthError,e),AuthError.createUnexpectedError=function(e){return new AuthError(o.unexpectedError.code,o.unexpectedError.desc+": "+e)},AuthError}(Error),a="1.2.0",c={code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},s={code:"client_info_empty_error",
desc:"The client info was empty. Please review the trace to determine the root cause."},u={code:"id_token_parsing_error",desc:"ID token cannot be parsed. Please review stack trace to determine root cause."},l={code:"null_or_empty_id_token",desc:"The idToken is null or empty. Please review the trace to determine the root cause."},d={code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},h={code:"invalid_authority_type",desc:"The given authority is not a valid type of authority supported by MSAL. Please review the trace to determine the root cause."},p={code:"hash_not_deserialized",desc:"The hash parameters could not be deserialized. Please review the trace to determine the root cause."},f={code:"invalid_state",desc:"State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState()."},g={code:"state_mismatch",
desc:"State mismatch error. Please check your network. Continued requests may cause cache overflow."},y={code:"nonce_mismatch",desc:"Nonce mismatch error. This may be caused by a race condition in concurrent requests."},E={code:"account_mismatch",desc:"The cached account and account which made the token request do not match."},C={code:"invalid_id_token",desc:"Invalid ID token format."},m={code:"no_tokens_found",desc:"No tokens were found for the given scopes, and no authorization code was passed to acquireToken. You must retrieve an authorization code before making a call to acquireToken()."},w={code:"cache_parse_error",desc:"Could not parse cache key."},_={code:"user_login_error",desc:"User login is required."},v={code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account."},A={code:"multiple_matching_accounts",
desc:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account"},S={code:"request_cannot_be_made",desc:"Token request cannot be made without authorization code or refresh token."},T={code:"cannot_append_empty_scope",desc:"Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info."},I={code:"cannot_remove_empty_scope",desc:"Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info."},R={code:"cannot_append_scopeset",desc:"Cannot append ScopeSet due to error."},b={code:"empty_input_scopeset",desc:"Empty input ScopeSet cannot be processed."},O={code:"device_code_polling_cancelled",desc:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true."},P={code:"device_code_expired",desc:"Device code is expired."},k={code:"no_account_in_silent_request",
desc:"Please pass an account object, silent flow is not supported without account information"},N={code:"invalid_cache_record",desc:"Cache record object was null or undefined."},U={code:"invalid_cache_environment",desc:"Invalid environment when attempting to create cache entry"},M={code:"no_account_found",desc:"No account found in cache for given key."},q={code:"no cache plugin set on CacheManager",desc:"ICachePlugin needs to be set before using readFromStorage or writeFromStorage"},D={code:"no_crypto_object",desc:"No crypto object detected. This is required for the following operation: "},H={code:"invalid_cache_type",desc:"Invalid cache type"},L={code:"unexpected_account_type",desc:"Unexpected account type."},x={code:"unexpected_credential_type",desc:"Unexpected credential type."},B={code:"invalid_assertion",desc:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515"},K={code:"invalid_client_credential",
desc:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential"},F=function(e){function ClientAuthError(t,r){var n=e.call(this,t,r)||this;return n.name="ClientAuthError",Object.setPrototypeOf(n,ClientAuthError.prototype),n}return __extends$1(ClientAuthError,e),ClientAuthError.createClientInfoDecodingError=function(e){return new ClientAuthError(c.code,c.desc+" Failed with error: "+e)},ClientAuthError.createClientInfoEmptyError=function(e){return new ClientAuthError(s.code,s.desc+" Given Object: "+e)},ClientAuthError.createIdTokenParsingError=function(e){return new ClientAuthError(u.code,u.desc+" Failed with error: "+e)},ClientAuthError.createIdTokenNullOrEmptyError=function(e){return new ClientAuthError(l.code,l.desc+" Raw ID Token Value: "+e)},ClientAuthError.createEndpointDiscoveryIncompleteError=function(e){return new ClientAuthError(d.code,d.desc+" Detail: "+e)},
ClientAuthError.createInvalidAuthorityTypeError=function(e){return new ClientAuthError(h.code,h.desc+" Given Url: "+e)},ClientAuthError.createHashNotDeserializedError=function(e){return new ClientAuthError(p.code,p.desc+" Given Object: "+e)},ClientAuthError.createInvalidStateError=function(e,t){return new ClientAuthError(f.code,f.desc+" Invalid State: "+e+", Root Err: "+t)},ClientAuthError.createStateMismatchError=function(){return new ClientAuthError(g.code,g.desc)},ClientAuthError.createNonceMismatchError=function(){return new ClientAuthError(y.code,y.desc)},ClientAuthError.createAccountMismatchError=function(){return new ClientAuthError(E.code,E.desc)},ClientAuthError.createInvalidIdTokenError=function(e){return new ClientAuthError(C.code,C.desc+" Given token: "+JSON.stringify(e))},ClientAuthError.createNoTokensFoundError=function(){return new ClientAuthError(m.code,m.desc)},ClientAuthError.createCacheParseError=function(e){return new ClientAuthError(w.code,w.desc+" Cache key: "+e)
},ClientAuthError.createUserLoginRequiredError=function(){return new ClientAuthError(_.code,_.desc)},ClientAuthError.createMultipleMatchingTokensInCacheError=function(e){return new ClientAuthError(v.code,"Cache error for scope "+e+": "+v.desc+".")},ClientAuthError.createMultipleMatchingAccountsInCacheError=function(){return new ClientAuthError(A.code,A.desc)},ClientAuthError.createTokenRequestCannotBeMadeError=function(){return new ClientAuthError(S.code,S.desc)},ClientAuthError.createAppendEmptyScopeToSetError=function(e){return new ClientAuthError(T.code,T.desc+" Given Scope: "+e)},ClientAuthError.createRemoveEmptyScopeFromSetError=function(e){return new ClientAuthError(I.code,I.desc+" Given Scope: "+e)},ClientAuthError.createAppendScopeSetError=function(e){return new ClientAuthError(R.code,R.desc+" Detail Error: "+e)},ClientAuthError.createEmptyInputScopeSetError=function(e){return new ClientAuthError(b.code,b.desc+" Given ScopeSet: "+e)},
ClientAuthError.createDeviceCodeCancelledError=function(){return new ClientAuthError(O.code,""+O.desc)},ClientAuthError.createDeviceCodeExpiredError=function(){return new ClientAuthError(P.code,""+P.desc)},ClientAuthError.createNoAccountInSilentRequestError=function(){return new ClientAuthError(k.code,""+k.desc)},ClientAuthError.createNullOrUndefinedCacheRecord=function(){return new ClientAuthError(N.code,N.desc)},ClientAuthError.createInvalidCacheEnvironmentError=function(){return new ClientAuthError(U.code,U.desc)},ClientAuthError.createNoAccountFoundError=function(){return new ClientAuthError(M.code,M.desc)},ClientAuthError.createCachePluginError=function(){return new ClientAuthError(q.code,""+q.desc)},ClientAuthError.createNoCryptoObjectError=function(e){return new ClientAuthError(D.code,""+D.desc+e)},ClientAuthError.createInvalidCacheTypeError=function(){return new ClientAuthError(H.code,""+H.desc)},ClientAuthError.createUnexpectedAccountTypeError=function(){
return new ClientAuthError(L.code,""+L.desc)},ClientAuthError.createUnexpectedCredentialTypeError=function(){return new ClientAuthError(x.code,""+x.desc)},ClientAuthError.createInvalidAssertionError=function(){return new ClientAuthError(B.code,""+B.desc)},ClientAuthError.createInvalidCredentialError=function(){return new ClientAuthError(K.code,""+K.desc)},ClientAuthError}(i),j=function(){function StringUtils(){}return StringUtils.decodeJwt=function(e){if(StringUtils.isEmpty(e))throw F.createIdTokenNullOrEmptyError(e);var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);if(!t||t.length<4)throw F.createIdTokenParsingError("Given token is malformed: "+JSON.stringify(e));return{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},StringUtils.isEmpty=function(e){return void 0===e||!e||0===e.length},StringUtils.startsWith=function(e,t){return 0===e.indexOf(t)},StringUtils.endsWith=function(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length},StringUtils.queryStringToObject=function(e){
var t,r=/\+/g,n=/([^&=]+)=([^&]*)/g,decode=function(e){return decodeURIComponent(decodeURIComponent(e.replace(r," ")))},o={};for(t=n.exec(e);t;)o[decode(t[1])]=decode(t[2]),t=n.exec(e);return o},StringUtils.trimArrayEntries=function(e){return e.map((function(e){return e.trim()}))},StringUtils.removeEmptyStringsFromArray=function(e){return e.filter((function(e){return!StringUtils.isEmpty(e)}))},StringUtils}();!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(n||(n={}));var G,z,Y,$,V,W,J=function(){function Logger(e){this.level=n.Info,e&&(this.localCallback=e.loggerCallback,this.piiLoggingEnabled=e.piiLoggingEnabled,this.level=e.logLevel)}return Logger.prototype.logMessage=function(e,t){if(!(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)){var r=(new Date).toUTCString(),o=(j.isEmpty(this.correlationId)?"["+r+"] : ":"["+r+"] : ["+this.correlationId+"]")+" : "+a+" : "+n[t.logLevel]+" - "+e
;this.executeCallback(t.logLevel,o,t.containsPii)}},Logger.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},Logger.prototype.error=function(e,t){this.logMessage(e,{logLevel:n.Error,containsPii:!1,correlationId:t||""})},Logger.prototype.errorPii=function(e,t){this.logMessage(e,{logLevel:n.Error,containsPii:!0,correlationId:t||""})},Logger.prototype.warning=function(e,t){this.logMessage(e,{logLevel:n.Warning,containsPii:!1,correlationId:t||""})},Logger.prototype.warningPii=function(e,t){this.logMessage(e,{logLevel:n.Warning,containsPii:!0,correlationId:t||""})},Logger.prototype.info=function(e,t){this.logMessage(e,{logLevel:n.Info,containsPii:!1,correlationId:t||""})},Logger.prototype.infoPii=function(e,t){this.logMessage(e,{logLevel:n.Info,containsPii:!0,correlationId:t||""})},Logger.prototype.verbose=function(e,t){this.logMessage(e,{logLevel:n.Verbose,containsPii:!1,correlationId:t||""})},Logger.prototype.verbosePii=function(e,t){
this.logMessage(e,{logLevel:n.Verbose,containsPii:!0,correlationId:t||""})},Logger.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},Logger}(),Q="MSAL.JS",X="msal.js.common",Z="msal",ee="https://login.microsoftonline.com/common/",te="adfs",re="https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",ne="|",oe="openid",ie="profile",ae="offline_access",ce="code",se="S256",ue="application/x-www-form-urlencoded;charset=utf-8",le="authorization_pending",de="not_defined";!function(e){e.CONTENT_TYPE="Content-Type",e.X_CLIENT_CURR_TELEM="x-client-current-telemetry",e.X_CLIENT_LAST_TELEM="x-client-last-telemetry"}(G||(G={})),function(e){e.ID_TOKEN="idtoken",e.CLIENT_INFO="client.info",e.ADAL_ID_TOKEN="adal.idtoken",e.ERROR="error",e.ERROR_DESC="error.description"}(z||(z={})),function(e){e.COMMON="common",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers"}(Y||(Y={})),function(e){e.CLIENT_ID="client_id",
e.REDIRECT_URI="redirect_uri",e.RESPONSE_TYPE="response_type",e.RESPONSE_MODE="response_mode",e.GRANT_TYPE="grant_type",e.CLAIMS="claims",e.SCOPE="scope",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.REFRESH_TOKEN="refresh_token",e.EXPIRES_IN="expires_in",e.STATE="state",e.NONCE="nonce",e.PROMPT="prompt",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info",e.CODE="code",e.CODE_CHALLENGE="code_challenge",e.CODE_CHALLENGE_METHOD="code_challenge_method",e.CODE_VERIFIER="code_verifier",e.CLIENT_REQUEST_ID="client-request-id",e.X_CLIENT_SKU="x-client-SKU",e.X_CLIENT_VER="x-client-VER",e.X_CLIENT_OS="x-client-OS",e.X_CLIENT_CPU="x-client-CPU",e.POST_LOGOUT_URI="post_logout_redirect_uri",e.DEVICE_CODE="device_code",e.CLIENT_SECRET="client_secret",e.CLIENT_ASSERTION="client_assertion",e.CLIENT_ASSERTION_TYPE="client_assertion_type"}($||($={})),function(e){e.ISSUER="iss",e.OBJID="oid",e.SUBJECT="sub",e.TENANTID="tid",
e.VERSION="ver",e.PREF_USERNAME="preferred_username",e.NAME="name",e.NONCE="nonce",e.EXPIRATION="exp",e.HOME_OBJID="home_oid",e.SESSIONID="sid",e.CLOUD_INSTANCE_HOSTNAME="cloud_instance_host_name"}(V||(V={})),function(e){e.ACCESS_TOKEN="access_token",e.XMS_CC="xms_cc"}(W||(W={}));var he,pe={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"};!function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ID_TOKEN="id_token",e.DOMAIN_HINT="domain_hint",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"}(he||(he={}));he.SID,he.LOGIN_HINT;var fe,ge,ye,Ee,Ce,me,we,_e={PLAIN:"plain",S256:"S256"};!function(e){e.QUERY="query",e.FRAGMENT="fragment",e.FORM_POST="form_post"}(fe||(fe={})),function(e){e.IMPLICIT_GRANT="implicit",e.AUTHORIZATION_CODE_GRANT="authorization_code",e.CLIENT_CREDENTIALS_GRANT="client_credentials",e.RESOURCE_OWNER_PASSWORD_GRANT="password",
e.REFRESH_TOKEN_GRANT="refresh_token",e.DEVICE_CODE_GRANT="device_code"}(ge||(ge={})),function(e){e.MSSTS_ACCOUNT_TYPE="MSSTS",e.ADFS_ACCOUNT_TYPE="ADFS",e.MSAV1_ACCOUNT_TYPE="MSA",e.GENERIC_ACCOUNT_TYPE="Generic"}(ye||(ye={})),function(e){e.CACHE_KEY_SEPARATOR="-",e.CLIENT_INFO_SEPARATOR="."}(Ee||(Ee={})),function(e){e.ID_TOKEN="IdToken",e.ACCESS_TOKEN="AccessToken",e.REFRESH_TOKEN="RefreshToken"}(Ce||(Ce={})),function(e){e.ACCOUNT="Account",e.CREDENTIAL="Credential",e.APP_METADATA="AppMetadata",e.TEMPORARY="TempCache",e.TELEMETRY="Telemetry"}(me||(me={})),function(e){e[e.ADFS=1001]="ADFS",e[e.MSA=1002]="MSA",e[e.MSSTS=1003]="MSSTS",e[e.GENERIC=1004]="GENERIC",e[e.ACCESS_TOKEN=2001]="ACCESS_TOKEN",e[e.REFRESH_TOKEN=2002]="REFRESH_TOKEN",e[e.ID_TOKEN=2003]="ID_TOKEN",e[e.APP_METADATA=3001]="APP_METADATA"}(we||(we={}));var ve={SCHEMA_VERSION:2,FAILURE_LIMIT:3,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:","},Ae=function(){function CredentialEntity(){}
return CredentialEntity.prototype.generateAccountId=function(){return CredentialEntity.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},CredentialEntity.prototype.generateCredentialId=function(){return CredentialEntity.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},CredentialEntity.prototype.generateTarget=function(){return CredentialEntity.generateTargetForCacheKey(this.target)},CredentialEntity.prototype.generateCredentialKey=function(){return CredentialEntity.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId)},CredentialEntity.prototype.generateType=function(){switch(this.credentialType){case Ce.ID_TOKEN:return we.ID_TOKEN;case Ce.ACCESS_TOKEN:return we.ACCESS_TOKEN;case Ce.REFRESH_TOKEN:return we.REFRESH_TOKEN;default:throw F.createUnexpectedCredentialTypeError()}},CredentialEntity.getCredentialType=function(e){
return-1!==e.indexOf(Ce.ACCESS_TOKEN.toLowerCase())?Ce.ACCESS_TOKEN:-1!==e.indexOf(Ce.ID_TOKEN.toLowerCase())?Ce.ID_TOKEN:-1!==e.indexOf(Ce.REFRESH_TOKEN.toLowerCase())?Ce.REFRESH_TOKEN:de},CredentialEntity.generateCredentialCacheKey=function(e,t,r,n,o,i,a){return[this.generateAccountIdForCacheKey(e,t),this.generateCredentialIdForCacheKey(r,n,o,a),this.generateTargetForCacheKey(i)].join(Ee.CACHE_KEY_SEPARATOR).toLowerCase()},CredentialEntity.generateAccountIdForCacheKey=function(e,t){return[e,t].join(Ee.CACHE_KEY_SEPARATOR).toLowerCase()},CredentialEntity.generateCredentialIdForCacheKey=function(e,t,r,n){return[e,e===Ce.REFRESH_TOKEN&&n||t,r||""].join(Ee.CACHE_KEY_SEPARATOR).toLowerCase()},CredentialEntity.generateTargetForCacheKey=function(e){return(e||"").toLowerCase()},CredentialEntity}(),Se={code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},Te={code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},Ie={
code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},Re={code:"authority_uri_insecure",desc:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},be={code:"url_parse_error",desc:"URL could not be parsed into appropriate segments."},Oe={code:"empty_url_error",desc:"URL was empty or null."},Pe={code:"empty_input_scopes_error",desc:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token."},ke={code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},Ne={code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},Ue={code:"invalid_prompt_value",
desc:"Supported prompt values are 'login', 'select_account', 'consent' and 'none'.  Please see here for valid configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},Me={code:"invalid_claims",desc:"Given claims parameter must be a stringified JSON object."},qe={code:"token_request_empty",desc:"Token request was empty and not found in cache."},De={code:"logout_request_empty",desc:"The logout request was null or undefined."},He={code:"invalid_code_challenge_method",desc:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".'},Le={code:"pkce_params_missing",desc:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request"},xe={code:"invalid_known_authorities",desc:"knownAuthorities and cloudDiscoveryMetadata cannot both be provided. Please provide cloudDiscoveryMetadata object for AAD, knownAuthorities otherwise."},Be={
code:"invalid_cloud_discovery_metadata",desc:"Invalid cloudDiscoveryMetadata provided. Must be a JSON object containing tenant_discovery_endpoint and metadata fields"},Ke={code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter."},Fe=function(e){function ClientConfigurationError(t,r){var n=e.call(this,t,r)||this;return n.name="ClientConfigurationError",Object.setPrototypeOf(n,ClientConfigurationError.prototype),n}return __extends$1(ClientConfigurationError,e),ClientConfigurationError.createRedirectUriEmptyError=function(){return new ClientConfigurationError(Se.code,Se.desc)},ClientConfigurationError.createPostLogoutRedirectUriEmptyError=function(){return new ClientConfigurationError(Te.code,Te.desc)},ClientConfigurationError.createClaimsRequestParsingError=function(e){return new ClientConfigurationError(Ie.code,Ie.desc+" Given value: "+e)},
ClientConfigurationError.createInsecureAuthorityUriError=function(e){return new ClientConfigurationError(Re.code,Re.desc+" Given URI: "+e)},ClientConfigurationError.createUrlParseError=function(e){return new ClientConfigurationError(be.code,be.desc+" Given Error: "+e)},ClientConfigurationError.createUrlEmptyError=function(){return new ClientConfigurationError(Oe.code,Oe.desc)},ClientConfigurationError.createScopesNonArrayError=function(e){return new ClientConfigurationError(ke.code,ke.desc+" Given Scopes: "+e)},ClientConfigurationError.createEmptyScopesArrayError=function(e){return new ClientConfigurationError(Pe.code,Pe.desc+" Given Scopes: "+e)},ClientConfigurationError.createClientIdSingleScopeError=function(e){return new ClientConfigurationError(Ne.code,Ne.desc+" Given Scopes: "+e)},ClientConfigurationError.createInvalidPromptError=function(e){return new ClientConfigurationError(Ue.code,Ue.desc+" Given value: "+e)},
ClientConfigurationError.createInvalidClaimsRequestError=function(){return new ClientConfigurationError(Me.code,Me.desc)},ClientConfigurationError.createEmptyLogoutRequestError=function(){return new ClientConfigurationError(De.code,De.desc)},ClientConfigurationError.createEmptyTokenRequestError=function(){return new ClientConfigurationError(qe.code,qe.desc)},ClientConfigurationError.createInvalidCodeChallengeMethodError=function(){return new ClientConfigurationError(He.code,He.desc)},ClientConfigurationError.createInvalidCodeChallengeParamsError=function(){return new ClientConfigurationError(Le.code,Le.desc)},ClientConfigurationError.createKnownAuthoritiesCloudDiscoveryMetadataError=function(){return new ClientConfigurationError(xe.code,xe.desc)},ClientConfigurationError.createInvalidCloudDiscoveryMetadataError=function(){return new ClientConfigurationError(Be.code,Be.desc)},ClientConfigurationError.createUntrustedAuthorityError=function(){
return new ClientConfigurationError(Ke.code,Ke.desc)},ClientConfigurationError}(F),je=function(){function ScopeSet(e){var t=this,r=e?j.trimArrayEntries(function __spreadArrays$1(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,c=i.length;a<c;a++,o++)n[o]=i[a];return n}(e)):[],n=r?j.removeEmptyStringsFromArray(r):[];this.validateInputScopes(n),this.scopes=new Set,n.forEach((function(e){return t.scopes.add(e)}))}return ScopeSet.fromString=function(e){return new ScopeSet((e=e||"").split(" "))},ScopeSet.prototype.validateInputScopes=function(e){if(!e||e.length<1)throw Fe.createEmptyScopesArrayError(e)},ScopeSet.prototype.containsScope=function(e){return!j.isEmpty(e)&&this.scopes.has(e)},ScopeSet.prototype.containsScopeSet=function(e){var t=this;return!(!e||e.scopes.size<=0)&&(this.scopes.size>=e.scopes.size&&e.asArray().every((function(e){return t.containsScope(e)})))},
ScopeSet.prototype.appendScope=function(e){j.isEmpty(e)||this.scopes.add(e.trim())},ScopeSet.prototype.appendScopes=function(e){var t=this;try{e.forEach((function(e){return t.appendScope(e)}))}catch(e){throw F.createAppendScopeSetError(e)}},ScopeSet.prototype.removeScope=function(e){if(j.isEmpty(e))throw F.createRemoveEmptyScopeFromSetError(e);this.scopes.delete(e.trim())},ScopeSet.prototype.unionScopeSets=function(e){if(!e)throw F.createEmptyInputScopeSetError(e);var t=new Set;return e.scopes.forEach((function(e){return t.add(e)})),this.scopes.forEach((function(e){return t.add(e)})),t},ScopeSet.prototype.intersectingScopeSets=function(e){if(!e)throw F.createEmptyInputScopeSetError(e);var t=this.unionScopeSets(e),r=e.getScopeCount(),n=this.getScopeCount();return t.size<n+r},ScopeSet.prototype.getScopeCount=function(){return this.scopes.size},ScopeSet.prototype.asArray=function(){var e=[];return this.scopes.forEach((function(t){return e.push(t)})),e},
ScopeSet.prototype.printScopes=function(){return this.scopes?this.asArray().join(" "):""},ScopeSet.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()},ScopeSet}();function buildClientInfo(e,t){if(j.isEmpty(e))throw F.createClientInfoEmptyError(e);try{var r=t.base64Decode(e);return JSON.parse(r)}catch(e){throw F.createClientInfoDecodingError(e)}}var Ge=function(){function UrlString(e){if(this._urlString=e,j.isEmpty(this._urlString))throw Fe.createUrlEmptyError();j.isEmpty(this.getHash())&&(this._urlString=UrlString.canonicalizeUri(e))}return Object.defineProperty(UrlString.prototype,"urlString",{get:function(){return this._urlString},enumerable:!0,configurable:!0}),UrlString.canonicalizeUri=function(e){return e&&(e=e.toLowerCase()),e&&!j.endsWith(e,"/")&&(e+="/"),e},UrlString.prototype.validateAsUri=function(){var e;try{e=this.getUrlComponents()}catch(e){throw Fe.createUrlParseError(e)}
if(!e.HostNameAndPort||!e.PathSegments||e.PathSegments.length<1)throw Fe.createUrlParseError("Given url string: "+this.urlString);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw Fe.createInsecureAuthorityUriError(this.urlString)},UrlString.prototype.urlRemoveQueryStringParameter=function(e){var t=new RegExp("(\\&"+e+"=)[^&]+");return this._urlString=this.urlString.replace(t,""),t=new RegExp("("+e+"=)[^&]+&"),this._urlString=this.urlString.replace(t,""),t=new RegExp("("+e+"=)[^&]+"),this._urlString=this.urlString.replace(t,""),this.urlString},UrlString.removeHashFromUrl=function(e){return UrlString.canonicalizeUri(e.split("#")[0])},UrlString.prototype.replaceTenantPath=function(e){var t=this.getUrlComponents(),r=t.PathSegments;return!e||0===r.length||r[0]!==Y.COMMON&&r[0]!==Y.ORGANIZATIONS||(r[0]=e),UrlString.constructAuthorityUriFromObject(t)},UrlString.prototype.getHash=function(){return UrlString.parseHash(this.urlString)},UrlString.prototype.getUrlComponents=function(){
var e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw Fe.createUrlParseError("Given url string: "+this.urlString);var r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5]},n=r.AbsolutePath.split("/");return n=n.filter((function(e){return e&&e.length>0})),r.PathSegments=n,r},UrlString.getDomainFromUrl=function(e){var t=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(t);if(!r)throw Fe.createUrlParseError("Given url string: "+e);return r[2]},UrlString.parseHash=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):""},UrlString.constructAuthorityUriFromObject=function(e){return new UrlString(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))},UrlString.getDeserializedHash=function(e){if(j.isEmpty(e))return{};var t=UrlString.parseHash(e),r=j.queryStringToObject(j.isEmpty(t)?e:t);if(!r)throw F.createHashNotDeserializedError(JSON.stringify(r));return r},
UrlString.hashContainsKnownProperties=function(e){if(j.isEmpty(e))return!1;var t=UrlString.getDeserializedHash(e);return!!(t.code||t.error_description||t.error||t.state)},UrlString}(),ze=function(){function TrustedAuthority(){}return TrustedAuthority.setTrustedAuthoritiesFromConfig=function(e,t){if(!this.getTrustedHostList().length){if(e.length>0&&!j.isEmpty(t))throw Fe.createKnownAuthoritiesCloudDiscoveryMetadataError();this.createCloudDiscoveryMetadataFromKnownAuthorities(e);try{if(t){var r=JSON.parse(t);this.saveCloudDiscoveryMetadata(r.metadata)}}catch(e){throw Fe.createInvalidCloudDiscoveryMetadataError()}}},TrustedAuthority.setTrustedAuthoritiesFromNetwork=function(e,t){return __awaiter$1(this,void 0,void 0,(function(){var r,n,o,i;return __generator$1(this,(function(a){switch(a.label){case 0:r=""+re+e.urlString+"oauth2/v2.0/authorize",a.label=1;case 1:return a.trys.push([1,3,,4]),[4,t.sendGetRequestAsync(r)];case 2:return n=a.sent(),o=n.body.metadata,
this.saveCloudDiscoveryMetadata(o),[3,4];case 3:return a.sent(),[2];case 4:return i=e.getUrlComponents().HostNameAndPort,this.getTrustedHostList().length>0&&!this.IsInTrustedHostList(i)&&this.createCloudDiscoveryMetadataFromKnownAuthorities([i]),[2]}}))}))},TrustedAuthority.saveCloudDiscoveryMetadata=function(e){e.forEach((function(e){e.aliases.forEach((function(t){TrustedAuthority.TrustedHostList[t.toLowerCase()]=e}))}))},TrustedAuthority.createCloudDiscoveryMetadataFromKnownAuthorities=function(e){var t=this;e.forEach((function(e){var r=Ge.getDomainFromUrl(e).toLowerCase();t.TrustedHostList[r]={preferred_cache:r,preferred_network:r,aliases:[r]}}))},TrustedAuthority.getTrustedHostList=function(){return Object.keys(this.TrustedHostList)},TrustedAuthority.getCloudDiscoveryMetadata=function(e){return this.TrustedHostList[e.toLowerCase()]||null},TrustedAuthority.IsInTrustedHostList=function(e){return Object.keys(this.TrustedHostList).indexOf(e.toLowerCase())>-1},
TrustedAuthority.TrustedHostList={},TrustedAuthority}(),Ye=function(){function AccountEntity(){}return AccountEntity.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(Ee.CACHE_KEY_SEPARATOR).toLowerCase()},AccountEntity.prototype.generateAccountKey=function(){return AccountEntity.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username})},AccountEntity.prototype.generateType=function(){switch(this.authorityType){case ye.ADFS_ACCOUNT_TYPE:return we.ADFS;case ye.MSAV1_ACCOUNT_TYPE:return we.MSA;case ye.MSSTS_ACCOUNT_TYPE:return we.MSSTS;case ye.GENERIC_ACCOUNT_TYPE:return we.GENERIC;default:throw F.createUnexpectedAccountTypeError()}},AccountEntity.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username}},AccountEntity.generateAccountCacheKey=function(e){
return[e.homeAccountId,e.environment||"",e.tenantId||""].join(Ee.CACHE_KEY_SEPARATOR).toLowerCase()},AccountEntity.createAccount=function(e,t,r,n){var o=new AccountEntity;o.authorityType=ye.MSSTS_ACCOUNT_TYPE,o.clientInfo=e;var i=buildClientInfo(e,n);o.homeAccountId=""+i.uid+Ee.CLIENT_INFO_SEPARATOR+i.utid;var a=t.canonicalAuthorityUrlComponents.HostNameAndPort,c=ze.getCloudDiscoveryMetadata(a)?ze.getCloudDiscoveryMetadata(a).preferred_cache:"";if(j.isEmpty(c))throw F.createInvalidCacheEnvironmentError();if(o.environment=c,o.realm=r.claims.tid,r){var s=j.isEmpty(r.claims.oid)?r.claims.sid:r.claims.oid;o.localAccountId=s,o.username=r.claims.preferred_username||(r.claims.emails?r.claims.emails[0]:""),o.name=r.claims.name}return o},AccountEntity.createADFSAccount=function(e,t){var r=new AccountEntity;r.authorityType=ye.ADFS_ACCOUNT_TYPE,r.homeAccountId=t.claims.sub
;var n=e.canonicalAuthorityUrlComponents.HostNameAndPort,o=ze.getCloudDiscoveryMetadata(n)?ze.getCloudDiscoveryMetadata(n).preferred_cache:"";if(j.isEmpty(o))throw F.createInvalidCacheEnvironmentError();return r.environment=o,r.username=t.claims.upn,r},AccountEntity.isAccountEntity=function(e){return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType")},AccountEntity}(),$e=function(){function CacheManager(){}return CacheManager.prototype.getAllAccounts=function(){var e=this.getAccountsFilteredBy(),t=Object.keys(e).map((function(t){return e[t]}));return t.length<1?[]:t.map((function(e){var t=new Ye;return(t=CacheManager.toObject(t,e)).getAccountInfo()}))},CacheManager.prototype.saveCacheRecord=function(e){if(!e)throw F.createNullOrUndefinedCacheRecord();e.account&&this.saveAccount(e.account),e.idToken&&this.saveCredential(e.idToken),
e.accessToken&&this.saveAccessToken(e.accessToken),e.refreshToken&&this.saveCredential(e.refreshToken)},CacheManager.prototype.saveAccount=function(e){var t=e.generateAccountKey();this.setItem(t,e,me.ACCOUNT)},CacheManager.prototype.saveCredential=function(e){var t=e.generateCredentialKey();this.setItem(t,e,me.CREDENTIAL)},CacheManager.prototype.saveAccessToken=function(e){var t=this,r=this.getCredentialsFilteredBy({clientId:e.clientId,credentialType:Ce.ACCESS_TOKEN,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm}),n=je.fromString(e.target),o=Object.keys(r.accessTokens).map((function(e){return r.accessTokens[e]}));o&&o.forEach((function(e){je.fromString(e.target).intersectingScopeSets(n)&&t.removeCredential(e)})),this.saveCredential(e)},CacheManager.prototype.getAccount=function(e){return this.getItem(e,me.ACCOUNT)},CacheManager.prototype.getCredential=function(e){return this.getItem(e,me.CREDENTIAL)},CacheManager.prototype.getAccountsFilteredBy=function(e){
return this.getAccountsFilteredByInternal(e?e.homeAccountId:"",e?e.environment:"",e?e.realm:"")},CacheManager.prototype.getAccountsFilteredByInternal=function(e,t,r){var n=this,o=this.getKeys(),i={};return o.forEach((function(o){var a=n.getAccountEntity(o);if(!a)return null;(j.isEmpty(e)||n.matchHomeAccountId(a,e))&&(j.isEmpty(t)||n.matchEnvironment(a,t))&&(j.isEmpty(r)||n.matchRealm(a,r))&&(i[o]=a)})),i},CacheManager.prototype.getCredentialsFilteredBy=function(e){return this.getCredentialsFilteredByInternal(e.homeAccountId,e.environment,e.credentialType,e.clientId,e.realm,e.target)},CacheManager.prototype.getCredentialsFilteredByInternal=function(e,t,r,n,o,i){var a=this,c=this.getKeys(),s={idTokens:{},accessTokens:{},refreshTokens:{}};return c.forEach((function(c){var u,l=Ae.getCredentialType(c);if(l!==de){try{u=a.getItem(c,me.CREDENTIAL)}catch(e){return}
if((j.isEmpty(e)||a.matchHomeAccountId(u,e))&&(j.isEmpty(t)||a.matchEnvironment(u,t))&&(j.isEmpty(o)||a.matchRealm(u,o))&&(j.isEmpty(r)||a.matchCredentialType(u,r))&&(j.isEmpty(n)||a.matchClientId(u,n))&&(j.isEmpty(i)||a.matchTarget(u,i)))switch(l){case Ce.ID_TOKEN:s.idTokens[c]=u;break;case Ce.ACCESS_TOKEN:s.accessTokens[c]=u;break;case Ce.REFRESH_TOKEN:s.refreshTokens[c]=u}}})),s},CacheManager.prototype.removeAppMetadata=function(){var e=this;return this.getKeys().forEach((function(t){e.isAppMetadata(t)&&e.removeItem(t,me.APP_METADATA)})),!0},CacheManager.prototype.removeAllAccounts=function(){var e=this;return this.getKeys().forEach((function(t){e.getAccountEntity(t)&&e.removeAccount(t)})),!0},CacheManager.prototype.removeAccount=function(e){var t=this.getAccount(e);if(!t)throw F.createNoAccountFoundError();return this.removeAccountContext(t)&&this.removeItem(e,me.ACCOUNT)},CacheManager.prototype.removeAccountContext=function(e){var t=this,r=this.getKeys(),n=e.generateAccountId()
;return r.forEach((function(e){if(Ae.getCredentialType(e)!==de){var r=t.getItem(e,me.CREDENTIAL);r&&n===r.generateAccountId()&&t.removeCredential(r)}})),!0},CacheManager.prototype.removeCredential=function(e){var t=e.generateCredentialKey();return this.removeItem(t,me.CREDENTIAL)},CacheManager.prototype.matchHomeAccountId=function(e,t){return e.homeAccountId&&t===e.homeAccountId},CacheManager.prototype.matchEnvironment=function(e,t){var r=ze.getCloudDiscoveryMetadata(t);return!!(r&&r.aliases.indexOf(e.environment)>-1)},CacheManager.prototype.matchCredentialType=function(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()},CacheManager.prototype.matchClientId=function(e,t){return e.clientId&&t===e.clientId},CacheManager.prototype.matchRealm=function(e,t){return e.realm&&t===e.realm},CacheManager.prototype.matchTarget=function(e,t){if(e.credentialType!==Ce.ACCESS_TOKEN||j.isEmpty(e.target))return!1;var r=je.fromString(e.target),n=je.fromString(t)
;return r.removeScope(ae),n.removeScope(ae),r.containsScopeSet(n)},CacheManager.prototype.getAccountEntity=function(e){if(Ae.getCredentialType(e)!==de||this.isAppMetadata(e))return null;var t;try{t=this.getItem(e,me.ACCOUNT)}catch(e){return null}return!t||j.isEmpty(t.authorityType)?null:t},CacheManager.prototype.isAppMetadata=function(e){return-1!==e.indexOf("appmetadata")},CacheManager.toObject=function(e,t){for(var r in t)e[r]=t[r];return e},CacheManager}(),Ve=function(e){function DefaultStorageClass(){return null!==e&&e.apply(this,arguments)||this}return __extends$1(DefaultStorageClass,e),DefaultStorageClass.prototype.setItem=function(){throw i.createUnexpectedError("Storage interface - setItem() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getItem=function(){throw i.createUnexpectedError("Storage interface - getItem() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.removeItem=function(){
throw i.createUnexpectedError("Storage interface - removeItem() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.containsKey=function(){throw i.createUnexpectedError("Storage interface - containsKey() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getKeys=function(){throw i.createUnexpectedError("Storage interface - getKeys() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.clear=function(){throw i.createUnexpectedError("Storage interface - clear() has not been implemented for the cacheStorage interface.")},DefaultStorageClass}($e),We={clientId:"",authority:null,knownAuthorities:[],cloudDiscoveryMetadata:"",clientCapabilities:[]},Je={tokenRenewalOffsetSeconds:300},Qe={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:n.Info},Xe={sendGetRequestAsync:function(){return __awaiter$1(this,void 0,void 0,(function(){return __generator$1(this,(function(e){
throw"Network interface - sendGetRequestAsync() has not been implemented",i.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented")}))}))},sendPostRequestAsync:function(){return __awaiter$1(this,void 0,void 0,(function(){return __generator$1(this,(function(e){throw"Network interface - sendPostRequestAsync() has not been implemented",i.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented")}))}))}},Ze={createNewGuid:function(){throw i.createUnexpectedError("Crypto interface - createNewGuid() has not been implemented")},base64Decode:function(){throw i.createUnexpectedError("Crypto interface - base64Decode() has not been implemented")},base64Encode:function(){throw i.createUnexpectedError("Crypto interface - base64Encode() has not been implemented")},generatePkceCodes:function(){return __awaiter$1(this,void 0,void 0,(function(){return __generator$1(this,(function(e){
throw"Crypto interface - generatePkceCodes() has not been implemented",i.createUnexpectedError("Crypto interface - generatePkceCodes() has not been implemented")}))}))}},et={sku:X,version:"1.2.0",cpu:"",os:""},tt={clientSecret:"",clientAssertion:null};var rt,nt=function(){function BaseClient(e){this.config=function buildClientConfiguration(e){var t=e.authOptions,r=e.systemOptions,n=e.loggerOptions,o=e.storageInterface,i=e.networkInterface,a=e.cryptoInterface,c=e.clientCredentials,s=e.libraryInfo,u=e.serverTelemetryManager;return{authOptions:__assign$1(__assign$1({},We),t),systemOptions:__assign$1(__assign$1({},Je),r),loggerOptions:__assign$1(__assign$1({},Qe),n),storageInterface:o||new Ve,networkInterface:i||Xe,cryptoInterface:a||Ze,clientCredentials:c||tt,libraryInfo:__assign$1(__assign$1({},et),s),serverTelemetryManager:u||null}}(e),this.logger=new J(this.config.loggerOptions),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,
this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,ze.setTrustedAuthoritiesFromConfig(this.config.authOptions.knownAuthorities,this.config.authOptions.cloudDiscoveryMetadata),this.authority=this.config.authOptions.authority}return BaseClient.prototype.createDefaultTokenRequestHeaders=function(){var e=this.createDefaultLibraryHeaders();return e[G.CONTENT_TYPE]=ue,this.serverTelemetryManager&&(e[G.X_CLIENT_CURR_TELEM]=this.serverTelemetryManager.generateCurrentRequestHeaderValue(),e[G.X_CLIENT_LAST_TELEM]=this.serverTelemetryManager.generateLastRequestHeaderValue()),e},BaseClient.prototype.createDefaultLibraryHeaders=function(){var e={};return e[$.X_CLIENT_SKU]=this.config.libraryInfo.sku,e[$.X_CLIENT_VER]=this.config.libraryInfo.version,e[$.X_CLIENT_OS]=this.config.libraryInfo.os,e[$.X_CLIENT_CPU]=this.config.libraryInfo.cpu,e},BaseClient.prototype.executePostToTokenEndpoint=function(e,t,r){
return __awaiter$1(this,void 0,void 0,(function(){var n;return __generator$1(this,(function(o){switch(o.label){case 0:return[4,this.networkClient.sendPostRequestAsync(e,{body:t,headers:r})];case 1:return n=o.sent(),this.config.serverTelemetryManager&&n.status<500&&429!==n.status&&this.config.serverTelemetryManager.clearTelemetryCache(),[2,n]}}))}))},BaseClient}(),ot=function(){function RequestValidator(){}return RequestValidator.validateRedirectUri=function(e){if(j.isEmpty(e))throw Fe.createRedirectUriEmptyError()},RequestValidator.validatePrompt=function(e){if([pe.LOGIN,pe.SELECT_ACCOUNT,pe.CONSENT,pe.NONE].indexOf(e)<0)throw Fe.createInvalidPromptError(e)},RequestValidator.validateClaims=function(e){try{JSON.parse(e)}catch(e){throw Fe.createInvalidClaimsRequestError()}},RequestValidator.validateCodeChallengeParams=function(e,t){if(j.isEmpty(e)||j.isEmpty(t))throw Fe.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(t)},
RequestValidator.validateCodeChallengeMethod=function(e){if([_e.PLAIN,_e.S256].indexOf(e)<0)throw Fe.createInvalidCodeChallengeMethodError()},RequestValidator.sanitizeEQParams=function(e,t){return e?(t.forEach((function(t,r){e[r]&&delete e[r]})),e):null},RequestValidator}(),it=function(){function RequestParameterBuilder(){this.parameters=new Map}return RequestParameterBuilder.prototype.addResponseTypeCode=function(){this.parameters.set($.RESPONSE_TYPE,encodeURIComponent(ce))},RequestParameterBuilder.prototype.addResponseMode=function(e){this.parameters.set($.RESPONSE_MODE,encodeURIComponent(e||fe.QUERY))},RequestParameterBuilder.prototype.addScopes=function(e){this.parameters.set($.SCOPE,encodeURIComponent(e.printScopes()))},RequestParameterBuilder.prototype.addClientId=function(e){this.parameters.set($.CLIENT_ID,encodeURIComponent(e))},RequestParameterBuilder.prototype.addRedirectUri=function(e){ot.validateRedirectUri(e),this.parameters.set($.REDIRECT_URI,encodeURIComponent(e))},
RequestParameterBuilder.prototype.addDomainHint=function(e){this.parameters.set(he.DOMAIN_HINT,encodeURIComponent(e))},RequestParameterBuilder.prototype.addLoginHint=function(e){this.parameters.set(he.LOGIN_HINT,encodeURIComponent(e))},RequestParameterBuilder.prototype.addSid=function(e){this.parameters.set(he.SID,encodeURIComponent(e))},RequestParameterBuilder.prototype.addClaims=function(e,t){var r=this.addClientCapabilitiesToClaims(e,t);ot.validateClaims(r),this.parameters.set($.CLAIMS,encodeURIComponent(r))},RequestParameterBuilder.prototype.addCorrelationId=function(e){this.parameters.set($.CLIENT_REQUEST_ID,encodeURIComponent(e))},RequestParameterBuilder.prototype.addLibraryInfo=function(e){this.parameters.set($.X_CLIENT_SKU,e.sku),this.parameters.set($.X_CLIENT_VER,e.version),this.parameters.set($.X_CLIENT_OS,e.os),this.parameters.set($.X_CLIENT_CPU,e.cpu)},RequestParameterBuilder.prototype.addPrompt=function(e){ot.validatePrompt(e),
this.parameters.set(""+$.PROMPT,encodeURIComponent(e))},RequestParameterBuilder.prototype.addState=function(e){j.isEmpty(e)||this.parameters.set($.STATE,encodeURIComponent(e))},RequestParameterBuilder.prototype.addNonce=function(e){this.parameters.set($.NONCE,encodeURIComponent(e))},RequestParameterBuilder.prototype.addCodeChallengeParams=function(e,t){if(ot.validateCodeChallengeParams(e,t),!e||!t)throw Fe.createInvalidCodeChallengeParamsError();this.parameters.set($.CODE_CHALLENGE,encodeURIComponent(e)),this.parameters.set($.CODE_CHALLENGE_METHOD,encodeURIComponent(t))},RequestParameterBuilder.prototype.addAuthorizationCode=function(e){this.parameters.set($.CODE,encodeURIComponent(e))},RequestParameterBuilder.prototype.addDeviceCode=function(e){this.parameters.set($.DEVICE_CODE,encodeURIComponent(e))},RequestParameterBuilder.prototype.addRefreshToken=function(e){this.parameters.set($.REFRESH_TOKEN,encodeURIComponent(e))},RequestParameterBuilder.prototype.addCodeVerifier=function(e){
this.parameters.set($.CODE_VERIFIER,encodeURIComponent(e))},RequestParameterBuilder.prototype.addClientSecret=function(e){this.parameters.set($.CLIENT_SECRET,encodeURIComponent(e))},RequestParameterBuilder.prototype.addClientAssertion=function(e){this.parameters.set($.CLIENT_ASSERTION,encodeURIComponent(e))},RequestParameterBuilder.prototype.addClientAssertionType=function(e){this.parameters.set($.CLIENT_ASSERTION_TYPE,encodeURIComponent(e))},RequestParameterBuilder.prototype.addGrantType=function(e){this.parameters.set($.GRANT_TYPE,encodeURIComponent(e))},RequestParameterBuilder.prototype.addClientInfo=function(){this.parameters.set("client_info","1")},RequestParameterBuilder.prototype.addExtraQueryParameters=function(e){var t=this;ot.sanitizeEQParams(e,this.parameters),Object.keys(e).forEach((function(r){t.parameters.set(r,e[r])}))},RequestParameterBuilder.prototype.addClientCapabilitiesToClaims=function(e,t){var r;if(j.isEmpty(e))r={};else try{r=JSON.parse(e)}catch(e){
throw Fe.createInvalidClaimsRequestError()}return t&&t.length>0&&(r.hasOwnProperty(W.ACCESS_TOKEN)||(r[W.ACCESS_TOKEN]={}),r[W.ACCESS_TOKEN][W.XMS_CC]={values:t}),JSON.stringify(r)},RequestParameterBuilder.prototype.createQueryString=function(){var e=new Array;return this.parameters.forEach((function(t,r){e.push(r+"="+t)})),e.join("&")},RequestParameterBuilder}(),at=function(e){function ServerError(t,r,n){var o=e.call(this,t,r)||this;return o.name="ServerError",o.subError=n,Object.setPrototypeOf(o,ServerError.prototype),o}return __extends$1(ServerError,e),ServerError}(i),ct=function(){function IdToken(e,t){if(j.isEmpty(e))throw F.createIdTokenNullOrEmptyError(e);this.rawIdToken=e,this.claims=IdToken.extractIdToken(e,t)}return IdToken.extractIdToken=function(e,t){var r=j.decodeJwt(e);if(!r)return null;try{var n=r.JWSPayload,o=t.base64Decode(n);return JSON.parse(o)}catch(e){throw F.createIdTokenParsingError(e)}},IdToken}(),st=function(){function TimeUtils(){}
return TimeUtils.nowSeconds=function(){return Math.round((new Date).getTime()/1e3)},TimeUtils.isTokenExpired=function(e,t){var r=Number(e)||0;return TimeUtils.nowSeconds()+t>r},TimeUtils}();!function(e){e[e.Default=0]="Default",e[e.Adfs=1]="Adfs"}(rt||(rt={}));var ut,lt,dt,ht,pt=function(e){function IdTokenEntity(){return null!==e&&e.apply(this,arguments)||this}return __extends$1(IdTokenEntity,e),IdTokenEntity.createIdTokenEntity=function(e,t,r,n,o){var i=new IdTokenEntity;return i.credentialType=Ce.ID_TOKEN,i.homeAccountId=e,i.environment=t,i.clientId=n,i.secret=r,i.realm=o,i},IdTokenEntity.isIdTokenEntity=function(e){return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===Ce.ID_TOKEN},IdTokenEntity}(Ae),ft=function(e){function AccessTokenEntity(){return null!==e&&e.apply(this,arguments)||this}
return __extends$1(AccessTokenEntity,e),AccessTokenEntity.createAccessTokenEntity=function(e,t,r,n,o,i,a,c){var s=new AccessTokenEntity;s.homeAccountId=e,s.credentialType=Ce.ACCESS_TOKEN,s.secret=r;var u=st.nowSeconds();return s.cachedAt=u.toString(),s.expiresOn=a.toString(),s.extendedExpiresOn=c.toString(),s.environment=t,s.clientId=n,s.realm=o,s.target=i,s},AccessTokenEntity.isAccessTokenEntity=function(e){return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.hasOwnProperty("target")&&e.credentialType===Ce.ACCESS_TOKEN},AccessTokenEntity}(Ae),gt=function(e){function RefreshTokenEntity(){return null!==e&&e.apply(this,arguments)||this}return __extends$1(RefreshTokenEntity,e),RefreshTokenEntity.createRefreshTokenEntity=function(e,t,r,n,o){var i=new RefreshTokenEntity;return i.clientId=n,i.credentialType=Ce.REFRESH_TOKEN,i.environment=t,
i.homeAccountId=e,i.secret=r,o&&(i.familyId=o),i},RefreshTokenEntity.isRefreshTokenEntity=function(e){return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===Ce.REFRESH_TOKEN},RefreshTokenEntity}(Ae),yt=["interaction_required","consent_required","login_required"],Et=["message_only","additional_action","basic_action","user_password_expired","consent_required"],Ct=function(e){function InteractionRequiredAuthError(t,r,n){var o=e.call(this,t,r,n)||this;return o.name="InteractionRequiredAuthError",Object.setPrototypeOf(o,InteractionRequiredAuthError.prototype),o}return __extends$1(InteractionRequiredAuthError,e),InteractionRequiredAuthError.isInteractionRequiredError=function(e,t,r){var n=!j.isEmpty(e)&&yt.indexOf(e)>-1,o=!j.isEmpty(r)&&Et.indexOf(r)>-1,i=!j.isEmpty(t)&&yt.some((function(e){return t.indexOf(e)>-1}));return n||i||o},InteractionRequiredAuthError
}(at),mt=function mt(e,t,r,n){this.account=e,this.idToken=t,this.accessToken=r,this.refreshToken=n},wt=function(){function ProtocolUtils(){}return ProtocolUtils.setRequestState=function(e,t,r){var n=ProtocolUtils.generateLibraryState(e,r);return j.isEmpty(t)?n:""+n+ne+t},ProtocolUtils.generateLibraryState=function(e,t){if(!e)throw F.createNoCryptoObjectError("generateLibraryState");var r={id:e.createNewGuid(),ts:st.nowSeconds()};t&&(r.meta=t);var n=JSON.stringify(r);return e.base64Encode(n)},ProtocolUtils.parseRequestState=function(e,t){if(!e)throw F.createNoCryptoObjectError("parseRequestState");if(j.isEmpty(t))throw F.createInvalidStateError(t,"Null, undefined or empty state");try{var r=decodeURIComponent(t).split(ne),n=r[0],o=r.length>1?r.slice(1).join(ne):"",i=e.base64Decode(n),a=JSON.parse(i);return{userRequestState:j.isEmpty(o)?"":o,libraryState:a}}catch(e){throw F.createInvalidStateError(t,e)}},ProtocolUtils}(),_t=function(){function ResponseHandler(e,t,r,n){this.clientId=e,
this.cacheStorage=t,this.cryptoObj=r,this.logger=n}return ResponseHandler.prototype.validateServerAuthorizationCodeResponse=function(e,t,r){if(decodeURIComponent(e.state)!==decodeURIComponent(t))throw F.createStateMismatchError();if(e.error||e.error_description||e.suberror){if(Ct.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new Ct(e.error,e.error_description,e.suberror);throw new at(e.error,e.error_description,e.suberror)}e.client_info&&buildClientInfo(e.client_info,r)},ResponseHandler.prototype.validateTokenResponse=function(e){if(e.error||e.error_description||e.suberror){if(Ct.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new Ct(e.error,e.error_description,e.suberror);var t=e.error_codes+" - ["+e.timestamp+"]: "+e.error_description+" - Correlation ID: "+e.correlation_id+" - Trace ID: "+e.trace_id;throw new at(e.error,t)}},ResponseHandler.prototype.handleServerTokenResponse=function(e,t,r,n,o){
e.client_info?(this.clientInfo=buildClientInfo(e.client_info,this.cryptoObj),j.isEmpty(this.clientInfo.uid)||j.isEmpty(this.clientInfo.utid)||(this.homeAccountIdentifier=this.clientInfo.uid+"."+this.clientInfo.utid)):this.homeAccountIdentifier="";var i=null;if(!j.isEmpty(e.id_token)&&(i=new ct(e.id_token,this.cryptoObj),!j.isEmpty(r)&&i.claims.nonce!==r))throw F.createNonceMismatchError();var a=null;j.isEmpty(n)||(a=wt.parseRequestState(this.cryptoObj,n));var c=this.generateCacheRecord(e,i,t,a&&a.libraryState,o);return this.cacheStorage.saveCacheRecord(c),ResponseHandler.generateAuthenticationResult(c,i,!1,a)},ResponseHandler.prototype.generateCacheRecord=function(e,t,r,n,o){var i=r.canonicalAuthorityUrlComponents.HostNameAndPort,a=ze.getCloudDiscoveryMetadata(i)?ze.getCloudDiscoveryMetadata(i).preferred_cache:"";if(j.isEmpty(a))throw F.createInvalidCacheEnvironmentError();var c=null,s=null
;j.isEmpty(e.id_token)||(c=pt.createIdTokenEntity(this.homeAccountIdentifier,a,e.id_token,this.clientId,t.claims.tid),s=this.generateAccountEntity(e,t,r));var u=null;if(!j.isEmpty(e.access_token)){var l=e.scope?je.fromString(e.scope):new je(o||[]),d=st.nowSeconds(),h=(n?n.ts:d)+e.expires_in,p=h+e.ext_expires_in;u=ft.createAccessTokenEntity(this.homeAccountIdentifier,a,e.access_token,this.clientId,t?t.claims.tid:r.tenant,l.printScopesLowerCase(),h,p)}var f=null;return j.isEmpty(e.refresh_token)||(f=gt.createRefreshTokenEntity(this.homeAccountIdentifier,a,e.refresh_token,this.clientId,e.foci)),new mt(s,c,u,f)},ResponseHandler.prototype.generateAccountEntity=function(e,t,r){if(r.authorityType===rt.Adfs)return Ye.createADFSAccount(r,t);if(j.isEmpty(e.client_info))throw F.createClientInfoEmptyError(e.client_info);return Ye.createAccount(e.client_info,r,t,this.cryptoObj)},ResponseHandler.generateAuthenticationResult=function(e,t,r,n){var o="",i=[],a=null,c=null,s=null
;return e.accessToken&&(o=e.accessToken.secret,i=je.fromString(e.accessToken.target).asArray(),a=new Date(1e3*Number(e.accessToken.expiresOn)),c=new Date(1e3*Number(e.accessToken.extendedExpiresOn))),e.refreshToken&&(s=e.refreshToken.familyId||null),{uniqueId:t?t.claims.oid||t.claims.sub:"",tenantId:t?t.claims.tid:"",scopes:i,account:e.account?e.account.getAccountInfo():null,idToken:t?t.rawIdToken:"",idTokenClaims:t?t.claims:null,accessToken:o,fromCache:r,expiresOn:a,extExpiresOn:c,familyId:s,state:n?n.userRequestState:""}},ResponseHandler}(),vt=function(e){function AuthorizationCodeClient(t){return e.call(this,t)||this}return __extends$1(AuthorizationCodeClient,e),AuthorizationCodeClient.prototype.getAuthCodeUrl=function(e){return __awaiter$1(this,void 0,void 0,(function(){var t;return __generator$1(this,(function(r){return t=this.createAuthCodeUrlQueryString(e),[2,this.authority.authorizationEndpoint+"?"+t]}))}))},AuthorizationCodeClient.prototype.acquireToken=function(e,t,r){
return __awaiter$1(this,void 0,void 0,(function(){var n,o;return __generator$1(this,(function(i){switch(i.label){case 0:if(this.logger.info("in acquireToken call"),!e||j.isEmpty(e.code))throw F.createTokenRequestCannotBeMadeError();return[4,this.executeTokenRequest(this.authority,e)];case 1:return n=i.sent(),(o=new _t(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger)).validateTokenResponse(n.body),[2,o.handleServerTokenResponse(n.body,this.authority,t,r)]}}))}))},AuthorizationCodeClient.prototype.handleFragmentResponse=function(e,t){var r=new _t(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger),n=new Ge(e),o=Ge.getDeserializedHash(n.getHash());return r.validateServerAuthorizationCodeResponse(o,t,this.cryptoUtils),o.code},AuthorizationCodeClient.prototype.getLogoutUri=function(e){if(!e)throw Fe.createEmptyLogoutRequestError()
;e.account?this.cacheManager.removeAccount(Ye.generateAccountCacheKey(e.account)):this.cacheManager.clear();var t=e.postLogoutRedirectUri?"?"+$.POST_LOGOUT_URI+"="+encodeURIComponent(e.postLogoutRedirectUri):"",r=e.correlationId?"&"+$.CLIENT_REQUEST_ID+"="+encodeURIComponent(e.correlationId):"";return""+this.authority.endSessionEndpoint+t+r},AuthorizationCodeClient.prototype.executeTokenRequest=function(e,t){return __awaiter$1(this,void 0,void 0,(function(){var r,n;return __generator$1(this,(function(o){return r=this.createTokenRequestBody(t),n=this.createDefaultTokenRequestHeaders(),[2,this.executePostToTokenEndpoint(e.tokenEndpoint,r,n)]}))}))},AuthorizationCodeClient.prototype.createTokenRequestBody=function(e){var t=new it;t.addClientId(this.config.authOptions.clientId),t.addRedirectUri(e.redirectUri);var r=new je(e.scopes||[]);if(t.addScopes(r),t.addAuthorizationCode(e.code),e.codeVerifier&&t.addCodeVerifier(e.codeVerifier),
this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){var n=this.config.clientCredentials.clientAssertion;t.addClientAssertion(n.assertion),t.addClientAssertionType(n.assertionType)}t.addGrantType(ge.AUTHORIZATION_CODE_GRANT),t.addClientInfo();var o=e.correlationId||this.config.cryptoInterface.createNewGuid();return t.addCorrelationId(o),(!j.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),t.createQueryString()},AuthorizationCodeClient.prototype.createAuthCodeUrlQueryString=function(e){var t=new it;t.addClientId(this.config.authOptions.clientId);var r=new je(e.scopes||[]);e.extraScopesToConsent&&r.appendScopes(e.extraScopesToConsent),t.addScopes(r),t.addRedirectUri(e.redirectUri);var n=e.correlationId||this.config.cryptoInterface.createNewGuid()
;return t.addCorrelationId(n),t.addResponseMode(e.responseMode),t.addResponseTypeCode(),t.addLibraryInfo(this.config.libraryInfo),t.addClientInfo(),e.codeChallenge&&t.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&t.addPrompt(e.prompt),e.loginHint&&t.addLoginHint(e.loginHint),e.domainHint&&t.addDomainHint(e.domainHint),e.sid&&t.addSid(e.sid),e.nonce&&t.addNonce(e.nonce),e.state&&t.addState(e.state),(!j.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),t.createQueryString()},AuthorizationCodeClient}(nt),At=(function(e){function DeviceCodeClient(t){return e.call(this,t)||this}__extends$1(DeviceCodeClient,e),DeviceCodeClient.prototype.acquireToken=function(e){return __awaiter$1(this,void 0,void 0,(function(){var t,r,n;return __generator$1(this,(function(o){
switch(o.label){case 0:return[4,this.getDeviceCode(e)];case 1:return t=o.sent(),e.deviceCodeCallback(t),[4,this.acquireTokenWithDeviceCode(e,t)];case 2:return r=o.sent(),(n=new _t(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger)).validateTokenResponse(r),[2,n.handleServerTokenResponse(r,this.authority)]}}))}))},DeviceCodeClient.prototype.getDeviceCode=function(e){return __awaiter$1(this,void 0,void 0,(function(){var t,r;return __generator$1(this,(function(n){return t=this.createQueryString(e),r=this.createDefaultLibraryHeaders(),[2,this.executePostRequestToDeviceCodeEndpoint(this.authority.deviceCodeEndpoint,t,r)]}))}))},DeviceCodeClient.prototype.executePostRequestToDeviceCodeEndpoint=function(e,t,r){return __awaiter$1(this,void 0,void 0,(function(){var n,o,i,a,c,s,u;return __generator$1(this,(function(l){switch(l.label){case 0:return[4,this.networkClient.sendPostRequestAsync(e,{body:t,headers:r})];case 1:return n=l.sent().body,o=n.user_code,
i=n.device_code,a=n.verification_uri,c=n.expires_in,s=n.interval,u=n.message,[2,{userCode:o,deviceCode:i,verificationUri:a,expiresIn:c,interval:s,message:u}]}}))}))},DeviceCodeClient.prototype.createQueryString=function(e){var t=new it,r=new je(e.scopes||[]);return t.addScopes(r),t.addClientId(this.config.authOptions.clientId),(!j.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),t.createQueryString()},DeviceCodeClient.prototype.acquireTokenWithDeviceCode=function(e,t){return __awaiter$1(this,void 0,void 0,(function(){var r,n,o,i,a=this;return __generator$1(this,(function(c){return r=this.createTokenRequestBody(e,t),n=this.createDefaultTokenRequestHeaders(),o=st.nowSeconds()+t.expiresIn,i=1e3*t.interval,[2,new Promise((function(t,c){var s=setInterval((function(){return __awaiter$1(a,void 0,void 0,(function(){var i,a;return __generator$1(this,(function(u){
switch(u.label){case 0:return u.trys.push([0,5,,6]),e.cancel?(this.logger.error("Token request cancelled by setting DeviceCodeRequest.cancel = true"),clearInterval(s),c(F.createDeviceCodeCancelledError()),[3,4]):[3,1];case 1:return st.nowSeconds()>o?(this.logger.error("Device code expired. Expiration time of device code was "+o),clearInterval(s),c(F.createDeviceCodeExpiredError()),[3,4]):[3,2];case 2:return[4,this.executePostToTokenEndpoint(this.authority.tokenEndpoint,r,n)];case 3:(i=u.sent()).body&&i.body.error==le?this.logger.info(i.body.error_description):(clearInterval(s),t(i.body)),u.label=4;case 4:return[3,6];case 5:return a=u.sent(),clearInterval(s),c(a),[3,6];case 6:return[2]}}))}))}),i)}))]}))}))},DeviceCodeClient.prototype.createTokenRequestBody=function(e,t){var r=new it,n=new je(e.scopes||[]);r.addScopes(n),r.addClientId(this.config.authOptions.clientId),r.addGrantType(ge.DEVICE_CODE_GRANT),r.addDeviceCode(t.deviceCode)
;var o=e.correlationId||this.config.cryptoInterface.createNewGuid();return r.addCorrelationId(o),r.addClientInfo(),(!j.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(e.claims,this.config.authOptions.clientCapabilities),r.createQueryString()}}(nt),function(e){function RefreshTokenClient(t){return e.call(this,t)||this}return __extends$1(RefreshTokenClient,e),RefreshTokenClient.prototype.acquireToken=function(e){return __awaiter$1(this,void 0,void 0,(function(){var t,r;return __generator$1(this,(function(n){switch(n.label){case 0:return[4,this.executeTokenRequest(e,this.authority)];case 1:return t=n.sent(),(r=new _t(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger)).validateTokenResponse(t.body),[2,r.handleServerTokenResponse(t.body,this.authority)]}}))}))},RefreshTokenClient.prototype.executeTokenRequest=function(e,t){return __awaiter$1(this,void 0,void 0,(function(){var r,n
;return __generator$1(this,(function(o){return r=this.createTokenRequestBody(e),n=this.createDefaultTokenRequestHeaders(),[2,this.executePostToTokenEndpoint(t.tokenEndpoint,r,n)]}))}))},RefreshTokenClient.prototype.createTokenRequestBody=function(e){var t=new it;t.addClientId(this.config.authOptions.clientId);var r=new je(e.scopes||[]);t.addScopes(r),t.addGrantType(ge.REFRESH_TOKEN_GRANT),t.addClientInfo();var n=e.correlationId||this.config.cryptoInterface.createNewGuid();if(t.addCorrelationId(n),t.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){var o=this.config.clientCredentials.clientAssertion;t.addClientAssertion(o.assertion),t.addClientAssertionType(o.assertionType)}
return(!j.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),t.createQueryString()},RefreshTokenClient}(nt)),St=(function(e){function ClientCredentialClient(t){return e.call(this,t)||this}__extends$1(ClientCredentialClient,e),ClientCredentialClient.prototype.acquireToken=function(e){return __awaiter$1(this,void 0,void 0,(function(){var t;return __generator$1(this,(function(r){switch(r.label){case 0:return this.scopeSet=new je(e.scopes||[]),e.skipCache?[4,this.executeTokenRequest(e,this.authority)]:[3,2];case 1:return[2,r.sent()];case 2:return null==(t=this.getCachedAuthenticationResult())?[3,3]:[2,t];case 3:return[4,this.executeTokenRequest(e,this.authority)];case 4:return[2,r.sent()]}}))}))},ClientCredentialClient.prototype.getCachedAuthenticationResult=function(){var e=this.readAccessTokenFromCache()
;return!e||st.isTokenExpired(e.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds)?null:_t.generateAuthenticationResult({account:null,accessToken:e,idToken:null,refreshToken:null},null,!0)},ClientCredentialClient.prototype.readAccessTokenFromCache=function(){var e={homeAccountId:"",environment:this.authority.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:Ce.ACCESS_TOKEN,clientId:this.config.authOptions.clientId,realm:this.authority.tenant,target:this.scopeSet.printScopesLowerCase()},t=this.cacheManager.getCredentialsFilteredBy(e),r=Object.keys(t.accessTokens).map((function(e){return t.accessTokens[e]}));return r.length<1?null:r[0]},ClientCredentialClient.prototype.executeTokenRequest=function(e,t){return __awaiter$1(this,void 0,void 0,(function(){var r,n,o,i;return __generator$1(this,(function(a){switch(a.label){case 0:return r=this.createTokenRequestBody(e),n=this.createDefaultTokenRequestHeaders(),[4,this.executePostToTokenEndpoint(t.tokenEndpoint,r,n)]
;case 1:return o=a.sent(),(i=new _t(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger)).validateTokenResponse(o.body),[2,i.handleServerTokenResponse(o.body,this.authority,null,null,e.scopes)]}}))}))},ClientCredentialClient.prototype.createTokenRequestBody=function(e){var t=new it;t.addClientId(this.config.authOptions.clientId),t.addScopes(this.scopeSet),t.addGrantType(ge.CLIENT_CREDENTIALS_GRANT);var r=e.correlationId||this.config.cryptoInterface.createNewGuid();if(t.addCorrelationId(r),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){var n=this.config.clientCredentials.clientAssertion;t.addClientAssertion(n.assertion),t.addClientAssertionType(n.assertionType)}return(!j.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),
t.createQueryString()}}(nt),function(e){function SilentFlowClient(t){return e.call(this,t)||this}return __extends$1(SilentFlowClient,e),SilentFlowClient.prototype.acquireToken=function(e){return __awaiter$1(this,void 0,void 0,(function(){var t,r,n,o,i,a,c,s,u,l,d;return __generator$1(this,(function(h){if(!e)throw Fe.createEmptyTokenRequestError();if(!e.account)throw F.createNoAccountInSilentRequestError();if(t=new je(e.scopes||[]),r=Ye.generateAccountCacheKey(e.account),n=this.cacheManager.getAccount(r),o=n.homeAccountId,i=n.environment,a=this.readAccessTokenFromCache(o,i,t,n.realm),c=this.readRefreshTokenFromCache(o,i),this.isRefreshRequired(e,a)){if(!c)throw F.createNoTokensFoundError();return s=new At(this.config),u=__assign$1(__assign$1({},e),{refreshToken:c.secret}),[2,s.acquireToken(u)]}return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),l=this.readIdTokenFromCache(o,i,n.realm),d=new ct(l.secret,this.config.cryptoInterface),
[2,_t.generateAuthenticationResult({account:n,accessToken:a,idToken:l,refreshToken:c},d,!0)]}))}))},SilentFlowClient.prototype.isRefreshRequired=function(e,t){return!(!e.forceRefresh&&!e.claims)||!(t&&!st.isTokenExpired(t.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))},SilentFlowClient.prototype.readIdTokenFromCache=function(e,t,r){var n=Ae.generateCredentialCacheKey(e,t,Ce.ID_TOKEN,this.config.authOptions.clientId,r);return this.cacheManager.getCredential(n)},SilentFlowClient.prototype.readAccessTokenFromCache=function(e,t,r,n){var o={homeAccountId:e,environment:t,credentialType:Ce.ACCESS_TOKEN,clientId:this.config.authOptions.clientId,realm:n,target:r.printScopesLowerCase()},i=this.cacheManager.getCredentialsFilteredBy(o),a=Object.keys(i.accessTokens).map((function(e){return i.accessTokens[e]}));if(a.length>1);else if(a.length<1)return null;return a[0]},SilentFlowClient.prototype.readRefreshTokenFromCache=function(e,t){
var r=Ae.generateCredentialCacheKey(e,t,Ce.REFRESH_TOKEN,this.config.authOptions.clientId);return this.cacheManager.getCredential(r)},SilentFlowClient}(nt)),Tt=function(){function Authority(e,t){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t}return Object.defineProperty(Authority.prototype,"authorityType",{get:function(){var e=this.canonicalAuthorityUrlComponents.PathSegments;return e.length&&e[0].toLowerCase()===te?rt.Adfs:rt.Default},enumerable:!0,configurable:!0}),Object.defineProperty(Authority.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(e){this._canonicalAuthority=new Ge(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!0,configurable:!0}),Object.defineProperty(Authority.prototype,"canonicalAuthorityUrlComponents",{get:function(){
return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!0,configurable:!0}),Object.defineProperty(Authority.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(Authority.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete())return this.replaceTenant(this.tenantDiscoveryResponse.authorization_endpoint);throw F.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(Authority.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete())return this.replaceTenant(this.tenantDiscoveryResponse.token_endpoint);throw F.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(Authority.prototype,"deviceCodeEndpoint",{
get:function(){if(this.discoveryComplete())return this.tenantDiscoveryResponse.token_endpoint.replace("/token","/devicecode");throw F.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(Authority.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete())return this.replaceTenant(this.tenantDiscoveryResponse.end_session_endpoint);throw F.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(Authority.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete())return this.replaceTenant(this.tenantDiscoveryResponse.issuer);throw F.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Authority.prototype.replaceTenant=function(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)},Object.defineProperty(Authority.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){
return this.authorityType===rt.Adfs?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!0,configurable:!0}),Authority.prototype.discoveryComplete=function(){return!!this.tenantDiscoveryResponse},Authority.prototype.discoverEndpoints=function(e){return __awaiter$1(this,void 0,void 0,(function(){return __generator$1(this,(function(t){return[2,this.networkInterface.sendGetRequestAsync(e)]}))}))},Object.defineProperty(Authority.prototype,"aadInstanceDiscoveryEndpointUrl",{get:function(){return""+re+this.canonicalAuthority+"oauth2/v2.0/authorize"},enumerable:!0,configurable:!0}),Authority.prototype.validateAndSetPreferredNetwork=function(){return __awaiter$1(this,void 0,void 0,(function(){var e,t;return __generator$1(this,(function(r){switch(r.label){case 0:return e=this.canonicalAuthorityUrlComponents.HostNameAndPort,
0!==ze.getTrustedHostList().length?[3,2]:[4,ze.setTrustedAuthoritiesFromNetwork(this._canonicalAuthority,this.networkInterface)];case 1:r.sent(),r.label=2;case 2:if(!ze.IsInTrustedHostList(e))throw Fe.createUntrustedAuthorityError();return t=ze.getCloudDiscoveryMetadata(e).preferred_network,e!==t&&(this.canonicalAuthority=this.canonicalAuthority.replace(e,t)),[2]}}))}))},Authority.prototype.resolveEndpointsAsync=function(){return __awaiter$1(this,void 0,void 0,(function(){var e,t;return __generator$1(this,(function(r){switch(r.label){case 0:return[4,this.validateAndSetPreferredNetwork()];case 1:return r.sent(),e=this.defaultOpenIdConfigurationEndpoint,[4,this.discoverEndpoints(e)];case 2:return t=r.sent(),this.tenantDiscoveryResponse=t.body,[2]}}))}))},Authority}(),It=function(){function AuthorityFactory(){}return AuthorityFactory.createDiscoveredInstance=function(e,t){return __awaiter$1(this,void 0,void 0,(function(){var r,n;return __generator$1(this,(function(o){switch(o.label){
case 0:if((r=AuthorityFactory.createInstance(e,t)).discoveryComplete())return[2,r];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,r.resolveEndpointsAsync()];case 2:return o.sent(),[2,r];case 3:throw n=o.sent(),F.createEndpointDiscoveryIncompleteError(n);case 4:return[2]}}))}))},AuthorityFactory.createInstance=function(e,t){if(j.isEmpty(e))throw Fe.createUrlEmptyError();return new Tt(e,t)},AuthorityFactory}(),Rt=function(){function ServerTelemetryManager(e,t){this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.forceRefresh=e.forceRefresh||!1,this.telemetryCacheKey=ve.CACHE_KEY+Ee.CACHE_KEY_SEPARATOR+e.clientId}return ServerTelemetryManager.prototype.generateCurrentRequestHeaderValue=function(){var e=this.forceRefresh?1:0,t=""+this.apiId+ve.VALUE_SEPARATOR+e;return[ve.SCHEMA_VERSION,t,""].join(ve.CATEGORY_SEPARATOR)},ServerTelemetryManager.prototype.generateLastRequestHeaderValue=function(){
var e=this.getLastRequests(),t=e.failedRequests.join(ve.VALUE_SEPARATOR),r=e.errors.join(ve.VALUE_SEPARATOR),n=e.errorCount;return[ve.SCHEMA_VERSION,e.cacheHits,t,r,n].join(ve.CATEGORY_SEPARATOR)},ServerTelemetryManager.prototype.cacheFailedRequest=function(e){var t=this.getLastRequests();t.failedRequests.push(this.apiId,this.correlationId),t.errors.push(e.errorCode),t.errorCount+=1,t.errors.length>ve.FAILURE_LIMIT&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),this.cacheManager.setItem(this.telemetryCacheKey,t,me.TELEMETRY)},ServerTelemetryManager.prototype.incrementCacheHits=function(){var e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setItem(this.telemetryCacheKey,e,me.TELEMETRY),e.cacheHits},ServerTelemetryManager.prototype.getLastRequests=function(){return this.cacheManager.getItem(this.telemetryCacheKey,me.TELEMETRY)||{failedRequests:[],errors:[],errorCount:0,cacheHits:0}},ServerTelemetryManager.prototype.clearTelemetryCache=function(){
this.cacheManager.removeItem(this.telemetryCacheKey)},ServerTelemetryManager}(),bt="localStorage",Ot="sessionStorage",Pt="interaction.status",kt="interaction_in_progress",Nt="invalid_grant",Ut=483,Mt=600,qt=50,Dt="msal.js.browser";!function(e){e.GET="GET",e.POST="POST"}(ut||(ut={})),function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",e.SESSION_STATE="session.state",e.REQUEST_STATE="request.state",e.NONCE_IDTOKEN="nonce.id_token",e.ORIGIN_URI="request.origin",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.REQUEST_PARAMS="request.params",e.SCOPES="scopes"}(lt||(lt={})),function(e){e[e.acquireTokenRedirect=861]="acquireTokenRedirect",e[e.acquireTokenPopup=862]="acquireTokenPopup",e[e.ssoSilent=863]="ssoSilent",e[e.acquireTokenSilent_authCode=864]="acquireTokenSilent_authCode",e[e.handleRedirectPromise=865]="handleRedirectPromise",e[e.acquireTokenSilent_silentFlow=61]="acquireTokenSilent_silentFlow"}(dt||(dt={})),function(e){e.REDIRECT="redirect",
e.POPUP="popup",e.SILENT="silent"}(ht||(ht={}));var Ht={scopes:[oe,ie]},Lt=function(){function FetchClient(){}return FetchClient.prototype.sendGetRequestAsync=function(e,t){return __awaiter(this,void 0,void 0,(function(){var r,n;return __generator(this,(function(o){switch(o.label){case 0:return[4,fetch(e,{method:ut.GET,headers:this.getFetchHeaders(t)})];case 1:return r=o.sent(),n={headers:this.getHeaderDict(r.headers)},[4,r.json()];case 2:return[2,(n.body=o.sent(),n.status=r.status,n)]}}))}))},FetchClient.prototype.sendPostRequestAsync=function(e,t){return __awaiter(this,void 0,void 0,(function(){var r,n,o;return __generator(this,(function(i){switch(i.label){case 0:return r=t&&t.body||"",[4,fetch(e,{method:ut.POST,headers:this.getFetchHeaders(t),body:r})];case 1:return n=i.sent(),o={headers:this.getHeaderDict(n.headers)},[4,n.json()];case 2:return[2,(o.body=i.sent(),o.status=n.status,o)]}}))}))},FetchClient.prototype.getFetchHeaders=function(e){var t=new Headers
;return e&&e.headers?(Object.keys(e.headers).forEach((function(r){t.append(r,e.headers[r])})),t):t},FetchClient.prototype.getHeaderDict=function(e){var t={};return e.forEach((function(e,r){t[r]=e})),t},FetchClient}(),xt={noWindowObjectError:{code:"no_window_object",desc:"No window object detected."},pkceNotGenerated:{code:"pkce_not_created",desc:"The PKCE code challenge and verifier could not be generated."},cryptoDoesNotExist:{code:"crypto_nonexistent",desc:"The crypto object or function is not available."},httpMethodNotImplementedError:{code:"http_method_not_implemented",desc:"The HTTP method given has not been implemented in this library."},emptyNavigateUriError:{code:"empty_navigate_uri",desc:"Navigation URI is empty. Please check stack trace for more info."},hashEmptyError:{code:"hash_empty_error",desc:"Hash value cannot be processed because it is empty."},interactionInProgress:{code:"interaction_in_progress",
desc:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API."},popUpWindowError:{code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},emptyWindowError:{code:"empty_window_error",desc:"window.open returned null or undefined window object."},userCancelledError:{code:"user_cancelled",desc:"User cancelled the flow."},monitorWindowTimeoutError:{code:"monitor_window_timeout",desc:"Token acquisition in popup failed due to timeout."},redirectInIframeError:{code:"redirect_in_iframe",desc:"Code flow is not supported inside an iframe. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs."},blockTokenRequestsInHiddenIframeError:{code:"block_iframe_reload",
desc:"Request was blocked inside an iframe because MSAL detected an authentication response. Please ensure monitorWindowForHash was called."},iframeClosedPrematurelyError:{code:"iframe_closed_prematurely",desc:"The iframe being monitored was closed prematurely."},silentSSOInsufficientInfoError:{code:"silent_sso_error",desc:"Silent SSO could not be completed - insufficient information was provided. Please provide either a loginHint or sid."},silentPromptValueError:{code:"silent_prompt_value_error",desc:"The value given for the prompt value is not valid for silent requests - must be set to 'none'."},tokenRequestCacheError:{code:"token_request_cache_error",desc:"The token request could not be fetched from the cache correctly."},invalidCacheType:{code:"invalid_cache_type",desc:"Invalid cache type"}},Bt=function(e){function BrowserAuthError(t,r){var n=e.call(this,t,r)||this;return Object.setPrototypeOf(n,BrowserAuthError.prototype),n.name="BrowserAuthError",n}
return __extends(BrowserAuthError,e),BrowserAuthError.createNoWindowObjectError=function(){return new BrowserAuthError(xt.noWindowObjectError.code,xt.noWindowObjectError.desc)},BrowserAuthError.createPkceNotGeneratedError=function(e){return new BrowserAuthError(xt.pkceNotGenerated.code,xt.pkceNotGenerated.desc+" Detail:"+e)},BrowserAuthError.createCryptoNotAvailableError=function(e){return new BrowserAuthError(xt.cryptoDoesNotExist.code,xt.cryptoDoesNotExist.desc+" Detail:"+e)},BrowserAuthError.createHttpMethodNotImplementedError=function(e){return new BrowserAuthError(xt.httpMethodNotImplementedError.code,xt.httpMethodNotImplementedError.desc+" Given Method: "+e)},BrowserAuthError.createEmptyNavigationUriError=function(){return new BrowserAuthError(xt.emptyNavigateUriError.code,xt.emptyNavigateUriError.desc)},BrowserAuthError.createEmptyHashError=function(e){return new BrowserAuthError(xt.hashEmptyError.code,xt.hashEmptyError.desc+" Given Url: "+e)},
BrowserAuthError.createInteractionInProgressError=function(){return new BrowserAuthError(xt.interactionInProgress.code,xt.interactionInProgress.desc)},BrowserAuthError.createPopupWindowError=function(e){var t=xt.popUpWindowError.desc;return t=j.isEmpty(e)?t:t+" Details: "+e,new BrowserAuthError(xt.popUpWindowError.code,t)},BrowserAuthError.createEmptyWindowCreatedError=function(){return new BrowserAuthError(xt.emptyWindowError.code,xt.emptyWindowError.desc)},BrowserAuthError.createUserCancelledError=function(){return new BrowserAuthError(xt.userCancelledError.code,xt.userCancelledError.desc)},BrowserAuthError.createMonitorWindowTimeoutError=function(){return new BrowserAuthError(xt.monitorWindowTimeoutError.code,xt.monitorWindowTimeoutError.desc)},BrowserAuthError.createRedirectInIframeError=function(e){return new BrowserAuthError(xt.redirectInIframeError.code,xt.redirectInIframeError.desc+" (window.parent !== window) => "+e)},
BrowserAuthError.createBlockReloadInHiddenIframeError=function(){return new BrowserAuthError(xt.blockTokenRequestsInHiddenIframeError.code,xt.blockTokenRequestsInHiddenIframeError.desc)},BrowserAuthError.createIframeClosedPrematurelyError=function(){return new BrowserAuthError(xt.iframeClosedPrematurelyError.code,xt.iframeClosedPrematurelyError.desc)},BrowserAuthError.createSilentSSOInsufficientInfoError=function(){return new BrowserAuthError(xt.silentSSOInsufficientInfoError.code,xt.silentSSOInsufficientInfoError.desc)},BrowserAuthError.createSilentPromptValueError=function(e){return new BrowserAuthError(xt.silentPromptValueError.code,xt.silentPromptValueError.desc+" Given value: "+e)},BrowserAuthError.createTokenRequestCacheError=function(e){return new BrowserAuthError(xt.tokenRequestCacheError.code,xt.tokenRequestCacheError.desc+" Error Detail: "+e)},BrowserAuthError.createInvalidCacheTypeError=function(){
return new BrowserAuthError(xt.invalidCacheType.code,""+xt.invalidCacheType.desc)},BrowserAuthError}(i),Kt=function(){function XhrClient(){}return XhrClient.prototype.sendGetRequestAsync=function(e,t){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(r){return[2,this.sendRequestAsync(e,ut.GET,t)]}))}))},XhrClient.prototype.sendPostRequestAsync=function(e,t){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(r){return[2,this.sendRequestAsync(e,ut.POST,t)]}))}))},XhrClient.prototype.sendRequestAsync=function(e,t,r){var n=this;return new Promise((function(o,i){var a=new XMLHttpRequest;if(a.open(t,e,!0),n.setXhrHeaders(a,r),a.onload=function(){(a.status<200||a.status>=300)&&i(a.responseText);try{var e=JSON.parse(a.responseText),t={headers:n.getHeaderDict(a),body:e,status:a.status};o(t)}catch(e){i(a.responseText)}},a.onerror=function(){i(a.status)},"POST"===t&&r.body)a.send(r.body);else{
if("GET"!==t)throw Bt.createHttpMethodNotImplementedError(t);a.send()}}))},XhrClient.prototype.setXhrHeaders=function(e,t){t&&t.headers&&Object.keys(t.headers).forEach((function(r){e.setRequestHeader(r,t.headers[r])}))},XhrClient.prototype.getHeaderDict=function(e){var t=e.getAllResponseHeaders().trim().split(/[\r\n]+/),r={};return t.forEach((function(e){var t=e.split(": "),n=t.shift(),o=t.join(": ");r[n]=o})),r},XhrClient}(),Ft=function(){function BrowserUtils(){}return BrowserUtils.navigateWindow=function(e,t){t?window.location.replace(e):window.location.assign(e)},BrowserUtils.clearHash=function(){window.location.hash=""},BrowserUtils.replaceHash=function(e){var t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):""},BrowserUtils.isInIframe=function(){return window.parent!==window},BrowserUtils.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},BrowserUtils.getHomepage=function(){var e=new Ge(window.location.href).getUrlComponents()
;return e.Protocol+"//"+e.HostNameAndPort+"/"},BrowserUtils.getBrowserNetworkClient=function(){return window.fetch?new Lt:new Kt},BrowserUtils.blockReloadInHiddenIframes=function(){if(Ge.hashContainsKnownProperties(window.location.hash)&&BrowserUtils.isInIframe())throw Bt.createBlockReloadInHiddenIframeError()},BrowserUtils.detectIEOrEdge=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),r=e.indexOf("Trident/"),n=e.indexOf("Edge/");return t>0||r>0||n>0},BrowserUtils}(),jt={clientId:"",authority:""+ee,knownAuthorities:[],cloudDiscoveryMetadata:"",redirectUri:"",postLogoutRedirectUri:"",navigateToLoginRequestUrl:!0,clientCapabilities:[]},Gt={cacheLocation:Ot,storeAuthStateInCookie:!1},zt=__assign(__assign({},Je),{loggerOptions:{loggerCallback:function(){},piiLoggingEnabled:!1},networkClient:Ft.getBrowserNetworkClient(),windowHashTimeout:6e4,iframeHashTimeout:6e3,loadFrameTimeout:Ft.detectIEOrEdge()?500:0,asyncPopups:!1});var Yt={redirectUriNotSet:{
code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},postLogoutUriNotSet:{code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},storageNotSupportedError:{code:"storage_not_supported",desc:"Given storage configuration option was not supported."},noRedirectCallbacksSet:{code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},invalidCallbackObject:{code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."}},$t=function(e){function BrowserConfigurationAuthError(t,r){var n=e.call(this,t,r)||this;return n.name="BrowserConfigurationAuthError",
Object.setPrototypeOf(n,BrowserConfigurationAuthError.prototype),n}return __extends(BrowserConfigurationAuthError,e),BrowserConfigurationAuthError.createRedirectUriEmptyError=function(){return new BrowserConfigurationAuthError(Yt.redirectUriNotSet.code,Yt.redirectUriNotSet.desc)},BrowserConfigurationAuthError.createPostLogoutRedirectUriEmptyError=function(){return new BrowserConfigurationAuthError(Yt.postLogoutUriNotSet.code,Yt.postLogoutUriNotSet.desc)},BrowserConfigurationAuthError.createStorageNotSupportedError=function(e){return new BrowserConfigurationAuthError(Yt.storageNotSupportedError.code,Yt.storageNotSupportedError.desc+" Given Location: "+e)},BrowserConfigurationAuthError.createInvalidCallbackObjectError=function(e){return new BrowserConfigurationAuthError(Yt.invalidCallbackObject.code,Yt.invalidCallbackObject.desc+" Given value for callback function: "+e)},BrowserConfigurationAuthError.createRedirectCallbacksNotSetError=function(){
return new BrowserConfigurationAuthError(Yt.noRedirectCallbacksSet.code,Yt.noRedirectCallbacksSet.desc)},BrowserConfigurationAuthError}(i),Vt=function(e){function BrowserStorage(t,r){var n=e.call(this)||this;return n.validateWindowStorage(r.cacheLocation),n.cacheConfig=r,n.windowStorage=window[n.cacheConfig.cacheLocation],n.clientId=t,n.migrateCacheEntries(),n}return __extends(BrowserStorage,e),BrowserStorage.prototype.validateWindowStorage=function(e){if("undefined"==typeof window||!window)throw Bt.createNoWindowObjectError();if(e!==bt&&e!==Ot)throw $t.createStorageNotSupportedError(e);if(!!!window[e])throw $t.createStorageNotSupportedError(e)},BrowserStorage.prototype.migrateCacheEntries=function(){var e=this,t=Z+"."+z.ID_TOKEN,r=Z+"."+z.CLIENT_INFO,n=Z+"."+z.ERROR,o=Z+"."+z.ERROR_DESC,i=[this.windowStorage.getItem(t),this.windowStorage.getItem(r),this.windowStorage.getItem(n),this.windowStorage.getItem(o)];[z.ID_TOKEN,z.CLIENT_INFO,z.ERROR,z.ERROR_DESC].forEach((function(t,r){
return e.migrateCacheEntry(t,i[r])}))},BrowserStorage.prototype.migrateCacheEntry=function(e,t){t&&this.setItem(this.generateCacheKey(e),t,me.TEMPORARY)},BrowserStorage.prototype.validateObjectKey=function(e){JSON.parse(e)},BrowserStorage.prototype.setItem=function(e,t,r){switch(r){case me.ACCOUNT:case me.CREDENTIAL:case me.APP_METADATA:this.windowStorage.setItem(e,JSON.stringify(t));break;case me.TEMPORARY:var n=t;this.windowStorage.setItem(e,n),this.cacheConfig.storeAuthStateInCookie&&this.setItemCookie(e,n);break;case me.TELEMETRY:this.windowStorage.setItem(e,JSON.stringify(t));break;default:throw Bt.createInvalidCacheTypeError()}},BrowserStorage.prototype.getItem=function(e,t){var r=this.windowStorage.getItem(e);if(j.isEmpty(r))return null;switch(t){case me.ACCOUNT:var n=new Ye;return $e.toObject(n,JSON.parse(r));case me.CREDENTIAL:switch(Ae.getCredentialType(e)){case Ce.ID_TOKEN:var o=new pt;return $e.toObject(o,JSON.parse(r));case Ce.ACCESS_TOKEN:var i=new ft
;return $e.toObject(i,JSON.parse(r));case Ce.REFRESH_TOKEN:var a=new gt;return $e.toObject(a,JSON.parse(r))}case me.APP_METADATA:return JSON.parse(r);case me.TEMPORARY:var c=this.getItemCookie(e);return this.cacheConfig.storeAuthStateInCookie?c:r;case me.TELEMETRY:return JSON.parse(r);default:throw Bt.createInvalidCacheTypeError()}},BrowserStorage.prototype.removeItem=function(e){return this.windowStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&this.clearItemCookie(e),!0},BrowserStorage.prototype.containsKey=function(e){return this.windowStorage.hasOwnProperty(e)},BrowserStorage.prototype.getKeys=function(){return Object.keys(this.windowStorage)},BrowserStorage.prototype.clear=function(){var e;for(e in this.removeAllAccounts(),this.removeAppMetadata(),this.windowStorage)!this.windowStorage.hasOwnProperty(e)||-1===e.indexOf(Z)&&-1===e.indexOf(this.clientId)||this.removeItem(e)},BrowserStorage.prototype.setItemCookie=function(e,t,r){
var n=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/;";r&&(n+="expires="+this.getCookieExpirationTime(r)+";");document.cookie=n},BrowserStorage.prototype.getItemCookie=function(e){for(var t=encodeURIComponent(e)+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return decodeURIComponent(o.substring(t.length,o.length))}return""},BrowserStorage.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)},BrowserStorage.prototype.clearMsalCookie=function(e){var t=e?lt.NONCE_IDTOKEN+"|"+e:lt.NONCE_IDTOKEN;this.clearItemCookie(this.generateCacheKey(t)),this.clearItemCookie(this.generateCacheKey(lt.REQUEST_STATE)),this.clearItemCookie(this.generateCacheKey(lt.ORIGIN_URI))},BrowserStorage.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+864e5*e).toUTCString()},BrowserStorage.prototype.getCache=function(){return this.windowStorage},
BrowserStorage.prototype.setCache=function(){},BrowserStorage.prototype.generateCacheKey=function(e){try{return this.validateObjectKey(e),e}catch(t){return j.startsWith(e,Z)||j.startsWith(e,z.ADAL_ID_TOKEN)?e:Z+"."+this.clientId+"."+e}},BrowserStorage.prototype.generateAuthorityKey=function(e){return""+lt.AUTHORITY+ne+e},BrowserStorage.prototype.generateNonceKey=function(e){return""+lt.NONCE_IDTOKEN+ne+e},BrowserStorage.prototype.setAuthorityCache=function(e,t){var r=this.generateAuthorityKey(t);this.setItem(this.generateCacheKey(r),e,me.TEMPORARY)},BrowserStorage.prototype.getCachedAuthority=function(){var e=this.getItem(this.generateCacheKey(lt.REQUEST_STATE),me.TEMPORARY);return e?this.getItem(this.generateCacheKey(this.generateAuthorityKey(e)),me.TEMPORARY):null},BrowserStorage.prototype.updateCacheEntries=function(e,t,r){this.setItem(this.generateCacheKey(lt.REQUEST_STATE),e,me.TEMPORARY),this.setItem(this.generateCacheKey(this.generateNonceKey(e)),t,me.TEMPORARY),
this.setAuthorityCache(r,e)},BrowserStorage.prototype.resetRequestCache=function(e){var t=this;this.getKeys().forEach((function(r){j.isEmpty(e)||-1===r.indexOf(e)||t.removeItem(r)})),this.removeItem(this.generateCacheKey(lt.REQUEST_STATE)),this.removeItem(this.generateCacheKey(lt.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(lt.ORIGIN_URI)),this.removeItem(this.generateCacheKey(lt.URL_HASH))},BrowserStorage.prototype.cleanRequest=function(){this.removeItem(this.generateCacheKey(Pt));var e=this.getItem(this.generateCacheKey(lt.REQUEST_STATE),me.TEMPORARY);this.resetRequestCache(e||"")},BrowserStorage.prototype.cacheCodeRequest=function(e,t){this.setItem(this.generateCacheKey(lt.REQUEST_PARAMS),t.base64Encode(JSON.stringify(e)),me.TEMPORARY)},BrowserStorage.prototype.getCachedRequest=function(e,t){try{var r=this.getItem(this.generateCacheKey(lt.REQUEST_PARAMS),me.TEMPORARY),n=JSON.parse(t.base64Decode(r));if(this.removeItem(this.generateCacheKey(lt.REQUEST_PARAMS)),
j.isEmpty(n.authority)){var o=this.generateAuthorityKey(e),i=this.getItem(this.generateCacheKey(o),me.TEMPORARY);n.authority=i}return n}catch(e){throw Bt.createTokenRequestCacheError(e)}},BrowserStorage}($e),Wt=function(){function MathUtils(){}return MathUtils.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},MathUtils}(),Jt=function(){function GuidGenerator(e){this.cryptoObj=e}return GuidGenerator.prototype.generateGuid=function(){try{var e=new Uint8Array(16);return this.cryptoObj.getRandomValues(e),e[6]|=64,e[6]&=79,e[8]|=128,e[8]&=191,Wt.decimalToHex(e[0])+Wt.decimalToHex(e[1])+Wt.decimalToHex(e[2])+Wt.decimalToHex(e[3])+"-"+Wt.decimalToHex(e[4])+Wt.decimalToHex(e[5])+"-"+Wt.decimalToHex(e[6])+Wt.decimalToHex(e[7])+"-"+Wt.decimalToHex(e[8])+Wt.decimalToHex(e[9])+"-"+Wt.decimalToHex(e[10])+Wt.decimalToHex(e[11])+Wt.decimalToHex(e[12])+Wt.decimalToHex(e[13])+Wt.decimalToHex(e[14])+Wt.decimalToHex(e[15])}catch(e){
for(var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",n=0,o="",i=0;i<36;i++)"-"!==t[i]&&"4"!==t[i]&&(n=16*Math.random()|0),"x"===t[i]?o+=r[n]:"y"===t[i]?(n&=3,o+=r[n|=8]):o+=t[i];return o}},GuidGenerator.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},GuidGenerator}(),Qt=function(){function BrowserStringUtils(){}return BrowserStringUtils.stringToUtf8Arr=function(e){for(var t,r=0,n=e.length,o=0;o<n;o++)r+=(t=e.charCodeAt(o))<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6;for(var i=new Uint8Array(r),a=0,c=0;a<r;c++)(t=e.charCodeAt(c))<128?i[a++]=t:t<2048?(i[a++]=192+(t>>>6),i[a++]=128+(63&t)):t<65536?(i[a++]=224+(t>>>12),i[a++]=128+(t>>>6&63),i[a++]=128+(63&t)):t<2097152?(i[a++]=240+(t>>>18),i[a++]=128+(t>>>12&63),i[a++]=128+(t>>>6&63),i[a++]=128+(63&t)):t<67108864?(i[a++]=248+(t>>>24),i[a++]=128+(t>>>18&63),i[a++]=128+(t>>>12&63),i[a++]=128+(t>>>6&63),i[a++]=128+(63&t)):(i[a++]=252+(t>>>30),
i[a++]=128+(t>>>24&63),i[a++]=128+(t>>>18&63),i[a++]=128+(t>>>12&63),i[a++]=128+(t>>>6&63),i[a++]=128+(63&t));return i},BrowserStringUtils.utf8ArrToString=function(e){for(var t="",r=void 0,n=e.length,o=0;o<n;o++)r=e[o],t+=String.fromCharCode(r>251&&r<254&&o+5<n?1073741824*(r-252)+(e[++o]-128<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>247&&r<252&&o+4<n?(r-248<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>239&&r<248&&o+3<n?(r-240<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>223&&r<240&&o+2<n?(r-224<<12)+(e[++o]-128<<6)+e[++o]-128:r>191&&r<224&&o+1<n?(r-192<<6)+e[++o]-128:r);return t},BrowserStringUtils}(),Xt=function(){function Base64Encode(){}return Base64Encode.prototype.urlEncode=function(e){return encodeURIComponent(this.encode(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))},Base64Encode.prototype.urlEncodeArr=function(e){return this.base64EncArr(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},
Base64Encode.prototype.encode=function(e){var t=Qt.stringToUtf8Arr(e);return this.base64EncArr(t)},Base64Encode.prototype.base64EncArr=function(e){for(var t=(3-e.length%3)%3,r="",n=void 0,o=e.length,i=0,a=0;a<o;a++)n=a%3,i|=e[a]<<(16>>>n&24),2!==n&&e.length-a!=1||(r+=String.fromCharCode(this.uint6ToB64(i>>>18&63),this.uint6ToB64(i>>>12&63),this.uint6ToB64(i>>>6&63),this.uint6ToB64(63&i)),i=0);return 0===t?r:r.substring(0,r.length-t)+(1===t?"=":"==")},Base64Encode.prototype.uint6ToB64=function(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65},Base64Encode}(),Zt=function(){function Base64Decode(){}return Base64Decode.prototype.decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}var r=this.base64DecToArr(t);return decodeURIComponent(Qt.utf8ArrToString(r))},Base64Decode.prototype.base64DecToArr=function(e,t){
for(var r=e.replace(/[^A-Za-z0-9\+\/]/g,""),n=r.length,o=t?Math.ceil((3*n+1>>>2)/t)*t:3*n+1>>>2,i=new Uint8Array(o),a=void 0,c=void 0,s=0,u=0,l=0;l<n;l++)if(c=3&l,s|=this.b64ToUint6(r.charCodeAt(l))<<18-6*c,3===c||n-l==1){for(a=0;a<3&&u<o;a++,u++)i[u]=s>>>(16>>>a&24)&255;s=0}return i},Base64Decode.prototype.b64ToUint6=function(e){return e>64&&e<91?e-65:e>96&&e<123?e-71:e>47&&e<58?e+4:43===e?62:47===e?63:0},Base64Decode}(),er=function(){function PkceGenerator(e){this.base64Encode=new Xt,this.cryptoObj=e}return PkceGenerator.prototype.generateCodes=function(){return __awaiter(this,void 0,void 0,(function(){var e,t;return __generator(this,(function(r){switch(r.label){case 0:return e=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(e)];case 1:return t=r.sent(),[2,{verifier:e,challenge:t}]}}))}))},PkceGenerator.prototype.generateCodeVerifier=function(){try{var e=new Uint8Array(32);return this.cryptoObj.getRandomValues(e),this.base64Encode.urlEncodeArr(e)}catch(e){
throw Bt.createPkceNotGeneratedError(e)}},PkceGenerator.prototype.generateCodeChallengeFromVerifier=function(e){return __awaiter(this,void 0,void 0,(function(){var t,r;return __generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(e)];case 1:return t=n.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(t))];case 2:throw r=n.sent(),Bt.createPkceNotGeneratedError(r);case 3:return[2]}}))}))},PkceGenerator}(),tr=function(){function BrowserCrypto(){if(!this.hasCryptoAPI())throw Bt.createCryptoNotAvailableError("Browser crypto or msCrypto object not available.")}return BrowserCrypto.prototype.sha256Digest=function(e){return __awaiter(this,void 0,void 0,(function(){var t;return __generator(this,(function(r){return t=Qt.stringToUtf8Arr(e),[2,this.hasIECrypto()?this.getMSCryptoDigest("SHA-256",t):this.getSubtleCryptoDigest("SHA-256",t)]}))}))},BrowserCrypto.prototype.getRandomValues=function(e){var t=window.msCrypto||window.crypto
;if(!t.getRandomValues)throw Bt.createCryptoNotAvailableError("getRandomValues does not exist.");t.getRandomValues(e)},BrowserCrypto.prototype.hasIECrypto=function(){return!!window.msCrypto},BrowserCrypto.prototype.hasBrowserCrypto=function(){return!!window.crypto},BrowserCrypto.prototype.hasCryptoAPI=function(){return this.hasIECrypto()||this.hasBrowserCrypto()},BrowserCrypto.prototype.getSubtleCryptoDigest=function(e,t){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(r){return[2,window.crypto.subtle.digest(e,t)]}))}))},BrowserCrypto.prototype.getMSCryptoDigest=function(e,t){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(r){return[2,new Promise((function(r,n){var o=window.msCrypto.subtle.digest(e,t.buffer);o.addEventListener("complete",(function(e){r(e.target.result)})),o.addEventListener("error",(function(e){n(e)}))}))]}))}))},BrowserCrypto}(),rr=function(){function CryptoOps(){this.browserCrypto=new tr,
this.b64Encode=new Xt,this.b64Decode=new Zt,this.guidGenerator=new Jt(this.browserCrypto),this.pkceGenerator=new er(this.browserCrypto)}return CryptoOps.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},CryptoOps.prototype.base64Encode=function(e){return this.b64Encode.encode(e)},CryptoOps.prototype.base64Decode=function(e){return this.b64Decode.decode(e)},CryptoOps.prototype.generatePkceCodes=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){return[2,this.pkceGenerator.generateCodes()]}))}))},CryptoOps}(),nr=function(){function InteractionHandler(e,t){this.authModule=e,this.browserStorage=t}return InteractionHandler.prototype.handleCodeResponse=function(e){return __awaiter(this,void 0,void 0,(function(){var t,r,n,o,i;return __generator(this,(function(a){switch(a.label){case 0:if(j.isEmpty(e))throw Bt.createEmptyHashError(e)
;return t=this.browserStorage.getItem(this.browserStorage.generateCacheKey(lt.REQUEST_STATE),me.TEMPORARY),r=this.authModule.handleFragmentResponse(e,t),n=this.browserStorage.generateNonceKey(t),o=this.browserStorage.getItem(this.browserStorage.generateCacheKey(n),me.TEMPORARY),this.authCodeRequest.code=r,[4,this.authModule.acquireToken(this.authCodeRequest,o,t)];case 1:return i=a.sent(),this.browserStorage.cleanRequest(),[2,i]}}))}))},InteractionHandler}(),or=function(e){function RedirectHandler(){return null!==e&&e.apply(this,arguments)||this}return __extends(RedirectHandler,e),RedirectHandler.prototype.initiateAuthRequest=function(e,t,r,n){if(j.isEmpty(e))throw this.authModule.logger.info("Navigate url is empty"),Bt.createEmptyNavigationUriError();r&&this.browserStorage.setItem(this.browserStorage.generateCacheKey(lt.ORIGIN_URI),r,me.TEMPORARY),this.browserStorage.setItem(this.browserStorage.generateCacheKey(Pt),kt,me.TEMPORARY),this.browserStorage.cacheCodeRequest(t,n),
this.authModule.logger.infoPii("Navigate to:"+e);var o=Ft.isInIframe();if(o)throw Bt.createRedirectInIframeError(o);return Ft.navigateWindow(e),window},RedirectHandler.prototype.handleCodeResponse=function(e,t){return __awaiter(this,void 0,void 0,(function(){var r,n,o,i,a;return __generator(this,(function(c){switch(c.label){case 0:if(j.isEmpty(e))throw Bt.createEmptyHashError(e);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Pt)),r=this.browserStorage.getItem(this.browserStorage.generateCacheKey(lt.REQUEST_STATE),me.TEMPORARY),n=this.authModule.handleFragmentResponse(e,r),o=this.browserStorage.generateNonceKey(r),i=this.browserStorage.getItem(this.browserStorage.generateCacheKey(o),me.TEMPORARY),this.authCodeRequest=this.browserStorage.getCachedRequest(r,t),this.authCodeRequest.code=n,[4,this.authModule.acquireToken(this.authCodeRequest,i,r)];case 1:return a=c.sent(),this.browserStorage.cleanRequest(),[2,a]}}))}))},RedirectHandler}(nr),ir=function(e){
function PopupHandler(t,r){var n=e.call(this,t,r)||this;return n.unloadWindow=n.unloadWindow.bind(n),n}return __extends(PopupHandler,e),PopupHandler.prototype.initiateAuthRequest=function(e,t,r){if(j.isEmpty(e))throw this.authModule.logger.error("Navigate url is empty"),Bt.createEmptyNavigationUriError();return this.authCodeRequest=t,this.browserStorage.setItem(this.browserStorage.generateCacheKey(Pt),kt,me.TEMPORARY),this.authModule.logger.infoPii("Navigate to:"+e),this.openPopup(e,r)},PopupHandler.prototype.monitorPopupForHash=function(e,t){var r=this;return new Promise((function(n,o){var i=t/qt,a=0,c=setInterval((function(){if(e.closed)return r.cleanPopup(),clearInterval(c),void o(Bt.createUserCancelledError());var t;try{t=e.location.href}catch(e){}if(!j.isEmpty(t)&&"about:blank"!==t){a++;var s=e.location.hash;return Ge.hashContainsKnownProperties(s)?(r.cleanPopup(e),clearInterval(c),void n(s)):a>i?(r.cleanPopup(e),clearInterval(c),
void o(Bt.createMonitorWindowTimeoutError())):void 0}}),qt)}))},PopupHandler.prototype.openPopup=function(e,t){try{var r=void 0;if(t?(r=t).location.assign(e):void 0===t&&(r=PopupHandler.openSizedPopup(e)),!r)throw Bt.createEmptyWindowCreatedError();return r.focus&&r.focus(),this.currentWindow=r,window.addEventListener("beforeunload",this.unloadWindow),r}catch(e){throw this.authModule.logger.error("error opening popup "+e.message),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Pt)),Bt.createPopupWindowError(e.toString())}},PopupHandler.openSizedPopup=function(e){void 0===e&&(e="about:blank");var t=window.screenLeft?window.screenLeft:window.screenX,r=window.screenTop?window.screenTop:window.screenY,n=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,o=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,i=Math.max(0,n/2-Ut/2+t),a=Math.max(0,o/2-Mt/2+r)
;return window.open(e,Q,"width="+Ut+", height="+Mt+", top="+a+", left="+i)},PopupHandler.prototype.unloadWindow=function(e){this.browserStorage.cleanRequest(),this.currentWindow.close(),delete e.returnValue},PopupHandler.prototype.cleanPopup=function(e){e&&e.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Pt))},PopupHandler}(nr),ar=function(e){function SilentHandler(t,r,n){var o=e.call(this,t,r)||this;return o.loadFrameTimeout=n,o}return __extends(SilentHandler,e),SilentHandler.prototype.initiateAuthRequest=function(e,t,r){return __awaiter(this,void 0,void 0,(function(){var n,o;return __generator(this,(function(i){switch(i.label){case 0:if(j.isEmpty(e))throw this.authModule.logger.info("Navigate url is empty"),Bt.createEmptyNavigationUriError();return this.authCodeRequest=t,n=r?"msalTokenFrame"+r:"msalTokenFrame",this.loadFrameTimeout?[4,this.loadFrame(e,n)]:[3,2];case 1:return o=i.sent(),[3,3]
;case 2:o=this.loadFrameSync(e,n),i.label=3;case 3:return[2,o]}}))}))},SilentHandler.prototype.monitorIframeForHash=function(e,t){var r=this;return new Promise((function(n,o){var i=window.performance.now()+t,a=setInterval((function(){if(window.performance.now()>i)return r.removeHiddenIframe(e),clearInterval(a),void o(Bt.createMonitorWindowTimeoutError());var t;try{t=e.contentWindow.location.href}catch(e){}if(!j.isEmpty(t)){var c=e.contentWindow.location.hash;return Ge.hashContainsKnownProperties(c)?(r.removeHiddenIframe(e),clearInterval(a),void n(c)):void 0}}),qt)}))},SilentHandler.prototype.loadFrame=function(e,t){var r=this;return new Promise((function(n,o){setTimeout((function(){var i=r.loadFrameSync(e,t);i?n(i):o("Unable to load iframe with name: "+t)}),r.loadFrameTimeout)}))},SilentHandler.prototype.loadFrameSync=function(e,t){var r=this.getHiddenIframe(t);return r?(""!==r.src&&"about:blank"!==r.src||(r.src=e),r):null},SilentHandler.prototype.getHiddenIframe=function(e){
if(void 0===e)return null;var t=document.getElementById(e);if(!t){if(document.createElement&&document.documentElement&&-1===window.navigator.userAgent.indexOf("MSIE 5.0")){var r=document.createElement("iframe");r.setAttribute("id",e),r.style.visibility="hidden",r.style.position="absolute",r.style.width=r.style.height="0",r.style.border="0",r.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),t=document.getElementsByTagName("body")[0].appendChild(r)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeend","<iframe name='"+e+"' id='"+e+"' style='display:none'></iframe>");window.frames&&window.frames[e]&&(t=window.frames[e])}return t},SilentHandler.prototype.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},SilentHandler}(nr),cr=function(){function BrowserProtocolUtils(){}return BrowserProtocolUtils.extractBrowserRequestState=function(e,t){if(j.isEmpty(t))return null;try{
return wt.parseRequestState(e,t).libraryState.meta}catch(e){throw F.createInvalidStateError(t,e)}},BrowserProtocolUtils}(),sr=function(){function PublicClientApplication(e){this.config=function buildConfiguration(e){var t=e.auth,r=e.cache,n=e.system;return{auth:__assign(__assign({},jt),t),cache:__assign(__assign({},Gt),r),system:__assign(__assign({},zt),n)}}(e),this.browserCrypto=new rr,this.networkClient=this.config.system.networkClient,this.browserStorage=new Vt(this.config.auth.clientId,this.config.cache),this.logger=new J(this.config.system.loggerOptions),ze.setTrustedAuthoritiesFromConfig(this.config.auth.knownAuthorities,this.config.auth.cloudDiscoveryMetadata),this.defaultAuthority=null}return PublicClientApplication.prototype.handleRedirectPromise=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){return[2,this.handleRedirectResponse()]}))}))},PublicClientApplication.prototype.handleRedirectResponse=function(){
return __awaiter(this,void 0,void 0,(function(){var e,t,r,n,o,i;return __generator(this,(function(a){return e=this.getRedirectResponseHash(),j.isEmpty(e)?[2,null]:(t=this.browserStorage.getItem(this.browserStorage.generateCacheKey(lt.ORIGIN_URI),me.TEMPORARY),r=Ge.removeHashFromUrl(t||""),n=Ge.removeHashFromUrl(window.location.href),r===n&&this.config.auth.navigateToLoginRequestUrl?(t.indexOf("#")>-1&&Ft.replaceHash(t),[2,this.handleHash(e)]):this.config.auth.navigateToLoginRequestUrl?(Ft.isInIframe()||(o=this.browserStorage.generateCacheKey(lt.URL_HASH),this.browserStorage.setItem(o,e,me.TEMPORARY),t&&"null"!==t?Ft.navigateWindow(t,!0):(i=Ft.getHomepage(),this.browserStorage.setItem(this.browserStorage.generateCacheKey(lt.ORIGIN_URI),i,me.TEMPORARY),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),Ft.navigateWindow(i,!0))),[2,null]):[2,this.handleHash(e)])}))}))},PublicClientApplication.prototype.getRedirectResponseHash=function(){
var e=window.location.hash,t=Ge.hashContainsKnownProperties(e),r=this.browserStorage.getItem(this.browserStorage.generateCacheKey(lt.URL_HASH),me.TEMPORARY);this.browserStorage.removeItem(this.browserStorage.generateCacheKey(lt.URL_HASH));var n=t?e:r;if(n){var o=Ge.getDeserializedHash(n);return cr.extractBrowserRequestState(this.browserCrypto,o.state).interactionType!==ht.REDIRECT?null:(Ft.clearHash(),n)}return this.browserStorage.cleanRequest(),null},PublicClientApplication.prototype.handleHash=function(e){return __awaiter(this,void 0,void 0,(function(){var t,r,n,o,i,a;return __generator(this,(function(c){switch(c.label){case 0:t=this.browserStorage.getItem(this.browserStorage.generateCacheKey(lt.REQUEST_PARAMS),me.TEMPORARY),r=JSON.parse(this.browserCrypto.base64Decode(t)),n=this.initializeServerTelemetryManager(dt.handleRedirectPromise,r.correlationId),c.label=1;case 1:return c.trys.push([1,4,,5]),o=this.browserStorage.getCachedAuthority(),[4,this.createAuthCodeClient(n,o)];case 2:
return i=c.sent(),[4,new or(i,this.browserStorage).handleCodeResponse(e,this.browserCrypto)];case 3:return[2,c.sent()];case 4:throw a=c.sent(),n.cacheFailedRequest(a),this.browserStorage.cleanRequest(),a;case 5:return[2]}}))}))},PublicClientApplication.prototype.loginRedirect=function(e){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){return[2,this.acquireTokenRedirect(e||Ht)]}))}))},PublicClientApplication.prototype.acquireTokenRedirect=function(e){return __awaiter(this,void 0,void 0,(function(){var t,r,n,o,i,a,c,s;return __generator(this,(function(u){switch(u.label){case 0:t=this.preflightInteractiveRequest(e,ht.REDIRECT),r=this.initializeServerTelemetryManager(dt.acquireTokenRedirect,t.correlationId),u.label=1;case 1:return u.trys.push([1,5,,6]),[4,this.initializeAuthorizationCodeRequest(t)];case 2:return n=u.sent(),[4,this.createAuthCodeClient(r,t.authority)];case 3:return o=u.sent(),i=new or(o,this.browserStorage),[4,o.getAuthCodeUrl(t)]
;case 4:return a=u.sent(),c=e&&e.redirectStartPage||window.location.href,i.initiateAuthRequest(a,n,c,this.browserCrypto),[3,6];case 5:throw s=u.sent(),r.cacheFailedRequest(s),this.browserStorage.cleanRequest(),s;case 6:return[2]}}))}))},PublicClientApplication.prototype.loginPopup=function(e){return this.acquireTokenPopup(e||Ht)},PublicClientApplication.prototype.acquireTokenPopup=function(e){if(this.config.system.asyncPopups)return this.acquireTokenPopupAsync(e);var t=ir.openSizedPopup();return this.acquireTokenPopupAsync(e,t)},PublicClientApplication.prototype.acquireTokenPopupAsync=function(e,t){return __awaiter(this,void 0,void 0,(function(){var r,n,o,i,a,c,s,u,l;return __generator(this,(function(d){switch(d.label){case 0:r=this.preflightInteractiveRequest(e,ht.POPUP),n=this.initializeServerTelemetryManager(dt.acquireTokenPopup,r.correlationId),d.label=1;case 1:return d.trys.push([1,7,,8]),[4,this.initializeAuthorizationCodeRequest(r)];case 2:return o=d.sent(),
[4,this.createAuthCodeClient(n,r.authority)];case 3:return[4,(i=d.sent()).getAuthCodeUrl(r)];case 4:return a=d.sent(),c=new ir(i,this.browserStorage),s=c.initiateAuthRequest(a,o,t),[4,c.monitorPopupForHash(s,this.config.system.windowHashTimeout)];case 5:return u=d.sent(),[4,c.handleCodeResponse(u)];case 6:return[2,d.sent()];case 7:throw l=d.sent(),n.cacheFailedRequest(l),this.browserStorage.cleanRequest(),l;case 8:return[2]}}))}))},PublicClientApplication.prototype.ssoSilent=function(e){return __awaiter(this,void 0,void 0,(function(){var t,r,n,o,i,a,c;return __generator(this,(function(s){switch(s.label){case 0:if(Ft.blockReloadInHiddenIframes(),j.isEmpty(e.loginHint)&&j.isEmpty(e.sid))throw Bt.createSilentSSOInsufficientInfoError();if(e.prompt&&e.prompt!==pe.NONE)throw Bt.createSilentPromptValueError(e.prompt);t=this.initializeAuthorizationRequest(__assign(__assign({},e),{prompt:pe.NONE}),ht.SILENT),r=this.initializeServerTelemetryManager(dt.ssoSilent,t.correlationId),s.label=1;case 1:
return s.trys.push([1,6,,7]),[4,this.initializeAuthorizationCodeRequest(t)];case 2:return n=s.sent(),o=t.scopes?t.scopes.join(" "):"",[4,this.createAuthCodeClient(r,t.authority)];case 3:return[4,(i=s.sent()).getAuthCodeUrl(t)];case 4:return a=s.sent(),[4,this.silentTokenHelper(a,n,i,o)];case 5:return[2,s.sent()];case 6:throw c=s.sent(),r.cacheFailedRequest(c),this.browserStorage.cleanRequest(),c;case 7:return[2]}}))}))},PublicClientApplication.prototype.acquireTokenSilent=function(e){return __awaiter(this,void 0,void 0,(function(){var t,r,n,o,i,a,c,s,u,l,d,h;return __generator(this,(function(p){switch(p.label){case 0:Ft.blockReloadInHiddenIframes(),t=__assign(__assign({},e),this.initializeBaseRequest(e)),r=this.initializeServerTelemetryManager(dt.acquireTokenSilent_silentFlow,t.correlationId),p.label=1;case 1:return p.trys.push([1,4,,12]),[4,this.createSilentFlowClient(r,t.authority)];case 2:return[4,p.sent().acquireToken(t)];case 3:return[2,p.sent()];case 4:if(n=p.sent(),
r.cacheFailedRequest(n),o=n instanceof at,i=n instanceof Ct,a=n.errorCode===Nt,!o||!a||i)return[3,11];c=this.initializeAuthorizationRequest(__assign(__assign({},t),{redirectUri:e.redirectUri,prompt:pe.NONE}),ht.SILENT),r=this.initializeServerTelemetryManager(dt.acquireTokenSilent_authCode,c.correlationId),p.label=5;case 5:return p.trys.push([5,10,,11]),[4,this.initializeAuthorizationCodeRequest(c)];case 6:return s=p.sent(),[4,this.createAuthCodeClient(r,c.authority)];case 7:return[4,(u=p.sent()).getAuthCodeUrl(c)];case 8:return l=p.sent(),d=c.scopes?c.scopes.join(" "):"",[4,this.silentTokenHelper(l,s,u,d)];case 9:return[2,p.sent()];case 10:throw h=p.sent(),r.cacheFailedRequest(h),this.browserStorage.cleanRequest(),h;case 11:throw n;case 12:return[2]}}))}))},PublicClientApplication.prototype.silentTokenHelper=function(e,t,r,n){return __awaiter(this,void 0,void 0,(function(){var o,i,a;return __generator(this,(function(c){switch(c.label){case 0:
return[4,(o=new ar(r,this.browserStorage,this.config.system.loadFrameTimeout)).initiateAuthRequest(e,t,n)];case 1:return i=c.sent(),[4,o.monitorIframeForHash(i,this.config.system.iframeHashTimeout)];case 2:return a=c.sent(),[2,o.handleCodeResponse(a)]}}))}))},PublicClientApplication.prototype.logout=function(e){return __awaiter(this,void 0,void 0,(function(){var t,r,n;return __generator(this,(function(o){switch(o.label){case 0:return t=this.initializeLogoutRequest(e),[4,this.createAuthCodeClient(null,t&&t.authority)];case 1:return r=o.sent(),n=r.getLogoutUri(t),Ft.navigateWindow(n),[2]}}))}))},PublicClientApplication.prototype.getAllAccounts=function(){return this.browserStorage.getAllAccounts()},PublicClientApplication.prototype.getAccountByUsername=function(e){var t=this.getAllAccounts();return!j.isEmpty(e)&&t&&t.length&&t.filter((function(t){return t.username.toLowerCase()===e.toLowerCase()}))[0]||null},PublicClientApplication.prototype.getAccountByHomeId=function(e){
var t=this.getAllAccounts();return!j.isEmpty(e)&&t&&t.length&&t.filter((function(t){return t.homeAccountId===e}))[0]||null},PublicClientApplication.prototype.getRedirectUri=function(e){return e||this.config.auth.redirectUri||Ft.getCurrentUri()},PublicClientApplication.prototype.getPostLogoutRedirectUri=function(e){return e||this.config.auth.postLogoutRedirectUri||Ft.getCurrentUri()},PublicClientApplication.prototype.getDiscoveredDefaultAuthority=function(){return __awaiter(this,void 0,void 0,(function(){var e;return __generator(this,(function(t){switch(t.label){case 0:return this.defaultAuthority?[3,2]:(e=this,[4,It.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient)]);case 1:e.defaultAuthority=t.sent(),t.label=2;case 2:return[2,this.defaultAuthority]}}))}))},PublicClientApplication.prototype.interactionInProgress=function(){return this.browserStorage.getItem(this.browserStorage.generateCacheKey(Pt),me.TEMPORARY)===kt},
PublicClientApplication.prototype.createAuthCodeClient=function(e,t){return __awaiter(this,void 0,void 0,(function(){var r;return __generator(this,(function(n){switch(n.label){case 0:return[4,this.getClientConfiguration(e,t)];case 1:return r=n.sent(),[2,new vt(r)]}}))}))},PublicClientApplication.prototype.createSilentFlowClient=function(e,t){return __awaiter(this,void 0,void 0,(function(){var r;return __generator(this,(function(n){switch(n.label){case 0:return[4,this.getClientConfiguration(e,t)];case 1:return r=n.sent(),[2,new St(r)]}}))}))},PublicClientApplication.prototype.getClientConfiguration=function(e,t){return __awaiter(this,void 0,void 0,(function(){var r,n;return __generator(this,(function(o){switch(o.label){case 0:return j.isEmpty(t)||t===this.config.auth.authority?[3,2]:[4,It.createDiscoveredInstance(t,this.config.system.networkClient)];case 1:return n=o.sent(),[3,4];case 2:return[4,this.getDiscoveredDefaultAuthority()];case 3:n=o.sent(),o.label=4;case 4:return r=n,[2,{
authOptions:{clientId:this.config.auth.clientId,authority:r,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds},loggerOptions:{loggerCallback:this.config.system.loggerOptions.loggerCallback,piiLoggingEnabled:this.config.system.loggerOptions.piiLoggingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:e,libraryInfo:{sku:Dt,version:"2.1.0",cpu:"",os:""}}]}}))}))},PublicClientApplication.prototype.preflightInteractiveRequest=function(e,t){if(Ft.blockReloadInHiddenIframes(),this.interactionInProgress())throw Bt.createInteractionInProgressError();return this.initializeAuthorizationRequest(e,t)},PublicClientApplication.prototype.initializeBaseRequest=function(e){var t=__assign({},e)
;return j.isEmpty(t.authority)&&(t.authority=this.config.auth.authority),t.correlationId=e&&e.correlationId||this.browserCrypto.createNewGuid(),t},PublicClientApplication.prototype.initializeServerTelemetryManager=function(e,t,r){var n={clientId:this.config.auth.clientId,correlationId:t,apiId:e,forceRefresh:r||!1};return new Rt(n,this.browserStorage)},PublicClientApplication.prototype.setDefaultScopes=function(e){return __assign(__assign({},e),{scopes:__spreadArrays(e&&e.scopes||[],Ht.scopes)})},PublicClientApplication.prototype.initializeAuthorizationRequest=function(e,t){var r=__assign({},e);if(r.redirectUri=this.getRedirectUri(r.redirectUri),j.isEmpty(r.loginHint)){var n=this.browserStorage.getItem(z.ADAL_ID_TOKEN,me.TEMPORARY);if(!j.isEmpty(n)){var o=new ct(n,this.browserCrypto);this.browserStorage.removeItem(z.ADAL_ID_TOKEN),o.claims&&o.claims.upn&&(r.loginHint=o.claims.upn)}}var i={interactionType:t};return r.state=wt.setRequestState(this.browserCrypto,e&&e.state||"",i),
j.isEmpty(r.nonce)&&(r.nonce=this.browserCrypto.createNewGuid()),r.responseMode=fe.FRAGMENT,r=__assign(__assign({},r),this.initializeBaseRequest(r)),this.browserStorage.updateCacheEntries(r.state,r.nonce,r.authority),__assign(__assign({},r),this.setDefaultScopes(r))},PublicClientApplication.prototype.initializeAuthorizationCodeRequest=function(e){return __awaiter(this,void 0,void 0,(function(){var t,r;return __generator(this,(function(n){switch(n.label){case 0:return[4,this.browserCrypto.generatePkceCodes()];case 1:return t=n.sent(),r=__assign(__assign({},e),{redirectUri:e.redirectUri,code:"",codeVerifier:t.verifier}),e.codeChallenge=t.challenge,e.codeChallengeMethod=se,[2,r]}}))}))},PublicClientApplication.prototype.initializeLogoutRequest=function(e){var t=__assign({},e);return j.isEmpty(t.authority)&&(t.authority=this.config.auth.authority),t.correlationId=t&&t.correlationId||this.browserCrypto.createNewGuid(),
t.postLogoutRedirectUri=this.getPostLogoutRedirectUri(e?e.postLogoutRedirectUri:""),t},PublicClientApplication}()},126:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.client=void 0;const n=r(104);t.client=new n.PublicClientApplication({auth:{clientId:"67dc74f0-fb8c-47a4-8435-63253a3fc3bb",authority:"https://login.microsoftonline.com/organizations/",navigateToLoginRequestUrl:!1},cache:{cacheLocation:"localStorage"}})},474:function(e,t,r){e.exports=r(475)},475:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(126);!function login(){var e;const t=new URL(location.href),r=JSON.parse(null!==(e=t.searchParams.get("params"))&&void 0!==e?e:JSON.stringify(null));n.client.loginRedirect(r)}()}})}));